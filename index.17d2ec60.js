!function(){function e(e){return e&&e.__esModule?e.default:e}function t(e,t,n,r){Object.defineProperty(e,t,{get:n,set:r,enumerable:!0,configurable:!0})}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},r={},a={},o=n.parcelRequire60ca;null==o&&((o=function(e){if(e in r)return r[e].exports;if(e in a){var t=a[e];delete a[e];var n={id:e,exports:{}};return r[e]=n,t.call(n.exports,n,n.exports),n.exports}var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,t){a[e]=t},n.parcelRequire60ca=o),o.register("hKHmD",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n;return e}})),o.register("kMC0W",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e){if(Array.isArray(e))return r.default(e)};var n,r=(n=o("8NIkP"))&&n.__esModule?n:{default:n}})),o.register("8NIkP",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}})),o.register("7AJDX",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}})),o.register("8CtQK",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}})),o.register("auk6i",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e,t){if(!e)return;if("string"==typeof e)return r.default(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r.default(e,t)};var n,r=(n=o("8NIkP"))&&n.__esModule?n:{default:n}})),o.register("8slrw",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e){if(Array.isArray(e))return e}})),o.register("ifqQW",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}})),o.register("ds8z5",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}})),o.register("gD1JV",(function(e,t){"use strict";function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e,t){return n(e,t)}})),o.register("ge8co",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e,t,n){return a.apply(null,arguments)};var n,r=(n=o("gD1JV"))&&n.__esModule?n:{default:n};function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function a(e,t,n){return(a=i()?Reflect.construct:function(e,t,n){var i=[null];i.push.apply(i,t);var a=new(Function.bind.apply(e,i));return n&&r.default(a,n.prototype),a}).apply(null,arguments)}})),o.register("cZGw3",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e){return-1!==Function.toString.call(e).indexOf("[native code]")}})),o.register("fVNic",(function(e,t){"use strict";function n(e){return(n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e){return n(e)}})),o.register("aTHs7",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}})),o.register("jmhxu",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e,t){return!t||"object"!==r.default(t)&&"function"!=typeof t?n.default(e):t};var n=i(o("ds8z5")),r=i(o("l5bVx"));function i(e){return e&&e.__esModule?e:{default:e}}})),o.register("l5bVx",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e){return e&&e.constructor===Symbol?"symbol":typeof e}})),o.register("2mz0K",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=r.default(e)););return e};var n,r=(n=o("fVNic"))&&n.__esModule?n:{default:n}}));var s={};t(s,"_DEFAULT_ENTRY_NAME",(function(){return Xt})),t(s,"_apps",(function(){return Zt})),t(s,"_components",(function(){return en})),t(s,"_addComponent",(function(){return tn})),t(s,"_addOrOverwriteComponent",(function(){return nn})),t(s,"_registerComponent",(function(){return rn})),t(s,"_getProvider",(function(){return an})),t(s,"_removeServiceInstance",(function(){return on})),t(s,"_clearComponents",(function(){return sn})),t(s,"SDK_VERSION",(function(){return hn})),t(s,"initializeApp",(function(){return fn})),t(s,"getApp",(function(){return dn})),t(s,"getApps",(function(){return pn})),t(s,"deleteApp",(function(){return vn})),t(s,"registerVersion",(function(){return mn})),t(s,"onLog",(function(){return gn})),t(s,"setLogLevel",(function(){return kn})),t(s,"FirebaseError",(function(){return Oe}));var u={};function c(e,t,n,r,i,a,o){try{var s=e[a](o),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}Object.defineProperty(u,"__esModule",{value:!0}),u.default=function(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){c(a,r,i,o,s,"next",e)}function s(e){c(a,r,i,o,s,"throw",e)}o(void 0)}))}};var l={};Object.defineProperty(l,"__esModule",{value:!0}),l.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")};var h={};function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(h,"__esModule",{value:!0}),h.default=function(e,t,n){t&&f(e.prototype,t);n&&f(e,n);return e};var d=o("hKHmD"),p={};Object.defineProperty(p,"__esModule",{value:!0}),p.default=function(e){return v.default(e)||y.default(e)||g.default(e)||m.default()};var v=k(o("kMC0W")),y=k(o("7AJDX")),m=k(o("8CtQK")),g=k(o("auk6i"));function k(e){return e&&e.__esModule?e:{default:e}}var _={},w=function(e){"use strict";var t,n=Object.prototype,r=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var i=t&&t.prototype instanceof y?t:y,a=Object.create(i.prototype),o=new C(r||[]);return a._invoke=function(e,t,n){var r=h;return function(i,a){if(r===d)throw new Error("Generator is already running");if(r===p){if("throw"===i)throw a;return N()}for(n.method=i,n.arg=a;;){var o=n.delegate;if(o){var s=T(o,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===h)throw r=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=d;var u=l(e,t,n);if("normal"===u.type){if(r=n.done?p:f,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=p,n.method="throw",n.arg=u.arg)}}}(e,n,o),a}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var h="suspendedStart",f="suspendedYield",d="executing",p="completed",v={};function y(){}function m(){}function g(){}var k={};u(k,a,(function(){return this}));var _=Object.getPrototypeOf,w=_&&_(_(A([])));w&&w!==n&&r.call(w,a)&&(k=w);var b=g.prototype=y.prototype=Object.create(k);function x(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function I(e,t){function n(i,a,o,s){var u=l(e[i],e,a);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==typeof h&&r.call(h,"__await")?t.resolve(h.__await).then((function(e){n("next",e,o,s)}),(function(e){n("throw",e,o,s)})):t.resolve(h).then((function(e){c.value=e,o(c)}),(function(e){return n("throw",e,o,s)}))}s(u.arg)}var i;this._invoke=function(e,r){function a(){return new t((function(t,i){n(e,r,t,i)}))}return i=i?i.then(a,a):a()}}function T(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,T(e,n),"throw"===n.method))return v;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var i=l(r,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function A(e){if(e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}return{next:N}}function N(){return{value:t,done:!0}}return m.prototype=g,u(b,"constructor",g),u(g,"constructor",m),m.displayName=u(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,u(e,s,"GeneratorFunction")),e.prototype=Object.create(b),e},e.awrap=function(e){return{__await:e}},x(I.prototype),u(I.prototype,o,(function(){return this})),e.AsyncIterator=I,e.async=function(t,n,r,i,a){void 0===a&&(a=Promise);var o=new I(c(t,n,r,i),a);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},x(b),u(b,s,"Generator"),u(b,a,(function(){return this})),u(b,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=A,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(S),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return s.type="throw",s.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var u=r.call(o,"catchLoc"),c=r.call(o,"finallyLoc");if(u&&c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),S(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;S(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:A(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}(_);try{regeneratorRuntime=w}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=w:Function("r","regeneratorRuntime = r")(w)}var b={};Object.defineProperty(b,"__esModule",{value:!0}),b.default=function(e,t){return x.default(e)||I.default(e,t)||E.default(e,t)||T.default()};var x=S(o("8slrw")),I=S(o("7AJDX")),T=S(o("ifqQW")),E=S(o("auk6i"));function S(e){return e&&e.__esModule?e:{default:e}}var C=o("ds8z5"),A={};Object.defineProperty(A,"__esModule",{value:!0}),A.default=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&R.default(e,t)};var N,R=(N=o("gD1JV"))&&N.__esModule?N:{default:N};var D={};Object.defineProperty(D,"__esModule",{value:!0}),D.default=function(e){return U(e)};var P=F(o("ge8co")),O=F(o("cZGw3")),M=F(o("fVNic")),L=F(o("gD1JV"));function F(e){return e&&e.__esModule?e:{default:e}}function U(e){var t="function"==typeof Map?new Map:void 0;return U=function(e){if(null===e||!O.default(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return P.default(e,arguments,M.default(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),L.default(n,e)},U(e)}var q={};Object.defineProperty(q,"__esModule",{value:!0}),q.default=function(e){var t=V.default();return function(){var n,r=j.default(e);if(t){var i=j.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return B.default(this,n)}};var V=K(o("aTHs7")),j=K(o("fVNic")),B=K(o("jmhxu"));function K(e){return e&&e.__esModule?e:{default:e}}var z,W,G,H=z={};function Q(){throw new Error("setTimeout has not been defined")}function Y(){throw new Error("clearTimeout has not been defined")}function J(e){if(W===setTimeout)return setTimeout(e,0);if((W===Q||!W)&&setTimeout)return W=setTimeout,setTimeout(e,0);try{return W(e,0)}catch(t){try{return W.call(null,e,0)}catch(t){return W.call(this,e,0)}}}!function(){try{W="function"==typeof setTimeout?setTimeout:Q}catch(e){W=Q}try{G="function"==typeof clearTimeout?clearTimeout:Y}catch(e){G=Y}}();var X,$=[],Z=!1,ee=-1;function te(){Z&&X&&(Z=!1,X.length?$=X.concat($):ee=-1,$.length&&ne())}function ne(){if(!Z){var e=J(te);Z=!0;for(var t=$.length;t;){for(X=$,$=[];++ee<t;)X&&X[ee].run();ee=-1,t=$.length}X=null,Z=!1,function(e){if(G===clearTimeout)return clearTimeout(e);if((G===Y||!G)&&clearTimeout)return G=clearTimeout,clearTimeout(e);try{G(e)}catch(t){try{return G.call(null,e)}catch(t){return G.call(this,e)}}}(e)}}function re(e,t){this.fun=e,this.array=t}function ie(){}H.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];$.push(new re(e,t)),1!==$.length||Z||J(ne)},re.prototype.run=function(){this.fun.apply(null,this.array)},H.title="browser",H.browser=!0,H.env={},H.argv=[],H.version="",H.versions={},H.on=ie,H.addListener=ie,H.once=ie,H.off=ie,H.removeListener=ie,H.removeAllListeners=ie,H.emit=ie,H.prependListener=ie,H.prependOnceListener=ie,H.listeners=function(e){return[]},H.binding=function(e){throw new Error("process.binding is not supported")},H.cwd=function(){return"/"},H.chdir=function(e){throw new Error("process.chdir is not supported")},H.umask=function(){return 0};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var ae=!1,oe=!1,se="${JSCORE_VERSION}",ue=function(e,t){if(!e)throw ce(t)},ce=function(e){return new Error("Firebase Database ("+se+") INTERNAL ASSERT FAILED: "+e)},le=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},he={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<e.length;i+=3){var a=e[i],o=i+1<e.length,s=o?e[i+1]:0,u=i+2<e.length,c=u?e[i+2]:0,l=a>>2,h=(3&a)<<4|s>>4,f=(15&s)<<2|c>>6,d=63&c;u||(d=64,o||(f=64)),r.push(n[l],n[h],n[f],n[d])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(le(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){var a=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&a)}else if(i>239&&i<365){var o=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(o>>10)),t[r++]=String.fromCharCode(56320+(1023&o))}else{var s=e[n++],u=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&u)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<e.length;){var a=n[e.charAt(i++)],o=i<e.length?n[e.charAt(i)]:0,s=++i<e.length?n[e.charAt(i)]:64,u=++i<e.length?n[e.charAt(i)]:64;if(++i,null==a||null==o||null==s||null==u)throw Error();var c=a<<2|o>>4;if(r.push(c),64!==s){var l=o<<4&240|s>>2;if(r.push(l),64!==u){var h=s<<6&192|u;r.push(h)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},fe=function(e){var t=le(e);return he.encodeByteArray(t,!0)},de=function(e){return fe(e).replace(/\./g,"")},pe=function(e){try{return he.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ve(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=ve(e[n],t[n]));return e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function ye(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function me(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ye())}function ge(){try{return"[object process]"===Object.prototype.toString.call(n.process)}catch(e){return!1}}function ke(){var e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function _e(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function we(){var e=ye();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function be(){return!0===ae||!0===oe}function xe(){try{return"object"==typeof indexedDB}catch(e){return!1}}function Ie(){return new Promise((function(e,t){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}}))}function Te(){return!("undefined"==typeof navigator||!navigator.cookieEnabled)}function Ee(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n)return n;throw new Error("Unable to locate global object.")}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Se=function(){try{return Ee().__FIREBASE_DEFAULTS__||function(){if(void 0!==z&&void 0!==z.env);}()||function(){if("undefined"!=typeof document){var e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}var t=e&&pe(e[1]);return t&&JSON.parse(t)}}()}catch(e){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(e))}},Ce=function(e){var t,n;return null===(n=null===(t=Se())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},Ae=function(e){var t=Ce(e);if(t){var n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error("Invalid host ".concat(t," with no separate hostname and port!"));var r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]}},Ne=function(){var e;return null===(e=Se())||void 0===e?void 0:e.config},Re=function(e){var t;return null===(t=Se())||void 0===t?void 0:t["_".concat(e)]},De=function(){"use strict";function t(){var n=this;e(l)(this,t),this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,t){n.resolve=e,n.reject=t}))}return e(h)(t,[{key:"wrapCallback",value:function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"==typeof e&&(t.promise.catch((function(){})),1===e.length?e(n):e(n,r))}}}]),t}();
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Pe(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var a=Object.assign({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[de(JSON.stringify({alg:"none",type:"JWT"})),de(JSON.stringify(a)),""].join(".")}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Oe=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i,a){var o;return e(l)(this,r),(o=n.call(this,i)).code=t,o.customData=a,o.name="FirebaseError",Object.setPrototypeOf(e(C)(o),r.prototype),Error.captureStackTrace&&Error.captureStackTrace(e(C)(o),Me.prototype.create),o}return r}(e(D)(Error)),Me=function(){"use strict";function t(n,r,i){e(l)(this,t),this.service=n,this.serviceName=r,this.errors=i}return e(h)(t,[{key:"create",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n[0]||{},a="".concat(this.service,"/").concat(e),o=this.errors[e],s=o?Le(o,i):"Error",u="".concat(this.serviceName,": ").concat(s," (").concat(a,")."),c=new Oe(a,u,i);return c}}]),t}();function Le(e,t){return e.replace(Fe,(function(e,n){var r=t[n];return null!=r?String(r):"<".concat(n,"?>")}))}var Fe=/\{\$([^}]+)}/g;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ue(e){return JSON.parse(e)}function qe(e){return JSON.stringify(e)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ve=function(e){var t={},n={},r={},i="";try{var a=e.split(".");t=Ue(pe(a[0])||""),n=Ue(pe(a[1])||""),i=a[2],r=n.d||{},delete n.d}catch(e){}return{header:t,claims:n,data:r,signature:i}},je=function(e){var t=Ve(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Be(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Ke(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function ze(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function We(e,t,n){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r}function Ge(e,t){if(e===t)return!0;var n=Object.keys(e),r=Object.keys(t),i=!0,a=!1,o=void 0;try{for(var s,u=n[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value;if(!r.includes(c))return!1;var l=e[c],h=t[c];if(He(l)&&He(h)){if(!Ge(l,h))return!1}else if(l!==h)return!1}}catch(e){a=!0,o=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw o}}var f=!0,d=!1,p=void 0;try{for(var v,y=r[Symbol.iterator]();!(f=(v=y.next()).done);f=!0){var m=v.value;if(!n.includes(m))return!1}}catch(e){d=!0,p=e}finally{try{f||null==y.return||y.return()}finally{if(d)throw p}}return!0}function He(e){return null!==e&&"object"==typeof e}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Qe(t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=function(t,r){var i=e(b)(r.value,2),a=i[0],o=i[1];Array.isArray(o)?o.forEach((function(e){n.push(encodeURIComponent(a)+"="+encodeURIComponent(e))})):n.push(encodeURIComponent(a)+"="+encodeURIComponent(o))},u=Object.entries(t)[Symbol.iterator]();!(r=(o=u.next()).done);r=!0)s(0,o)}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return n.length?"&"+n.join("&"):""}function Ye(t){var n={};return t.replace(/^\?/,"").split("&").forEach((function(t){if(t){var r=e(b)(t.split("="),2),i=r[0],a=r[1];n[decodeURIComponent(i)]=decodeURIComponent(a)}})),n}function Je(e){var t=e.indexOf("?");if(!t)return"";var n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Xe=function(){"use strict";function t(){e(l)(this,t),this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var n=1;n<this.blockSize;++n)this.pad_[n]=0;this.reset()}return e(h)(t,[{key:"reset",value:function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}},{key:"compress_",value:function(e,t){t||(t=0);var n=this.W_;if("string"==typeof e)for(var r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(var i=0;i<16;i++)n[i]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(var a=16;a<80;a++){var o=n[a-3]^n[a-8]^n[a-14]^n[a-16];n[a]=4294967295&(o<<1|o>>>31)}for(var s,u,c=this.chain_[0],l=this.chain_[1],h=this.chain_[2],f=this.chain_[3],d=this.chain_[4],p=0;p<80;p++){p<40?p<20?(s=f^l&(h^f),u=1518500249):(s=l^h^f,u=1859775393):p<60?(s=l&h|f&(l|h),u=2400959708):(s=l^h^f,u=3395469782);var v=(c<<5|c>>>27)+s+d+u+n[p]&4294967295;d=f,f=h,h=4294967295&(l<<30|l>>>2),l=c,c=v}this.chain_[0]=this.chain_[0]+c&4294967295,this.chain_[1]=this.chain_[1]+l&4294967295,this.chain_[2]=this.chain_[2]+h&4294967295,this.chain_[3]=this.chain_[3]+f&4294967295,this.chain_[4]=this.chain_[4]+d&4294967295}},{key:"update",value:function(e,t){if(null!=e){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=0,i=this.buf_,a=this.inbuf_;r<t;){if(0===a)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[a]=e.charCodeAt(r),++r,++a===this.blockSize){this.compress_(i),a=0;break}}else for(;r<t;)if(i[a]=e[r],++r,++a===this.blockSize){this.compress_(i),a=0;break}}this.inbuf_=a,this.total_+=t}}},{key:"digest",value:function(){var e=[],t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&t,t/=256;this.compress_(this.buf_);for(var r=0,i=0;i<5;i++)for(var a=24;a>=0;a-=8)e[r]=this.chain_[i]>>a&255,++r;return e}}]),t}();function $e(e,t){var n=new Ze(e,t);return n.subscribe.bind(n)}var Ze=function(){"use strict";function t(n,r){var i=this;e(l)(this,t),this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then((function(){n(i)})).catch((function(e){i.error(e)}))}return e(h)(t,[{key:"next",value:function(e){this.forEachObserver((function(t){t.next(e)}))}},{key:"error",value:function(e){this.forEachObserver((function(t){t.error(e)})),this.close(e)}},{key:"complete",value:function(){this.forEachObserver((function(e){e.complete()})),this.close()}},{key:"subscribe",value:function(e,t,n){var r,i=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!=typeof e||null===e)return!1;var n=!0,r=!1,i=void 0;try{for(var a,o=t[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;if(s in e&&"function"==typeof e[s])return!0}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=et),void 0===r.error&&(r.error=et),void 0===r.complete&&(r.complete=et);var a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(e){}})),this.observers.push(r),a}},{key:"unsubscribeOne",value:function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}},{key:"forEachObserver",value:function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)}},{key:"sendOne",value:function(e,t){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}}))}},{key:"close",value:function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((function(){t.observers=void 0,t.onNoObservers=void 0})))}}]),t}();function et(){}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var tt=function(e,t,n,r){var i;if(r<t?i="at least "+t:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(e+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")};function nt(e,t){return"".concat(e," failed: ").concat(t," argument ")}function rt(e,t,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(nt(e,t)+"must be a valid function.")}function it(e,t,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(nt(e,t)+"must be a valid context object.")}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var at=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);if(i>=55296&&i<=56319){var a=i-55296;r++,ue(r<e.length,"Surrogate pair missing trail surrogate."),i=65536+(a<<10)+(e.charCodeAt(r)-56320)}i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):i<65536?(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},ot=function(e){for(var t=0,n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t},st=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},ut=144e5;function ct(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,r=t*Math.pow(n,e),i=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(ut,r+i)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function lt(e){return e&&e._delegate?e._delegate:e}var ht=function(){"use strict";function t(n,r,i){e(l)(this,t),this.name=n,this.instanceFactory=r,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return e(h)(t,[{key:"setInstantiationMode",value:function(e){return this.instantiationMode=e,this}},{key:"setMultipleInstances",value:function(e){return this.multipleInstances=e,this}},{key:"setServiceProps",value:function(e){return this.serviceProps=e,this}},{key:"setInstanceCreatedCallback",value:function(e){return this.onInstanceCreated=e,this}}]),t}(),ft="[DEFAULT]",dt=function(){"use strict";function t(n,r){e(l)(this,t),this.name=n,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return e(h)(t,[{key:"get",value:function(e){var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new De;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch(e){}}return this.instancesDeferred.get(t).promise}},{key:"getImmediate",value:function(e){var t,n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(r)return null;throw e}}},{key:"getComponent",value:function(){return this.component}},{key:"setComponent",value:function(t){if(t.name!==this.name)throw Error("Mismatching Component ".concat(t.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=t,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t))try{this.getOrInitializeService({instanceIdentifier:ft})}catch(e){}var n=!0,r=!1,i=void 0;try{for(var a,o=this.instancesDeferred.entries()[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=e(b)(a.value,2),u=s[0],c=s[1],l=this.normalizeInstanceIdentifier(u);try{var h=this.getOrInitializeService({instanceIdentifier:l});c.resolve(h)}catch(e){}}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}}}},{key:"clearInstance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ft;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}},{key:"delete",value:function(){var t=this;return e(u)(e(_).mark((function n(){var r;return e(_).wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=Array.from(t.instances.values()),n.next=3,Promise.all(e(p)(r.filter((function(e){return"INTERNAL"in e})).map((function(e){return e.INTERNAL.delete()}))).concat(e(p)(r.filter((function(e){return"_delete"in e})).map((function(e){return e._delete()})))));case 3:case"end":return n.stop()}}),n)})))()}},{key:"isComponentSet",value:function(){return null!=this.component}},{key:"isInitialized",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ft;return this.instances.has(e)}},{key:"getOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ft;return this.instancesOptions.get(e)||{}}},{key:"initialize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.options,r=void 0===n?{}:n,i=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(i))throw Error("".concat(this.name,"(").concat(i,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));var a=this.getOrInitializeService({instanceIdentifier:i,options:r}),o=!0,s=!1,u=void 0;try{for(var c,l=this.instancesDeferred.entries()[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var h=e(b)(c.value,2),f=h[0],d=h[1],p=this.normalizeInstanceIdentifier(f);i===p&&d.resolve(a)}}catch(e){s=!0,u=e}finally{try{o||null==l.return||l.return()}finally{if(s)throw u}}return a}},{key:"onInit",value:function(e,t){var n,r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);var a=this.instances.get(r);return a&&e(a,r),function(){i.delete(e)}}},{key:"invokeOnInitCallbacks",value:function(e,t){var n=this.onInitCallbacks.get(t);if(n){var r=!0,i=!1,a=void 0;try{for(var o,s=n[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;try{u(e,t)}catch(e){}}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}}}},{key:"getOrInitializeService",value:function(e){var t,n=e.instanceIdentifier,r=e.options,i=void 0===r?{}:r,a=this.instances.get(n);if(!a&&this.component&&(a=this.component.instanceFactory(this.container,{instanceIdentifier:(t=n,t===ft?void 0:t),options:i}),this.instances.set(n,a),this.instancesOptions.set(n,i),this.invokeOnInitCallbacks(a,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,a)}catch(e){}return a||null}},{key:"normalizeInstanceIdentifier",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ft;return this.component?this.component.multipleInstances?e:ft:e}},{key:"shouldAutoInitialize",value:function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}]),t}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var pt,vt,yt=function(){"use strict";function t(n){e(l)(this,t),this.name=n,this.providers=new Map}return e(h)(t,[{key:"addComponent",value:function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}},{key:"addOrOverwriteComponent",value:function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}},{key:"getProvider",value:function(e){if(this.providers.has(e))return this.providers.get(e);var t=new dt(e,this);return this.providers.set(e,t),t}},{key:"getProviders",value:function(){return Array.from(this.providers.values())}}]),t}(),mt=(d=o("hKHmD"),[]);(vt=pt||(pt={}))[vt.DEBUG=0]="DEBUG",vt[vt.VERBOSE=1]="VERBOSE",vt[vt.INFO=2]="INFO",vt[vt.WARN=3]="WARN",vt[vt.ERROR=4]="ERROR",vt[vt.SILENT=5]="SILENT";var gt,kt={debug:pt.DEBUG,verbose:pt.VERBOSE,info:pt.INFO,warn:pt.WARN,error:pt.ERROR,silent:pt.SILENT},_t=pt.INFO,wt=(gt={},e(d)(gt,pt.DEBUG,"log"),e(d)(gt,pt.VERBOSE,"log"),e(d)(gt,pt.INFO,"info"),e(d)(gt,pt.WARN,"warn"),e(d)(gt,pt.ERROR,"error"),gt),bt=function(t,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];var o;if(!(n<t.logLevel)){var s=(new Date).toISOString(),u=wt[n];if(!u)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(n,")"));(o=console)[u].apply(o,["[".concat(s,"]  ").concat(t.name,":")].concat(e(p)(i)))}},xt=function(){"use strict";function t(n){e(l)(this,t),this.name=n,this._logLevel=_t,this._logHandler=bt,this._userLogHandler=null,mt.push(this)}return e(h)(t,[{key:"logLevel",get:function(){return this._logLevel},set:function(e){if(!(e in pt))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}},{key:"setLogLevel",value:function(e){this._logLevel="string"==typeof e?kt[e]:e}},{key:"logHandler",get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}},{key:"userLogHandler",get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e}},{key:"debug",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this._userLogHandler&&this._userLogHandler.apply(this,[this,pt.DEBUG].concat(e(p)(n))),this._logHandler.apply(this,[this,pt.DEBUG].concat(e(p)(n)))}},{key:"log",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this._userLogHandler&&this._userLogHandler.apply(this,[this,pt.VERBOSE].concat(e(p)(n))),this._logHandler.apply(this,[this,pt.VERBOSE].concat(e(p)(n)))}},{key:"info",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this._userLogHandler&&this._userLogHandler.apply(this,[this,pt.INFO].concat(e(p)(n))),this._logHandler.apply(this,[this,pt.INFO].concat(e(p)(n)))}},{key:"warn",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this._userLogHandler&&this._userLogHandler.apply(this,[this,pt.WARN].concat(e(p)(n))),this._logHandler.apply(this,[this,pt.WARN].concat(e(p)(n)))}},{key:"error",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this._userLogHandler&&this._userLogHandler.apply(this,[this,pt.ERROR].concat(e(p)(n))),this._logHandler.apply(this,[this,pt.ERROR].concat(e(p)(n)))}}]),t}();function It(e,t){var n=!0,r=!1,i=void 0;try{for(var a,o=mt[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value,u=null;t&&t.level&&(u=kt[t.level]),s.userLogHandler=null===e?null:function(t,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];var o=i.map((function(e){if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(e){return null}})).filter((function(e){return e})).join(" ");n>=(null!=u?u:t.logLevel)&&e({level:pt[n].toLowerCase(),message:o,args:i,type:t.name})}}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}}var Tt={};Object.defineProperty(Tt,"__esModule",{value:!0}),Tt.default=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Et.default(e,t,n[t])}))}return e};var Et=function(e){return e&&e.__esModule?e:{default:e}}(o("hKHmD"));var St,Ct;var At=new WeakMap,Nt=new WeakMap,Rt=new WeakMap,Dt=new WeakMap,Pt=new WeakMap;var Ot={get:function(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return Nt.get(e);if("objectStoreNames"===t)return e.objectStoreNames||Rt.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ft(e[t])},set:function(e,t,n){return e[t]=n,!0},has:function(e,t){return e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e}};function Mt(t){return t!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Ct||(Ct=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.apply(Ut(this),n),Ft(At.get(this))}:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return Ft(t.apply(Ut(this),n))}:function(n){for(var r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];var o,s=(o=t).call.apply(o,[Ut(this),n].concat(e(p)(i)));return Rt.set(s,n.sort?n.sort():[n]),Ft(s)}}function Lt(e){return"function"==typeof e?Mt(e):(e instanceof IDBTransaction&&function(e){if(!Nt.has(e)){var t=new Promise((function(t,n){var r=function(){e.removeEventListener("complete",i),e.removeEventListener("error",a),e.removeEventListener("abort",a)},i=function(){t(),r()},a=function(){n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",a),e.addEventListener("abort",a)}));Nt.set(e,t)}}(e),t=e,(St||(St=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((function(e){return t instanceof e}))?new Proxy(e,Ot):e);var t}function Ft(e){if(e instanceof IDBRequest)return t=e,(n=new Promise((function(e,n){var r=function(){t.removeEventListener("success",i),t.removeEventListener("error",a)},i=function(){e(Ft(t.result)),r()},a=function(){n(t.error),r()};t.addEventListener("success",i),t.addEventListener("error",a)}))).then((function(e){e instanceof IDBCursor&&At.set(e,t)})).catch((function(){})),Pt.set(n,t),n;var t,n;if(Dt.has(e))return Dt.get(e);var r=Lt(e);return r!==e&&(Dt.set(e,r),Pt.set(r,e)),r}var Ut=function(e){return Pt.get(e)};function qt(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.blocked,i=n.upgrade,a=n.blocking,o=n.terminated,s=indexedDB.open(e,t),u=Ft(s);return i&&s.addEventListener("upgradeneeded",(function(e){i(Ft(s.result),e.oldVersion,e.newVersion,Ft(s.transaction))})),r&&s.addEventListener("blocked",(function(){return r()})),u.then((function(e){o&&e.addEventListener("close",(function(){return o()})),a&&e.addEventListener("versionchange",(function(){return a()}))})).catch((function(){})),u}function Vt(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).blocked,n=indexedDB.deleteDatabase(e);return t&&n.addEventListener("blocked",(function(){return t()})),Ft(n).then((function(){}))}var jt=["get","getKey","getAll","getAllKeys","count"],Bt=["put","add","delete","clear"],Kt=new Map;function zt(t,n){if(t instanceof IDBDatabase&&!(n in t)&&"string"==typeof n){if(Kt.get(n))return Kt.get(n);var r=n.replace(/FromIndex$/,""),i=n!==r,a=Bt.includes(r);if(r in(i?IDBIndex:IDBObjectStore).prototype&&(a||jt.includes(r))){var o,s=(o=e(u)(e(_).mark((function t(n){var o,s,u,c,l,h,f=arguments;return e(_).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(o=f.length,s=new Array(o>1?o-1:0),u=1;u<o;u++)s[u-1]=f[u];return l=this.transaction(n,a?"readwrite":"readonly"),h=l.store,i&&(h=h.index(s.shift())),t.next=7,Promise.all([(c=h)[r].apply(c,e(p)(s)),a&&l.done]);case 7:return t.abrupt("return",t.sent[0]);case 8:case"end":return t.stop()}}),t,this)}))),function(e){return o.apply(this,arguments)});return Kt.set(n,s),s}}}Ot=function(t){return e(Tt)({},t,{get:function(e,n,r){return zt(e,n)||t.get(e,n,r)},has:function(e,n){return!!zt(e,n)||t.has(e,n)}})}(Ot);
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Wt=function(){"use strict";function t(n){e(l)(this,t),this.container=n}return e(h)(t,[{key:"getPlatformInfoString",value:function(){return this.container.getProviders().map((function(e){if(function(e){var t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){var t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null})).filter((function(e){return e})).join(" ")}}]),t}();var Gt,Ht,Qt="@firebase/app",Yt="0.9.0",Jt=new xt("@firebase/app"),Xt="[DEFAULT]",$t=(Gt={},e(d)(Gt,Qt,"fire-core"),e(d)(Gt,"@firebase/app-compat","fire-core-compat"),e(d)(Gt,"@firebase/analytics","fire-analytics"),e(d)(Gt,"@firebase/analytics-compat","fire-analytics-compat"),e(d)(Gt,"@firebase/app-check","fire-app-check"),e(d)(Gt,"@firebase/app-check-compat","fire-app-check-compat"),e(d)(Gt,"@firebase/auth","fire-auth"),e(d)(Gt,"@firebase/auth-compat","fire-auth-compat"),e(d)(Gt,"@firebase/database","fire-rtdb"),e(d)(Gt,"@firebase/database-compat","fire-rtdb-compat"),e(d)(Gt,"@firebase/functions","fire-fn"),e(d)(Gt,"@firebase/functions-compat","fire-fn-compat"),e(d)(Gt,"@firebase/installations","fire-iid"),e(d)(Gt,"@firebase/installations-compat","fire-iid-compat"),e(d)(Gt,"@firebase/messaging","fire-fcm"),e(d)(Gt,"@firebase/messaging-compat","fire-fcm-compat"),e(d)(Gt,"@firebase/performance","fire-perf"),e(d)(Gt,"@firebase/performance-compat","fire-perf-compat"),e(d)(Gt,"@firebase/remote-config","fire-rc"),e(d)(Gt,"@firebase/remote-config-compat","fire-rc-compat"),e(d)(Gt,"@firebase/storage","fire-gcs"),e(d)(Gt,"@firebase/storage-compat","fire-gcs-compat"),e(d)(Gt,"@firebase/firestore","fire-fst"),e(d)(Gt,"@firebase/firestore-compat","fire-fst-compat"),e(d)(Gt,"fire-js","fire-js"),e(d)(Gt,"firebase","fire-js-all"),Gt),Zt=new Map,en=new Map;function tn(e,t){try{e.container.addComponent(t)}catch(n){Jt.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function nn(e,t){e.container.addOrOverwriteComponent(t)}function rn(e){var t=e.name;if(en.has(t))return Jt.debug("There were multiple attempts to register component ".concat(t,".")),!1;en.set(t,e);var n=!0,r=!1,i=void 0;try{for(var a,o=Zt.values()[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){tn(a.value,e)}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return!0}function an(e,t){var n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function on(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Xt;an(e,t).clearInstance(n)}function sn(){en.clear()}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var un=(Ht={},e(d)(Ht,"no-app","No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()"),e(d)(Ht,"bad-app-name","Illegal App name: '{$appName}"),e(d)(Ht,"duplicate-app","Firebase App named '{$appName}' already exists with different options or config"),e(d)(Ht,"app-deleted","Firebase App named '{$appName}' already deleted"),e(d)(Ht,"no-options","Need to provide options, when not being deployed to hosting via source."),e(d)(Ht,"invalid-app-argument","firebase.{$appName}() takes either no argument or a Firebase App instance."),e(d)(Ht,"invalid-log-argument","First argument to `onLog` must be null or a function."),e(d)(Ht,"idb-open","Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}."),e(d)(Ht,"idb-get","Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}."),e(d)(Ht,"idb-set","Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}."),e(d)(Ht,"idb-delete","Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."),Ht),cn=new Me("app","Firebase",un),ln=function(){"use strict";function t(n,r,i){var a=this;e(l)(this,t),this._isDeleted=!1,this._options=Object.assign({},n),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new ht("app",(function(){return a}),"PUBLIC"))}return e(h)(t,[{key:"automaticDataCollectionEnabled",get:function(){return this.checkDestroyed(),this._automaticDataCollectionEnabled},set:function(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}},{key:"name",get:function(){return this.checkDestroyed(),this._name}},{key:"options",get:function(){return this.checkDestroyed(),this._options}},{key:"config",get:function(){return this.checkDestroyed(),this._config}},{key:"container",get:function(){return this._container}},{key:"isDeleted",get:function(){return this._isDeleted},set:function(e){this._isDeleted=e}},{key:"checkDestroyed",value:function(){if(this.isDeleted)throw cn.create("app-deleted",{appName:this._name})}}]),t}(),hn="9.15.0";function fn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!=typeof t){var r=t;t={name:r}}var i=Object.assign({name:Xt,automaticDataCollectionEnabled:!1},t),a=i.name;if("string"!=typeof a||!a)throw cn.create("bad-app-name",{appName:String(a)});if(n||(n=Ne()),!n)throw cn.create("no-options");var o=Zt.get(a);if(o){if(Ge(n,o.options)&&Ge(i,o.config))return o;throw cn.create("duplicate-app",{appName:a})}var s=new yt(a),u=!0,c=!1,l=void 0;try{for(var h,f=en.values()[Symbol.iterator]();!(u=(h=f.next()).done);u=!0){var d=h.value;s.addComponent(d)}}catch(e){c=!0,l=e}finally{try{u||null==f.return||f.return()}finally{if(c)throw l}}var p=new ln(n,i,s);return Zt.set(a,p),p}function dn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Xt,t=Zt.get(e);if(!t&&e===Xt)return fn();if(!t)throw cn.create("no-app",{appName:e});return t}function pn(){return Array.from(Zt.values())}function vn(e){return yn.apply(this,arguments)}function yn(){return(yn=e(u)(e(_).mark((function t(n){var r;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.name,!Zt.has(r)){e.next=6;break}return Zt.delete(r),e.next=5,Promise.all(n.container.getProviders().map((function(e){return e.delete()})));case 5:n.isDeleted=!0;case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function mn(e,t,n){var r,i=null!==(r=$t[e])&&void 0!==r?r:e;n&&(i+="-".concat(n));var a=i.match(/\s|\//),o=t.match(/\s|\//);if(a||o){var s=['Unable to register library "'.concat(i,'" with version "').concat(t,'":')];return a&&s.push('library name "'.concat(i,'" contains illegal characters (whitespace or "/")')),a&&o&&s.push("and"),o&&s.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void Jt.warn(s.join(" "))}rn(new ht("".concat(i,"-version"),(function(){return{library:i,version:t}}),"VERSION"))}function gn(e,t){if(null!==e&&"function"!=typeof e)throw cn.create("invalid-log-argument");It(e,t)}function kn(e){var t;t=e,mt.forEach((function(e){e.setLogLevel(t)}))}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _n="firebase-heartbeat-store",wn=null;function bn(){return wn||(wn=qt("firebase-heartbeat-database",1,{upgrade:function(e,t){if(0===t)e.createObjectStore(_n)}}).catch((function(e){throw cn.create("idb-open",{originalErrorMessage:e.message})}))),wn}function xn(e){return In.apply(this,arguments)}function In(){return(In=e(u)(e(_).mark((function t(n){var r,i;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,bn();case 3:return r=e.sent,e.abrupt("return",r.transaction(_n).objectStore(_n).get(Sn(n)));case 7:e.prev=7,e.t0=e.catch(0),e.t0 instanceof Oe?Jt.warn(e.t0.message):(i=cn.create("idb-get",{originalErrorMessage:null===e.t0||void 0===e.t0?void 0:e.t0.message}),Jt.warn(i.message));case 10:case"end":return e.stop()}}),t,null,[[0,7]])})))).apply(this,arguments)}function Tn(e,t){return En.apply(this,arguments)}function En(){return(En=e(u)(e(_).mark((function t(n,r){var i,a,o,s;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,bn();case 3:return i=e.sent,a=i.transaction(_n,"readwrite"),o=a.objectStore(_n),e.next=8,o.put(r,Sn(n));case 8:return e.abrupt("return",a.done);case 11:e.prev=11,e.t0=e.catch(0),e.t0 instanceof Oe?Jt.warn(e.t0.message):(s=cn.create("idb-set",{originalErrorMessage:null===e.t0||void 0===e.t0?void 0:e.t0.message}),Jt.warn(s.message));case 14:case"end":return e.stop()}}),t,null,[[0,11]])})))).apply(this,arguments)}function Sn(e){return"".concat(e.name,"!").concat(e.options.appId)}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Cn=function(){"use strict";function t(n){var r=this;e(l)(this,t),this.container=n,this._heartbeatsCache=null;var i=this.container.getProvider("app").getImmediate();this._storage=new Dn(i),this._heartbeatsCachePromise=this._storage.read().then((function(e){return r._heartbeatsCache=e,e}))}return e(h)(t,[{key:"triggerHeartbeat",value:function(){var t=this;return e(u)(e(_).mark((function n(){var r,i,a;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.container.getProvider("platform-logger").getImmediate(),i=r.getPlatformInfoString(),a=An(),null!==t._heartbeatsCache){e.next=7;break}return e.next=6,t._heartbeatsCachePromise;case 6:t._heartbeatsCache=e.sent;case 7:if(t._heartbeatsCache.lastSentHeartbeatDate!==a&&!t._heartbeatsCache.heartbeats.some((function(e){return e.date===a}))){e.next=11;break}return e.abrupt("return");case 11:t._heartbeatsCache.heartbeats.push({date:a,agent:i});case 12:return t._heartbeatsCache.heartbeats=t._heartbeatsCache.heartbeats.filter((function(e){var t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),e.abrupt("return",t._storage.overwrite(t._heartbeatsCache));case 14:case"end":return e.stop()}}),n)})))()}},{key:"getHeartbeatsHeader",value:function(){var t=this;return e(u)(e(_).mark((function n(){var r,i,a,o,s;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==t._heartbeatsCache){e.next=3;break}return e.next=3,t._heartbeatsCachePromise;case 3:if(null!==t._heartbeatsCache&&0!==t._heartbeatsCache.heartbeats.length){e.next=5;break}return e.abrupt("return","");case 5:if(r=An(),i=Nn(t._heartbeatsCache.heartbeats),a=i.heartbeatsToSend,o=i.unsentEntries,s=de(JSON.stringify({version:2,heartbeats:a})),t._heartbeatsCache.lastSentHeartbeatDate=r,!(o.length>0)){e.next=15;break}return t._heartbeatsCache.heartbeats=o,e.next=13,t._storage.overwrite(t._heartbeatsCache);case 13:e.next=16;break;case 15:t._heartbeatsCache.heartbeats=[],t._storage.overwrite(t._heartbeatsCache);case 16:return e.abrupt("return",s);case 17:case"end":return e.stop()}}),n)})))()}}]),t}();function An(){return(new Date).toISOString().substring(0,10)}function Nn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,n=[],r=e.slice(),i=!0,a=!1,o=void 0;try{for(var s,u=function(e,i){var a=i.value,o=n.find((function(e){return e.agent===a.agent}));if(o){if(o.dates.push(a.date),Pn(n)>t)return o.dates.pop(),"break"}else if(n.push({agent:a.agent,dates:[a.date]}),Pn(n)>t)return n.pop(),"break";r=r.slice(1)},c=e[Symbol.iterator]();!(i=(s=c.next()).done);i=!0){var l=u(c,s);if("break"===l)break}}catch(e){a=!0,o=e}finally{try{i||null==c.return||c.return()}finally{if(a)throw o}}return{heartbeatsToSend:n,unsentEntries:r}}var Rn,Dn=function(){"use strict";function t(n){e(l)(this,t),this.app=n,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}return e(h)(t,[{key:"runIndexedDBEnvironmentCheck",value:function(){return e(u)(e(_).mark((function t(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(xe()){e.next=4;break}return e.abrupt("return",!1);case 4:return e.abrupt("return",Ie().then((function(){return!0})).catch((function(){return!1})));case 5:case"end":return e.stop()}}),t)})))()}},{key:"read",value:function(){var t=this;return e(u)(e(_).mark((function n(){var r;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._canUseIndexedDBPromise;case 2:if(e.sent){e.next=7;break}return e.abrupt("return",{heartbeats:[]});case 7:return e.next=9,xn(t.app);case 9:return r=e.sent,e.abrupt("return",r||{heartbeats:[]});case 11:case"end":return e.stop()}}),n)})))()}},{key:"overwrite",value:function(t){var n=this;return e(u)(e(_).mark((function r(){var i,a;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,n._canUseIndexedDBPromise;case 3:if(e.sent){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,n.read();case 10:return a=e.sent,e.abrupt("return",Tn(n.app,{lastSentHeartbeatDate:null!==(i=t.lastSentHeartbeatDate)&&void 0!==i?i:a.lastSentHeartbeatDate,heartbeats:t.heartbeats}));case 12:case"end":return e.stop()}}),r)})))()}},{key:"add",value:function(t){var n=this;return e(u)(e(_).mark((function r(){var i,a;return e(_).wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=3,n._canUseIndexedDBPromise;case 3:if(r.sent){r.next=8;break}return r.abrupt("return");case 8:return r.next=10,n.read();case 10:return a=r.sent,r.abrupt("return",Tn(n.app,{lastSentHeartbeatDate:null!==(i=t.lastSentHeartbeatDate)&&void 0!==i?i:a.lastSentHeartbeatDate,heartbeats:e(p)(a.heartbeats).concat(e(p)(t.heartbeats))}));case 12:case"end":return r.stop()}}),r)})))()}}]),t}();function Pn(e){return de(JSON.stringify({version:2,heartbeats:e})).length}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Rn="",rn(new ht("platform-logger",(function(e){return new Wt(e)}),"PRIVATE")),rn(new ht("heartbeat",(function(e){return new Cn(e)}),"PRIVATE")),mn(Qt,Yt,Rn),mn(Qt,Yt,"esm2017"),mn("fire-js","");
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
mn("firebase","9.15.0","app");C=o("ds8z5");var On=o("l5bVx"),Mn="@firebase/database",Ln="0.14.0",Fn="";function Un(e){Fn=e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var qn,Vn=function(){"use strict";function t(n){e(l)(this,t),this.domStorage_=n,this.prefix_="firebase:"}return e(h)(t,[{key:"set",value:function(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),qe(t))}},{key:"get",value:function(e){var t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:Ue(t)}},{key:"remove",value:function(e){this.domStorage_.removeItem(this.prefixedName_(e))}},{key:"prefixedName_",value:function(e){return this.prefix_+e}},{key:"toString",value:function(){return this.domStorage_.toString()}}]),t}(),jn=function(){"use strict";function t(){e(l)(this,t),this.cache_={},this.isInMemoryStorage=!0}return e(h)(t,[{key:"set",value:function(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}},{key:"get",value:function(e){return Be(this.cache_,e)?this.cache_[e]:null}},{key:"remove",value:function(e){delete this.cache_[e]}}]),t}(),Bn=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){var t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new Vn(t)}}catch(e){}return new jn},Kn=Bn("localStorage"),zn=Bn("sessionStorage"),Wn=new xt("@firebase/database"),Gn=(qn=1,function(){return qn++}),Hn=function(e){var t=at(e),n=new Xe;n.update(t);var r=n.digest();return he.encodeByteArray(r)},Qn=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r="",i=0;i<t.length;i++){var a=t[i];Array.isArray(a)||a&&"object"==typeof a&&"number"==typeof a.length?r+=Qn.apply(null,a):r+="object"==typeof a?qe(a):a,r+=" "}return r},Yn=null,Jn=!0,Xn=function(e,t){ue(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(Wn.logLevel=pt.VERBOSE,Yn=Wn.log.bind(Wn),t&&zn.set("logging_enabled",!0)):"function"==typeof e?Yn=e:(Yn=null,zn.remove("logging_enabled"))},$n=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!0===Jn&&(Jn=!1,null===Yn&&!0===zn.get("logging_enabled")&&Xn(!0)),Yn){var r=Qn.apply(null,t);Yn(r)}},Zn=function(t){return function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];$n.apply(void 0,[t].concat(e(p)(r)))}},er=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i="FIREBASE INTERNAL ERROR: "+Qn.apply(void 0,e(p)(n));Wn.error(i)},tr=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i="FIREBASE FATAL ERROR: ".concat(Qn.apply(void 0,e(p)(n)));throw Wn.error(i),new Error(i)},nr=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i="FIREBASE WARNING: "+Qn.apply(void 0,e(p)(n));Wn.warn(i)},rr=function(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},ir="[MIN_NAME]",ar="[MAX_NAME]",or=function(e,t){if(e===t)return 0;if(e===ir||t===ar)return-1;if(t===ir||e===ar)return 1;var n=pr(e),r=pr(t);return null!==n?null!==r?n-r==0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1},sr=function(e,t){return e===t?0:e<t?-1:1},ur=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+qe(t))},cr=function(e){if("object"!=typeof e||null===e)return qe(e);var t=[];for(var n in e)t.push(n);t.sort();for(var r="{",i=0;i<t.length;i++)0!==i&&(r+=","),r+=qe(t[i]),r+=":",r+=cr(e[t[i]]);return r+="}"},lr=function(e,t){var n=e.length;if(n<=t)return[e];for(var r=[],i=0;i<n;i+=t)i+t>n?r.push(e.substring(i,n)):r.push(e.substring(i,i+t));return r};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hr(e,t){for(var n in e)e.hasOwnProperty(n)&&t(n,e[n])}var fr=function(e){ue(!rr(e),"Invalid JSON number");var t,n,r,i,a,o=1023;0===e?(n=0,r=0,t=1/e==-1/0?1:0):(t=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(n=(i=Math.min(Math.floor(Math.log(e)/Math.LN2),o))+o,r=Math.round(e*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,r=Math.round(e/Math.pow(2,-1074))));var s=[];for(a=52;a;a-=1)s.push(r%2?1:0),r=Math.floor(r/2);for(a=11;a;a-=1)s.push(n%2?1:0),n=Math.floor(n/2);s.push(t?1:0),s.reverse();var u=s.join(""),c="";for(a=0;a<64;a+=8){var l=parseInt(u.substr(a,8),2).toString(16);1===l.length&&(l="0"+l),c+=l}return c.toLowerCase()};var dr=new RegExp("^-?(0*)\\d{1,10}$"),pr=function(e){if(dr.test(e)){var t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},vr=function(e){try{e()}catch(e){setTimeout((function(){var t=e.stack||"";throw nr("Exception was thrown by user callback.",t),e}),Math.floor(0))}},yr=function(e,t){var n=setTimeout(e,t);return"number"==typeof n&&"undefined"!=typeof Deno&&Deno.unrefTimer?Deno.unrefTimer(n):"object"==typeof n&&n.unref&&n.unref(),n},mr=function(){"use strict";function t(n,r){var i=this;e(l)(this,t),this.appName_=n,this.appCheckProvider=r,this.appCheck=null==r?void 0:r.getImmediate({optional:!0}),this.appCheck||null==r||r.get().then((function(e){return i.appCheck=e}))}return e(h)(t,[{key:"getToken",value:function(e){var t=this;return this.appCheck?this.appCheck.getToken(e):new Promise((function(n,r){var i=t;setTimeout((function(){i.appCheck?i.getToken(e).then(n,r):n(null)}),0)}))}},{key:"addTokenChangeListener",value:function(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then((function(t){return t.addTokenListener(e)}))}},{key:"notifyForInvalidToken",value:function(){nr('Provided AppCheck credentials for the app named "'.concat(this.appName_,'" ')+"are invalid. This usually indicates your app was not initialized correctly.")}}]),t}(),gr=function(){"use strict";function t(n,r,i){var a=this;e(l)(this,t),this.appName_=n,this.firebaseOptions_=r,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit((function(e){return a.auth_=e}))}return e(h)(t,[{key:"getToken",value:function(e){var t=this;return this.auth_?this.auth_.getToken(e).catch((function(e){return e&&"auth/token-not-initialized"===e.code?($n("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)})):new Promise((function(n,r){var i=t;setTimeout((function(){i.auth_?i.getToken(e).then(n,r):n(null)}),0)}))}},{key:"addTokenChangeListener",value:function(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then((function(t){return t.addAuthTokenListener(e)}))}},{key:"removeTokenChangeListener",value:function(e){this.authProvider_.get().then((function(t){return t.removeAuthTokenListener(e)}))}},{key:"notifyForInvalidToken",value:function(){var e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',nr(e)}}]),t}(),kr=function(){"use strict";function t(n){e(l)(this,t),this.accessToken=n}return e(h)(t,[{key:"getToken",value:function(e){return Promise.resolve({accessToken:this.accessToken})}},{key:"addTokenChangeListener",value:function(e){e(this.accessToken)}},{key:"removeTokenChangeListener",value:function(e){}},{key:"notifyForInvalidToken",value:function(){}}]),t}();kr.OWNER="owner";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var _r="5",wr=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,br="websocket",xr="long_polling",Ir=function(){"use strict";function t(n,r,i,a){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",u=arguments.length>6&&void 0!==arguments[6]&&arguments[6];e(l)(this,t),this.secure=r,this.namespace=i,this.webSocketOnly=a,this.nodeAdmin=o,this.persistenceKey=s,this.includeNamespaceInQueryParams=u,this._host=n.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Kn.get("host:"+n)||this._host}return e(h)(t,[{key:"isCacheableHost",value:function(){return"s-"===this.internalHost.substr(0,2)}},{key:"isCustomHost",value:function(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}},{key:"host",get:function(){return this._host},set:function(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Kn.set("host:"+this._host,this.internalHost))}},{key:"toString",value:function(){var e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}},{key:"toURLString",value:function(){var e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?"?ns=".concat(this.namespace):"";return"".concat(e).concat(this.host,"/").concat(t)}}]),t}();function Tr(e,t,n){var r;if(ue("string"==typeof t,"typeof type must == string"),ue("object"==typeof n,"typeof params must == object"),t===br)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==xr)throw new Error("Unknown connection type: "+t);r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);var i=[];return hr(n,(function(e,t){i.push(e+"="+t)})),r+i.join("&")}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Er=function(){"use strict";function t(){e(l)(this,t),this.counters_={}}return e(h)(t,[{key:"incrementCounter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;Be(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}},{key:"get",value:function(){return ve(void 0,this.counters_)}}]),t}(),Sr={},Cr={};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ar(e){var t=e.toString();return Sr[t]||(Sr[t]=new Er),Sr[t]}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Nr=function(){"use strict";function t(n){e(l)(this,t),this.onMessage_=n,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return e(h)(t,[{key:"closeAfter",value:function(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}},{key:"handleResponse",value:function(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){var n=function(e){i[e]&&vr((function(){r.onMessage_(i[e])}))},r=this,i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(var a=0;a<i.length;++a)n(a);if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}]),t}(),Rr="start",Dr="close",Pr=function(){"use strict";function t(n,r,i,a,o,s,u){var c=this;e(l)(this,t),this.connId=n,this.repoInfo=r,this.applicationId=i,this.appCheckToken=a,this.authToken=o,this.transportSessionId=s,this.lastSessionId=u,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Zn(n),this.stats_=Ar(r),this.urlFn=function(e){return c.appCheckToken&&(e.ac=c.appCheckToken),Tr(r,xr,e)}}return e(h)(t,[{key:"open",value:function(t,n){var r=this;this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new Nr(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((function(){r.log_("Timed out trying to connect."),r.onClosed_(),r.connectTimeoutTimer_=null}),Math.floor(3e4)),function(e){if(be()||"complete"===document.readyState)e();else{var t=!1,n=function(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(function(){"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((function(){var t=r;if(!r.isClosed_){r.scriptTagHolder=new Or((function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var a=e(b)(r,5),o=a[0],s=a[1],u=a[2];a[3],a[4];if(t.incrementIncomingBytes_(r),t.scriptTagHolder)if(t.connectTimeoutTimer_&&(clearTimeout(t.connectTimeoutTimer_),t.connectTimeoutTimer_=null),t.everConnected_=!0,o===Rr)t.id=s,t.password=u;else{if(o!==Dr)throw new Error("Unrecognized command received: "+o);if(s){var c=t;t.scriptTagHolder.sendNewPolls=!1,t.myPacketOrderer.closeAfter(s,(function(){c.onClosed_()}))}else t.onClosed_()}}),(function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var a=e(b)(r,2),o=a[0],s=a[1];t.incrementIncomingBytes_(r),t.myPacketOrderer.handleResponse(o,s)}),(function(){t.onClosed_()}),r.urlFn);var n={start:"t"};n.ser=Math.floor(1e8*Math.random()),r.scriptTagHolder.uniqueCallbackIdentifier&&(n.cb=r.scriptTagHolder.uniqueCallbackIdentifier),n.v=_r,r.transportSessionId&&(n.s=r.transportSessionId),r.lastSessionId&&(n.ls=r.lastSessionId),r.applicationId&&(n.p=r.applicationId),r.appCheckToken&&(n.ac=r.appCheckToken),"undefined"!=typeof location&&location.hostname&&wr.test(location.hostname)&&(n.r="f");var i=r.urlFn(n);r.log_("Connecting via long-poll to "+i),r.scriptTagHolder.addTag(i,(function(){}))}}))}},{key:"start",value:function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}},{key:"markConnectionHealthy",value:function(){}},{key:"shutdown_",value:function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}},{key:"onClosed_",value:function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}},{key:"close",value:function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}},{key:"send",value:function(e){var t=qe(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);for(var n=fe(t),r=lr(n,1840),i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++}},{key:"addDisconnectPingFrame",value:function(e,t){if(!be()){this.myDisconnFrame=document.createElement("iframe");var n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}}},{key:"incrementIncomingBytes_",value:function(e){var t=qe(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}],[{key:"forceAllow",value:function(){t.forceAllow_=!0}},{key:"forceDisallow",value:function(){t.forceDisallow_=!0}},{key:"isAvailable",value:function(){return!be()&&(!!t.forceAllow_||!(t.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}}]),t}(),Or=function(){"use strict";function t(n,r,i,a){if(e(l)(this,t),this.onDisconnect=i,this.urlFn=a,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,be())this.commandCB=n,this.onMessageCB=r;else{this.uniqueCallbackIdentifier=Gn(),window["pLPCommand"+this.uniqueCallbackIdentifier]=n,window["pRTLPCB"+this.uniqueCallbackIdentifier]=r,this.myIFrame=t.createIFrame_();var o="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11))o='<script>document.domain="'+document.domain+'";<\/script>';var s="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(s),this.myIFrame.doc.close()}catch(e){$n("frame writing exception"),e.stack&&$n(e.stack),$n(e)}}}return e(h)(t,[{key:"close",value:function(){if(this.alive=!1,this.myIFrame){var e=this;this.myIFrame.doc.body.innerHTML="",setTimeout((function(){null!==e.myIFrame&&(document.body.removeChild(e.myIFrame),e.myIFrame=null)}),Math.floor(0))}var t=this.onDisconnect;t&&(this.onDisconnect=null,t())}},{key:"startLongPoll",value:function(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}},{key:"newRequest_",value:function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;for(var t=this.urlFn(e),n="",r=0;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;var i=this.pendingSegs.shift();n=n+"&seg"+r+"="+i.seg+"&ts"+r+"="+i.ts+"&d"+r+"="+i.d,r++}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}},{key:"enqueueSegment",value:function(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}},{key:"addLongPollTag_",value:function(e,t){var n=this;this.outstandingRequests.add(t);var r=function(){n.outstandingRequests.delete(t),n.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(e,(function(){clearTimeout(i),r()}))}},{key:"addTag",value:function(e,t){var n=this;be()?this.doNodeLongPoll(e,t):setTimeout((function(){try{var r=n;if(!n.sendNewPolls)return;var i=n.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){var e=i.readyState;e&&"loaded"!==e&&"complete"!==e||(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),t())},i.onerror=function(){$n("Long-poll script failed to load: "+e),r.sendNewPolls=!1,r.close()},n.myIFrame.doc.body.appendChild(i)}catch(e){}}),Math.floor(1))}}],[{key:"createIFrame_",value:function(){var e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||$n("No IE domain setting required")}catch(n){var t=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+t+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}}]),t}(),Mr=null;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */"undefined"!=typeof MozWebSocket?Mr=MozWebSocket:"undefined"!=typeof WebSocket&&(Mr=WebSocket);var Lr=function(){"use strict";function t(n,r,i,a,o,s,u){e(l)(this,t),this.connId=n,this.applicationId=i,this.appCheckToken=a,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Zn(this.connId),this.stats_=Ar(r),this.connURL=t.connectionURL_(r,s,u,a,i),this.nodeAdmin=r.nodeAdmin}return e(h)(t,[{key:"open",value:function(e,t){var n=this;this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Kn.set("previous_websocket_failure",!0);try{var r;if(be()){var i=this.nodeAdmin?"AdminNode":"Node";r={headers:{"User-Agent":"Firebase/".concat(_r,"/").concat(Fn,"/").concat(z.platform,"/").concat(i),"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(r.headers.Authorization="Bearer ".concat(this.authToken)),this.appCheckToken&&(r.headers["X-Firebase-AppCheck"]=this.appCheckToken);var a={},o=0===this.connURL.indexOf("wss://")?a.HTTPS_PROXY||a.https_proxy:a.HTTP_PROXY||a.http_proxy;o&&(r.proxy={origin:o})}this.mySock=new Mr(this.connURL,[],r)}catch(e){this.log_("Error instantiating WebSocket.");var s=e.message||e.data;return s&&this.log_(s),void this.onClosed_()}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(e){n.handleIncomingFrame(e)},this.mySock.onerror=function(e){n.log_("WebSocket error.  Closing connection.");var t=e.message||e.data;t&&n.log_(t),n.onClosed_()}}},{key:"start",value:function(){}},{key:"markConnectionHealthy",value:function(){Kn.remove("previous_websocket_failure")}},{key:"appendFrame_",value:function(e){if(this.frames.push(e),this.frames.length===this.totalFrames){var t=this.frames.join("");this.frames=null;var n=Ue(t);this.onMessage(n)}}},{key:"handleNewFrameCount_",value:function(e){this.totalFrames=e,this.frames=[]}},{key:"extractFrameCount_",value:function(e){if(ue(null===this.frames,"We already have a frame buffer"),e.length<=6){var t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}},{key:"handleIncomingFrame",value:function(e){if(null!==this.mySock){var t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{var n=this.extractFrameCount_(t);null!==n&&this.appendFrame_(n)}}}},{key:"send",value:function(e){this.resetKeepAlive();var t=qe(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);var n=lr(t,16384);n.length>1&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])}},{key:"shutdown_",value:function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}},{key:"onClosed_",value:function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}},{key:"close",value:function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}},{key:"resetKeepAlive",value:function(){var e=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((function(){e.mySock&&e.sendString_("0"),e.resetKeepAlive()}),Math.floor(45e3))}},{key:"sendString_",value:function(e){try{this.mySock.send(e)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}],[{key:"connectionURL_",value:function(e,t,n,r,i){var a={};return a.v=_r,!be()&&"undefined"!=typeof location&&location.hostname&&wr.test(location.hostname)&&(a.r="f"),t&&(a.s=t),n&&(a.ls=n),r&&(a.ac=r),i&&(a.p=i),Tr(e,br,a)}},{key:"forceDisallow",value:function(){t.forceDisallow_=!0}},{key:"isAvailable",value:function(){var e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var n=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==Mr&&!t.forceDisallow_}},{key:"previouslyFailed",value:function(){return Kn.isInMemoryStorage||!0===Kn.get("previous_websocket_failure")}}]),t}();Lr.responsesRequiredToBeHealthy=2,Lr.healthyTimeout=3e4;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Fr=function(){"use strict";function t(n){e(l)(this,t),this.initTransports_(n)}return e(h)(t,[{key:"initTransports_",value:function(e){var n=Lr&&Lr.isAvailable(),r=n&&!Lr.previouslyFailed();if(e.webSocketOnly&&(n||nr("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[Lr];else{var i=this.transports_=[],a=!0,o=!1,s=void 0;try{for(var u,c=t.ALL_TRANSPORTS[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var l=u.value;l&&l.isAvailable()&&i.push(l)}}catch(e){o=!0,s=e}finally{try{a||null==c.return||c.return()}finally{if(o)throw s}}t.globalTransportInitialized_=!0}}},{key:"initialTransport",value:function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}},{key:"upgradeTransport",value:function(){return this.transports_.length>1?this.transports_[1]:null}}],[{key:"ALL_TRANSPORTS",get:function(){return[Pr,Lr]}},{key:"IS_TRANSPORT_INITIALIZED",get:function(){return this.globalTransportInitialized_}}]),t}();Fr.globalTransportInitialized_=!1;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Ur=function(){"use strict";function t(n,r,i,a,o,s,u,c,h,f){e(l)(this,t),this.id=n,this.repoInfo_=r,this.applicationId_=i,this.appCheckToken_=a,this.authToken_=o,this.onMessage_=s,this.onReady_=u,this.onDisconnect_=c,this.onKill_=h,this.lastSessionId=f,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Zn("c:"+this.id+":"),this.transportManager_=new Fr(r),this.log_("Connection created"),this.start_()}return e(h)(t,[{key:"start_",value:function(){var e=this,t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((function(){e.conn_&&e.conn_.open(n,r)}),Math.floor(0));var i=t.healthyTimeout||0;i>0&&(this.healthyTimeout_=yr((function(){e.healthyTimeout_=null,e.isHealthy_||(e.conn_&&e.conn_.bytesReceived>102400?(e.log_("Connection exceeded healthy timeout but has received "+e.conn_.bytesReceived+" bytes.  Marking connection healthy."),e.isHealthy_=!0,e.conn_.markConnectionHealthy()):e.conn_&&e.conn_.bytesSent>10240?e.log_("Connection exceeded healthy timeout but has sent "+e.conn_.bytesSent+" bytes.  Leaving connection alive."):(e.log_("Closing unhealthy connection after timeout."),e.close()))}),Math.floor(i)))}},{key:"nextTransportId_",value:function(){return"c:"+this.id+":"+this.connectionCount++}},{key:"disconnReceiver_",value:function(e){var t=this;return function(n){e===t.conn_?t.onConnectionLost_(n):e===t.secondaryConn_?(t.log_("Secondary connection lost."),t.onSecondaryConnectionLost_()):t.log_("closing an old connection")}}},{key:"connReceiver_",value:function(e){var t=this;return function(n){2!==t.state_&&(e===t.rx_?t.onPrimaryMessageReceived_(n):e===t.secondaryConn_?t.onSecondaryMessageReceived_(n):t.log_("message on old connection"))}}},{key:"sendRequest",value:function(e){var t={t:"d",d:e};this.sendData_(t)}},{key:"tryCleanupConnection",value:function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}},{key:"onSecondaryControl_",value:function(e){if("t"in e){var t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}},{key:"onSecondaryMessageReceived_",value:function(e){var t=ur("t",e),n=ur("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}},{key:"upgradeIfSecondaryHealthy_",value:function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}},{key:"proceedWithUpgrade_",value:function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}},{key:"onPrimaryMessageReceived_",value:function(e){var t=ur("t",e),n=ur("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}},{key:"onDataMessage_",value:function(e){this.onPrimaryResponse_(),this.onMessage_(e)}},{key:"onPrimaryResponse_",value:function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}},{key:"onControl_",value:function(e){var t=ur("t",e);if("d"in e){var n=e.d;if("h"===t)this.onHandshake_(n);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?er("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):er("Unknown control packet command: "+t)}}},{key:"onHandshake_",value:function(e){var t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),_r!==n&&nr("Protocol version mismatch detected"),this.tryStartUpgrade_())}},{key:"tryStartUpgrade_",value:function(){var e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}},{key:"startUpgrade_",value:function(e){var t=this;this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),yr((function(){t.secondaryConn_&&(t.log_("Timed out trying to upgrade."),t.secondaryConn_.close())}),Math.floor(6e4))}},{key:"onReset_",value:function(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}},{key:"onConnectionEstablished_",value:function(e,t){var n=this;this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):yr((function(){n.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))}},{key:"sendPingOnPrimaryIfNecessary_",value:function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}},{key:"onSecondaryConnectionLost_",value:function(){var e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}},{key:"onConnectionLost_",value:function(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Kn.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}},{key:"onConnectionShutdown_",value:function(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}},{key:"sendData_",value:function(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}},{key:"close",value:function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}},{key:"closeConnections_",value:function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}]),t}(),qr=function(){"use strict";function t(){e(l)(this,t)}return e(h)(t,[{key:"put",value:function(e,t,n,r){}},{key:"merge",value:function(e,t,n,r){}},{key:"refreshAuthToken",value:function(e){}},{key:"refreshAppCheckToken",value:function(e){}},{key:"onDisconnectPut",value:function(e,t,n){}},{key:"onDisconnectMerge",value:function(e,t,n){}},{key:"onDisconnectCancel",value:function(e,t){}},{key:"reportStats",value:function(e){}}]),t}(),Vr=function(){"use strict";function t(n){e(l)(this,t),this.allowedEvents_=n,this.listeners_={},ue(Array.isArray(n)&&n.length>0,"Requires a non-empty array")}return e(h)(t,[{key:"trigger",value:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if(Array.isArray(this.listeners_[t]))for(var a=e(p)(this.listeners_[t]),o=0;o<a.length;o++)a[o].callback.apply(a[o].context,r)}},{key:"on",value:function(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});var r=this.getInitialEvent(e);r&&t.apply(n,r)}},{key:"off",value:function(e,t,n){this.validateEventType_(e);for(var r=this.listeners_[e]||[],i=0;i<r.length;i++)if(r[i].callback===t&&(!n||n===r[i].context))return void r.splice(i,1)}},{key:"validateEventType_",value:function(e){ue(this.allowedEvents_.find((function(t){return t===e})),"Unknown event: "+e)}}]),t}(),jr=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(){var t;return e(l)(this,r),(t=n.call(this,["online"])).online_=!0,"undefined"==typeof window||void 0===window.addEventListener||me()||(window.addEventListener("online",(function(){t.online_||(t.online_=!0,t.trigger("online",!0))}),!1),window.addEventListener("offline",(function(){t.online_&&(t.online_=!1,t.trigger("online",!1))}),!1)),t}return e(h)(r,[{key:"getInitialEvent",value:function(e){return ue("online"===e,"Unknown event type: "+e),[this.online_]}},{key:"currentlyOnline",value:function(){return this.online_}}],[{key:"getInstance",value:function(){return new r}}]),r}(Vr),Br=function(){"use strict";function t(n,r){if(e(l)(this,t),void 0===r){this.pieces_=n.split("/");for(var i=0,a=0;a<this.pieces_.length;a++)this.pieces_[a].length>0&&(this.pieces_[i]=this.pieces_[a],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=n,this.pieceNum_=r}return e(h)(t,[{key:"toString",value:function(){for(var e="",t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}]),t}();function Kr(){return new Br("")}function zr(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function Wr(e){return e.pieces_.length-e.pieceNum_}function Gr(e){var t=e.pieceNum_;return t<e.pieces_.length&&t++,new Br(e.pieces_,t)}function Hr(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function Qr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.pieces_.slice(e.pieceNum_+t)}function Yr(e){if(e.pieceNum_>=e.pieces_.length)return null;for(var t=[],n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new Br(t,0)}function Jr(e,t){for(var n=[],r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);if(t instanceof Br)for(var i=t.pieceNum_;i<t.pieces_.length;i++)n.push(t.pieces_[i]);else for(var a=t.split("/"),o=0;o<a.length;o++)a[o].length>0&&n.push(a[o]);return new Br(n,0)}function Xr(e){return e.pieceNum_>=e.pieces_.length}function $r(e,t){var n=zr(e),r=zr(t);if(null===n)return t;if(n===r)return $r(Gr(e),Gr(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function Zr(e,t){for(var n=Qr(e,0),r=Qr(t,0),i=0;i<n.length&&i<r.length;i++){var a=or(n[i],r[i]);if(0!==a)return a}return n.length===r.length?0:n.length<r.length?-1:1}function ei(e,t){if(Wr(e)!==Wr(t))return!1;for(var n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function ti(e,t){var n=e.pieceNum_,r=t.pieceNum_;if(Wr(e)>Wr(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}var ni=function t(n,r){"use strict";e(l)(this,t),this.errorPrefix_=r,this.parts_=Qr(n,0),this.byteLength_=Math.max(1,this.parts_.length);for(var i=0;i<this.parts_.length;i++)this.byteLength_+=ot(this.parts_[i]);ri(this)};function ri(e){if(e.byteLength_>768)throw new Error(e.errorPrefix_+"has a key path longer than 768 bytes ("+e.byteLength_+").");if(e.parts_.length>32)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+ii(e))}function ii(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ai=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(){var t,i,a;return e(l)(this,r),t=n.call(this,["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(a="visibilitychange",i="hidden"):void 0!==document.mozHidden?(a="mozvisibilitychange",i="mozHidden"):void 0!==document.msHidden?(a="msvisibilitychange",i="msHidden"):void 0!==document.webkitHidden&&(a="webkitvisibilitychange",i="webkitHidden")),t.visible_=!0,a&&document.addEventListener(a,(function(){var e=!document[i];e!==t.visible_&&(t.visible_=e,t.trigger("visible",e))}),!1),t}return e(h)(r,[{key:"getInitialEvent",value:function(e){return ue("visible"===e,"Unknown event type: "+e),[this.visible_]}}],[{key:"getInstance",value:function(){return new r}}]),r}(Vr),oi=1e3,si=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i,a,o,s,u,c,h){var f;if(e(l)(this,r),(f=n.call(this)).repoInfo_=t,f.applicationId_=i,f.onDataUpdate_=a,f.onConnectStatus_=o,f.onServerInfoUpdate_=s,f.authTokenProvider_=u,f.appCheckTokenProvider_=c,f.authOverride_=h,f.id=r.nextPersistentConnectionId_++,f.log_=Zn("p:"+f.id+":"),f.interruptReasons_={},f.listens=new Map,f.outstandingPuts_=[],f.outstandingGets_=[],f.outstandingPutCount_=0,f.outstandingGetCount_=0,f.onDisconnectRequestQueue_=[],f.connected_=!1,f.reconnectDelay_=oi,f.maxReconnectDelay_=3e5,f.securityDebugCallback_=null,f.lastSessionId=null,f.establishConnectionTimer_=null,f.visible_=!1,f.requestCBHash_={},f.requestNumber_=0,f.realtime_=null,f.authToken_=null,f.appCheckToken_=null,f.forceTokenRefresh_=!1,f.invalidAuthTokenCount_=0,f.invalidAppCheckTokenCount_=0,f.firstConnection_=!0,f.lastConnectionAttemptTime_=null,f.lastConnectionEstablishedTime_=null,h&&!be())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return ai.getInstance().on("visible",f.onVisible_,e(C)(f)),-1===t.host.indexOf("fblocal")&&jr.getInstance().on("online",f.onOnline_,e(C)(f)),f}return e(h)(r,[{key:"sendRequest",value:function(e,t,n){var r=++this.requestNumber_,i={r:r,a:e,b:t};this.log_(qe(i)),ue(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)}},{key:"get",value:function(e){this.initConnection_();var t=new De,n={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:function(e){var n=e.d;"ok"===e.s?t.resolve(n):t.reject(n)}};this.outstandingGets_.push(n),this.outstandingGetCount_++;var r=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(r),t.promise}},{key:"listen",value:function(e,t,n,r){this.initConnection_();var i=e._queryIdentifier,a=e._path.toString();this.log_("Listen called for "+a+" "+i),this.listens.has(a)||this.listens.set(a,new Map),ue(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),ue(!this.listens.get(a).has(i),"listen() called twice for same path/queryId.");var o={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(a).set(i,o),this.connected_&&this.sendListen_(o)}},{key:"sendGet_",value:function(e){var t=this,n=this.outstandingGets_[e];this.sendRequest("g",n.request,(function(r){delete t.outstandingGets_[e],t.outstandingGetCount_--,0===t.outstandingGetCount_&&(t.outstandingGets_=[]),n.onComplete&&n.onComplete(r)}))}},{key:"sendListen_",value:function(e){var t=this,n=e.query,i=n._path.toString(),a=n._queryIdentifier;this.log_("Listen on "+i+" for "+a);var o={p:i};e.tag&&(o.q=n._queryObject,o.t=e.tag),o.h=e.hashFn(),this.sendRequest("q",o,(function(o){var s=o.d,u=o.s;r.warnOnListenWarnings_(s,n),(t.listens.get(i)&&t.listens.get(i).get(a))===e&&(t.log_("listen response",o),"ok"!==u&&t.removeListen_(i,a),e.onComplete&&e.onComplete(u,s))}))}},{key:"refreshAuthToken",value:function(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(function(){})),this.reduceReconnectDelayIfAdminCredential_(e)}},{key:"reduceReconnectDelayIfAdminCredential_",value:function(e){var t;(e&&40===e.length||"object"==typeof(t=Ve(e).claims)&&!0===t.admin)&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}},{key:"refreshAppCheckToken",value:function(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(function(){}))}},{key:"tryAuth",value:function(){if(this.connected_&&this.authToken_){var e=this,t=this.authToken_,n=je(t)?"auth":"gauth",r={cred:t};null===this.authOverride_?r.noauth=!0:"object"==typeof this.authOverride_&&(r.authvar=this.authOverride_),this.sendRequest(n,r,(function(n){var r=n.s,i=n.d||"error";e.authToken_===t&&("ok"===r?e.invalidAuthTokenCount_=0:e.onAuthRevoked_(r,i))}))}}},{key:"tryAppCheck",value:function(){var e=this;this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(function(t){var n=t.s,r=t.d||"error";"ok"===n?e.invalidAppCheckTokenCount_=0:e.onAppCheckRevoked_(n,r)}))}},{key:"unlisten",value:function(e,t){var n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),ue(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)}},{key:"sendUnlisten_",value:function(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);var i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)}},{key:"onDisconnectPut",value:function(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}},{key:"onDisconnectMerge",value:function(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}},{key:"onDisconnectCancel",value:function(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}},{key:"sendOnDisconnect_",value:function(e,t,n,r){var i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,(function(e){r&&setTimeout((function(){r(e.s,e.d)}),Math.floor(0))}))}},{key:"put",value:function(e,t,n,r){this.putInternal("p",e,t,n,r)}},{key:"merge",value:function(e,t,n,r){this.putInternal("m",e,t,n,r)}},{key:"putInternal",value:function(e,t,n,r,i){this.initConnection_();var a={p:t,d:n};void 0!==i&&(a.h=i),this.outstandingPuts_.push({action:e,request:a,onComplete:r}),this.outstandingPutCount_++;var o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+t)}},{key:"sendPut_",value:function(e){var t=this,n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,(function(r){t.log_(n+" response",r),delete t.outstandingPuts_[e],t.outstandingPutCount_--,0===t.outstandingPutCount_&&(t.outstandingPuts_=[]),i&&i(r.s,r.d)}))}},{key:"reportStats",value:function(e){if(this.connected_){var t=this,n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,(function(e){if("ok"!==e.s){var n=e.d;t.log_("reportStats","Error sending stats: "+n)}}))}}},{key:"onDataMessage_",value:function(e){if("r"in e){this.log_("from server: "+qe(e));var t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}},{key:"onDataPush_",value:function(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):er("Unrecognized action received from server: "+qe(e)+"\nAre you using the latest client?")}},{key:"onReady_",value:function(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}},{key:"scheduleConnect_",value:function(e){var t=this;ue(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((function(){t.establishConnectionTimer_=null,t.establishConnection_()}),Math.floor(e))}},{key:"initConnection_",value:function(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}},{key:"onVisible_",value:function(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=oi,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}},{key:"onOnline_",value:function(e){e?(this.log_("Browser went online."),this.reconnectDelay_=oi,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}},{key:"onRealtimeDisconnect_",value:function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=oi),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();var e=(new Date).getTime()-this.lastConnectionAttemptTime_,t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}},{key:"establishConnection_",value:function(){var t=this;return e(u)(e(_).mark((function n(){var i,a,o,s,u,c,l,h,f,d,p,v,y;return e(_).wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.shouldReconnect_()){n.next=31;break}return t.log_("Making a connection attempt"),t.lastConnectionAttemptTime_=(new Date).getTime(),t.lastConnectionEstablishedTime_=null,i=t.onDataMessage_.bind(t),a=t.onReady_.bind(t),o=t.onRealtimeDisconnect_.bind(t),s=t.id+":"+r.nextConnectionId_++,u=t.lastSessionId,c=!1,l=null,h=function(){l?l.close():(c=!0,o())},f=function(e){ue(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(e)},t.realtime_={close:h,sendRequest:f},d=t.forceTokenRefresh_,t.forceTokenRefresh_=!1,n.prev=16,n.t0=e(b),n.next=20,Promise.all([t.authTokenProvider_.getToken(d),t.appCheckTokenProvider_.getToken(d)]);case 20:n.t1=n.sent,p=(0,n.t0)(n.t1,2),v=p[0],y=p[1],c?$n("getToken() completed but was canceled"):($n("getToken() completed. Creating connection."),t.authToken_=v&&v.accessToken,t.appCheckToken_=y&&y.token,l=new Ur(s,t.repoInfo_,t.applicationId_,t.appCheckToken_,t.authToken_,i,a,o,(function(e){nr(e+" ("+t.repoInfo_.toString()+")"),t.interrupt("server_kill")}),u)),n.next=31;break;case 27:n.prev=27,n.t2=n.catch(16),t.log_("Failed to get token: "+n.t2),c||(t.repoInfo_.nodeAdmin&&nr(n.t2),h());case 31:case"end":return n.stop()}}),n,null,[[16,27]])})))()}},{key:"interrupt",value:function(e){$n("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}},{key:"resume",value:function(e){$n("Resuming connection for reason: "+e),delete this.interruptReasons_[e],ze(this.interruptReasons_)&&(this.reconnectDelay_=oi,this.realtime_||this.scheduleConnect_(0))}},{key:"handleTimestamp_",value:function(e){var t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}},{key:"cancelSentTransactions_",value:function(){for(var e=0;e<this.outstandingPuts_.length;e++){var t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}},{key:"onListenRevoked_",value:function(e,t){var n;n=t?t.map((function(e){return cr(e)})).join("$"):"default";var r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")}},{key:"removeListen_",value:function(e,t){var n,r=new Br(e).toString();if(this.listens.has(r)){var i=this.listens.get(r);n=i.get(t),i.delete(t),0===i.size&&this.listens.delete(r)}else n=void 0;return n}},{key:"onAuthRevoked_",value:function(e,t){$n("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}},{key:"onAppCheckRevoked_",value:function(e,t){$n("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}},{key:"onSecurityDebugPacket_",value:function(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}},{key:"restoreState_",value:function(){this.tryAuth(),this.tryAppCheck();var e=!0,t=!1,n=void 0,r=!0,i=!1,a=void 0;try{for(var o,s=this.listens.values()[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;try{for(var c,l=u.values()[Symbol.iterator]();!(e=(c=l.next()).done);e=!0){var h=c.value;this.sendListen_(h)}}catch(e){t=!0,n=e}finally{try{e||null==l.return||l.return()}finally{if(t)throw n}}}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}for(var f=0;f<this.outstandingPuts_.length;f++)this.outstandingPuts_[f]&&this.sendPut_(f);for(;this.onDisconnectRequestQueue_.length;){var d=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(d.action,d.pathString,d.data,d.onComplete)}for(var p=0;p<this.outstandingGets_.length;p++)this.outstandingGets_[p]&&this.sendGet_(p)}},{key:"sendConnectStats_",value:function(){var e={},t="js";be()&&(t=this.repoInfo_.nodeAdmin?"admin_node":"node"),e["sdk."+t+"."+Fn.replace(/\./g,"-")]=1,me()?e["framework.cordova"]=1:_e()&&(e["framework.reactnative"]=1),this.reportStats(e)}},{key:"shouldReconnect_",value:function(){var e=jr.getInstance().currentlyOnline();return ze(this.interruptReasons_)&&e}}],[{key:"warnOnListenWarnings_",value:function(e,t){if(e&&"object"==typeof e&&Be(e,"w")){var n=Ke(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+t._queryParams.getIndex().toString()+'"',i=t._path.toString();nr("Using an unspecified index. Your data will be downloaded and "+"filtered on the client. Consider adding ".concat(r," at ")+"".concat(i," to your security rules for better performance."))}}}}]),r}(qr);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */si.nextPersistentConnectionId_=0,si.nextConnectionId_=0;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var ui,ci=function(){"use strict";function t(n,r){e(l)(this,t),this.name=n,this.node=r}return e(h)(t,null,[{key:"Wrap",value:function(e,n){return new t(e,n)}}]),t}(),li=function(){"use strict";function t(){e(l)(this,t)}return e(h)(t,[{key:"getCompare",value:function(){return this.compare.bind(this)}},{key:"indexedValueChanged",value:function(e,t){var n=new ci(ir,e),r=new ci(ir,t);return 0!==this.compare(n,r)}},{key:"minPost",value:function(){return ci.MIN}}]),t}(),hi=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(){return e(l)(this,r),n.apply(this,arguments)}return e(h)(r,[{key:"compare",value:function(e,t){return or(e.name,t.name)}},{key:"isDefinedOn",value:function(e){throw ce("KeyIndex.isDefinedOn not expected to be called.")}},{key:"indexedValueChanged",value:function(e,t){return!1}},{key:"minPost",value:function(){return ci.MIN}},{key:"maxPost",value:function(){return new ci(ar,ui)}},{key:"makePost",value:function(e,t){return ue("string"==typeof e,"KeyIndex indexValue must always be a string."),new ci(e,ui)}},{key:"toString",value:function(){return".key"}}],[{key:"__EMPTY_NODE",get:function(){return ui},set:function(e){ui=e}}]),r}(li),fi=new hi,di=function(){"use strict";function t(n,r,i,a){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;e(l)(this,t),this.isReverse_=a,this.resultGenerator_=o,this.nodeStack_=[];for(var s=1;!n.isEmpty();)if(s=r?i(n.key,r):1,a&&(s*=-1),s<0)n=this.isReverse_?n.left:n.right;else{if(0===s){this.nodeStack_.push(n);break}this.nodeStack_.push(n),n=this.isReverse_?n.right:n.left}}return e(h)(t,[{key:"getNext",value:function(){if(0===this.nodeStack_.length)return null;var e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}},{key:"hasNext",value:function(){return this.nodeStack_.length>0}},{key:"peek",value:function(){if(0===this.nodeStack_.length)return null;var e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}]),t}(),pi=function(){"use strict";function t(n,r,i,a,o){e(l)(this,t),this.key=n,this.value=r,this.color=null!=i?i:t.RED,this.left=null!=a?a:mi.EMPTY_NODE,this.right=null!=o?o:mi.EMPTY_NODE}return e(h)(t,[{key:"copy",value:function(e,n,r,i,a){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=a?a:this.right)}},{key:"count",value:function(){return this.left.count()+1+this.right.count()}},{key:"isEmpty",value:function(){return!1}},{key:"inorderTraversal",value:function(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}},{key:"min_",value:function(){return this.left.isEmpty()?this:this.left.min_()}},{key:"minKey",value:function(){return this.min_().key}},{key:"maxKey",value:function(){return this.right.isEmpty()?this.key:this.right.maxKey()}},{key:"insert",value:function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp_()}},{key:"removeMin_",value:function(){if(this.left.isEmpty())return mi.EMPTY_NODE;var e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),(e=e.copy(null,null,null,e.left.removeMin_(),null)).fixUp_()}},{key:"remove",value:function(e,t){var n,r;if(t(e,(n=this).key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return mi.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}},{key:"isRed_",value:function(){return this.color}},{key:"fixUp_",value:function(){var e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}},{key:"moveRedLeft_",value:function(){var e=this.colorFlip_();return e.right.left.isRed_()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight_())).rotateLeft_()).colorFlip_()),e}},{key:"moveRedRight_",value:function(){var e=this.colorFlip_();return e.left.left.isRed_()&&(e=(e=e.rotateRight_()).colorFlip_()),e}},{key:"rotateLeft_",value:function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}},{key:"rotateRight_",value:function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}},{key:"colorFlip_",value:function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}},{key:"checkMaxDepth_",value:function(){var e=this.check_();return Math.pow(2,e)<=this.count()+1}},{key:"check_",value:function(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}]),t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */pi.RED=!0,pi.BLACK=!1;var vi,yi=function(){"use strict";function t(){e(l)(this,t)}return e(h)(t,[{key:"copy",value:function(e,t,n,r,i){return this}},{key:"insert",value:function(e,t,n){return new pi(e,t,null)}},{key:"remove",value:function(e,t){return this}},{key:"count",value:function(){return 0}},{key:"isEmpty",value:function(){return!0}},{key:"inorderTraversal",value:function(e){return!1}},{key:"reverseTraversal",value:function(e){return!1}},{key:"minKey",value:function(){return null}},{key:"maxKey",value:function(){return null}},{key:"check_",value:function(){return 0}},{key:"isRed_",value:function(){return!1}}]),t}(),mi=function(){"use strict";function t(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.EMPTY_NODE;e(l)(this,t),this.comparator_=n,this.root_=r}return e(h)(t,[{key:"insert",value:function(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,pi.BLACK,null,null))}},{key:"remove",value:function(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,pi.BLACK,null,null))}},{key:"get",value:function(e){for(var t,n=this.root_;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key)))return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}},{key:"getPredecessorKey",value:function(e){for(var t,n=this.root_,r=null;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}},{key:"isEmpty",value:function(){return this.root_.isEmpty()}},{key:"count",value:function(){return this.root_.count()}},{key:"minKey",value:function(){return this.root_.minKey()}},{key:"maxKey",value:function(){return this.root_.maxKey()}},{key:"inorderTraversal",value:function(e){return this.root_.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.root_.reverseTraversal(e)}},{key:"getIterator",value:function(e){return new di(this.root_,null,this.comparator_,!1,e)}},{key:"getIteratorFrom",value:function(e,t){return new di(this.root_,e,this.comparator_,!1,t)}},{key:"getReverseIteratorFrom",value:function(e,t){return new di(this.root_,e,this.comparator_,!0,t)}},{key:"getReverseIterator",value:function(e){return new di(this.root_,null,this.comparator_,!0,e)}}]),t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function gi(e,t){return or(e.name,t.name)}function ki(e,t){return or(e,t)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */mi.EMPTY_NODE=new yi;var _i,wi,bi,xi=function(e){return"number"==typeof e?"number:"+fr(e):"string:"+e},Ii=function(e){if(e.isLeafNode()){var t=e.val();ue("string"==typeof t||"number"==typeof t||"object"==typeof t&&Be(t,".sv"),"Priority must be a string or number.")}else ue(e===vi||e.isEmpty(),"priority of unexpected type.");ue(e===vi||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},Ti=function(){"use strict";function t(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.__childrenNodeConstructor.EMPTY_NODE;e(l)(this,t),this.value_=n,this.priorityNode_=r,this.lazyHash_=null,ue(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),Ii(this.priorityNode_)}return e(h)(t,[{key:"isLeafNode",value:function(){return!0}},{key:"getPriority",value:function(){return this.priorityNode_}},{key:"updatePriority",value:function(e){return new t(this.value_,e)}},{key:"getImmediateChild",value:function(e){return".priority"===e?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}},{key:"getChild",value:function(e){return Xr(e)?this:".priority"===zr(e)?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}},{key:"hasChild",value:function(){return!1}},{key:"getPredecessorChildName",value:function(e,t){return null}},{key:"updateImmediateChild",value:function(e,n){return".priority"===e?this.updatePriority(n):n.isEmpty()&&".priority"!==e?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}},{key:"updateChild",value:function(e,n){var r=zr(e);return null===r?n:n.isEmpty()&&".priority"!==r?this:(ue(".priority"!==r||1===Wr(e),".priority must be the last token in a path"),this.updateImmediateChild(r,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(Gr(e),n)))}},{key:"isEmpty",value:function(){return!1}},{key:"numChildren",value:function(){return 0}},{key:"forEachChild",value:function(e,t){return!1}},{key:"val",value:function(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}},{key:"hash",value:function(){if(null===this.lazyHash_){var t="";this.priorityNode_.isEmpty()||(t+="priority:"+xi(this.priorityNode_.val())+":");var n=e(On)(this.value_);t+=n+":",t+="number"===n?fr(this.value_):this.value_,this.lazyHash_=Hn(t)}return this.lazyHash_}},{key:"getValue",value:function(){return this.value_}},{key:"compareTo",value:function(e){return e===t.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof t.__childrenNodeConstructor?-1:(ue(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}},{key:"compareToLeafNode_",value:function(n){var r=e(On)(n.value_),i=e(On)(this.value_),a=t.VALUE_TYPE_ORDER.indexOf(r),o=t.VALUE_TYPE_ORDER.indexOf(i);return ue(a>=0,"Unknown leaf type: "+r),ue(o>=0,"Unknown leaf type: "+i),a===o?"object"===i?0:this.value_<n.value_?-1:this.value_===n.value_?0:1:o-a}},{key:"withIndex",value:function(){return this}},{key:"isIndexed",value:function(){return!0}},{key:"equals",value:function(e){if(e===this)return!0;if(e.isLeafNode()){var t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}],[{key:"__childrenNodeConstructor",get:function(){return _i},set:function(e){_i=e}}]),t}();Ti.VALUE_TYPE_ORDER=["object","boolean","number","string"];var Ei,Si,Ci=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(){return e(l)(this,r),n.apply(this,arguments)}return e(h)(r,[{key:"compare",value:function(e,t){var n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?or(e.name,t.name):i}},{key:"isDefinedOn",value:function(e){return!e.getPriority().isEmpty()}},{key:"indexedValueChanged",value:function(e,t){return!e.getPriority().equals(t.getPriority())}},{key:"minPost",value:function(){return ci.MIN}},{key:"maxPost",value:function(){return new ci(ar,new Ti("[PRIORITY-POST]",bi))}},{key:"makePost",value:function(e,t){var n=wi(e);return new ci(t,new Ti("[PRIORITY-POST]",n))}},{key:"toString",value:function(){return".priority"}}]),r}(li),Ai=new Ci,Ni=Math.log(2),Ri=function(){"use strict";function t(n){e(l)(this,t);var r;this.count=(r=n+1,parseInt(Math.log(r)/Ni,10)),this.current_=this.count-1;var i,a=(i=this.count,parseInt(Array(i+1).join("1"),2));this.bits_=n+1&a}return e(h)(t,[{key:"nextBitIsOne",value:function(){var e=!(this.bits_&1<<this.current_);return this.current_--,e}}]),t}(),Di=function(e,t,n,r){e.sort(t);var i=function(t,r){var a,o,s=r-t;if(0===s)return null;if(1===s)return a=e[t],o=n?n(a):a,new pi(o,a.node,pi.BLACK,null,null);var u=parseInt(s/2,10)+t,c=i(t,u),l=i(u+1,r);return a=e[u],o=n?n(a):a,new pi(o,a.node,pi.BLACK,c,l)},a=function(t){for(var r=null,a=null,o=e.length,s=function(t,r){var a=o-t,s=o;o-=t;var c=i(a+1,s),l=e[a],h=n?n(l):l;u(new pi(h,l.node,r,null,c))},u=function(e){r?(r.left=e,r=e):(a=e,r=e)},c=0;c<t.count;++c){var l=t.nextBitIsOne(),h=Math.pow(2,t.count-(c+1));l?s(h,pi.BLACK):(s(h,pi.BLACK),s(h,pi.RED))}return a}(new Ri(e.length));return new mi(r||t,a)},Pi={},Oi=function(){"use strict";function t(n,r){e(l)(this,t),this.indexes_=n,this.indexSet_=r}return e(h)(t,[{key:"get",value:function(e){var t=Ke(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof mi?t:null}},{key:"hasIndex",value:function(e){return Be(this.indexSet_,e.toString())}},{key:"addIndex",value:function(e,n){ue(e!==fi,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var r,i=[],a=!1,o=n.getIterator(ci.Wrap),s=o.getNext();s;)a=a||e.isDefinedOn(s.node),i.push(s),s=o.getNext();r=a?Di(i,e.getCompare()):Pi;var u=e.toString(),c=Object.assign({},this.indexSet_);c[u]=e;var l=Object.assign({},this.indexes_);return l[u]=r,new t(l,c)}},{key:"addToIndexes",value:function(e,n){var r=this;return new t(We(this.indexes_,(function(t,i){var a=Ke(r.indexSet_,i);if(ue(a,"Missing index implementation for "+i),t===Pi){if(a.isDefinedOn(e.node)){for(var o=[],s=n.getIterator(ci.Wrap),u=s.getNext();u;)u.name!==e.name&&o.push(u),u=s.getNext();return o.push(e),Di(o,a.getCompare())}return Pi}var c=n.get(e.name),l=t;return c&&(l=l.remove(new ci(e.name,c))),l.insert(e,e.node)})),this.indexSet_)}},{key:"removeFromIndexes",value:function(e,n){return new t(We(this.indexes_,(function(t){if(t===Pi)return t;var r=n.get(e.name);return r?t.remove(new ci(e.name,r)):t})),this.indexSet_)}}],[{key:"Default",get:function(){return ue(Pi&&Ai,"ChildrenNode.ts has not been loaded"),Ei=Ei||new t({".priority":Pi},{".priority":Ai})}}]),t}(),Mi=function(){"use strict";function t(n,r,i){e(l)(this,t),this.children_=n,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&Ii(this.priorityNode_),this.children_.isEmpty()&&ue(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return e(h)(t,[{key:"isLeafNode",value:function(){return!1}},{key:"getPriority",value:function(){return this.priorityNode_||Si}},{key:"updatePriority",value:function(e){return this.children_.isEmpty()?this:new t(this.children_,e,this.indexMap_)}},{key:"getImmediateChild",value:function(e){if(".priority"===e)return this.getPriority();var t=this.children_.get(e);return null===t?Si:t}},{key:"getChild",value:function(e){var t=zr(e);return null===t?this:this.getImmediateChild(t).getChild(Gr(e))}},{key:"hasChild",value:function(e){return null!==this.children_.get(e)}},{key:"updateImmediateChild",value:function(e,n){if(ue(n,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(n);var r,i,a=new ci(e,n);n.isEmpty()?(r=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(a,this.children_)):(r=this.children_.insert(e,n),i=this.indexMap_.addToIndexes(a,this.children_));var o=r.isEmpty()?Si:this.priorityNode_;return new t(r,o,i)}},{key:"updateChild",value:function(e,t){var n=zr(e);if(null===n)return t;ue(".priority"!==zr(e)||1===Wr(e),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(Gr(e),t);return this.updateImmediateChild(n,r)}},{key:"isEmpty",value:function(){return this.children_.isEmpty()}},{key:"numChildren",value:function(){return this.children_.count()}},{key:"val",value:function(e){if(this.isEmpty())return null;var n={},r=0,i=0,a=!0;if(this.forEachChild(Ai,(function(o,s){n[o]=s.val(e),r++,a&&t.INTEGER_REGEXP_.test(o)?i=Math.max(i,Number(o)):a=!1})),!e&&a&&i<2*r){var o=[];for(var s in n)o[s]=n[s];return o}return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}},{key:"hash",value:function(){if(null===this.lazyHash_){var e="";this.getPriority().isEmpty()||(e+="priority:"+xi(this.getPriority().val())+":"),this.forEachChild(Ai,(function(t,n){var r=n.hash();""!==r&&(e+=":"+t+":"+r)})),this.lazyHash_=""===e?"":Hn(e)}return this.lazyHash_}},{key:"getPredecessorChildName",value:function(e,t,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new ci(e,t));return i?i.name:null}return this.children_.getPredecessorKey(e)}},{key:"getFirstChildName",value:function(e){var t=this.resolveIndex_(e);if(t){var n=t.minKey();return n&&n.name}return this.children_.minKey()}},{key:"getFirstChild",value:function(e){var t=this.getFirstChildName(e);return t?new ci(t,this.children_.get(t)):null}},{key:"getLastChildName",value:function(e){var t=this.resolveIndex_(e);if(t){var n=t.maxKey();return n&&n.name}return this.children_.maxKey()}},{key:"getLastChild",value:function(e){var t=this.getLastChildName(e);return t?new ci(t,this.children_.get(t)):null}},{key:"forEachChild",value:function(e,t){var n=this.resolveIndex_(e);return n?n.inorderTraversal((function(e){return t(e.name,e.node)})):this.children_.inorderTraversal(t)}},{key:"getIterator",value:function(e){return this.getIteratorFrom(e.minPost(),e)}},{key:"getIteratorFrom",value:function(e,t){var n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,(function(e){return e}));for(var r=this.children_.getIteratorFrom(e.name,ci.Wrap),i=r.peek();null!=i&&t.compare(i,e)<0;)r.getNext(),i=r.peek();return r}},{key:"getReverseIterator",value:function(e){return this.getReverseIteratorFrom(e.maxPost(),e)}},{key:"getReverseIteratorFrom",value:function(e,t){var n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,(function(e){return e}));for(var r=this.children_.getReverseIteratorFrom(e.name,ci.Wrap),i=r.peek();null!=i&&t.compare(i,e)>0;)r.getNext(),i=r.peek();return r}},{key:"compareTo",value:function(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Li?-1:0}},{key:"withIndex",value:function(e){if(e===fi||this.indexMap_.hasIndex(e))return this;var n=this.indexMap_.addIndex(e,this.children_);return new t(this.children_,this.priorityNode_,n)}},{key:"isIndexed",value:function(e){return e===fi||this.indexMap_.hasIndex(e)}},{key:"equals",value:function(e){if(e===this)return!0;if(e.isLeafNode())return!1;var t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){for(var n=this.getIterator(Ai),r=t.getIterator(Ai),i=n.getNext(),a=r.getNext();i&&a;){if(i.name!==a.name||!i.node.equals(a.node))return!1;i=n.getNext(),a=r.getNext()}return null===i&&null===a}return!1}return!1}},{key:"resolveIndex_",value:function(e){return e===fi?null:this.indexMap_.get(e.toString())}}],[{key:"EMPTY_NODE",get:function(){return Si||(Si=new t(new mi(ki),null,Oi.Default))}}]),t}();Mi.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;var Li=new(function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(){return e(l)(this,r),n.call(this,new mi(ki),Mi.EMPTY_NODE,Oi.Default)}return e(h)(r,[{key:"compareTo",value:function(e){return e===this?0:1}},{key:"equals",value:function(e){return e===this}},{key:"getPriority",value:function(){return this}},{key:"getImmediateChild",value:function(e){return Mi.EMPTY_NODE}},{key:"isEmpty",value:function(){return!1}}]),r}(Mi));Object.defineProperties(ci,{MIN:{value:new ci(ir,Mi.EMPTY_NODE)},MAX:{value:new ci(ar,Li)}}),hi.__EMPTY_NODE=Mi.EMPTY_NODE,Ti.__childrenNodeConstructor=Mi,vi=Li,function(e){bi=e}(Li);function Fi(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null===t)return Mi.EMPTY_NODE;if("object"==typeof t&&".priority"in t&&(n=t[".priority"]),ue(null===n||"string"==typeof n||"number"==typeof n||"object"==typeof n&&".sv"in n,"Invalid priority type found: "+(void 0===n?"undefined":e(On)(n))),"object"==typeof t&&".value"in t&&null!==t[".value"]&&(t=t[".value"]),"object"!=typeof t||".sv"in t){var r=t;return new Ti(r,Fi(n))}if(t instanceof Array){var i=Mi.EMPTY_NODE;return hr(t,(function(e,n){if(Be(t,e)&&"."!==e.substring(0,1)){var r=Fi(n);!r.isLeafNode()&&r.isEmpty()||(i=i.updateImmediateChild(e,r))}})),i.updatePriority(Fi(n))}var a=[],o=!1,s=t;if(hr(s,(function(e,t){if("."!==e.substring(0,1)){var n=Fi(t);n.isEmpty()||(o=o||!n.getPriority().isEmpty(),a.push(new ci(e,n)))}})),0===a.length)return Mi.EMPTY_NODE;var u=Di(a,gi,(function(e){return e.name}),ki);if(o){var c=Di(a,Ai.getCompare());return new Mi(u,Fi(n),new Oi({".priority":c},{".priority":Ai}))}return new Mi(u,Fi(n),Oi.Default)}!function(e){wi=e}(Fi);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Ui=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t){var i;return e(l)(this,r),(i=n.call(this)).indexPath_=t,ue(!Xr(t)&&".priority"!==zr(t),"Can't create PathIndex with empty path or .priority key"),i}return e(h)(r,[{key:"extractChild",value:function(e){return e.getChild(this.indexPath_)}},{key:"isDefinedOn",value:function(e){return!e.getChild(this.indexPath_).isEmpty()}},{key:"compare",value:function(e,t){var n=this.extractChild(e.node),r=this.extractChild(t.node),i=n.compareTo(r);return 0===i?or(e.name,t.name):i}},{key:"makePost",value:function(e,t){var n=Fi(e),r=Mi.EMPTY_NODE.updateChild(this.indexPath_,n);return new ci(t,r)}},{key:"maxPost",value:function(){var e=Mi.EMPTY_NODE.updateChild(this.indexPath_,Li);return new ci(ar,e)}},{key:"toString",value:function(){return Qr(this.indexPath_,0).join("/")}}]),r}(li),qi=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(){return e(l)(this,r),n.apply(this,arguments)}return e(h)(r,[{key:"compare",value:function(e,t){var n=e.node.compareTo(t.node);return 0===n?or(e.name,t.name):n}},{key:"isDefinedOn",value:function(e){return!0}},{key:"indexedValueChanged",value:function(e,t){return!e.equals(t)}},{key:"minPost",value:function(){return ci.MIN}},{key:"maxPost",value:function(){return ci.MAX}},{key:"makePost",value:function(e,t){var n=Fi(e);return new ci(t,n)}},{key:"toString",value:function(){return".value"}}]),r}(li),Vi=new qi;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function ji(e){return{type:"value",snapshotNode:e}}function Bi(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function Ki(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function zi(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Wi=function(){"use strict";function t(n){e(l)(this,t),this.index_=n}return e(h)(t,[{key:"updateChild",value:function(e,t,n,r,i,a){ue(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");var o=e.getImmediateChild(t);return o.getChild(r).equals(n.getChild(r))&&o.isEmpty()===n.isEmpty()?e:(null!=a&&(n.isEmpty()?e.hasChild(t)?a.trackChildChange(Ki(t,o)):ue(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):o.isEmpty()?a.trackChildChange(Bi(t,n)):a.trackChildChange(zi(t,n,o))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))}},{key:"updateFullNode",value:function(e,t,n){return null!=n&&(e.isLeafNode()||e.forEachChild(Ai,(function(e,r){t.hasChild(e)||n.trackChildChange(Ki(e,r))})),t.isLeafNode()||t.forEachChild(Ai,(function(t,r){if(e.hasChild(t)){var i=e.getImmediateChild(t);i.equals(r)||n.trackChildChange(zi(t,r,i))}else n.trackChildChange(Bi(t,r))}))),t.withIndex(this.index_)}},{key:"updatePriority",value:function(e,t){return e.isEmpty()?Mi.EMPTY_NODE:e.updatePriority(t)}},{key:"filtersNodes",value:function(){return!1}},{key:"getIndexedFilter",value:function(){return this}},{key:"getIndex",value:function(){return this.index_}}]),t}(),Gi=function(){"use strict";function t(n){e(l)(this,t),this.indexedFilter_=new Wi(n.getIndex()),this.index_=n.getIndex(),this.startPost_=t.getStartPost_(n),this.endPost_=t.getEndPost_(n),this.startIsInclusive_=!n.startAfterSet_,this.endIsInclusive_=!n.endBeforeSet_}return e(h)(t,[{key:"getStartPost",value:function(){return this.startPost_}},{key:"getEndPost",value:function(){return this.endPost_}},{key:"matches",value:function(e){var t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,n=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&n}},{key:"updateChild",value:function(e,t,n,r,i,a){return this.matches(new ci(t,n))||(n=Mi.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,r,i,a)}},{key:"updateFullNode",value:function(e,t,n){t.isLeafNode()&&(t=Mi.EMPTY_NODE);var r=t.withIndex(this.index_);r=r.updatePriority(Mi.EMPTY_NODE);var i=this;return t.forEachChild(Ai,(function(e,t){i.matches(new ci(e,t))||(r=r.updateImmediateChild(e,Mi.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(e,r,n)}},{key:"updatePriority",value:function(e,t){return e}},{key:"filtersNodes",value:function(){return!0}},{key:"getIndexedFilter",value:function(){return this.indexedFilter_}},{key:"getIndex",value:function(){return this.index_}}],[{key:"getStartPost_",value:function(e){if(e.hasStart()){var t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}},{key:"getEndPost_",value:function(e){if(e.hasEnd()){var t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}]),t}(),Hi=function(){"use strict";function t(n){var r=this;e(l)(this,t),this.withinDirectionalStart=function(e){return r.reverse_?r.withinEndPost(e):r.withinStartPost(e)},this.withinDirectionalEnd=function(e){return r.reverse_?r.withinStartPost(e):r.withinEndPost(e)},this.withinStartPost=function(e){var t=r.index_.compare(r.rangedFilter_.getStartPost(),e);return r.startIsInclusive_?t<=0:t<0},this.withinEndPost=function(e){var t=r.index_.compare(e,r.rangedFilter_.getEndPost());return r.endIsInclusive_?t<=0:t<0},this.rangedFilter_=new Gi(n),this.index_=n.getIndex(),this.limit_=n.getLimit(),this.reverse_=!n.isViewFromLeft(),this.startIsInclusive_=!n.startAfterSet_,this.endIsInclusive_=!n.endBeforeSet_}return e(h)(t,[{key:"updateChild",value:function(e,t,n,r,i,a){return this.rangedFilter_.matches(new ci(t,n))||(n=Mi.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,r,i,a):this.fullLimitUpdateChild_(e,t,n,i,a)}},{key:"updateFullNode",value:function(e,t,n){var r;if(t.isLeafNode()||t.isEmpty())r=Mi.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){var i;r=Mi.EMPTY_NODE.withIndex(this.index_),i=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var a=0;i.hasNext()&&a<this.limit_;){var o=i.getNext();if(this.withinDirectionalStart(o)){if(!this.withinDirectionalEnd(o))break;r=r.updateImmediateChild(o.name,o.node),a++}}}else{var s;r=(r=t.withIndex(this.index_)).updatePriority(Mi.EMPTY_NODE),s=this.reverse_?r.getReverseIterator(this.index_):r.getIterator(this.index_);for(var u=0;s.hasNext();){var c=s.getNext();u<this.limit_&&this.withinDirectionalStart(c)&&this.withinDirectionalEnd(c)?u++:r=r.updateImmediateChild(c.name,Mi.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,n)}},{key:"updatePriority",value:function(e,t){return e}},{key:"filtersNodes",value:function(){return!0}},{key:"getIndexedFilter",value:function(){return this.rangedFilter_.getIndexedFilter()}},{key:"getIndex",value:function(){return this.index_}},{key:"fullLimitUpdateChild_",value:function(e,t,n,r,i){var a;if(this.reverse_){var o=this.index_.getCompare();a=function(e,t){return o(t,e)}}else a=this.index_.getCompare();var s=e;ue(s.numChildren()===this.limit_,"");var u=new ci(t,n),c=this.reverse_?s.getFirstChild(this.index_):s.getLastChild(this.index_),l=this.rangedFilter_.matches(u);if(s.hasChild(t)){for(var h=s.getImmediateChild(t),f=r.getChildAfterChild(this.index_,c,this.reverse_);null!=f&&(f.name===t||s.hasChild(f.name));)f=r.getChildAfterChild(this.index_,f,this.reverse_);var d=null==f?1:a(f,u);if(l&&!n.isEmpty()&&d>=0)return null!=i&&i.trackChildChange(zi(t,n,h)),s.updateImmediateChild(t,n);null!=i&&i.trackChildChange(Ki(t,h));var p=s.updateImmediateChild(t,Mi.EMPTY_NODE);return null!=f&&this.rangedFilter_.matches(f)?(null!=i&&i.trackChildChange(Bi(f.name,f.node)),p.updateImmediateChild(f.name,f.node)):p}return n.isEmpty()?e:l&&a(c,u)>=0?(null!=i&&(i.trackChildChange(Ki(c.name,c.node)),i.trackChildChange(Bi(t,n))),s.updateImmediateChild(t,n).updateImmediateChild(c.name,Mi.EMPTY_NODE)):e}}]),t}(),Qi=function(){"use strict";function t(){e(l)(this,t),this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Ai}return e(h)(t,[{key:"hasStart",value:function(){return this.startSet_}},{key:"isViewFromLeft",value:function(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}},{key:"getIndexStartValue",value:function(){return ue(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}},{key:"getIndexStartName",value:function(){return ue(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:ir}},{key:"hasEnd",value:function(){return this.endSet_}},{key:"getIndexEndValue",value:function(){return ue(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}},{key:"getIndexEndName",value:function(){return ue(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:ar}},{key:"hasLimit",value:function(){return this.limitSet_}},{key:"hasAnchoredLimit",value:function(){return this.limitSet_&&""!==this.viewFrom_}},{key:"getLimit",value:function(){return ue(this.limitSet_,"Only valid if limit has been set"),this.limit_}},{key:"getIndex",value:function(){return this.index_}},{key:"loadsAllData",value:function(){return!(this.startSet_||this.endSet_||this.limitSet_)}},{key:"isDefault",value:function(){return this.loadsAllData()&&this.index_===Ai}},{key:"copy",value:function(){var e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}]),t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yi(e,t,n){var r=e.copy();return r.startSet_=!0,void 0===t&&(t=null),r.indexStartValue_=t,null!=n?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function Ji(e,t,n){var r=e.copy();return r.endSet_=!0,void 0===t&&(t=null),r.indexEndValue_=t,void 0!==n?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function Xi(e,t){var n=e.copy();return n.index_=t,n}function $i(e){var t,n={};if(e.isDefault())return n;if(e.index_===Ai?t="$priority":e.index_===Vi?t="$value":e.index_===fi?t="$key":(ue(e.index_ instanceof Ui,"Unrecognized index type!"),t=e.index_.toString()),n.orderBy=qe(t),e.startSet_){var r=e.startAfterSet_?"startAfter":"startAt";n[r]=qe(e.indexStartValue_),e.startNameSet_&&(n[r]+=","+qe(e.indexStartName_))}if(e.endSet_){var i=e.endBeforeSet_?"endBefore":"endAt";n[i]=qe(e.indexEndValue_),e.endNameSet_&&(n[i]+=","+qe(e.indexEndName_))}return e.limitSet_&&(e.isViewFromLeft()?n.limitToFirst=e.limit_:n.limitToLast=e.limit_),n}function Zi(e){var t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_),t.sin=!e.startAfterSet_),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_),t.ein=!e.endBeforeSet_),e.limitSet_){t.l=e.limit_;var n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==Ai&&(t.i=e.index_.toString()),t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ea=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i,a,o){var s;return e(l)(this,r),(s=n.call(this)).repoInfo_=t,s.onDataUpdate_=i,s.authTokenProvider_=a,s.appCheckTokenProvider_=o,s.log_=Zn("p:rest:"),s.listens_={},s}return e(h)(r,[{key:"reportStats",value:function(e){throw new Error("Method not implemented.")}},{key:"listen",value:function(e,t,n,i){var a=this,o=e._path.toString();this.log_("Listen called for "+o+" "+e._queryIdentifier);var s=r.getListenId_(e,n),u={};this.listens_[s]=u;var c=$i(e._queryParams);this.restRequest_(o+".json",c,(function(e,t){var r=t;(404===e&&(r=null,e=null),null===e&&a.onDataUpdate_(o,r,!1,n),Ke(a.listens_,s)===u)&&i(e?401===e?"permission_denied":"rest_error:"+e:"ok",null)}))}},{key:"unlisten",value:function(e,t){var n=r.getListenId_(e,t);delete this.listens_[n]}},{key:"get",value:function(e){var t=this,n=$i(e._queryParams),r=e._path.toString(),i=new De;return this.restRequest_(r+".json",n,(function(e,n){var a=n;404===e&&(a=null,e=null),null===e?(t.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))})),i.promise}},{key:"refreshAuthToken",value:function(e){}},{key:"restRequest_",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,i=this;return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((function(a){var o=e(b)(a,2),s=o[0],u=o[1],c=i;s&&s.accessToken&&(n.auth=s.accessToken),u&&u.token&&(n.ac=u.token);var l=(i.repoInfo_.secure?"https://":"http://")+i.repoInfo_.host+t+"?ns="+i.repoInfo_.namespace+Qe(n);i.log_("Sending REST request for "+l);var h=new XMLHttpRequest;h.onreadystatechange=function(){if(r&&4===h.readyState){c.log_("REST Response for "+l+" received. status:",h.status,"response:",h.responseText);var e=null;if(h.status>=200&&h.status<300){try{e=Ue(h.responseText)}catch(e){nr("Failed to parse JSON response for "+l+": "+h.responseText)}r(null,e)}else 401!==h.status&&404!==h.status&&nr("Got unsuccessful REST response for "+l+" Status: "+h.status),r(h.status);r=null}},h.open("GET",l,!0),h.send()}))}}],[{key:"getListenId_",value:function(e,t){return void 0!==t?"tag$"+t:(ue(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}}]),r}(qr),ta=function(){"use strict";function t(){e(l)(this,t),this.rootNode_=Mi.EMPTY_NODE}return e(h)(t,[{key:"getNode",value:function(e){return this.rootNode_.getChild(e)}},{key:"updateSnapshot",value:function(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}]),t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function na(){return{value:null,children:new Map}}function ra(e,t,n){if(Xr(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{var r=zr(t);e.children.has(r)||e.children.set(r,na()),ra(e.children.get(r),t=Gr(t),n)}}function ia(e,t){if(Xr(t))return e.value=null,e.children.clear(),!0;if(null!==e.value){if(e.value.isLeafNode())return!1;var n=e.value;return e.value=null,n.forEachChild(Ai,(function(t,n){ra(e,new Br(t),n)})),ia(e,t)}if(e.children.size>0){var r=zr(t);if(t=Gr(t),e.children.has(r))ia(e.children.get(r),t)&&e.children.delete(r);return 0===e.children.size}return!0}function aa(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach((function(e,n){t(n,e)}))}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e,(function(e,r){aa(r,new Br(t.toString()+"/"+e),n)}))}var oa,sa,ua=function(){"use strict";function t(n){e(l)(this,t),this.collection_=n,this.last_=null}return e(h)(t,[{key:"get",value:function(){var e=this.collection_.get(),t=Object.assign({},e);return this.last_&&hr(this.last_,(function(e,n){t[e]=t[e]-n})),this.last_=e,t}}]),t}(),ca=function(){"use strict";function t(n,r){e(l)(this,t),this.server_=r,this.statsToReport_={},this.statsListener_=new ua(n);var i=1e4+2e4*Math.random();yr(this.reportStats_.bind(this),Math.floor(i))}return e(h)(t,[{key:"reportStats_",value:function(){var e=this,t=this.statsListener_.get(),n={},r=!1;hr(t,(function(t,i){i>0&&Be(e.statsToReport_,t)&&(n[t]=i,r=!0)})),r&&this.server_.reportStats(n),yr(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}]),t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function la(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(sa=oa||(oa={}))[sa.OVERWRITE=0]="OVERWRITE",sa[sa.MERGE=1]="MERGE",sa[sa.ACK_USER_WRITE=2]="ACK_USER_WRITE",sa[sa.LISTEN_COMPLETE=3]="LISTEN_COMPLETE";var ha,fa=function(){"use strict";function t(n,r,i){e(l)(this,t),this.path=n,this.affectedTree=r,this.revert=i,this.type=oa.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}return e(h)(t,[{key:"operationForChild",value:function(e){if(Xr(this.path)){if(null!=this.affectedTree.value)return ue(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new Br(e));return new t(Kr(),n,this.revert)}return ue(zr(this.path)===e,"operationForChild called for unrelated child."),new t(Gr(this.path),this.affectedTree,this.revert)}}]),t}(),da=function(){"use strict";function t(n,r){e(l)(this,t),this.source=n,this.path=r,this.type=oa.LISTEN_COMPLETE}return e(h)(t,[{key:"operationForChild",value:function(e){return Xr(this.path)?new t(this.source,Kr()):new t(this.source,Gr(this.path))}}]),t}(),pa=function(){"use strict";function t(n,r,i){e(l)(this,t),this.source=n,this.path=r,this.snap=i,this.type=oa.OVERWRITE}return e(h)(t,[{key:"operationForChild",value:function(e){return Xr(this.path)?new t(this.source,Kr(),this.snap.getImmediateChild(e)):new t(this.source,Gr(this.path),this.snap)}}]),t}(),va=function(){"use strict";function t(n,r,i){e(l)(this,t),this.source=n,this.path=r,this.children=i,this.type=oa.MERGE}return e(h)(t,[{key:"operationForChild",value:function(e){if(Xr(this.path)){var n=this.children.subtree(new Br(e));return n.isEmpty()?null:n.value?new pa(this.source,Kr(),n.value):new t(this.source,Kr(),n)}return ue(zr(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,Gr(this.path),this.children)}},{key:"toString",value:function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}]),t}(),ya=function(){"use strict";function t(n,r,i){e(l)(this,t),this.node_=n,this.fullyInitialized_=r,this.filtered_=i}return e(h)(t,[{key:"isFullyInitialized",value:function(){return this.fullyInitialized_}},{key:"isFiltered",value:function(){return this.filtered_}},{key:"isCompleteForPath",value:function(e){if(Xr(e))return this.isFullyInitialized()&&!this.filtered_;var t=zr(e);return this.isCompleteForChild(t)}},{key:"isCompleteForChild",value:function(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}},{key:"getNode",value:function(){return this.node_}}]),t}(),ma=function t(n){"use strict";e(l)(this,t),this.query_=n,this.index_=this.query_._queryParams.getIndex()};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ga(e,t,n,r,i,a){var o=r.filter((function(e){return e.type===n}));o.sort((function(t,n){return function(e,t,n){if(null==t.childName||null==n.childName)throw ce("Should only compare child_ events.");var r=new ci(t.childName,t.snapshotNode),i=new ci(n.childName,n.snapshotNode);return e.index_.compare(r,i)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e,t,n)})),o.forEach((function(n){var r=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,n,a);i.forEach((function(i){i.respondsTo(n.type)&&t.push(i.createEvent(r,e.query_))}))}))}function ka(e,t){return{eventCache:e,serverCache:t}}function _a(e,t,n,r){return ka(new ya(t,n,r),e.serverCache)}function wa(e,t,n,r){return ka(e.eventCache,new ya(t,n,r))}function ba(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function xa(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ia=function(){return ha||(ha=new mi(sr)),ha},Ta=function(){"use strict";function t(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ia();e(l)(this,t),this.value=n,this.children=r}return e(h)(t,[{key:"isEmpty",value:function(){return null===this.value&&this.children.isEmpty()}},{key:"findRootMostMatchingPathAndValue",value:function(e,t){if(null!=this.value&&t(this.value))return{path:Kr(),value:this.value};if(Xr(e))return null;var n=zr(e),r=this.children.get(n);if(null!==r){var i=r.findRootMostMatchingPathAndValue(Gr(e),t);return null!=i?{path:Jr(new Br(n),i.path),value:i.value}:null}return null}},{key:"findRootMostValueAndPath",value:function(e){return this.findRootMostMatchingPathAndValue(e,(function(){return!0}))}},{key:"subtree",value:function(e){if(Xr(e))return this;var n=zr(e),r=this.children.get(n);return null!==r?r.subtree(Gr(e)):new t(null)}},{key:"set",value:function(e,n){if(Xr(e))return new t(n,this.children);var r=zr(e),i=(this.children.get(r)||new t(null)).set(Gr(e),n),a=this.children.insert(r,i);return new t(this.value,a)}},{key:"remove",value:function(e){if(Xr(e))return this.children.isEmpty()?new t(null):new t(null,this.children);var n=zr(e),r=this.children.get(n);if(r){var i,a=r.remove(Gr(e));return i=a.isEmpty()?this.children.remove(n):this.children.insert(n,a),null===this.value&&i.isEmpty()?new t(null):new t(this.value,i)}return this}},{key:"get",value:function(e){if(Xr(e))return this.value;var t=zr(e),n=this.children.get(t);return n?n.get(Gr(e)):null}},{key:"setTree",value:function(e,n){if(Xr(e))return n;var r,i=zr(e),a=(this.children.get(i)||new t(null)).setTree(Gr(e),n);return r=a.isEmpty()?this.children.remove(i):this.children.insert(i,a),new t(this.value,r)}},{key:"fold",value:function(e){return this.fold_(Kr(),e)}},{key:"fold_",value:function(e,t){var n={};return this.children.inorderTraversal((function(r,i){n[r]=i.fold_(Jr(e,r),t)})),t(e,this.value,n)}},{key:"findOnPath",value:function(e,t){return this.findOnPath_(e,Kr(),t)}},{key:"findOnPath_",value:function(e,t,n){var r=!!this.value&&n(t,this.value);if(r)return r;if(Xr(e))return null;var i=zr(e),a=this.children.get(i);return a?a.findOnPath_(Gr(e),Jr(t,i),n):null}},{key:"foreachOnPath",value:function(e,t){return this.foreachOnPath_(e,Kr(),t)}},{key:"foreachOnPath_",value:function(e,n,r){if(Xr(e))return this;this.value&&r(n,this.value);var i=zr(e),a=this.children.get(i);return a?a.foreachOnPath_(Gr(e),Jr(n,i),r):new t(null)}},{key:"foreach",value:function(e){this.foreach_(Kr(),e)}},{key:"foreach_",value:function(e,t){this.children.inorderTraversal((function(n,r){r.foreach_(Jr(e,n),t)})),this.value&&t(e,this.value)}},{key:"foreachChild",value:function(e){this.children.inorderTraversal((function(t,n){n.value&&e(t,n.value)}))}}],[{key:"fromObject",value:function(e){var n=new t(null);return hr(e,(function(e,t){n=n.set(new Br(e),t)})),n}}]),t}(),Ea=function(){"use strict";function t(n){e(l)(this,t),this.writeTree_=n}return e(h)(t,null,[{key:"empty",value:function(){return new t(new Ta(null))}}]),t}();function Sa(e,t,n){if(Xr(t))return new Ea(new Ta(n));var r=e.writeTree_.findRootMostValueAndPath(t);if(null!=r){var i=r.path,a=r.value,o=$r(i,t);return a=a.updateChild(o,n),new Ea(e.writeTree_.set(i,a))}var s=new Ta(n),u=e.writeTree_.setTree(t,s);return new Ea(u)}function Ca(e,t,n){var r=e;return hr(n,(function(e,n){r=Sa(r,Jr(t,e),n)})),r}function Aa(e,t){if(Xr(t))return Ea.empty();var n=e.writeTree_.setTree(t,new Ta(null));return new Ea(n)}function Na(e,t){return null!=Ra(e,t)}function Ra(e,t){var n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild($r(n.path,t)):null}function Da(e){var t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(Ai,(function(e,n){t.push(new ci(e,n))})):e.writeTree_.children.inorderTraversal((function(e,n){null!=n.value&&t.push(new ci(e,n.value))})),t}function Pa(e,t){if(Xr(t))return e;var n=Ra(e,t);return new Ea(null!=n?new Ta(n):e.writeTree_.subtree(t))}function Oa(e){return e.writeTree_.isEmpty()}function Ma(e,t){return La(Kr(),e.writeTree_,t)}function La(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);var r=null;return t.children.inorderTraversal((function(t,i){".priority"===t?(ue(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=La(Jr(e,t),i,n)})),n.getChild(e).isEmpty()||null===r||(n=n.updateChild(Jr(e,".priority"),r)),n}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fa(e,t){return Xa(t,e)}function Ua(e,t){for(var n=0;n<e.allWrites.length;n++){var r=e.allWrites[n];if(r.writeId===t)return r}return null}function qa(e,t){var n=e.allWrites.findIndex((function(e){return e.writeId===t}));ue(n>=0,"removeWrite called with nonexistent writeId.");var r=e.allWrites[n];e.allWrites.splice(n,1);for(var i=r.visible,a=!1,o=e.allWrites.length-1;i&&o>=0;){var s=e.allWrites[o];s.visible&&(o>=n&&Va(s,r.path)?i=!1:ti(r.path,s.path)&&(a=!0)),o--}if(i){if(a)return function(e){e.visibleWrites=Ba(e.allWrites,ja,Kr()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}(e),!0;r.snap?e.visibleWrites=Aa(e.visibleWrites,r.path):hr(r.children,(function(t){e.visibleWrites=Aa(e.visibleWrites,Jr(r.path,t))}));return!0}return!1}function Va(e,t){if(e.snap)return ti(e.path,t);for(var n in e.children)if(e.children.hasOwnProperty(n)&&ti(Jr(e.path,n),t))return!0;return!1}function ja(e){return e.visible}function Ba(e,t,n){for(var r=Ea.empty(),i=0;i<e.length;++i){var a=e[i];if(t(a)){var o=a.path,s=void 0;if(a.snap)ti(n,o)?r=Sa(r,s=$r(n,o),a.snap):ti(o,n)&&(s=$r(o,n),r=Sa(r,Kr(),a.snap.getChild(s)));else{if(!a.children)throw ce("WriteRecord should have .snap or .children");if(ti(n,o))r=Ca(r,s=$r(n,o),a.children);else if(ti(o,n))if(Xr(s=$r(o,n)))r=Ca(r,Kr(),a.children);else{var u=Ke(a.children,zr(s));if(u){var c=u.getChild(Gr(s));r=Sa(r,Kr(),c)}}}}}return r}function Ka(e,t,n,r,i){if(r||i){var a=Pa(e.visibleWrites,t);if(!i&&Oa(a))return n;if(i||null!=n||Na(a,Kr())){return Ma(Ba(e.allWrites,(function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&(ti(e.path,t)||ti(t,e.path))}),t),n||Mi.EMPTY_NODE)}return null}var o=Ra(e.visibleWrites,t);if(null!=o)return o;var s=Pa(e.visibleWrites,t);return Oa(s)?n:null!=n||Na(s,Kr())?Ma(s,n||Mi.EMPTY_NODE):null}function za(e,t,n,r){return Ka(e.writeTree,e.treePath,t,n,r)}function Wa(e,t){return function(e,t,n){var r=Mi.EMPTY_NODE,i=Ra(e.visibleWrites,t);if(i)return i.isLeafNode()||i.forEachChild(Ai,(function(e,t){r=r.updateImmediateChild(e,t)})),r;if(n){var a=Pa(e.visibleWrites,t);return n.forEachChild(Ai,(function(e,t){var n=Ma(Pa(a,new Br(e)),t);r=r.updateImmediateChild(e,n)})),Da(a).forEach((function(e){r=r.updateImmediateChild(e.name,e.node)})),r}return Da(Pa(e.visibleWrites,t)).forEach((function(e){r=r.updateImmediateChild(e.name,e.node)})),r}(e.writeTree,e.treePath,t)}function Ga(e,t,n,r){return function(e,t,n,r,i){ue(r||i,"Either existingEventSnap or existingServerSnap must exist");var a=Jr(t,n);if(Na(e.visibleWrites,a))return null;var o=Pa(e.visibleWrites,a);return Oa(o)?i.getChild(n):Ma(o,i.getChild(n))}(e.writeTree,e.treePath,t,n,r)}function Ha(e,t){return function(e,t){return Ra(e.visibleWrites,t)}(e.writeTree,Jr(e.treePath,t))}function Qa(e,t,n,r,i,a){return function(e,t,n,r,i,a,o){var s,u=Pa(e.visibleWrites,t),c=Ra(u,Kr());if(null!=c)s=c;else{if(null==n)return[];s=Ma(u,n)}if((s=s.withIndex(o)).isEmpty()||s.isLeafNode())return[];for(var l=[],h=o.getCompare(),f=a?s.getReverseIteratorFrom(r,o):s.getIteratorFrom(r,o),d=f.getNext();d&&l.length<i;)0!==h(d,r)&&l.push(d),d=f.getNext();return l}(e.writeTree,e.treePath,t,n,r,i,a)}function Ya(e,t,n){return function(e,t,n,r){var i=Jr(t,n),a=Ra(e.visibleWrites,i);return null!=a?a:r.isCompleteForChild(n)?Ma(Pa(e.visibleWrites,i),r.getNode().getImmediateChild(n)):null}(e.writeTree,e.treePath,t,n)}function Ja(e,t){return Xa(Jr(e.treePath,t),e.writeTree)}function Xa(e,t){return{treePath:e,writeTree:t}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $a=function(){"use strict";function t(){e(l)(this,t),this.changeMap=new Map}return e(h)(t,[{key:"trackChildChange",value:function(e){var t=e.type,n=e.childName;ue("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),ue(".priority"!==n,"Only non-priority child changes can be tracked.");var r=this.changeMap.get(n);if(r){var i=r.type;if("child_added"===t&&"child_removed"===i)this.changeMap.set(n,zi(n,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===i)this.changeMap.set(n,Ki(n,r.oldSnap));else if("child_changed"===t&&"child_added"===i)this.changeMap.set(n,Bi(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==i)throw ce("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(n,zi(n,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,e)}},{key:"getChanges",value:function(){return Array.from(this.changeMap.values())}}]),t}(),Za=new(function(){"use strict";function t(){e(l)(this,t)}return e(h)(t,[{key:"getCompleteChild",value:function(e){return null}},{key:"getChildAfterChild",value:function(e,t,n){return null}}]),t}()),eo=function(){"use strict";function t(n,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e(l)(this,t),this.writes_=n,this.viewCache_=r,this.optCompleteServerCache_=i}return e(h)(t,[{key:"getCompleteChild",value:function(e){var t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);var n=null!=this.optCompleteServerCache_?new ya(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Ya(this.writes_,e,n)}},{key:"getChildAfterChild",value:function(e,t,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:xa(this.viewCache_),i=Qa(this.writes_,r,t,1,n,e);return 0===i.length?null:i[0]}}]),t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function to(e,t,n,r,i){var a,o,s=new $a;if(n.type===oa.OVERWRITE){var u=n;u.source.fromUser?a=io(e,t,u.path,u.snap,r,i,s):(ue(u.source.fromServer,"Unknown source."),o=u.source.tagged||t.serverCache.isFiltered()&&!Xr(u.path),a=ro(e,t,u.path,u.snap,r,i,o,s))}else if(n.type===oa.MERGE){var c=n;c.source.fromUser?a=function(e,t,n,r,i,a,o){var s=t;return r.foreach((function(r,u){var c=Jr(n,r);ao(t,zr(c))&&(s=io(e,s,c,u,i,a,o))})),r.foreach((function(r,u){var c=Jr(n,r);ao(t,zr(c))||(s=io(e,s,c,u,i,a,o))})),s}(e,t,c.path,c.children,r,i,s):(ue(c.source.fromServer,"Unknown source."),o=c.source.tagged||t.serverCache.isFiltered(),a=so(e,t,c.path,c.children,r,i,o,s))}else if(n.type===oa.ACK_USER_WRITE){var l=n;a=l.revert?function(e,t,n,r,i,a){var o;if(null!=Ha(r,n))return t;var s,u=new eo(r,t,i),c=t.eventCache.getNode();if(Xr(n)||".priority"===zr(n)){var l;if(t.serverCache.isFullyInitialized())l=za(r,xa(t));else{var h=t.serverCache.getNode();ue(h instanceof Mi,"serverChildren would be complete if leaf node"),l=Wa(r,h)}s=e.filter.updateFullNode(c,l,a)}else{var f=zr(n),d=Ya(r,f,t.serverCache);null==d&&t.serverCache.isCompleteForChild(f)&&(d=c.getImmediateChild(f)),(s=null!=d?e.filter.updateChild(c,f,d,Gr(n),u,a):t.eventCache.getNode().hasChild(f)?e.filter.updateChild(c,f,Mi.EMPTY_NODE,Gr(n),u,a):c).isEmpty()&&t.serverCache.isFullyInitialized()&&(o=za(r,xa(t))).isLeafNode()&&(s=e.filter.updateFullNode(s,o,a))}return o=t.serverCache.isFullyInitialized()||null!=Ha(r,Kr()),_a(t,s,o,e.filter.filtersNodes())}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e,t,l.path,r,i,s):function(e,t,n,r,i,a,o){if(null!=Ha(i,n))return t;var s=t.serverCache.isFiltered(),u=t.serverCache;if(null!=r.value){if(Xr(n)&&u.isFullyInitialized()||u.isCompleteForPath(n))return ro(e,t,n,u.getNode().getChild(n),i,a,s,o);if(Xr(n)){var c=new Ta(null);return u.getNode().forEachChild(fi,(function(e,t){c=c.set(new Br(e),t)})),so(e,t,n,c,i,a,s,o)}return t}var l=new Ta(null);return r.foreach((function(e,t){var r=Jr(n,e);u.isCompleteForPath(r)&&(l=l.set(e,u.getNode().getChild(r)))})),so(e,t,n,l,i,a,s,o)}(e,t,l.path,l.affectedTree,r,i,s)}else{if(n.type!==oa.LISTEN_COMPLETE)throw ce("Unknown operation type: "+n.type);a=function(e,t,n,r,i){var a=t.serverCache,o=wa(t,a.getNode(),a.isFullyInitialized()||Xr(n),a.isFiltered());return no(e,o,n,r,Za,i)}(e,t,n.path,r,s)}var h=s.getChanges();return function(e,t,n){var r=t.eventCache;if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),a=ba(e);(n.length>0||!e.eventCache.isFullyInitialized()||i&&!r.getNode().equals(a)||!r.getNode().getPriority().equals(a.getPriority()))&&n.push(ji(ba(t)))}}(t,a,h),{viewCache:a,changes:h}}function no(e,t,n,r,i,a){var o,s,u=t.eventCache;if(null!=Ha(r,n))return t;if(Xr(n))if(ue(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){var c=xa(t),l=Wa(r,c instanceof Mi?c:Mi.EMPTY_NODE);o=e.filter.updateFullNode(t.eventCache.getNode(),l,a)}else{var h=za(r,xa(t));o=e.filter.updateFullNode(t.eventCache.getNode(),h,a)}else{var f=zr(n);if(".priority"===f){ue(1===Wr(n),"Can't have a priority with additional path components");var d=u.getNode(),p=Ga(r,n,d,s=t.serverCache.getNode());o=null!=p?e.filter.updatePriority(d,p):u.getNode()}else{var v,y=Gr(n);if(u.isCompleteForChild(f)){s=t.serverCache.getNode();var m=Ga(r,n,u.getNode(),s);v=null!=m?u.getNode().getImmediateChild(f).updateChild(y,m):u.getNode().getImmediateChild(f)}else v=Ya(r,f,t.serverCache);o=null!=v?e.filter.updateChild(u.getNode(),f,v,y,i,a):u.getNode()}}return _a(t,o,u.isFullyInitialized()||Xr(n),e.filter.filtersNodes())}function ro(e,t,n,r,i,a,o,s){var u,c=t.serverCache,l=o?e.filter:e.filter.getIndexedFilter();if(Xr(n))u=l.updateFullNode(c.getNode(),r,null);else if(l.filtersNodes()&&!c.isFiltered()){var h=c.getNode().updateChild(n,r);u=l.updateFullNode(c.getNode(),h,null)}else{var f=zr(n);if(!c.isCompleteForPath(n)&&Wr(n)>1)return t;var d=Gr(n),p=c.getNode().getImmediateChild(f).updateChild(d,r);u=".priority"===f?l.updatePriority(c.getNode(),p):l.updateChild(c.getNode(),f,p,d,Za,null)}var v=wa(t,u,c.isFullyInitialized()||Xr(n),l.filtersNodes());return no(e,v,n,i,new eo(i,v,a),s)}function io(e,t,n,r,i,a,o){var s,u,c=t.eventCache,l=new eo(i,t,a);if(Xr(n))u=e.filter.updateFullNode(t.eventCache.getNode(),r,o),s=_a(t,u,!0,e.filter.filtersNodes());else{var h=zr(n);if(".priority"===h)u=e.filter.updatePriority(t.eventCache.getNode(),r),s=_a(t,u,c.isFullyInitialized(),c.isFiltered());else{var f,d=Gr(n),p=c.getNode().getImmediateChild(h);if(Xr(d))f=r;else{var v=l.getCompleteChild(h);f=null!=v?".priority"===Hr(d)&&v.getChild(Yr(d)).isEmpty()?v:v.updateChild(d,r):Mi.EMPTY_NODE}if(p.equals(f))s=t;else s=_a(t,e.filter.updateChild(c.getNode(),h,f,d,l,o),c.isFullyInitialized(),e.filter.filtersNodes())}}return s}function ao(e,t){return e.eventCache.isCompleteForChild(t)}function oo(e,t,n){return n.foreach((function(e,n){t=t.updateChild(e,n)})),t}function so(e,t,n,r,i,a,o,s){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;var u,c=t;u=Xr(n)?r:new Ta(null).setTree(n,r);var l=t.serverCache.getNode();return u.children.inorderTraversal((function(n,r){if(l.hasChild(n)){var u=oo(0,t.serverCache.getNode().getImmediateChild(n),r);c=ro(e,c,new Br(n),u,i,a,o,s)}})),u.children.inorderTraversal((function(n,r){var u=!t.serverCache.isCompleteForChild(n)&&null===r.value;if(!l.hasChild(n)&&!u){var h=oo(0,t.serverCache.getNode().getImmediateChild(n),r);c=ro(e,c,new Br(n),h,i,a,o,s)}})),c}var uo,co=function(){"use strict";function t(n,r){e(l)(this,t),this.query_=n,this.eventRegistrations_=[];var i,a=this.query_._queryParams,o=new Wi(a.getIndex()),s=(i=a).loadsAllData()?new Wi(i.getIndex()):i.hasLimit()?new Hi(i):new Gi(i);this.processor_=
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(e){return{filter:e}}(s);var u=r.serverCache,c=r.eventCache,h=o.updateFullNode(Mi.EMPTY_NODE,u.getNode(),null),f=s.updateFullNode(Mi.EMPTY_NODE,c.getNode(),null),d=new ya(h,u.isFullyInitialized(),o.filtersNodes()),p=new ya(f,c.isFullyInitialized(),s.filtersNodes());this.viewCache_=ka(p,d),this.eventGenerator_=new ma(this.query_)}return e(h)(t,[{key:"query",get:function(){return this.query_}}]),t}();function lo(e,t){var n=xa(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!Xr(t)&&!n.getImmediateChild(zr(t)).isEmpty())?n.getChild(t):null}function ho(e){return 0===e.eventRegistrations_.length}function fo(e,t,n){var r=[];if(n){ue(null==t,"A cancel should cancel all event registrations.");var i=e.query._path;e.eventRegistrations_.forEach((function(e){var t=e.createCancelEvent(n,i);t&&r.push(t)}))}if(t){for(var a=[],o=0;o<e.eventRegistrations_.length;++o){var s=e.eventRegistrations_[o];if(s.matches(t)){if(t.hasAnyCallback()){a=a.concat(e.eventRegistrations_.slice(o+1));break}}else a.push(s)}e.eventRegistrations_=a}else e.eventRegistrations_=[];return r}function po(e,t,n,r){t.type===oa.MERGE&&null!==t.source.queryId&&(ue(xa(e.viewCache_),"We should always have a full cache before handling merges"),ue(ba(e.viewCache_),"Missing event cache, even though we have a server cache"));var i,a,o=e.viewCache_,s=to(e.processor_,o,t,n,r);return i=e.processor_,a=s.viewCache,ue(a.eventCache.getNode().isIndexed(i.filter.getIndex()),"Event snap not indexed"),ue(a.serverCache.getNode().isIndexed(i.filter.getIndex()),"Server snap not indexed"),ue(s.viewCache.serverCache.isFullyInitialized()||!o.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=s.viewCache,vo(e,s.changes,s.viewCache.eventCache.getNode(),null)}function vo(e,t,n,r){var i=r?[r]:e.eventRegistrations_;return function(e,t,n,r){var i=[],a=[];return t.forEach((function(t){var n;"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&a.push((n=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:n}))})),ga(e,i,"child_removed",t,r,n),ga(e,i,"child_added",t,r,n),ga(e,i,"child_moved",a,r,n),ga(e,i,"child_changed",t,r,n),ga(e,i,"value",t,r,n),i}(e.eventGenerator_,t,n,i)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var yo,mo=function t(){"use strict";e(l)(this,t),this.views=new Map};function go(e){return 0===e.views.size}function ko(e,t,n,r){var i=t.source.queryId;if(null!==i){var a=e.views.get(i);return ue(null!=a,"SyncTree gave us an op for an invalid query."),po(a,t,n,r)}var o=[],s=!0,u=!1,c=void 0;try{for(var l,h=e.views.values()[Symbol.iterator]();!(s=(l=h.next()).done);s=!0){var f=l.value;o=o.concat(po(f,t,n,r))}}catch(e){u=!0,c=e}finally{try{s||null==h.return||h.return()}finally{if(u)throw c}}return o}function _o(e,t,n,r,i){var a=t._queryIdentifier,o=e.views.get(a);if(!o){var s=za(n,i?r:null),u=!1;s?u=!0:r instanceof Mi?(s=Wa(n,r),u=!1):(s=Mi.EMPTY_NODE,u=!1);var c=ka(new ya(s,u,!1),new ya(r,i,!1));return new co(t,c)}return o}function wo(e,t,n,r,i,a){var o=_o(e,t,r,i,a);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,o),function(e,t){e.eventRegistrations_.push(t)}(o,n),function(e,t){var n=e.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Ai,(function(e,t){r.push(Bi(e,t))})),n.isFullyInitialized()&&r.push(ji(n.getNode())),vo(e,r,n.getNode(),t)}(o,n)}function bo(t,n,r,i){var a=n._queryIdentifier,o=[],s=[],u=So(t),c=!0,l=!1,h=void 0;if("default"===a)try{for(var f,d=t.views.entries()[Symbol.iterator]();!(c=(f=d.next()).done);c=!0){var p=e(b)(f.value,2),v=p[0],y=p[1];s=s.concat(fo(y,r,i)),ho(y)&&(t.views.delete(v),y.query._queryParams.loadsAllData()||o.push(y.query))}}catch(e){l=!0,h=e}finally{try{c||null==d.return||d.return()}finally{if(l)throw h}}else{var m=t.views.get(a);m&&(s=s.concat(fo(m,r,i)),ho(m)&&(t.views.delete(a),m.query._queryParams.loadsAllData()||o.push(m.query)))}return u&&!So(t)&&o.push(new(ue(uo,"Reference.ts has not been loaded"),uo)(n._repo,n._path)),{removed:o,events:s}}function xo(e){var t=[],n=!0,r=!1,i=void 0;try{for(var a,o=e.views.values()[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;s.query._queryParams.loadsAllData()||t.push(s)}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return t}function Io(e,t){var n=null,r=!0,i=!1,a=void 0;try{for(var o,s=e.views.values()[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;n=n||lo(u,t)}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}function To(e,t){if(t._queryParams.loadsAllData())return Co(e);var n=t._queryIdentifier;return e.views.get(n)}function Eo(e,t){return null!=To(e,t)}function So(e){return null!=Co(e)}function Co(e){var t=!0,n=!1,r=void 0;try{for(var i,a=e.views.values()[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;if(o.query._queryParams.loadsAllData())return o}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return null}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ao=1,No=function t(n){"use strict";e(l)(this,t),this.listenProvider_=n,this.syncPointTree_=new Ta(null),this.pendingWriteTree_={visibleWrites:Ea.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map};function Ro(e,t,n,r,i){return function(e,t,n,r,i){ue(r>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),e.allWrites.push({path:t,snap:n,writeId:r,visible:i}),i&&(e.visibleWrites=Sa(e.visibleWrites,t,n)),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r,i),i?Vo(e,new pa({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,n)):[]}function Do(e,t,n,r){!function(e,t,n,r){ue(r>e.lastWriteId,"Stacking an older merge on top of newer ones"),e.allWrites.push({path:t,children:n,writeId:r,visible:!0}),e.visibleWrites=Ca(e.visibleWrites,t,n),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r);var i=Ta.fromObject(n);return Vo(e,new va({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,i))}function Po(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=Ua(e.pendingWriteTree_,t),i=qa(e.pendingWriteTree_,t);if(i){var a=new Ta(null);return null!=r.snap?a=a.set(Kr(),!0):hr(r.children,(function(e){a=a.set(new Br(e),!0)})),Vo(e,new fa(r.path,a,n))}return[]}function Oo(e,t,n){return Vo(e,new pa({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function Mo(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=t._path,o=e.syncPointTree_.get(a),s=[];if(o&&("default"===t._queryIdentifier||Eo(o,t))){var u=bo(o,t,n,r);go(o)&&(e.syncPointTree_=e.syncPointTree_.remove(a));var c=u.removed;if(s=u.events,!i){var l=-1!==c.findIndex((function(e){return e._queryParams.loadsAllData()})),h=e.syncPointTree_.findOnPath(a,(function(e,t){return So(t)}));if(l&&!h){var f=e.syncPointTree_.subtree(a);if(!f.isEmpty())for(var d=Yo(f),p=0;p<d.length;++p){var v=d[p],y=v.query,m=Ko(e,v);e.listenProvider_.startListening(Jo(y),zo(e,y),m.hashFn,m.onComplete)}}if(!h&&c.length>0&&!r)if(l){var g=null;e.listenProvider_.stopListening(Jo(t),g)}else c.forEach((function(t){var n=e.queryToTagMap.get(Wo(t));e.listenProvider_.stopListening(Jo(t),n)}))}Xo(e,c)}return s}function Lo(e,t,n,r){var i=Go(e,r);if(null!=i){var a=Ho(i),o=a.path,s=a.queryId,u=$r(o,t);return Qo(e,o,new pa(la(s),u,n))}return[]}function Fo(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=t._path,a=null,o=!1;e.syncPointTree_.foreachOnPath(i,(function(e,t){var n=$r(e,i);a=a||Io(t,n),o=o||So(t)}));var s,u=e.syncPointTree_.get(i);if(u?(o=o||So(u),a=a||Io(u,Kr())):(u=new mo,e.syncPointTree_=e.syncPointTree_.set(i,u)),null!=a)s=!0;else{s=!1,a=Mi.EMPTY_NODE;var c=e.syncPointTree_.subtree(i);c.foreachChild((function(e,t){var n=Io(t,Kr());n&&(a=a.updateImmediateChild(e,n))}))}var l=Eo(u,t);if(!l&&!t._queryParams.loadsAllData()){var h=Wo(t);ue(!e.queryToTagMap.has(h),"View does not exist, but we have a tag");var f=$o();e.queryToTagMap.set(h,f),e.tagToQueryMap.set(f,h)}var d=Fa(e.pendingWriteTree_,i),p=wo(u,t,n,d,a,s);if(!l&&!o&&!r){var v=To(u,t);p=p.concat(Zo(e,t,v))}return p}function Uo(e,t,n){var r=e.pendingWriteTree_,i=e.syncPointTree_.findOnPath(t,(function(e,n){var r=Io(n,$r(e,t));if(r)return r}));return Ka(r,t,i,n,!0)}function qo(e,t){var n=t._path,r=null;e.syncPointTree_.foreachOnPath(n,(function(e,t){var i=$r(e,n);r=r||Io(t,i)}));var i=e.syncPointTree_.get(n);i?r=r||Io(i,Kr()):(i=new mo,e.syncPointTree_=e.syncPointTree_.set(n,i));var a=null!=r,o=a?new ya(r,!0,!1):null;return function(e){return ba(e.viewCache_)}(_o(i,t,Fa(e.pendingWriteTree_,t._path),a?o.getNode():Mi.EMPTY_NODE,a))}function Vo(e,t){return jo(t,e.syncPointTree_,null,Fa(e.pendingWriteTree_,Kr()))}function jo(e,t,n,r){if(Xr(e.path))return Bo(e,t,n,r);var i=t.get(Kr());null==n&&null!=i&&(n=Io(i,Kr()));var a=[],o=zr(e.path),s=e.operationForChild(o),u=t.children.get(o);if(u&&s){var c=n?n.getImmediateChild(o):null,l=Ja(r,o);a=a.concat(jo(s,u,c,l))}return i&&(a=a.concat(ko(i,e,r,n))),a}function Bo(e,t,n,r){var i=t.get(Kr());null==n&&null!=i&&(n=Io(i,Kr()));var a=[];return t.children.inorderTraversal((function(t,i){var o=n?n.getImmediateChild(t):null,s=Ja(r,t),u=e.operationForChild(t);u&&(a=a.concat(Bo(u,i,o,s)))})),i&&(a=a.concat(ko(i,e,r,n))),a}function Ko(e,t){var n=t.query,r=zo(e,n);return{hashFn:function(){var e=function(e){return e.viewCache_.serverCache.getNode()}(t)||Mi.EMPTY_NODE;return e.hash()},onComplete:function(t){if("ok"===t)return r?function(e,t,n){var r=Go(e,n);if(r){var i=Ho(r),a=i.path,o=i.queryId,s=$r(a,t);return Qo(e,a,new da(la(o),s))}return[]}(e,n._path,r):function(e,t){return Vo(e,new da({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t))}(e,n._path);var i=function(e,t){var n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?n="Client doesn't have permission to access the desired data.":"unavailable"===e&&(n="The service is unavailable");var r=new Error(e+" at "+t._path.toString()+": "+n);return r.code=e.toUpperCase(),r}(t,n);return Mo(e,n,null,i)}}}function zo(e,t){var n=Wo(t);return e.queryToTagMap.get(n)}function Wo(e){return e._path.toString()+"$"+e._queryIdentifier}function Go(e,t){return e.tagToQueryMap.get(t)}function Ho(e){var t=e.indexOf("$");return ue(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new Br(e.substr(0,t))}}function Qo(e,t,n){var r=e.syncPointTree_.get(t);return ue(r,"Missing sync point for query tag that we're tracking"),ko(r,n,Fa(e.pendingWriteTree_,t),null)}function Yo(e){return e.fold((function(e,t,n){if(t&&So(t))return[Co(t)];var r=[];return t&&(r=xo(t)),hr(n,(function(e,t){r=r.concat(t)})),r}))}function Jo(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new(ue(yo,"Reference.ts has not been loaded"),yo)(e._repo,e._path):e}function Xo(e,t){for(var n=0;n<t.length;++n){var r=t[n];if(!r._queryParams.loadsAllData()){var i=Wo(r),a=e.queryToTagMap.get(i);e.queryToTagMap.delete(i),e.tagToQueryMap.delete(a)}}}function $o(){return Ao++}function Zo(e,t,n){var r=t._path,i=zo(e,t),a=Ko(e,n),o=e.listenProvider_.startListening(Jo(t),i,a.hashFn,a.onComplete),s=e.syncPointTree_.subtree(r);if(i)ue(!So(s.value),"If we're adding a query, it shouldn't be shadowed");else for(var u=s.fold((function(e,t,n){if(!Xr(e)&&t&&So(t))return[Co(t).query];var r=[];return t&&(r=r.concat(xo(t).map((function(e){return e.query})))),hr(n,(function(e,t){r=r.concat(t)})),r})),c=0;c<u.length;++c){var l=u[c];e.listenProvider_.stopListening(Jo(l),zo(e,l))}return o}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var es=function(){"use strict";function t(n){e(l)(this,t),this.node_=n}return e(h)(t,[{key:"getImmediateChild",value:function(e){return new t(this.node_.getImmediateChild(e))}},{key:"node",value:function(){return this.node_}}]),t}(),ts=function(){"use strict";function t(n,r){e(l)(this,t),this.syncTree_=n,this.path_=r}return e(h)(t,[{key:"getImmediateChild",value:function(e){var n=Jr(this.path_,e);return new t(this.syncTree_,n)}},{key:"node",value:function(){return Uo(this.syncTree_,this.path_)}}]),t}(),ns=function(e,t,n){return e&&"object"==typeof e?(ue(".sv"in e,"Unexpected leaf node or priority contents"),"string"==typeof e[".sv"]?rs(e[".sv"],t,n):"object"==typeof e[".sv"]?is(e[".sv"],t):void ue(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},rs=function(e,t,n){if("timestamp"===e)return n.timestamp;ue(!1,"Unexpected server value: "+e)},is=function(e,t,n){e.hasOwnProperty("increment")||ue(!1,"Unexpected server value: "+JSON.stringify(e,null,2));var r=e.increment;"number"!=typeof r&&ue(!1,"Unexpected increment value: "+r);var i=t.node();if(ue(null!=i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;var a=i.getValue();return"number"!=typeof a?r:a+r},as=function(e,t,n,r){return ss(t,new ts(n,e),r)},os=function(e,t,n){return ss(e,new es(t),n)};function ss(e,t,n){var r,i=e.getPriority().val(),a=ns(i,t.getImmediateChild(".priority"),n);if(e.isLeafNode()){var o=e,s=ns(o.getValue(),t,n);return s!==o.getValue()||a!==o.getPriority().val()?new Ti(s,Fi(a)):e}var u=e;return r=u,a!==u.getPriority().val()&&(r=r.updatePriority(new Ti(a))),u.forEachChild(Ai,(function(e,i){var a=ss(i,t.getImmediateChild(e),n);a!==i&&(r=r.updateImmediateChild(e,a))})),r}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var us=function t(){"use strict";var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{children:{},childCount:0};e(l)(this,t),this.name=n,this.parent=r,this.node=i};function cs(e,t){for(var n=t instanceof Br?t:new Br(t),r=e,i=zr(n);null!==i;){var a=Ke(r.node.children,i)||{children:{},childCount:0};r=new us(i,r,a),i=zr(n=Gr(n))}return r}function ls(e){return e.node.value}function hs(e,t){e.node.value=t,ys(e)}function fs(e){return e.node.childCount>0}function ds(e,t){hr(e.node.children,(function(n,r){t(new us(n,e,r))}))}function ps(e,t,n,r){n&&!r&&t(e),ds(e,(function(e){ps(e,t,!0,r)})),n&&r&&t(e)}function vs(e){return new Br(null===e.parent?e.name:vs(e.parent)+"/"+e.name)}function ys(e){null!==e.parent&&function(e,t,n){var r=function(e){return void 0===ls(e)&&!fs(e)}(n),i=Be(e.node.children,t);r&&i?(delete e.node.children[t],e.node.childCount--,ys(e)):r||i||(e.node.children[t]=n.node,e.node.childCount++,ys(e))}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e.parent,e.name,e)}var ms=/[\[\].#$\/\u0000-\u001F\u007F]/,gs=/[\[\].#$\u0000-\u001F\u007F]/,ks=10485760,_s=function(e){return"string"==typeof e&&0!==e.length&&!ms.test(e)},ws=function(e){return"string"==typeof e&&0!==e.length&&!gs.test(e)},bs=function(e){return null===e||"string"==typeof e||"number"==typeof e&&!rr(e)||e&&"object"==typeof e&&Be(e,".sv")},xs=function(e,t,n,r){r&&void 0===t||Is(nt(e,"value"),t,n)},Is=function(e,t,n){var r=n instanceof Br?new ni(n,e):n;if(void 0===t)throw new Error(e+"contains undefined "+ii(r));if("function"==typeof t)throw new Error(e+"contains a function "+ii(r)+" with contents = "+t.toString());if(rr(t))throw new Error(e+"contains "+t.toString()+" "+ii(r));if("string"==typeof t&&t.length>3495253.3333333335&&ot(t)>ks)throw new Error(e+"contains a string greater than "+"10485760 utf8 bytes "+ii(r)+" ('"+t.substring(0,50)+"...')");if(t&&"object"==typeof t){var i=!1,a=!1;if(hr(t,(function(t,n){if(".value"===t)i=!0;else if(".priority"!==t&&".sv"!==t&&(a=!0,!_s(t)))throw new Error(e+" contains an invalid key ("+t+") "+ii(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');var o,s;s=t,(o=r).parts_.length>0&&(o.byteLength_+=1),o.parts_.push(s),o.byteLength_+=ot(s),ri(o),Is(e,n,r),function(e){var t=e.parts_.pop();e.byteLength_-=ot(t),e.parts_.length>0&&(e.byteLength_-=1)}(r)})),i&&a)throw new Error(e+' contains ".value" child '+ii(r)+" in addition to actual children.")}},Ts=function(e,t,n,r){if(!r||void 0!==t){var i=nt(e,"values");if(!t||"object"!=typeof t||Array.isArray(t))throw new Error(i+" must be an object containing the children to replace.");var a=[];hr(t,(function(e,t){var r=new Br(e);if(Is(i,t,Jr(n,r)),".priority"===Hr(r)&&!bs(t))throw new Error(i+"contains an invalid value for '"+r.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(r)})),function(e,t){var n,r;for(n=0;n<t.length;n++)for(var i=Qr(r=t[n]),a=0;a<i.length;a++)if(".priority"===i[a]&&a===i.length-1);else if(!_s(i[a]))throw new Error(e+"contains an invalid key ("+i[a]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');t.sort(Zr);var o=null;for(n=0;n<t.length;n++){if(r=t[n],null!==o&&ti(o,r))throw new Error(e+"contains a path "+o.toString()+" that is ancestor of another path "+r.toString());o=r}}(i,a)}},Es=function(e,t,n){if(!n||void 0!==t){if(rr(t))throw new Error(nt(e,"priority")+"is "+t.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!bs(t))throw new Error(nt(e,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Ss=function(e,t,n,r){if(!(r&&void 0===n||_s(n)))throw new Error(nt(e,t)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},Cs=function(e,t,n,r){if(!(r&&void 0===n||ws(n)))throw new Error(nt(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},As=function(e,t){if(".info"===zr(t))throw new Error(e+" failed = Can't modify data under /.info/")},Ns=function(e,t){var n=t.path.toString();if("string"!=typeof t.repoInfo.host||0===t.repoInfo.host.length||!_s(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),ws(e)}(n))throw new Error(nt(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},Rs=function t(){"use strict";e(l)(this,t),this.eventLists_=[],this.recursionDepth_=0};function Ds(e,t){for(var n=null,r=0;r<t.length;r++){var i=t[r],a=i.getPath();null===n||ei(a,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:a}),n.events.push(i)}n&&e.eventLists_.push(n)}function Ps(e,t,n){Ds(e,n),Ms(e,(function(e){return ei(e,t)}))}function Os(e,t,n){Ds(e,n),Ms(e,(function(e){return ti(e,t)||ti(t,e)}))}function Ms(e,t){e.recursionDepth_++;for(var n=!0,r=0;r<e.eventLists_.length;r++){var i=e.eventLists_[r];if(i)t(i.path)?(Ls(e.eventLists_[r]),e.eventLists_[r]=null):n=!1}n&&(e.eventLists_=[]),e.recursionDepth_--}function Ls(e){for(var t=0;t<e.events.length;t++){var n=e.events[t];if(null!==n){e.events[t]=null;var r=n.getEventRunner();Yn&&$n("event: "+n.toString()),vr(r)}}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Fs="repo_interrupt",Us=function(){"use strict";function t(n,r,i,a){e(l)(this,t),this.repoInfo_=n,this.forceRestClient_=r,this.authTokenProvider_=i,this.appCheckProvider_=a,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Rs,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=na(),this.transactionQueueTree_=new us,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}return e(h)(t,[{key:"toString",value:function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}]),t}();function qs(e,t,n){if(e.stats_=Ar(e.repoInfo_),e.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new ea(e.repoInfo_,(function(t,n,r,i){Bs(e,t,n,r,i)}),e.authTokenProvider_,e.appCheckProvider_),setTimeout((function(){return Ks(e,!0)}),0);else{if(null!=n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{qe(n)}catch(e){throw new Error("Invalid authOverride provided: "+e)}}e.persistentConnection_=new si(e.repoInfo_,t,(function(t,n,r,i){Bs(e,t,n,r,i)}),(function(t){Ks(e,t)}),(function(t){!function(e,t){hr(t,(function(t,n){zs(e,t,n)}))}(e,t)}),e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}var r,i,a;e.authTokenProvider_.addTokenChangeListener((function(t){e.server_.refreshAuthToken(t)})),e.appCheckProvider_.addTokenChangeListener((function(t){e.server_.refreshAppCheckToken(t.token)})),e.statsReporter_=(r=e.repoInfo_,i=function(){return new ca(e.stats_,e.server_)},a=r.toString(),Cr[a]||(Cr[a]=i()),Cr[a]),e.infoData_=new ta,e.infoSyncTree_=new No({startListening:function(t,n,r,i){var a=[],o=e.infoData_.getNode(t._path);return o.isEmpty()||(a=Oo(e.infoSyncTree_,t._path,o),setTimeout((function(){i("ok")}),0)),a},stopListening:function(){}}),zs(e,"connected",!1),e.serverSyncTree_=new No({startListening:function(t,n,r,i){return e.server_.listen(t,r,n,(function(n,r){var a=i(n,r);Os(e.eventQueue_,t._path,a)})),[]},stopListening:function(t,n){e.server_.unlisten(t,n)}})}function Vs(e){var t=e.infoData_.getNode(new Br(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function js(e){return(t=(t={timestamp:Vs(e)})||{}).timestamp=t.timestamp||(new Date).getTime(),t;var t}function Bs(e,t,n,r,i){e.dataUpdateCount++;var a=new Br(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;var o=[];if(i)if(r){var s=We(n,(function(e){return Fi(e)}));o=function(e,t,n,r){var i=Go(e,r);if(i){var a=Ho(i),o=a.path,s=a.queryId,u=$r(o,t),c=Ta.fromObject(n);return Qo(e,o,new va(la(s),u,c))}return[]}(e.serverSyncTree_,a,s,i)}else{var u=Fi(n);o=Lo(e.serverSyncTree_,a,u,i)}else if(r){var c=We(n,(function(e){return Fi(e)}));o=function(e,t,n){var r=Ta.fromObject(n);return Vo(e,new va({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,r))}(e.serverSyncTree_,a,c)}else{var l=Fi(n);o=Oo(e.serverSyncTree_,a,l)}var h=a;o.length>0&&(h=nu(e,a)),Os(e.eventQueue_,h,o)}function Ks(e,t){zs(e,"connected",t),!1===t&&function(e){Xs(e,"onDisconnectEvents");var t=js(e),n=na();aa(e.onDisconnect_,Kr(),(function(r,i){var a=as(r,i,e.serverSyncTree_,t);ra(n,r,a)}));var r=[];aa(n,Kr(),(function(t,n){r=r.concat(Oo(e.serverSyncTree_,t,n));var i=su(e,t);nu(e,i)})),e.onDisconnect_=na(),Os(e.eventQueue_,Kr(),r)}(e)}function zs(e,t,n){var r=new Br("/.info/"+t),i=Fi(n);e.infoData_.updateSnapshot(r,i);var a=Oo(e.infoSyncTree_,r,i);Os(e.eventQueue_,r,a)}function Ws(e){return e.nextWriteId_++}function Gs(e,t,n,r,i){Xs(e,"set",{path:t.toString(),value:n,priority:r});var a=js(e),o=Fi(n,r),s=Uo(e.serverSyncTree_,t),u=os(o,s,a),c=Ws(e),l=Ro(e.serverSyncTree_,t,u,c,!0);Ds(e.eventQueue_,l),e.server_.put(t.toString(),o.val(!0),(function(n,r){var a="ok"===n;a||nr("set at "+t+" failed: "+n);var o=Po(e.serverSyncTree_,c,!a);Os(e.eventQueue_,t,o),$s(e,i,n,r)}));var h=su(e,t);nu(e,h),Os(e.eventQueue_,h,[])}function Hs(e,t,n){e.server_.onDisconnectCancel(t.toString(),(function(r,i){"ok"===r&&ia(e.onDisconnect_,t),$s(e,n,r,i)}))}function Qs(e,t,n,r){var i=Fi(n);e.server_.onDisconnectPut(t.toString(),i.val(!0),(function(n,a){"ok"===n&&ra(e.onDisconnect_,t,i),$s(e,r,n,a)}))}function Ys(e,t,n){var r;r=".info"===zr(t._path)?Mo(e.infoSyncTree_,t,n):Mo(e.serverSyncTree_,t,n),Ps(e.eventQueue_,t._path,r)}function Js(e){e.persistentConnection_&&e.persistentConnection_.interrupt(Fs)}function Xs(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var a="";t.persistentConnection_&&(a=t.persistentConnection_.id+":"),$n.apply(void 0,[a].concat(e(p)(r)))}function $s(e,t,n,r){t&&vr((function(){if("ok"===n)t(null);else{var e=(n||"error").toUpperCase(),i=e;r&&(i+=": "+r);var a=new Error(i);a.code=e,t(a)}}))}function Zs(e,t,n){return Uo(e.serverSyncTree_,t,n)||Mi.EMPTY_NODE}function eu(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.transactionQueueTree_;if(t||ou(e,t),ls(t)){var n=iu(e,t);ue(n.length>0,"Sending zero length transaction queue");var r=n.every((function(e){return 0===e.status}));r&&tu(e,vs(t),n)}else fs(t)&&ds(t,(function(t){eu(e,t)}))}function tu(e,t,n){for(var r=n.map((function(e){return e.currentWriteId})),i=Zs(e,t,r),a=i,o=i.hash(),s=0;s<n.length;s++){var u=n[s];ue(0===u.status,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;var c=$r(t,u.path);a=a.updateChild(c,u.currentOutputSnapshotRaw)}var l=a.val(!0),h=t;e.server_.put(h.toString(),l,(function(r){Xs(e,"transaction put response",{path:h.toString(),status:r});var i=[];if("ok"===r){for(var a=function(t){n[t].status=2,i=i.concat(Po(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&o.push((function(){return n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved)})),n[t].unwatcher()},o=[],s=0;s<n.length;s++)a(s);ou(e,cs(e.transactionQueueTree_,t)),eu(e,e.transactionQueueTree_),Os(e.eventQueue_,t,i);for(var u=0;u<o.length;u++)vr(o[u])}else{if("datastale"===r)for(var c=0;c<n.length;c++)3===n[c].status?n[c].status=4:n[c].status=0;else{nr("transaction at "+h.toString()+" failed: "+r);for(var l=0;l<n.length;l++)n[l].status=4,n[l].abortReason=r}nu(e,t)}}),o)}function nu(e,t){var n=ru(e,t),r=vs(n);return function(e,t,n){var r=function(r){var s,u=t[r],c=$r(n,u.path),l=!1,h=void 0;if(ue(null!==c,"rerunTransactionsUnderNode_: relativePath should not be null."),4===u.status)l=!0,h=u.abortReason,a=a.concat(Po(e.serverSyncTree_,u.currentWriteId,!0));else if(0===u.status)if(u.retryCount>=25)l=!0,h="maxretry",a=a.concat(Po(e.serverSyncTree_,u.currentWriteId,!0));else{var f=Zs(e,u.path,o);u.currentInputSnapshot=f;var d=t[r].update(f.val());if(void 0!==d){Is("transaction failed: Data returned ",d,u.path);var p=Fi(d);"object"==typeof d&&null!=d&&Be(d,".priority")||(p=p.updatePriority(f.getPriority()));var v=u.currentWriteId,y=js(e),m=os(p,f,y);u.currentOutputSnapshotRaw=p,u.currentOutputSnapshotResolved=m,u.currentWriteId=Ws(e),o.splice(o.indexOf(v),1),a=(a=a.concat(Ro(e.serverSyncTree_,u.path,m,u.currentWriteId,u.applyLocally))).concat(Po(e.serverSyncTree_,v,!0))}else l=!0,h="nodata",a=a.concat(Po(e.serverSyncTree_,u.currentWriteId,!0))}Os(e.eventQueue_,n,a),a=[],l&&(t[r].status=2,s=t[r].unwatcher,setTimeout(s,Math.floor(0)),t[r].onComplete&&("nodata"===h?i.push((function(){return t[r].onComplete(null,!1,t[r].currentInputSnapshot)})):i.push((function(){return t[r].onComplete(new Error(h),!1,null)}))))};if(0===t.length)return;for(var i=[],a=[],o=t.filter((function(e){return 0===e.status})).map((function(e){return e.currentWriteId})),s=0;s<t.length;s++)r(s);ou(e,e.transactionQueueTree_);for(var u=0;u<i.length;u++)vr(i[u]);eu(e,e.transactionQueueTree_)}(e,iu(e,n),r),r}function ru(e,t){var n,r=e.transactionQueueTree_;for(n=zr(t);null!==n&&void 0===ls(r);)r=cs(r,n),n=zr(t=Gr(t));return r}function iu(e,t){var n=[];return au(e,t,n),n.sort((function(e,t){return e.order-t.order})),n}function au(e,t,n){var r=ls(t);if(r)for(var i=0;i<r.length;i++)n.push(r[i]);ds(t,(function(t){au(e,t,n)}))}function ou(e,t){var n=ls(t);if(n){for(var r=0,i=0;i<n.length;i++)2!==n[i].status&&(n[r]=n[i],r++);n.length=r,hs(t,n.length>0?n:void 0)}ds(t,(function(t){ou(e,t)}))}function su(e,t){var n=vs(ru(e,t)),r=cs(e.transactionQueueTree_,t);return function(e,t,n){for(var r=n?e:e.parent;null!==r;){if(t(r))return!0;r=r.parent}}(r,(function(t){uu(e,t)})),uu(e,r),ps(r,(function(t){uu(e,t)})),n}function uu(e,t){var n=ls(t);if(n){for(var r=[],i=[],a=-1,o=0;o<n.length;o++)3===n[o].status||(1===n[o].status?(ue(a===o-1,"All SENT items should be at beginning of queue."),a=o,n[o].status=3,n[o].abortReason="set"):(ue(0===n[o].status,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(Po(e.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));-1===a?hs(t,void 0):n.length=a+1,Os(e.eventQueue_,vs(t),i);for(var s=0;s<r.length;s++)vr(r[s])}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var cu,lu,hu=function(e,t){var n=fu(e),r=n.namespace;"firebase.com"===n.domain&&tr(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||tr("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&nr("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");var i="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new Ir(n.host,n.secure,r,i,t,"",r!==n.subdomain),path:new Br(n.pathString)}},fu=function(e){var t="",n="",r="",i="",a="",o=!0,s="https",u=443;if("string"==typeof e){var c=e.indexOf("//");c>=0&&(s=e.substring(0,c-1),e=e.substring(c+2));var l=e.indexOf("/");-1===l&&(l=e.length);var h=e.indexOf("?");-1===h&&(h=e.length),t=e.substring(0,Math.min(l,h)),l<h&&(i=function(e){for(var t="",n=e.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(e){}t+="/"+i}return t}(e.substring(l,h)));var f=function(e){var t={};"?"===e.charAt(0)&&(e=e.substring(1));var n=!0,r=!1,i=void 0;try{for(var a,o=e.split("&")[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;if(0!==s.length){var u=s.split("=");2===u.length?t[decodeURIComponent(u[0])]=decodeURIComponent(u[1]):nr("Invalid query segment '".concat(s,"' in query '").concat(e,"'"))}}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return t}(e.substring(Math.min(e.length,h)));(c=t.indexOf(":"))>=0?(o="https"===s||"wss"===s,u=parseInt(t.substring(c+1),10)):c=t.length;var d=t.slice(0,c);if("localhost"===d.toLowerCase())n="localhost";else if(d.split(".").length<=2)n=d;else{var p=t.indexOf(".");r=t.substring(0,p).toLowerCase(),n=t.substring(p+1),a=r}"ns"in f&&(a=f.ns)}return{host:t,port:u,domain:n,subdomain:r,secure:o,scheme:s,pathString:i,namespace:a}},du="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",pu=(cu=0,lu=[],function(e){var t,n=e===cu;cu=e;var r=new Array(8);for(t=7;t>=0;t--)r[t]=du.charAt(e%64),e=Math.floor(e/64);ue(0===e,"Cannot push at time == 0");var i=r.join("");if(n){for(t=11;t>=0&&63===lu[t];t--)lu[t]=0;lu[t]++}else for(t=0;t<12;t++)lu[t]=Math.floor(64*Math.random());for(t=0;t<12;t++)i+=du.charAt(lu[t]);return ue(20===i.length,"nextPushId: Length should be 20."),i}),vu=function(){"use strict";function t(n,r,i,a){e(l)(this,t),this.eventType=n,this.eventRegistration=r,this.snapshot=i,this.prevName=a}return e(h)(t,[{key:"getPath",value:function(){var e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}},{key:"getEventType",value:function(){return this.eventType}},{key:"getEventRunner",value:function(){return this.eventRegistration.getEventRunner(this)}},{key:"toString",value:function(){return this.getPath().toString()+":"+this.eventType+":"+qe(this.snapshot.exportVal())}}]),t}(),yu=function(){"use strict";function t(n,r,i){e(l)(this,t),this.eventRegistration=n,this.error=r,this.path=i}return e(h)(t,[{key:"getPath",value:function(){return this.path}},{key:"getEventType",value:function(){return"cancel"}},{key:"getEventRunner",value:function(){return this.eventRegistration.getEventRunner(this)}},{key:"toString",value:function(){return this.path.toString()+":cancel"}}]),t}(),mu=function(){"use strict";function t(n,r){e(l)(this,t),this.snapshotCallback=n,this.cancelCallback=r}return e(h)(t,[{key:"onValue",value:function(e,t){this.snapshotCallback.call(null,e,t)}},{key:"onCancel",value:function(e){return ue(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}},{key:"hasCancelCallback",get:function(){return!!this.cancelCallback}},{key:"matches",value:function(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}]),t}(),gu=function(){"use strict";function t(n,r){e(l)(this,t),this._repo=n,this._path=r}return e(h)(t,[{key:"cancel",value:function(){var e=new De;return Hs(this._repo,this._path,e.wrapCallback((function(){}))),e.promise}},{key:"remove",value:function(){As("OnDisconnect.remove",this._path);var e=new De;return Qs(this._repo,this._path,null,e.wrapCallback((function(){}))),e.promise}},{key:"set",value:function(e){As("OnDisconnect.set",this._path),xs("OnDisconnect.set",e,this._path,!1);var t=new De;return Qs(this._repo,this._path,e,t.wrapCallback((function(){}))),t.promise}},{key:"setWithPriority",value:function(e,t){As("OnDisconnect.setWithPriority",this._path),xs("OnDisconnect.setWithPriority",e,this._path,!1),Es("OnDisconnect.setWithPriority",t,!1);var n=new De;return function(e,t,n,r,i){var a=Fi(n,r);e.server_.onDisconnectPut(t.toString(),a.val(!0),(function(n,r){"ok"===n&&ra(e.onDisconnect_,t,a),$s(0,i,n,r)}))}(this._repo,this._path,e,t,n.wrapCallback((function(){}))),n.promise}},{key:"update",value:function(e){As("OnDisconnect.update",this._path),Ts("OnDisconnect.update",e,this._path,!1);var t=new De;return function(e,t,n,r){if(ze(n))return $n("onDisconnect().update() called with empty data.  Don't do anything."),void $s(0,r,"ok",void 0);e.server_.onDisconnectMerge(t.toString(),n,(function(i,a){"ok"===i&&hr(n,(function(n,r){var i=Fi(r);ra(e.onDisconnect_,Jr(t,n),i)})),$s(0,r,i,a)}))}(this._repo,this._path,e,t.wrapCallback((function(){}))),t.promise}}]),t}(),ku=function(){"use strict";function t(n,r,i,a){e(l)(this,t),this._repo=n,this._path=r,this._queryParams=i,this._orderByCalled=a}return e(h)(t,[{key:"key",get:function(){return Xr(this._path)?null:Hr(this._path)}},{key:"ref",get:function(){return new xu(this._repo,this._path)}},{key:"_queryIdentifier",get:function(){var e=Zi(this._queryParams),t=cr(e);return"{}"===t?"default":t}},{key:"_queryObject",get:function(){return Zi(this._queryParams)}},{key:"isEqual",value:function(e){if(!((e=lt(e))instanceof t))return!1;var n=this._repo===e._repo,r=ei(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&r&&i}},{key:"toJSON",value:function(){return this.toString()}},{key:"toString",value:function(){return this._repo.toString()+function(e){for(var t="",n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)}}]),t}();function _u(e,t){if(!0===e._orderByCalled)throw new Error(t+": You can't combine multiple orderBy calls.")}function wu(e){var t=null,n=null;if(e.hasStart()&&(t=e.getIndexStartValue()),e.hasEnd()&&(n=e.getIndexEndValue()),e.getIndex()===fi){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(e.hasStart()){if(e.getIndexStartName()!==ir)throw new Error(r);if("string"!=typeof t)throw new Error(i)}if(e.hasEnd()){if(e.getIndexEndName()!==ar)throw new Error(r);if("string"!=typeof n)throw new Error(i)}}else if(e.getIndex()===Ai){if(null!=t&&!bs(t)||null!=n&&!bs(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(ue(e.getIndex()instanceof Ui||e.getIndex()===Vi,"unknown index type."),null!=t&&"object"==typeof t||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function bu(e){if(e.hasStart()&&e.hasEnd()&&e.hasLimit()&&!e.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var xu=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i){return e(l)(this,r),n.call(this,t,i,new Qi,!1)}return e(h)(r,[{key:"parent",get:function(){var e=Yr(this._path);return null===e?null:new r(this._repo,e)}},{key:"root",get:function(){for(var e=this;null!==e.parent;)e=e.parent;return e}}]),r}(ku),Iu=function(){"use strict";function t(n,r,i){e(l)(this,t),this._node=n,this.ref=r,this._index=i}return e(h)(t,[{key:"priority",get:function(){return this._node.getPriority().val()}},{key:"key",get:function(){return this.ref.key}},{key:"size",get:function(){return this._node.numChildren()}},{key:"child",value:function(e){var n=new Br(e),r=Su(this.ref,e);return new t(this._node.getChild(n),r,Ai)}},{key:"exists",value:function(){return!this._node.isEmpty()}},{key:"exportVal",value:function(){return this._node.val(!0)}},{key:"forEach",value:function(e){var n=this;return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(function(r,i){return e(new t(i,Su(n.ref,r),Ai))}))}},{key:"hasChild",value:function(e){var t=new Br(e);return!this._node.getChild(t).isEmpty()}},{key:"hasChildren",value:function(){return!this._node.isLeafNode()&&!this._node.isEmpty()}},{key:"toJSON",value:function(){return this.exportVal()}},{key:"val",value:function(){return this._node.val()}}]),t}();function Tu(e,t){return(e=lt(e))._checkNotDeleted("ref"),void 0!==t?Su(e._root,t):e._root}function Eu(e,t){(e=lt(e))._checkNotDeleted("refFromURL");var n=hu(t,e._repo.repoInfo_.nodeAdmin);Ns("refFromURL",n);var r=n.repoInfo;return e._repo.repoInfo_.isCustomHost()||r.host===e._repo.repoInfo_.host||tr("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+e._repo.repoInfo_.host+")"),Tu(e,n.path.toString())}function Su(e,t){var n,r,i,a;return null===zr((e=lt(e))._path)?(n="child",r="path",a=!1,(i=t)&&(i=i.replace(/^\/*\.info(\/|$)/,"/")),Cs(n,r,i,a)):Cs("child","path",t,!1),new xu(e._repo,Jr(e._path,t))}function Cu(e,t){e=lt(e),As("push",e._path),xs("push",t,e._path,!0);var n,r=Vs(e._repo),i=pu(r),a=Su(e,i),o=Su(e,i);return n=null!=t?Nu(o,t).then((function(){return o})):Promise.resolve(o),a.then=n.then.bind(n),a.catch=n.then.bind(n,void 0),a}function Au(e){return As("remove",e._path),Nu(e,null)}function Nu(e,t){e=lt(e),As("set",e._path),xs("set",t,e._path,!1);var n=new De;return Gs(e._repo,e._path,t,null,n.wrapCallback((function(){}))),n.promise}function Ru(e,t){e=lt(e),As("setPriority",e._path),Es("setPriority",t,!1);var n=new De;return Gs(e._repo,Jr(e._path,".priority"),t,null,n.wrapCallback((function(){}))),n.promise}function Du(e,t,n){if(As("setWithPriority",e._path),xs("setWithPriority",t,e._path,!1),Es("setWithPriority",n,!1),".length"===e.key||".keys"===e.key)throw"setWithPriority failed: "+e.key+" is a read-only object.";var r=new De;return Gs(e._repo,e._path,t,n,r.wrapCallback((function(){}))),r.promise}function Pu(e,t){Ts("update",t,e._path,!1);var n=new De;return function(e,t,n,r){Xs(e,"update",{path:t.toString(),value:n});var i=!0,a=js(e),o={};if(hr(n,(function(n,r){i=!1,o[n]=as(Jr(t,n),Fi(r),e.serverSyncTree_,a)})),i)$n("update() called with empty data.  Don't do anything."),$s(0,r,"ok",void 0);else{var s=Ws(e),u=Do(e.serverSyncTree_,t,o,s);Ds(e.eventQueue_,u),e.server_.merge(t.toString(),n,(function(n,i){var a="ok"===n;a||nr("update at "+t+" failed: "+n);var o=Po(e.serverSyncTree_,s,!a),u=o.length>0?nu(e,t):t;Os(e.eventQueue_,u,o),$s(0,r,n,i)})),hr(n,(function(n){var r=su(e,Jr(t,n));nu(e,r)})),Os(e.eventQueue_,t,[])}}(e._repo,e._path,t,n.wrapCallback((function(){}))),n.promise}function Ou(e){e=lt(e);var t,n,r,i,a=new mu((function(){})),o=new Mu(a);return(t=e._repo,n=e,r=o,i=qo(t.serverSyncTree_,n),null!=i?Promise.resolve(i):t.server_.get(n).then((function(e){var i,a=Fi(e).withIndex(n._queryParams.getIndex());if(Fo(t.serverSyncTree_,n,r,!0),n._queryParams.loadsAllData())i=Oo(t.serverSyncTree_,n._path,a);else{var o=zo(t.serverSyncTree_,n);i=Lo(t.serverSyncTree_,n._path,a,o)}return Os(t.eventQueue_,n._path,i),Mo(t.serverSyncTree_,n,r,null,!0),a}),(function(e){return Xs(t,"get for query "+qe(n)+" failed: "+e),Promise.reject(new Error(e))}))).then((function(t){return new Iu(t,new xu(e._repo,e._path),e._queryParams.getIndex())}))}var Mu=function(){"use strict";function t(n){e(l)(this,t),this.callbackContext=n}return e(h)(t,[{key:"respondsTo",value:function(e){return"value"===e}},{key:"createEvent",value:function(e,t){var n=t._queryParams.getIndex();return new vu("value",this,new Iu(e.snapshotNode,new xu(t._repo,t._path),n))}},{key:"getEventRunner",value:function(e){var t=this;return"cancel"===e.getEventType()?function(){return t.callbackContext.onCancel(e.error)}:function(){return t.callbackContext.onValue(e.snapshot,null)}}},{key:"createCancelEvent",value:function(e,t){return this.callbackContext.hasCancelCallback?new yu(this,e,t):null}},{key:"matches",value:function(e){return e instanceof t&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}},{key:"hasAnyCallback",value:function(){return null!==this.callbackContext}}]),t}(),Lu=function(){"use strict";function t(n,r){e(l)(this,t),this.eventType=n,this.callbackContext=r}return e(h)(t,[{key:"respondsTo",value:function(e){var t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}},{key:"createCancelEvent",value:function(e,t){return this.callbackContext.hasCancelCallback?new yu(this,e,t):null}},{key:"createEvent",value:function(e,t){ue(null!=e.childName,"Child events should have a childName.");var n=Su(new xu(t._repo,t._path),e.childName),r=t._queryParams.getIndex();return new vu(e.type,this,new Iu(e.snapshotNode,n,r),e.prevName)}},{key:"getEventRunner",value:function(e){var t=this;return"cancel"===e.getEventType()?function(){return t.callbackContext.onCancel(e.error)}:function(){return t.callbackContext.onValue(e.snapshot,e.prevName)}}},{key:"matches",value:function(e){return e instanceof t&&(this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)))}},{key:"hasAnyCallback",value:function(){return!!this.callbackContext}}]),t}();function Fu(e,t,n,r,i){var a;if("object"==typeof r&&(a=void 0,i=r),"function"==typeof r&&(a=r),i&&i.onlyOnce){var o=n,s=function(t,n){Ys(e._repo,e,d),o(t,n)};s.userCallback=n.userCallback,s.context=n.context,n=s}var u,c,l,h,f=new mu(n,a||void 0),d="value"===t?new Mu(f):new Lu(t,f);return u=e._repo,l=d,h=".info"===zr((c=e)._path)?Fo(u.infoSyncTree_,c,l):Fo(u.serverSyncTree_,c,l),Ps(u.eventQueue_,c._path,h),function(){return Ys(e._repo,e,d)}}function Uu(e,t,n,r){return Fu(e,"value",t,n,r)}function qu(e,t,n,r){return Fu(e,"child_added",t,n,r)}function Vu(e,t,n,r){return Fu(e,"child_changed",t,n,r)}function ju(e,t,n,r){return Fu(e,"child_moved",t,n,r)}function Bu(e,t,n,r){return Fu(e,"child_removed",t,n,r)}function Ku(e,t,n){var r=null,i=n?new mu(n):null;"value"===t?r=new Mu(i):t&&(r=new Lu(t,i)),Ys(e._repo,e,r)}var zu=function t(){"use strict";e(l)(this,t)},Wu=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i){var a;return e(l)(this,r),(a=n.call(this))._value=t,a._key=i,a}return e(h)(r,[{key:"_apply",value:function(e){xs("endAt",this._value,e._path,!0);var t=Ji(e._queryParams,this._value,this._key);if(bu(t),wu(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new ku(e._repo,e._path,t,e._orderByCalled)}}]),r}(zu);function Gu(e,t){return Ss("endAt","key",t,!0),new Wu(e,t)}var Hu=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i){var a;return e(l)(this,r),(a=n.call(this))._value=t,a._key=i,a}return e(h)(r,[{key:"_apply",value:function(e){xs("endBefore",this._value,e._path,!1);var t,n,r,i,a=(t=e._queryParams,n=this._value,r=this._key,(i=t.index_===fi||r?Ji(t,n,r):Ji(t,n,ir)).endBeforeSet_=!0,i);if(bu(a),wu(a),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new ku(e._repo,e._path,a,e._orderByCalled)}}]),r}(zu);function Qu(e,t){return Ss("endBefore","key",t,!0),new Hu(e,t)}var Yu=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i){var a;return e(l)(this,r),(a=n.call(this))._value=t,a._key=i,a}return e(h)(r,[{key:"_apply",value:function(e){xs("startAt",this._value,e._path,!0);var t=Yi(e._queryParams,this._value,this._key);if(bu(t),wu(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new ku(e._repo,e._path,t,e._orderByCalled)}}]),r}(zu);function Ju(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;return Ss("startAt","key",t,!0),new Yu(e,t)}var Xu=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i){var a;return e(l)(this,r),(a=n.call(this))._value=t,a._key=i,a}return e(h)(r,[{key:"_apply",value:function(e){xs("startAfter",this._value,e._path,!1);var t,n,r,i,a=(t=e._queryParams,n=this._value,r=this._key,(i=t.index_===fi||r?Yi(t,n,r):Yi(t,n,ar)).startAfterSet_=!0,i);if(bu(a),wu(a),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new ku(e._repo,e._path,a,e._orderByCalled)}}]),r}(zu);function $u(e,t){return Ss("startAfter","key",t,!0),new Xu(e,t)}var Zu=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t){var i;return e(l)(this,r),(i=n.call(this))._limit=t,i}return e(h)(r,[{key:"_apply",value:function(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new ku(e._repo,e._path,(t=e._queryParams,n=this._limit,(r=t.copy()).limitSet_=!0,r.limit_=n,r.viewFrom_="l",r),e._orderByCalled);var t,n,r}}]),r}(zu);function ec(e){if("number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new Zu(e)}var tc=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t){var i;return e(l)(this,r),(i=n.call(this))._limit=t,i}return e(h)(r,[{key:"_apply",value:function(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new ku(e._repo,e._path,(t=e._queryParams,n=this._limit,(r=t.copy()).limitSet_=!0,r.limit_=n,r.viewFrom_="r",r),e._orderByCalled);var t,n,r}}]),r}(zu);function nc(e){if("number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new tc(e)}var rc=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t){var i;return e(l)(this,r),(i=n.call(this))._path=t,i}return e(h)(r,[{key:"_apply",value:function(e){_u(e,"orderByChild");var t=new Br(this._path);if(Xr(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");var n=new Ui(t),r=Xi(e._queryParams,n);return wu(r),new ku(e._repo,e._path,r,!0)}}]),r}(zu);function ic(e){if("$key"===e)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===e)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===e)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Cs("orderByChild","path",e,!1),new rc(e)}var ac=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(){return e(l)(this,r),n.apply(this,arguments)}return e(h)(r,[{key:"_apply",value:function(e){_u(e,"orderByKey");var t=Xi(e._queryParams,fi);return wu(t),new ku(e._repo,e._path,t,!0)}}]),r}(zu);function oc(){return new ac}var sc=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(){return e(l)(this,r),n.apply(this,arguments)}return e(h)(r,[{key:"_apply",value:function(e){_u(e,"orderByPriority");var t=Xi(e._queryParams,Ai);return wu(t),new ku(e._repo,e._path,t,!0)}}]),r}(zu);function uc(){return new sc}var cc=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(){return e(l)(this,r),n.apply(this,arguments)}return e(h)(r,[{key:"_apply",value:function(e){_u(e,"orderByValue");var t=Xi(e._queryParams,Vi);return wu(t),new ku(e._repo,e._path,t,!0)}}]),r}(zu);function lc(){return new cc}var hc=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i){var a;return e(l)(this,r),(a=n.call(this))._value=t,a._key=i,a}return e(h)(r,[{key:"_apply",value:function(e){if(xs("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new Wu(this._value,this._key)._apply(new Yu(this._value,this._key)._apply(e))}}]),r}(zu);function fc(e,t){return Ss("equalTo","key",t,!0),new hc(e,t)}function dc(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=lt(e),a=!0,o=!1,s=void 0;try{for(var u,c=n[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var l=u.value;i=l._apply(i)}}catch(e){o=!0,s=e}finally{try{a||null==c.return||c.return()}finally{if(o)throw s}}return i}!function(e){ue(!uo,"__referenceConstructor has already been defined"),uo=e}(xu),function(e){ue(!yo,"__referenceConstructor has already been defined"),yo=e}(xu);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var pc={},vc=!1;function yc(e,t,n,r){e.repoInfo_=new Ir("".concat(t,":").concat(n),!1,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams),r&&(e.authTokenProvider_=r)}function mc(e,t,n,r,i){var a=r||e.options.databaseURL;void 0===a&&(e.options.projectId||tr("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),$n("Using default host for project ",e.options.projectId),a="".concat(e.options.projectId,"-default-rtdb.firebaseio.com"));var o,s=hu(a,i),u=s.repoInfo,c=void 0;void 0!==z&&z.env&&(c=z.env.FIREBASE_DATABASE_EMULATOR_HOST),c?(o=!0,a="http://".concat(c,"?ns=").concat(u.namespace),u=(s=hu(a,i)).repoInfo):o=!s.repoInfo.secure;var l=i&&o?new kr(kr.OWNER):new gr(e.name,e.options,t);Ns("Invalid Firebase Database URL",s),Xr(s.path)||tr("Database URL must point to the root of a Firebase Database (not including a child path).");var h=function(e,t,n,r){var i=pc[t.name];i||(i={},pc[t.name]=i);var a=i[e.toURLString()];a&&tr("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.");return a=new Us(e,vc,n,r),i[e.toURLString()]=a,a}(u,e,l,new mr(e.name,n));return new gc(h,e)}var gc=function(){"use strict";function t(n,r){e(l)(this,t),this._repoInternal=n,this.app=r,this.type="database",this._instanceStarted=!1}return e(h)(t,[{key:"_repo",get:function(){return this._instanceStarted||(qs(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}},{key:"_root",get:function(){return this._rootInternal||(this._rootInternal=new xu(this._repo,Kr())),this._rootInternal}},{key:"_delete",value:function(){var e,t,n;return null!==this._rootInternal&&(e=this._repo,t=this.app.name,(n=pc[t])&&n[e.key]===e||tr("Database ".concat(t,"(").concat(e.repoInfo_,") has already been deleted.")),Js(e),delete n[e.key],this._repoInternal=null,this._rootInternal=null),Promise.resolve()}},{key:"_checkNotDeleted",value:function(e){null===this._rootInternal&&tr("Cannot call "+e+" on a deleted database.")}}]),t}();function kc(){Fr.IS_TRANSPORT_INITIALIZED&&nr("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function _c(){kc(),Pr.forceDisallow()}function wc(){kc(),Lr.forceDisallow(),Pr.forceAllow()}function bc(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};(e=lt(e))._checkNotDeleted("useEmulator"),e._instanceStarted&&tr("Cannot call useEmulator() after instance has already been initialized.");var i=e._repoInternal,a=void 0;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&tr('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),a=new kr(kr.OWNER);else if(r.mockUserToken){var o="string"==typeof r.mockUserToken?r.mockUserToken:Pe(r.mockUserToken,e.app.options.projectId);a=new kr(o)}yc(i,t,n,a)}function xc(e){(e=lt(e))._checkNotDeleted("goOffline"),Js(e._repo)}function Ic(e){var t;(e=lt(e))._checkNotDeleted("goOnline"),(t=e._repo).persistentConnection_&&t.persistentConnection_.resume(Fs)}function Tc(e,t){Xn(e,t)}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Ec={".sv":"timestamp"};function Sc(e){return{".sv":{increment:e}}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Cc=function(){"use strict";function t(n,r){e(l)(this,t),this.committed=n,this.snapshot=r}return e(h)(t,[{key:"toJSON",value:function(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}]),t}();function Ac(e,t,n){var r;if(e=lt(e),As("Reference.transaction",e._path),".length"===e.key||".keys"===e.key)throw"Reference.transaction failed: "+e.key+" is a read-only object.";var i=null===(r=null==n?void 0:n.applyLocally)||void 0===r||r,a=new De,o=Uu(e,(function(){}));return function(e,t,n,r,i,a){Xs(e,"transaction on "+t);var o={path:t,update:n,onComplete:r,status:null,order:Gn(),applyLocally:a,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},s=Zs(e,t,void 0);o.currentInputSnapshot=s;var u=o.update(s.val());if(void 0===u)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{Is("transaction failed: Data returned ",u,o.path),o.status=0;var c,l=cs(e.transactionQueueTree_,t),h=ls(l)||[];h.push(o),hs(l,h),"object"==typeof u&&null!==u&&Be(u,".priority")?(c=Ke(u,".priority"),ue(bs(c),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):c=(Uo(e.serverSyncTree_,t)||Mi.EMPTY_NODE).getPriority().val();var f=js(e),d=Fi(u,c),p=os(d,s,f);o.currentOutputSnapshotRaw=d,o.currentOutputSnapshotResolved=p,o.currentWriteId=Ws(e);var v=Ro(e.serverSyncTree_,t,p,o.currentWriteId,o.applyLocally);Os(e.eventQueue_,t,v),eu(e,e.transactionQueueTree_)}}(e._repo,e._path,t,(function(t,n,r){var i=null;t?a.reject(t):(i=new Iu(r,new xu(e._repo,e._path),Ai),a.resolve(new Cc(n,i)))}),o,i),a.promise}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */si.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},si.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};!function(e){Un(hn),rn(new ht("database",(function(e,t){var n=t.instanceIdentifier;return mc(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),n)}),"PUBLIC").setMultipleInstances(!0)),mn(Mn,Ln,e),mn(Mn,Ln,"esm2017")}();d=o("hKHmD");
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Nc,Rc=function(){"use strict";function t(n,r){var i=this;e(l)(this,t),this._delegate=n,this.firebase=r,tn(n,new ht("app-compat",(function(){return i}),"PUBLIC")),this.container=n.container}return e(h)(t,[{key:"automaticDataCollectionEnabled",get:function(){return this._delegate.automaticDataCollectionEnabled},set:function(e){this._delegate.automaticDataCollectionEnabled=e}},{key:"name",get:function(){return this._delegate.name}},{key:"options",get:function(){return this._delegate.options}},{key:"delete",value:function(){var e=this;return new Promise((function(t){e._delegate.checkDestroyed(),t()})).then((function(){return e.firebase.INTERNAL.removeApp(e.name),vn(e._delegate)}))}},{key:"_getService",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Xt;this._delegate.checkDestroyed();var r=this._delegate.container.getProvider(e);return r.isInitialized()||"EXPLICIT"!==(null===(t=r.getComponent())||void 0===t?void 0:t.instantiationMode)||r.initialize(),r.getImmediate({identifier:n})}},{key:"_removeServiceInstance",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Xt;this._delegate.container.getProvider(e).clearInstance(t)}},{key:"_addComponent",value:function(e){tn(this._delegate,e)}},{key:"_addOrOverwriteComponent",value:function(e){nn(this._delegate,e)}},{key:"toJSON",value:function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}]),t}(),Dc=(Nc={},e(d)(Nc,"no-app","No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()"),e(d)(Nc,"invalid-app-argument","firebase.{$appName}() takes either no argument or a Firebase App instance."),Nc),Pc=new Me("app-compat","Firebase",Dc);var Oc=
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function e(){var t=
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(e){var t={},n={__esModule:!0,initializeApp:function(r){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=s.initializeApp(r,i);if(Be(t,a.name))return t[a.name];var o=new e(a,n);return t[a.name]=o,o},app:r,registerVersion:s.registerVersion,setLogLevel:s.setLogLevel,onLog:s.onLog,apps:null,SDK_VERSION:s.SDK_VERSION,INTERNAL:{registerComponent:function(t){var i=t.name,a=i.replace("-compat","");if(s._registerComponent(t)&&"PUBLIC"===t.type){var o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r();if("function"!=typeof e[a])throw Pc.create("invalid-app-argument",{appName:i});return e[a]()};void 0!==t.serviceProps&&ve(o,t.serviceProps),n[a]=o,e.prototype[a]=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this._getService.bind(this,i).apply(this,t.multipleInstances?n:[])}}return"PUBLIC"===t.type?n[a]:null},removeApp:function(e){delete t[e]},useAsService:function(e,t){return"serverAuth"===t?null:t},modularAPIs:s}};function r(e){if(e=e||s._DEFAULT_ENTRY_NAME,!Be(t,e))throw Pc.create("no-app",{appName:e});return t[e]}return n.default=n,Object.defineProperty(n,"apps",{get:function(){return Object.keys(t).map((function(e){return t[e]}))}}),r.App=e,n}(Rc);return t.INTERNAL=Object.assign(Object.assign({},t.INTERNAL),{createFirebaseNamespace:e,extendNamespace:function(e){ve(t,e)},createSubscribe:$e,ErrorFactory:Me,deepExtend:ve}),t}(),Mc=new xt("@firebase/app-compat");
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
if("object"==typeof self&&self.self===self&&void 0!==self.firebase){Mc.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var Lc=self.firebase.SDK_VERSION;Lc&&Lc.indexOf("LITE")>=0&&Mc.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var Fc=Oc;!
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(e){mn("@firebase/app-compat","0.2.0",e)}();d=o("hKHmD"),d=o("hKHmD");var Uc,qc="@firebase/installations",Vc="0.6.0",jc=1e4,Bc="w:".concat(Vc),Kc="FIS_v2",zc=36e5,Wc=(Uc={},e(d)(Uc,"missing-app-config-values",'Missing App configuration value: "{$valueName}"'),e(d)(Uc,"not-registered","Firebase Installation is not registered."),e(d)(Uc,"installation-not-found","Firebase Installation not found."),e(d)(Uc,"request-failed",'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"'),e(d)(Uc,"app-offline","Could not process request. Application offline."),e(d)(Uc,"delete-pending-registration","Can't delete installation while there is a pending registration request."),Uc),Gc=new Me("installations","Installations",Wc);function Hc(e){return e instanceof Oe&&e.code.includes("request-failed")}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qc(e){var t=e.projectId;return"".concat("https://firebaseinstallations.googleapis.com/v1","/projects/").concat(t,"/installations")}function Yc(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}function Jc(e,t){return Xc.apply(this,arguments)}function Xc(){return(Xc=e(u)(e(_).mark((function t(n,r){var i,a;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.json();case 2:return i=e.sent,a=i.error,e.abrupt("return",Gc.create("request-failed",{requestName:n,serverCode:a.code,serverMessage:a.message,serverStatus:a.status}));case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function $c(e){var t=e.apiKey;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function Zc(e,t){var n=t.refreshToken,r=$c(e);return r.append("Authorization",function(e){return"".concat(Kc," ").concat(e)}(n)),r}function el(e){return tl.apply(this,arguments)}function tl(){return(tl=e(u)(e(_).mark((function t(n){var r;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n();case 2:if(!((r=e.sent).status>=500&&r.status<600)){e.next=5;break}return e.abrupt("return",n());case 5:return e.abrupt("return",r);case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function nl(e,t){return rl.apply(this,arguments)}function rl(){return(rl=
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(_).mark((function t(n,r){var i,a,o,s,u,c,l,h,f,d,p,v;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n.appConfig,a=n.heartbeatServiceProvider,o=r.fid,s=Qc(i),u=$c(i),!(c=a.getImmediate({optional:!0}))){e.next=9;break}return e.next=7,c.getHeartbeatsHeader();case 7:(l=e.sent)&&u.append("x-firebase-client",l);case 9:return h={fid:o,authVersion:Kc,appId:i.appId,sdkVersion:Bc},f={method:"POST",headers:u,body:JSON.stringify(h)},e.next=13,el((function(){return fetch(s,f)}));case 13:if(!(d=e.sent).ok){e.next=22;break}return e.next=17,d.json();case 17:return p=e.sent,v={fid:p.fid||o,registrationStatus:2,refreshToken:p.refreshToken,authToken:Yc(p.authToken)},e.abrupt("return",v);case 22:return e.next=24,Jc("Create Installation",d);case 24:throw e.sent;case 25:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function il(e){return new Promise((function(t){setTimeout(t,e)}))}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var al=/^[cdef][\w-]{21}$/;function ol(){try{var t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;var n=function(t){return(n=t,btoa((r=String).fromCharCode.apply(r,e(p)(n))).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22);var n,r}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t);return al.test(n)?n:""}catch(e){return""}}function sl(e){return"".concat(e.appName,"!").concat(e.appId)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ul=new Map;function cl(e,t){var n=sl(e);ll(n,t),function(e,t){var n=fl();n&&n.postMessage({key:e,fid:t});dl()}(n,t)}function ll(e,t){var n=ul.get(e);if(n){var r=!0,i=!1,a=void 0;try{for(var o,s=n[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){(0,o.value)(t)}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}}}var hl=null;function fl(){return!hl&&"BroadcastChannel"in self&&((hl=new BroadcastChannel("[Firebase] FID Change")).onmessage=function(e){ll(e.data.key,e.data.fid)}),hl}function dl(){0===ul.size&&hl&&(hl.close(),hl=null)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var pl="firebase-installations-store",vl=null;function yl(){return vl||(vl=qt("firebase-installations-database",1,{upgrade:function(e,t){if(0===t)e.createObjectStore(pl)}})),vl}function ml(e,t){return gl.apply(this,arguments)}function gl(){return(gl=e(u)(e(_).mark((function t(n,r){var i,a,o,s,u;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=sl(n),e.next=3,yl();case 3:return a=e.sent,o=a.transaction(pl,"readwrite"),s=o.objectStore(pl),e.next=8,s.get(i);case 8:return u=e.sent,e.next=11,s.put(r,i);case 11:return e.next=13,o.done;case 13:return u&&u.fid===r.fid||cl(n,r.fid),e.abrupt("return",r);case 15:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function kl(e){return _l.apply(this,arguments)}function _l(){return(_l=e(u)(e(_).mark((function t(n){var r,i,a;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=sl(n),e.next=3,yl();case 3:return i=e.sent,a=i.transaction(pl,"readwrite"),e.next=7,a.objectStore(pl).delete(r);case 7:return e.next=9,a.done;case 9:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function wl(e,t){return bl.apply(this,arguments)}function bl(){return(bl=e(u)(e(_).mark((function t(n,r){var i,a,o,s,u,c;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=sl(n),e.next=3,yl();case 3:return a=e.sent,o=a.transaction(pl,"readwrite"),s=o.objectStore(pl),e.next=8,s.get(i);case 8:if(u=e.sent,void 0!==(c=r(u))){e.next=15;break}return e.next=13,s.delete(i);case 13:e.next=17;break;case 15:return e.next=17,s.put(c,i);case 17:return e.next=19,o.done;case 19:return!c||u&&u.fid===c.fid||cl(n,c.fid),e.abrupt("return",c);case 21:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function xl(e){return Il.apply(this,arguments)}function Il(){return(Il=
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(_).mark((function t(n){var r,i;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,wl(n.appConfig,(function(e){var t=Tl(e),i=El(n,t);return r=i.registrationPromise,i.installationEntry}));case 3:if(""!==(i=e.sent).fid){e.next=9;break}return e.next=7,r;case 7:return e.t0=e.sent,e.abrupt("return",{installationEntry:e.t0});case 9:return e.abrupt("return",{installationEntry:i,registrationPromise:r});case 10:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Tl(e){return Rl(e||{fid:ol(),registrationStatus:0})}function El(e,t){if(0===t.registrationStatus){if(!navigator.onLine)return{installationEntry:t,registrationPromise:Promise.reject(Gc.create("app-offline"))};var n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=function(e,t){return Sl.apply(this,arguments)}(e,n);return{installationEntry:n,registrationPromise:r}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:Cl(e)}:{installationEntry:t}}function Sl(){return(Sl=e(u)(e(_).mark((function t(n,r){var i;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,nl(n,r);case 3:return i=e.sent,e.abrupt("return",ml(n.appConfig,i));case 7:if(e.prev=7,e.t0=e.catch(0),!Hc(e.t0)||409!==e.t0.customData.serverCode){e.next=14;break}return e.next=12,kl(n.appConfig);case 12:e.next=16;break;case 14:return e.next=16,ml(n.appConfig,{fid:r.fid,registrationStatus:0});case 16:throw e.t0;case 17:case"end":return e.stop()}}),t,null,[[0,7]])})))).apply(this,arguments)}function Cl(e){return Al.apply(this,arguments)}function Al(){return(Al=e(u)(e(_).mark((function t(n){var r,i,a,o;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Nl(n.appConfig);case 2:r=e.sent;case 3:if(1!==r.registrationStatus){e.next=11;break}return e.next=6,il(100);case 6:return e.next=8,Nl(n.appConfig);case 8:r=e.sent,e.next=3;break;case 11:if(0!==r.registrationStatus){e.next=22;break}return e.next=14,xl(n);case 14:if(i=e.sent,a=i.installationEntry,!(o=i.registrationPromise)){e.next=21;break}return e.abrupt("return",o);case 21:return e.abrupt("return",a);case 22:return e.abrupt("return",r);case 23:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Nl(e){return wl(e,(function(e){if(!e)throw Gc.create("installation-not-found");return Rl(e)}))}function Rl(e){return 1===(t=e).registrationStatus&&t.registrationTime+jc<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}function Dl(e,t){return Pl.apply(this,arguments)}function Pl(){return(Pl=
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(_).mark((function t(n,r){var i,a,o,s,u,c,l,h,f,d,p;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n.appConfig,a=n.heartbeatServiceProvider,o=Ol(i,r),s=Zc(i,r),!(u=a.getImmediate({optional:!0}))){e.next=9;break}return e.next=7,u.getHeartbeatsHeader();case 7:(c=e.sent)&&s.append("x-firebase-client",c);case 9:return l={installation:{sdkVersion:Bc,appId:i.appId}},h={method:"POST",headers:s,body:JSON.stringify(l)},e.next=13,el((function(){return fetch(o,h)}));case 13:if(!(f=e.sent).ok){e.next=22;break}return e.next=17,f.json();case 17:return d=e.sent,p=Yc(d),e.abrupt("return",p);case 22:return e.next=24,Jc("Generate Auth Token",f);case 24:throw e.sent;case 25:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Ol(e,t){var n=t.fid;return"".concat(Qc(e),"/").concat(n,"/authTokens:generate")}function Ml(e){return Ll.apply(this,arguments)}function Ll(){return Ll=
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(_).mark((function t(n){var r,i,a,o,s=arguments;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>1&&void 0!==s[1]&&s[1],e.next=4,wl(n.appConfig,(function(e){if(!Bl(e))throw Gc.create("not-registered");var t=e.authToken;if(!r&&Kl(t))return e;if(1===t.requestStatus)return i=Fl(n,r),e;if(!navigator.onLine)throw Gc.create("app-offline");var a=zl(e);return i=Vl(n,a),a}));case 4:if(a=e.sent,!i){e.next=11;break}return e.next=8,i;case 8:e.t0=e.sent,e.next=12;break;case 11:e.t0=a.authToken;case 12:return o=e.t0,e.abrupt("return",o);case 14:case"end":return e.stop()}}),t)}))),Ll.apply(this,arguments)}function Fl(e,t){return Ul.apply(this,arguments)}function Ul(){return(Ul=e(u)(e(_).mark((function t(n,r){var i,a;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ql(n.appConfig);case 2:i=e.sent;case 3:if(1!==i.authToken.requestStatus){e.next=11;break}return e.next=6,il(100);case 6:return e.next=8,ql(n.appConfig);case 8:i=e.sent,e.next=3;break;case 11:if(0!==(a=i.authToken).requestStatus){e.next=16;break}return e.abrupt("return",Ml(n,r));case 16:return e.abrupt("return",a);case 17:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function ql(e){return wl(e,(function(e){if(!Bl(e))throw Gc.create("not-registered");var t,n=e.authToken;return 1===(t=n).requestStatus&&t.requestTime+jc<Date.now()?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e}))}function Vl(e,t){return jl.apply(this,arguments)}function jl(){return(jl=e(u)(e(_).mark((function t(n,r){var i,a,o;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Dl(n,r);case 3:return i=e.sent,a=Object.assign(Object.assign({},r),{authToken:i}),e.next=7,ml(n.appConfig,a);case 7:return e.abrupt("return",i);case 10:if(e.prev=10,e.t0=e.catch(0),!Hc(e.t0)||401!==e.t0.customData.serverCode&&404!==e.t0.customData.serverCode){e.next=17;break}return e.next=15,kl(n.appConfig);case 15:e.next=20;break;case 17:return o=Object.assign(Object.assign({},r),{authToken:{requestStatus:0}}),e.next=20,ml(n.appConfig,o);case 20:throw e.t0;case 21:case"end":return e.stop()}}),t,null,[[0,10]])})))).apply(this,arguments)}function Bl(e){return void 0!==e&&2===e.registrationStatus}function Kl(e){return 2===e.requestStatus&&!function(e){var t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+zc}(e)}function zl(e){var t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}function Wl(){return(Wl=
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(_).mark((function t(n){var r,i,a,o;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n,e.next=3,xl(r);case 3:return i=e.sent,a=i.installationEntry,(o=i.registrationPromise)?o.catch(console.error):Ml(r).catch(console.error),e.abrupt("return",a.fid);case 8:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Gl(){return Gl=
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(_).mark((function t(n){var r,i,a,o=arguments;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>1&&void 0!==o[1]&&o[1],i=n,e.next=4,Hl(i);case 4:return e.next=6,Ml(i,r);case 6:return a=e.sent,e.abrupt("return",a.token);case 8:case"end":return e.stop()}}),t)}))),Gl.apply(this,arguments)}function Hl(e){return Ql.apply(this,arguments)}function Ql(){return(Ql=e(u)(e(_).mark((function t(n){var r;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,xl(n);case 2:if(!(r=e.sent.registrationPromise)){e.next=6;break}return e.next=6,r;case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Yl(e){return Gc.create("missing-app-config-values",{valueName:e})}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Jl="installations",Xl=function(e){var t=an(e.getProvider("app").getImmediate(),Jl).getImmediate(),n={getId:function(){return function(e){return Wl.apply(this,arguments)}(t)},getToken:function(e){return function(e){return Gl.apply(this,arguments)}(t,e)}};return n};rn(new ht(Jl,(function(e){var t=e.getProvider("app").getImmediate(),n=
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(e){if(!e||!e.options)throw Yl("App Configuration");if(!e.name)throw Yl("App Name");var t=!0,n=!1,r=void 0;try{for(var i,a=["projectId","apiKey","appId"][Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;if(!e.options[o])throw Yl(o)}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,heartbeatServiceProvider:an(t,"heartbeat"),_delete:function(){return Promise.resolve()}}}),"PUBLIC")),rn(new ht("installations-internal",Xl,"PRIVATE")),mn(qc,Vc),mn(qc,Vc,"esm2017");
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var $l,Zl="analytics",eh=6e4,th="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",nh="https://www.googletagmanager.com/gtag/js",rh=new xt("@firebase/analytics");
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function ih(e){return Promise.all(e.map((function(e){return e.catch((function(e){return e}))})))}function ah(e,t){var n=document.createElement("script");n.src="".concat(nh,"?l=").concat(e,"&id=").concat(t),n.async=!0,document.head.appendChild(n)}function oh(e,t,n,r,i,a){return sh.apply(this,arguments)}function sh(){return(sh=e(u)(e(_).mark((function t(n,r,i,a,o,s){var u,c,l;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=a[o],e.prev=1,!u){e.next=7;break}return e.next=5,r[u];case 5:e.next=14;break;case 7:return e.next=9,ih(i);case 9:if(c=e.sent,!(l=c.find((function(e){return e.measurementId===o})))){e.next=14;break}return e.next=14,r[l.appId];case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(1),rh.error(e.t0);case 19:n("config",o,s);case 20:case"end":return e.stop()}}),t,null,[[1,16]])})))).apply(this,arguments)}function uh(e,t,n,r,i){return ch.apply(this,arguments)}function ch(){return(ch=e(u)(e(_).mark((function t(n,r,i,a,o){var s,u,c,l,h,f,d,p,v,y,m;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,s=[],!o||!o.send_to){e.next=38;break}return u=o.send_to,Array.isArray(u)||(u=[u]),e.next=7,ih(i);case 7:c=e.sent,l=!0,h=!1,f=void 0,e.prev=9,d=u[Symbol.iterator]();case 11:if(l=(p=d.next()).done){e.next=24;break}if(v=p.value,y=c.find((function(e){return e.measurementId===v})),!(m=y&&r[y.appId])){e.next=19;break}s.push(m),e.next=21;break;case 19:return s=[],e.abrupt("break",24);case 21:l=!0,e.next=11;break;case 24:e.next=30;break;case 26:e.prev=26,e.t0=e.catch(9),h=!0,f=e.t0;case 30:e.prev=30,e.prev=31,l||null==d.return||d.return();case 33:if(e.prev=33,!h){e.next=36;break}throw f;case 36:return e.finish(33);case 37:return e.finish(30);case 38:return 0===s.length&&(s=Object.values(r)),e.next=41,Promise.all(s);case 41:n("event",a,o||{}),e.next=47;break;case 44:e.prev=44,e.t1=e.catch(0),rh.error(e.t1);case 47:case"end":return e.stop()}}),t,null,[[0,44],[9,26,30,38],[31,,33,37]])})))).apply(this,arguments)}function lh(t,n,r,i,a){var o=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];window[i].push(arguments)};return window[a]&&"function"==typeof window[a]&&(o=window[a]),window[a]=function(t,n,r,i){function a(){return(a=e(u)(e(_).mark((function a(o,s,u){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,"event"!==o){e.next=6;break}return e.next=4,uh(t,n,r,s,u);case 4:e.next=12;break;case 6:if("config"!==o){e.next=11;break}return e.next=9,oh(t,n,r,i,s,u);case 9:e.next=12;break;case 11:"consent"===o?t("consent","update",u):t("set",s);case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),rh.error(e.t0);case 17:case"end":return e.stop()}}),a,null,[[0,14]])})))).apply(this,arguments)}return function(e,t,n){return a.apply(this,arguments)}}(o,t,n,r),{gtagCore:o,wrappedGtag:window[a]}}function hh(e){var t=window.document.getElementsByTagName("script"),n=!0,r=!1,i=void 0;try{for(var a,o=Object.values(t)[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;if(s.src&&s.src.includes(nh)&&s.src.includes(e))return s}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return null}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var fh=($l={},e(d)($l,"already-exists","A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId."),e(d)($l,"already-initialized","initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance."),e(d)($l,"already-initialized-settings","Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect."),e(d)($l,"interop-component-reg-failed","Firebase Analytics Interop Component failed to instantiate: {$reason}"),e(d)($l,"invalid-analytics-context","Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}"),e(d)($l,"indexeddb-unavailable","IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}"),e(d)($l,"fetch-throttle","The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}."),e(d)($l,"config-fetch-failed","Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}"),e(d)($l,"no-api-key",'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.'),e(d)($l,"no-app-id",'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'),$l),dh=new Me("analytics","Analytics",fh),ph=function(){"use strict";function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;e(l)(this,t),this.throttleMetadata=n,this.intervalMillis=r}return e(h)(t,[{key:"getThrottleMetadata",value:function(e){return this.throttleMetadata[e]}},{key:"setThrottleMetadata",value:function(e,t){this.throttleMetadata[e]=t}},{key:"deleteThrottleMetadata",value:function(e){delete this.throttleMetadata[e]}}]),t}(),vh=new ph;function yh(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}function mh(e){return gh.apply(this,arguments)}function gh(){return(gh=e(u)(e(_).mark((function t(n){var r,i,a,o,s,u,c,l;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.appId,a=n.apiKey,o={method:"GET",headers:yh(a)},s=th.replace("{app-id}",i),e.next=6,fetch(s,o);case 6:if(200===(u=e.sent).status||304===u.status){e.next=19;break}return c="",e.prev=9,e.next=12,u.json();case 12:l=e.sent,(null===(r=l.error)||void 0===r?void 0:r.message)&&(c=l.error.message),e.next=18;break;case 16:e.prev=16,e.t0=e.catch(9);case 18:throw dh.create("config-fetch-failed",{httpStatus:u.status,responseMessage:c});case 19:return e.abrupt("return",u.json());case 20:case"end":return e.stop()}}),t,null,[[9,16]])})))).apply(this,arguments)}function kh(e){return _h.apply(this,arguments)}function _h(){return _h=e(u)(e(_).mark((function t(n){var r,i,a,o,s,c,l,h,f=arguments;return e(_).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=f.length>1&&void 0!==f[1]?f[1]:vh,i=f.length>2?f[2]:void 0,a=n.options,o=a.appId,s=a.apiKey,c=a.measurementId,o){t.next=4;break}throw dh.create("no-app-id");case 4:if(s){t.next=8;break}if(!c){t.next=7;break}return t.abrupt("return",{measurementId:c,appId:o});case 7:throw dh.create("no-api-key");case 8:return l=r.getThrottleMetadata(o)||{backoffCount:0,throttleEndTimeMillis:Date.now()},h=new Sh,setTimeout(e(u)(e(_).mark((function t(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:h.abort();case 1:case"end":return e.stop()}}),t)}))),void 0!==i?i:eh),t.abrupt("return",wh({appId:o,apiKey:s,measurementId:c},l,h,r));case 12:case"end":return t.stop()}}),t)}))),_h.apply(this,arguments)}function wh(e,t,n){return bh.apply(this,arguments)}function bh(){return bh=e(u)(e(_).mark((function t(n,r,i){var a,o,s,u,c,l,h,f,d,p,v=arguments;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.throttleEndTimeMillis,o=r.backoffCount,s=v.length>3&&void 0!==v[3]?v[3]:vh,c=n.appId,l=n.measurementId,e.prev=3,e.next=6,xh(i,a);case 6:e.next=14;break;case 8:if(e.prev=8,e.t0=e.catch(3),!l){e.next=13;break}return rh.warn("Timed out fetching this Firebase app's measurement ID from the server."+" Falling back to the measurement ID ".concat(l)+' provided in the "measurementId" field in the local Firebase config. ['.concat(null===e.t0||void 0===e.t0?void 0:e.t0.message,"]")),e.abrupt("return",{appId:c,measurementId:l});case 13:throw e.t0;case 14:return e.prev=14,e.next=17,mh(n);case 17:return h=e.sent,s.deleteThrottleMetadata(c),e.abrupt("return",h);case 22:if(e.prev=22,e.t1=e.catch(14),Ih(f=e.t1)){e.next=33;break}if(s.deleteThrottleMetadata(c),!l){e.next=32;break}return rh.warn("Failed to fetch this Firebase app's measurement ID from the server."+" Falling back to the measurement ID ".concat(l)+' provided in the "measurementId" field in the local Firebase config. ['.concat(null==f?void 0:f.message,"]")),e.abrupt("return",{appId:c,measurementId:l});case 32:throw e.t1;case 33:return d=503===Number(null===(u=null==f?void 0:f.customData)||void 0===u?void 0:u.httpStatus)?ct(o,s.intervalMillis,30):ct(o,s.intervalMillis),p={throttleEndTimeMillis:Date.now()+d,backoffCount:o+1},s.setThrottleMetadata(c,p),rh.debug("Calling attemptFetch again in ".concat(d," millis")),e.abrupt("return",wh(n,p,i,s));case 38:case"end":return e.stop()}}),t,null,[[3,8],[14,22]])}))),bh.apply(this,arguments)}function xh(e,t){return new Promise((function(n,r){var i=Math.max(t-Date.now(),0),a=setTimeout(n,i);e.addEventListener((function(){clearTimeout(a),r(dh.create("fetch-throttle",{throttleEndTimeMillis:t}))}))}))}function Ih(e){if(!(e instanceof Oe&&e.customData))return!1;var t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}var Th,Eh,Sh=function(){"use strict";function t(){e(l)(this,t),this.listeners=[]}return e(h)(t,[{key:"addEventListener",value:function(e){this.listeners.push(e)}},{key:"abort",value:function(){this.listeners.forEach((function(e){return e()}))}}]),t}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ch(){return(Ch=e(u)(e(_).mark((function t(n,r,i,a,o){var s,u;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o||!o.global){e.next=5;break}return n("event",i,a),e.abrupt("return");case 5:return e.next=7,r;case 7:s=e.sent,u=Object.assign(Object.assign({},a),{send_to:s}),n("event",i,u);case 10:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Ah(){return(Ah=e(u)(e(_).mark((function t(n,r,i,a){var o;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a||!a.global){e.next=5;break}return n("set",{screen_name:i}),e.abrupt("return",Promise.resolve());case 5:return e.next=7,r;case 7:o=e.sent,n("config",o,{update:!0,screen_name:i});case 9:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Nh(){return Nh=e(u)(e(_).mark((function t(n,r,i,a){var o;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a||!a.global){e.next=5;break}return n("set",{user_id:i}),e.abrupt("return",Promise.resolve());case 5:return e.next=7,r;case 7:o=e.sent,n("config",o,{update:!0,user_id:i});case 9:case"end":return e.stop()}}),t)}))),Nh.apply(this,arguments)}function Rh(){return(Rh=e(u)(e(_).mark((function t(n,r,i,a){var o,s,u,c,l,h,f,d;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a||!a.global){e.next=23;break}for(o={},s=!0,u=!1,c=void 0,e.prev=3,l=Object.keys(i)[Symbol.iterator]();!(s=(h=l.next()).done);s=!0)f=h.value,o["user_properties.".concat(f)]=i[f];e.next=11;break;case 7:e.prev=7,e.t0=e.catch(3),u=!0,c=e.t0;case 11:e.prev=11,e.prev=12,s||null==l.return||l.return();case 14:if(e.prev=14,!u){e.next=17;break}throw c;case 17:return e.finish(14);case 18:return e.finish(11);case 19:return n("set",o),e.abrupt("return",Promise.resolve());case 23:return e.next=25,r;case 25:d=e.sent,n("config",d,{update:!0,user_properties:i});case 27:case"end":return e.stop()}}),t,null,[[3,7,11,19],[12,,14,18]])})))).apply(this,arguments)}function Dh(){return(Dh=e(u)(e(_).mark((function t(n,r){var i;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n;case 2:i=e.sent,window["ga-disable-".concat(i)]=!r;case 4:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Ph(e){Eh=e}function Oh(e){Th=e}function Mh(){return Lh.apply(this,arguments)}function Lh(){return(Lh=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(_).mark((function t(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(xe()){e.next=5;break}return rh.warn(dh.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),e.abrupt("return",!1);case 5:return e.prev=5,e.next=8,Ie();case 8:e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(5),rh.warn(dh.create("indexeddb-unavailable",{errorInfo:null===e.t0||void 0===e.t0?void 0:e.t0.toString()}).message),e.abrupt("return",!1);case 14:return e.abrupt("return",!0);case 15:case"end":return e.stop()}}),t,null,[[5,10]])})))).apply(this,arguments)}function Fh(){return(Fh=e(u)(e(_).mark((function t(n,r,i,a,o,s,u){var c,l,h,f,d,p,v;return e(_).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(l=kh(n)).then((function(e){i[e.measurementId]=e.appId,n.options.measurementId&&e.measurementId!==n.options.measurementId&&rh.warn("The measurement ID in the local Firebase config (".concat(n.options.measurementId,")")+" does not match the measurement ID fetched from the server (".concat(e.measurementId,").")+" To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.")})).catch((function(e){return rh.error(e)})),r.push(l),h=Mh().then((function(e){return e?a.getId():void 0})),t.t0=e(b),t.next=8,Promise.all([l,h]);case 8:return t.t1=t.sent,f=(0,t.t0)(t.t1,2),d=f[0],p=f[1],hh(s)||ah(s,d.measurementId),Eh&&(o("consent","default",Eh),Ph(void 0)),o("js",new Date),(v=null!==(c=null==u?void 0:u.config)&&void 0!==c?c:{}).origin="firebase",v.update=!0,null!=p&&(v.firebase_id=p),o("config",d.measurementId,v),Th&&(o("set",Th),Oh(void 0)),t.abrupt("return",d.measurementId);case 22:case"end":return t.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Uh,qh,Vh=function(){"use strict";function t(n){e(l)(this,t),this.app=n}return e(h)(t,[{key:"_delete",value:function(){return delete jh[this.app.options.appId],Promise.resolve()}}]),t}(),jh={},Bh=[],Kh={},zh="dataLayer",Wh="gtag",Gh=!1;function Hh(e){if(Gh)throw dh.create("already-initialized");e.dataLayerName&&(zh=e.dataLayerName),e.gtagName&&(Wh=e.gtagName)}function Qh(e,t,n){!function(){var e=[];if(ke()&&e.push("This is a browser extension environment."),Te()||e.push("Cookies are not available."),e.length>0){var t=e.map((function(e,t){return"(".concat(t+1,") ").concat(e)})).join(" "),n=dh.create("invalid-analytics-context",{errorInfo:t});rh.warn(n.message)}}();var r,i,a=e.options.appId;if(!a)throw dh.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw dh.create("no-api-key");rh.warn('The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest'+" measurement ID for this Firebase app. Falling back to the measurement ID ".concat(e.options.measurementId)+' provided in the "measurementId" field in the local Firebase config.')}if(null!=jh[a])throw dh.create("already-exists",{id:a});if(!Gh){r=zh,i=[],Array.isArray(window[r])?i=window[r]:window[r]=i;var o=lh(jh,Bh,Kh,zh,Wh),s=o.wrappedGtag,u=o.gtagCore;qh=s,Uh=u,Gh=!0}return jh[a]=function(e,t,n,r,i,a,o){return Fh.apply(this,arguments)}(e,Bh,Kh,t,Uh,zh,n),new Vh(e)}function Yh(){return Jh.apply(this,arguments)}function Jh(){return(Jh=e(u)(e(_).mark((function t(){var n;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!ke()){e.next=2;break}return e.abrupt("return",!1);case 2:if(Te()){e.next=4;break}return e.abrupt("return",!1);case 4:if(xe()){e.next=6;break}return e.abrupt("return",!1);case 6:return e.prev=6,e.next=9,Ie();case 9:return n=e.sent,e.abrupt("return",n);case 13:return e.prev=13,e.t0=e.catch(6),e.abrupt("return",!1);case 16:case"end":return e.stop()}}),t,null,[[6,13]])})))).apply(this,arguments)}function Xh(e,t,n){e=lt(e),function(e,t,n,r){return Ah.apply(this,arguments)}(qh,jh[e.app.options.appId],t,n).catch((function(e){return rh.error(e)}))}function $h(e,t,n){e=lt(e),function(e,t,n,r){return Nh.apply(this,arguments)}(qh,jh[e.app.options.appId],t,n).catch((function(e){return rh.error(e)}))}function Zh(e,t,n){e=lt(e),function(e,t,n,r){return Rh.apply(this,arguments)}(qh,jh[e.app.options.appId],t,n).catch((function(e){return rh.error(e)}))}function ef(e,t){e=lt(e),function(e,t){return Dh.apply(this,arguments)}(jh[e.app.options.appId],t).catch((function(e){return rh.error(e)}))}function tf(e,t,n,r){e=lt(e),function(e,t,n,r,i){return Ch.apply(this,arguments)}(qh,jh[e.app.options.appId],t,n,r).catch((function(e){return rh.error(e)}))}var nf="@firebase/analytics",rf="0.9.0";rn(new ht(Zl,(function(e,t){var n=t.options;return Qh(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),n)}),"PUBLIC")),rn(new ht("analytics-internal",(function(e){try{var t=e.getProvider(Zl).getImmediate();return{logEvent:function(e,n,r){return tf(t,e,n,r)}}}catch(e){throw dh.create("interop-component-reg-failed",{reason:e})}}),"PRIVATE")),mn(nf,rf),mn(nf,rf,"esm2017");var af,of,sf=function(){"use strict";function t(n,r){e(l)(this,t),this.app=n,this._delegate=r}return e(h)(t,[{key:"logEvent",value:function(e,t,n){tf(this._delegate,e,t,n)}},{key:"setCurrentScreen",value:function(e,t){Xh(this._delegate,e,t)}},{key:"setUserId",value:function(e,t){$h(this._delegate,e,t)}},{key:"setUserProperties",value:function(e,t){Zh(this._delegate,e,t)}},{key:"setAnalyticsCollectionEnabled",value:function(e){ef(this._delegate,e)}}]),t}();(of=af||(af={})).ADD_SHIPPING_INFO="add_shipping_info",of.ADD_PAYMENT_INFO="add_payment_info",of.ADD_TO_CART="add_to_cart",of.ADD_TO_WISHLIST="add_to_wishlist",of.BEGIN_CHECKOUT="begin_checkout",of.CHECKOUT_PROGRESS="checkout_progress",of.EXCEPTION="exception",of.GENERATE_LEAD="generate_lead",of.LOGIN="login",of.PAGE_VIEW="page_view",of.PURCHASE="purchase",of.REFUND="refund",of.REMOVE_FROM_CART="remove_from_cart",of.SCREEN_VIEW="screen_view",of.SEARCH="search",of.SELECT_CONTENT="select_content",of.SELECT_ITEM="select_item",of.SELECT_PROMOTION="select_promotion",of.SET_CHECKOUT_OPTION="set_checkout_option",of.SHARE="share",of.SIGN_UP="sign_up",of.TIMING_COMPLETE="timing_complete",of.VIEW_CART="view_cart",of.VIEW_ITEM="view_item",of.VIEW_ITEM_LIST="view_item_list",of.VIEW_PROMOTION="view_promotion",of.VIEW_SEARCH_RESULTS="view_search_results";
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var uf,cf=function(e){var t=e.getProvider("app-compat").getImmediate(),n=e.getProvider("analytics").getImmediate();return new sf(t,n)};uf={Analytics:sf,settings:Hh,isSupported:Yh,EventName:af},Fc.INTERNAL.registerComponent(new ht("analytics-compat",cf,"PUBLIC").setServiceProps(uf).setMultipleInstances(!0)),Fc.registerVersion("@firebase/analytics-compat","0.2.0");d=o("hKHmD"),d=o("hKHmD");var lf=new Map,hf={activated:!1,tokenObservers:[]},ff={initialized:!1,enabled:!1};function df(e){return lf.get(e)||Object.assign({},hf)}function pf(){return ff}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var vf,yf="https://content-firebaseappcheck.googleapis.com/v1",mf=3e4,gf=96e4,kf=function(){"use strict";function t(n,r,i,a,o){if(e(l)(this,t),this.operation=n,this.retryPolicy=r,this.getWaitDuration=i,this.lowerBound=a,this.upperBound=o,this.pending=null,this.nextErrorWaitInterval=a,a>o)throw new Error("Proactive refresh lower bound greater than upper bound!")}return e(h)(t,[{key:"start",value:function(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch((function(){}))}},{key:"stop",value:function(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}},{key:"isRunning",value:function(){return!!this.pending}},{key:"process",value:function(t){var n=this;return e(u)(e(_).mark((function r(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.stop(),e.prev=1,n.pending=new De,e.next=5,_f(n.getNextRun(t));case 5:return n.pending.resolve(),e.next=8,n.pending.promise;case 8:return n.pending=new De,e.next=11,n.operation();case 11:return n.pending.resolve(),e.next=14,n.pending.promise;case 14:n.process(!0).catch((function(){})),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(1),n.retryPolicy(e.t0)?n.process(!1).catch((function(){})):n.stop();case 20:case"end":return e.stop()}}),r,null,[[1,17]])})))()}},{key:"getNextRun",value:function(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();var t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}]),t}();function _f(e){return new Promise((function(t){setTimeout(t,e)}))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var wf=(vf={},e(d)(vf,"already-initialized","You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance."),e(d)(vf,"use-before-activation","App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services."),e(d)(vf,"fetch-network-error","Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}."),e(d)(vf,"fetch-parse-error","Fetch client could not parse response. Original error: {$originalErrorMessage}."),e(d)(vf,"fetch-status-error","Fetch server returned an HTTP error status. HTTP status: {$httpStatus}."),e(d)(vf,"storage-open","Error thrown when opening storage. Original error: {$originalErrorMessage}."),e(d)(vf,"storage-get","Error thrown when reading from storage. Original error: {$originalErrorMessage}."),e(d)(vf,"storage-set","Error thrown when writing to storage. Original error: {$originalErrorMessage}."),e(d)(vf,"recaptcha-error","ReCAPTCHA error."),e(d)(vf,"throttled","Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"),vf),bf=new Me("appCheck","AppCheck",wf);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function xf(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return t?null===(e=self.grecaptcha)||void 0===e?void 0:e.enterprise:self.grecaptcha}function If(e){if(!df(e).activated)throw bf.create("use-before-activation",{appName:e.name})}function Tf(e){var t=Math.round(e/1e3),n=Math.floor(t/86400),r=Math.floor((t-86400*n)/3600),i=Math.floor((t-86400*n-3600*r)/60),a=t-86400*n-3600*r-60*i,o="";return n&&(o+=Ef(n)+"d:"),r&&(o+=Ef(r)+"h:"),o+=Ef(i)+"m:"+Ef(a)+"s"}function Ef(e){return 0===e?"00":e>=10?e.toString():"0"+e}function Sf(e,t){return Cf.apply(this,arguments)}function Cf(){return(Cf=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(_).mark((function t(n,r){var i,a,o,s,u,c,l,h,f,d,p;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n.url,a=n.body,o={"Content-Type":"application/json"},!(s=r.getImmediate({optional:!0}))){e.next=8;break}return e.next=6,s.getHeartbeatsHeader();case 6:(u=e.sent)&&(o["X-Firebase-Client"]=u);case 8:return c={method:"POST",body:JSON.stringify(a),headers:o},e.prev=10,e.next=13,fetch(i,c);case 13:l=e.sent,e.next=19;break;case 16:throw e.prev=16,e.t0=e.catch(10),bf.create("fetch-network-error",{originalErrorMessage:null===e.t0||void 0===e.t0?void 0:e.t0.message});case 19:if(200===l.status){e.next=21;break}throw bf.create("fetch-status-error",{httpStatus:l.status});case 21:return e.prev=22,e.next=25,l.json();case 25:h=e.sent,e.next=31;break;case 28:throw e.prev=28,e.t1=e.catch(22),bf.create("fetch-parse-error",{originalErrorMessage:null===e.t1||void 0===e.t1?void 0:e.t1.message});case 31:if((f=h.ttl.match(/^([\d.]+)(s)$/))&&f[2]&&!isNaN(Number(f[1]))){e.next=34;break}throw bf.create("fetch-parse-error",{originalErrorMessage:"ttl field (timeToLive) is not in standard Protobuf Duration "+"format: ".concat(h.ttl)});case 34:return d=1e3*Number(f[1]),p=Date.now(),e.abrupt("return",{token:h.token,expireTimeMillis:p+d,issuedAtTimeMillis:p});case 37:case"end":return e.stop()}}),t,null,[[10,16],[22,28]])})))).apply(this,arguments)}function Af(e,t){var n=e.options,r=n.projectId,i=n.appId,a=n.apiKey;return{url:"".concat(yf,"/projects/").concat(r,"/apps/").concat(i,":").concat("exchangeDebugToken","?key=").concat(a),body:{debug_token:t}}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Nf="firebase-app-check-store",Rf="debug-token",Df=null;function Pf(){return Df||(Df=new Promise((function(e,t){try{var n=indexedDB.open("firebase-app-check-database",1);n.onsuccess=function(t){e(t.target.result)},n.onerror=function(e){var n;t(bf.create("storage-open",{originalErrorMessage:null===(n=e.target.error)||void 0===n?void 0:n.message}))},n.onupgradeneeded=function(e){var t=e.target.result;if(0===e.oldVersion)t.createObjectStore(Nf,{keyPath:"compositeKey"})}}catch(e){t(bf.create("storage-open",{originalErrorMessage:null==e?void 0:e.message}))}})))}function Of(e){return qf(jf(e))}function Mf(e){return Ff(Rf,e)}function Lf(){return qf(Rf)}function Ff(e,t){return Uf.apply(this,arguments)}function Uf(){return(Uf=e(u)(e(_).mark((function t(n,r){var i,a,o,s;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Pf();case 2:return i=e.sent,a=i.transaction(Nf,"readwrite"),o=a.objectStore(Nf),s=o.put({compositeKey:n,value:r}),e.abrupt("return",new Promise((function(e,t){s.onsuccess=function(t){e()},a.onerror=function(e){var n;t(bf.create("storage-set",{originalErrorMessage:null===(n=e.target.error)||void 0===n?void 0:n.message}))}})));case 7:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function qf(e){return Vf.apply(this,arguments)}function Vf(){return(Vf=e(u)(e(_).mark((function t(n){var r,i,a,o;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Pf();case 2:return r=e.sent,i=r.transaction(Nf,"readonly"),a=i.objectStore(Nf),o=a.get(n),e.abrupt("return",new Promise((function(e,t){o.onsuccess=function(t){var n=t.target.result;e(n?n.value:void 0)},i.onerror=function(e){var n;t(bf.create("storage-get",{originalErrorMessage:null===(n=e.target.error)||void 0===n?void 0:n.message}))}})));case 7:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function jf(e){return"".concat(e.options.appId,"-").concat(e.name)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Bf=new xt("@firebase/app-check");function Kf(){return(Kf=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(_).mark((function t(n){var r;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!xe()){e.next=12;break}return r=void 0,e.prev=2,e.next=5,Of(n);case 5:r=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),Bf.warn("Failed to read token from IndexedDB. Error: ".concat(e.t0));case 11:return e.abrupt("return",r);case 12:return e.abrupt("return",void 0);case 13:case"end":return e.stop()}}),t,null,[[2,8]])})))).apply(this,arguments)}function zf(e,t){return xe()?function(e,t){return Ff(jf(e),t)}(e,t).catch((function(e){Bf.warn("Failed to write token to IndexedDB. Error: ".concat(e))})):Promise.resolve()}function Wf(){return(Wf=e(u)(e(_).mark((function t(){var n,r;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=void 0,e.prev=1,e.next=4,Lf();case 4:n=e.sent,e.next=9;break;case 7:e.prev=7,e.t0=e.catch(1);case 9:if(n){e.next=15;break}return Mf(r=st()).catch((function(e){return Bf.warn("Failed to persist debug token to IndexedDB. Error: ".concat(e))})),e.abrupt("return",r);case 15:return e.abrupt("return",n);case 16:case"end":return e.stop()}}),t,null,[[1,7]])})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gf(){return pf().enabled}function Hf(){return Qf.apply(this,arguments)}function Qf(){return(Qf=e(u)(e(_).mark((function t(){var n;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=pf()).enabled||!n.token){e.next=5;break}return e.abrupt("return",n.token.promise);case 5:throw Error("\n            Can't get debug token in production mode.\n        ");case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Yf(){var e=Ee(),t=pf();if(t.initialized=!0,"string"==typeof e.FIREBASE_APPCHECK_DEBUG_TOKEN||!0===e.FIREBASE_APPCHECK_DEBUG_TOKEN){t.enabled=!0;var n=new De;t.token=n,"string"==typeof e.FIREBASE_APPCHECK_DEBUG_TOKEN?n.resolve(e.FIREBASE_APPCHECK_DEBUG_TOKEN):n.resolve(function(){return Wf.apply(this,arguments)}())}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Jf={error:"UNKNOWN_ERROR"};function Xf(e){return $f.apply(this,arguments)}function $f(){return $f=e(u)(e(_).mark((function t(n){var r,i,a,o,s,u,c,l,h,f=arguments;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=f.length>1&&void 0!==f[1]&&f[1],If(i=n.app),a=df(i),o=a.token,s=void 0,o&&!rd(o)&&(a.token=void 0,o=void 0),o){e.next=18;break}return e.next=10,a.cachedTokenPromise;case 10:if(!(u=e.sent)){e.next=18;break}if(!rd(u)){e.next=16;break}o=u,e.next=18;break;case 16:return e.next=18,zf(i,void 0);case 18:if(r||!o||!rd(o)){e.next=20;break}return e.abrupt("return",{token:o.token});case 20:if(c=!1,!Gf()){e.next=40;break}if(a.exchangeTokenPromise){e.next=33;break}return e.t0=Sf,e.t1=Af,e.t2=i,e.next=28,Hf();case 28:e.t3=e.sent,e.t4=(0,e.t1)(e.t2,e.t3),e.t5=n.heartbeatServiceProvider,a.exchangeTokenPromise=(0,e.t0)(e.t4,e.t5).finally((function(){a.exchangeTokenPromise=void 0})),c=!0;case 33:return e.next=35,a.exchangeTokenPromise;case 35:return l=e.sent,e.next=38,zf(i,l);case 38:return a.token=l,e.abrupt("return",{token:l.token});case 40:return e.prev=40,a.exchangeTokenPromise||(a.exchangeTokenPromise=a.provider.getToken().finally((function(){a.exchangeTokenPromise=void 0})),c=!0),e.next=44,df(i).exchangeTokenPromise;case 44:o=e.sent,e.next=51;break;case 47:e.prev=47,e.t6=e.catch(40),"appCheck/throttled"===e.t6.code?Bf.warn(e.t6.message):Bf.error(e.t6),s=e.t6;case 51:if(o){e.next=56;break}h=id(s),e.next=64;break;case 56:if(!s){e.next=60;break}h=rd(o)?{token:o.token,internalError:s}:id(s),e.next=64;break;case 60:return h={token:o.token},a.token=o,e.next=64,zf(i,o);case 64:return c&&nd(i,h),e.abrupt("return",h);case 66:case"end":return e.stop()}}),t,null,[[40,47]])}))),$f.apply(this,arguments)}function Zf(t,n,r,i){var a=df(t.app),o={next:r,error:i,type:n};if(a.tokenObservers=e(p)(a.tokenObservers).concat([o]),a.token&&rd(a.token)){var s=a.token;Promise.resolve().then((function(){r({token:s.token}),td(t)})).catch((function(){}))}a.cachedTokenPromise.then((function(){return td(t)}))}function ed(e,t){var n=df(e),r=n.tokenObservers.filter((function(e){return e.next!==t}));0===r.length&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),n.tokenObservers=r}function td(t){var n=df(t.app),r=n.tokenRefresher;r||(r=function(t){var n=t.app;return new kf(e(u)(e(_).mark((function r(){var i;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(df(n).token){e.next=8;break}return e.next=5,Xf(t);case 5:i=e.sent,e.next=11;break;case 8:return e.next=10,Xf(t,!0);case 10:i=e.sent;case 11:if(!i.error){e.next=13;break}throw i.error;case 13:if(!i.internalError){e.next=15;break}throw i.internalError;case 15:case"end":return e.stop()}}),r)}))),(function(){return!0}),(function(){var e=df(n);if(e.token){var t=e.token.issuedAtTimeMillis+.5*(e.token.expireTimeMillis-e.token.issuedAtTimeMillis)+3e5,r=e.token.expireTimeMillis-3e5;return t=Math.min(t,r),Math.max(0,t-Date.now())}return 0}),mf,gf)}(t),n.tokenRefresher=r),!r.isRunning()&&n.isTokenAutoRefreshEnabled&&r.start()}function nd(e,t){var n=df(e).tokenObservers,r=!0,i=!1,a=void 0;try{for(var o,s=n[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;try{"EXTERNAL"===u.type&&null!=t.error?u.error(t.error):u.next(t)}catch(e){}}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}}function rd(e){return e.expireTimeMillis-Date.now()>0}function id(e){return{token:(t=Jf,he.encodeString(JSON.stringify(t),!1)),error:e};var t}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ad=function(){"use strict";function t(n,r){e(l)(this,t),this.app=n,this.heartbeatServiceProvider=r}return e(h)(t,[{key:"_delete",value:function(){var e=df(this.app).tokenObservers,t=!0,n=!1,r=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;ed(this.app,o.next)}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return Promise.resolve()}}]),t}();var od="https://www.google.com/recaptcha/api.js",sd="https://www.google.com/recaptcha/enterprise.js";function ud(e,t){var n=new De;df(e).reCAPTCHAState={initialized:n};var r,i,a=hd(e),o=xf(!1);return o?ld(e,t,o,a,n):(r=function(){var r=xf(!1);if(!r)throw new Error("no recaptcha");ld(e,t,r,a,n)},(i=document.createElement("script")).src=od,i.onload=r,document.head.appendChild(i)),n.promise}function cd(e,t){var n=new De;df(e).reCAPTCHAState={initialized:n};var r,i,a=hd(e),o=xf(!0);return o?ld(e,t,o,a,n):(r=function(){var r=xf(!0);if(!r)throw new Error("no recaptcha");ld(e,t,r,a,n)},(i=document.createElement("script")).src=sd,i.onload=r,document.head.appendChild(i)),n.promise}function ld(e,t,n,r,i){n.ready((function(){!function(e,t,n,r){var i=n.render(r,{sitekey:t,size:"invisible"}),a=df(e);a.reCAPTCHAState=Object.assign(Object.assign({},a.reCAPTCHAState),{widgetId:i})}(e,t,n,r),i.resolve(n)}))}function hd(e){var t="fire_app_check_".concat(e.name),n=document.createElement("div");return n.id=t,n.style.display="none",document.body.appendChild(n),t}function fd(e){return dd.apply(this,arguments)}function dd(){return(dd=e(u)(e(_).mark((function t(n){var r,i;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return If(n),r=df(n).reCAPTCHAState,e.next=4,r.initialized.promise;case 4:return i=e.sent,e.abrupt("return",new Promise((function(e,t){var r=df(n).reCAPTCHAState;i.ready((function(){e(i.execute(r.widgetId,{action:"fire_app_check"}))}))})));case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var pd=function(){"use strict";function t(n){e(l)(this,t),this._siteKey=n,this._throttleData=null}return e(h)(t,[{key:"getToken",value:function(){var t=this;return e(u)(e(_).mark((function n(){var r,i,a,o;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return gd(t._throttleData),e.next=4,fd(t._app).catch((function(e){throw bf.create("recaptcha-error")}));case 4:return a=e.sent,e.prev=6,e.next=9,Sf((n=t._app,s=a,u=void 0,c=void 0,l=void 0,h=void 0,u=n.options,c=u.projectId,l=u.appId,h=u.apiKey,{url:"".concat(yf,"/projects/").concat(c,"/apps/").concat(l,":").concat("exchangeRecaptchaV3Token","?key=").concat(h),body:{recaptcha_v3_token:s}}),t._heartbeatServiceProvider);case 9:o=e.sent,e.next=20;break;case 12:if(e.prev=12,e.t0=e.catch(6),!(null===(r=e.t0.code)||void 0===r?void 0:r.includes("fetch-status-error"))){e.next=19;break}throw t._throttleData=md(Number(null===(i=e.t0.customData)||void 0===i?void 0:i.httpStatus),t._throttleData),bf.create("throttled",{time:Tf(t._throttleData.allowRequestsAfter-Date.now()),httpStatus:t._throttleData.httpStatus});case 19:throw e.t0;case 20:return t._throttleData=null,e.abrupt("return",o);case 22:case"end":return e.stop()}var n,s,u,c,l,h}),n,null,[[6,12]])})))()}},{key:"initialize",value:function(e){this._app=e,this._heartbeatServiceProvider=an(e,"heartbeat"),ud(e,this._siteKey).catch((function(){}))}},{key:"isEqual",value:function(e){return e instanceof t&&this._siteKey===e._siteKey}}]),t}(),vd=function(){"use strict";function t(n){e(l)(this,t),this._siteKey=n,this._throttleData=null}return e(h)(t,[{key:"getToken",value:function(){var t=this;return e(u)(e(_).mark((function n(){var r,i,a,o;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return gd(t._throttleData),e.next=4,fd(t._app).catch((function(e){throw bf.create("recaptcha-error")}));case 4:return a=e.sent,e.prev=6,e.next=9,Sf((n=t._app,s=a,u=void 0,c=void 0,l=void 0,h=void 0,u=n.options,c=u.projectId,l=u.appId,h=u.apiKey,{url:"".concat(yf,"/projects/").concat(c,"/apps/").concat(l,":").concat("exchangeRecaptchaEnterpriseToken","?key=").concat(h),body:{recaptcha_enterprise_token:s}}),t._heartbeatServiceProvider);case 9:o=e.sent,e.next=20;break;case 12:if(e.prev=12,e.t0=e.catch(6),!(null===(r=e.t0.code)||void 0===r?void 0:r.includes("fetch-status-error"))){e.next=19;break}throw t._throttleData=md(Number(null===(i=e.t0.customData)||void 0===i?void 0:i.httpStatus),t._throttleData),bf.create("throttled",{time:Tf(t._throttleData.allowRequestsAfter-Date.now()),httpStatus:t._throttleData.httpStatus});case 19:throw e.t0;case 20:return t._throttleData=null,e.abrupt("return",o);case 22:case"end":return e.stop()}var n,s,u,c,l,h}),n,null,[[6,12]])})))()}},{key:"initialize",value:function(e){this._app=e,this._heartbeatServiceProvider=an(e,"heartbeat"),cd(e,this._siteKey).catch((function(){}))}},{key:"isEqual",value:function(e){return e instanceof t&&this._siteKey===e._siteKey}}]),t}(),yd=function(){"use strict";function t(n){e(l)(this,t),this._customProviderOptions=n}return e(h)(t,[{key:"getToken",value:function(){var t=this;return e(u)(e(_).mark((function n(){var r,i,a;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._customProviderOptions.getToken();case 2:return r=e.sent,n=r.token,o=void 0,o=Ve(n).claims,i="object"==typeof o&&o.hasOwnProperty("iat")?o.iat:null,a=null!==i&&i<Date.now()&&i>0?1e3*i:Date.now(),e.abrupt("return",Object.assign(Object.assign({},r),{issuedAtTimeMillis:a}));case 6:case"end":return e.stop()}var n,o}),n)})))()}},{key:"initialize",value:function(e){this._app=e}},{key:"isEqual",value:function(e){return e instanceof t&&this._customProviderOptions.getToken.toString()===e._customProviderOptions.getToken.toString()}}]),t}();function md(e,t){if(404===e||403===e)return{backoffCount:1,allowRequestsAfter:Date.now()+864e5,httpStatus:e};var n=t?t.backoffCount:0,r=ct(n,1e3,2);return{backoffCount:n+1,allowRequestsAfter:Date.now()+r,httpStatus:e}}function gd(e){if(e&&Date.now()-e.allowRequestsAfter<=0)throw bf.create("throttled",{time:Tf(e.allowRequestsAfter-Date.now()),httpStatus:e.httpStatus})}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kd(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:dn(),t=arguments.length>1?arguments[1]:void 0,n=an(e=lt(e),"app-check");if(pf().initialized||Yf(),Gf()&&Hf().then((function(e){return console.log("App Check debug token: ".concat(e,". You will need to add it to your app's App Check settings in the Firebase console for it to work."))})),n.isInitialized()){var r=n.getImmediate(),i=n.getOptions();if(i.isTokenAutoRefreshEnabled===t.isTokenAutoRefreshEnabled&&i.provider.isEqual(t.provider))return r;throw bf.create("already-initialized",{appName:e.name})}var a=n.initialize({options:t});return _d(e,t.provider,t.isTokenAutoRefreshEnabled),df(e).isTokenAutoRefreshEnabled&&Zf(a,"INTERNAL",(function(){})),a}function _d(e,t,n){var r=function(e,t){return lf.set(e,t),lf.get(e)}(e,Object.assign({},hf));r.activated=!0,r.provider=t,r.cachedTokenPromise=function(e){return Kf.apply(this,arguments)}(e).then((function(t){return t&&rd(t)&&(r.token=t,nd(e,{token:t.token})),t})),r.isTokenAutoRefreshEnabled=void 0===n?e.automaticDataCollectionEnabled:n,r.provider.initialize(e)}function wd(e,t){var n=df(e.app);n.tokenRefresher&&(!0===t?n.tokenRefresher.start():n.tokenRefresher.stop()),n.isTokenAutoRefreshEnabled=t}function bd(e,t){return xd.apply(this,arguments)}function xd(){return(xd=e(u)(e(_).mark((function t(n,r){var i;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Xf(n,r);case 2:if(!(i=e.sent).error){e.next=5;break}throw i.error;case 5:return e.abrupt("return",{token:i.token});case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Id(e,t,n,r){var i=function(){},a=function(){};return i=null!=t.next?t.next.bind(t):t,null!=t.error?a=t.error.bind(t):n&&(a=n),Zf(e,"EXTERNAL",i,a),function(){return ed(e.app,i)}}var Td="app-check-internal";rn(new ht("app-check",(function(e){return function(e,t){return new ad(e,t)}(e.getProvider("app").getImmediate(),e.getProvider("heartbeat"))}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((function(e,t,n){e.getProvider(Td).initialize()}))),rn(new ht(Td,(function(e){return function(e){return{getToken:function(t){return Xf(e,t)},addTokenListener:function(t){return Zf(e,"INTERNAL",t)},removeTokenListener:function(t){return ed(e.app,t)}}}(e.getProvider("app-check").getImmediate())}),"PUBLIC").setInstantiationMode("EXPLICIT")),mn("@firebase/app-check","0.6.0");var Ed=e(d)({},"use-before-activation","App Check is being used before activate() is called for FirebaseApp {$appName}. Call activate() before instantiating other Firebase services."),Sd=new Me("appCheck","AppCheck",Ed),Cd=function(){"use strict";function t(n){e(l)(this,t),this.app=n}return e(h)(t,[{key:"activate",value:function(e,t){var n;n="string"==typeof e?new pd(e):e instanceof vd||e instanceof pd||e instanceof yd?e:new yd({getToken:e.getToken}),this._delegate=kd(this.app,{provider:n,isTokenAutoRefreshEnabled:t})}},{key:"setTokenAutoRefreshEnabled",value:function(e){if(!this._delegate)throw Sd.create("use-before-activation",{appName:this.app.name});wd(this._delegate,e)}},{key:"getToken",value:function(e){if(!this._delegate)throw Sd.create("use-before-activation",{appName:this.app.name});return bd(this._delegate,e)}},{key:"onTokenChanged",value:function(e,t,n){if(!this._delegate)throw Sd.create("use-before-activation",{appName:this.app.name});return Id(this._delegate,e,t)}}]),t}(),Ad=function(e){var t=e.getProvider("app-compat").getImmediate();return new Cd(t)};Fc.INTERNAL.registerComponent(new ht("appCheck-compat",Ad,"PUBLIC").setServiceProps({ReCaptchaEnterpriseProvider:vd,ReCaptchaV3Provider:pd,CustomProvider:yd})),Fc.registerVersion("@firebase/app-check-compat","0.3.0");var Nd={};Object.defineProperty(Nd,"__esModule",{value:!0}),Nd.default=function(e,t,n){return Dd(e,t,n)};var Rd=function(e){return e&&e.__esModule?e:{default:e}}(o("2mz0K"));function Dd(e,t,n){return(Dd="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=Rd.default(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n||e):i.value}})(e,t,n)}var Pd=o("fVNic"),Od={};Object.defineProperty(Od,"__esModule",{value:!0}),Od.default=function(e){return Md.default(e)||Ld.default(e)||Ud.default(e,i)||Fd.default()};var Md=qd(o("8slrw")),Ld=qd(o("7AJDX")),Fd=qd(o("ifqQW")),Ud=qd(o("auk6i"));function qd(e){return e&&e.__esModule?e:{default:e}}C=o("ds8z5"),d=o("hKHmD"),Pd=o("fVNic");function Vd(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}Object.create;Object.create;
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var jd="facebook.com",Bd="github.com",Kd="google.com",zd="password",Wd="twitter.com",Gd="EMAIL_SIGNIN",Hd="PASSWORD_RESET",Qd="RECOVER_EMAIL",Yd="REVERT_SECOND_FACTOR_ADDITION",Jd="VERIFY_AND_CHANGE_EMAIL",Xd="VERIFY_EMAIL";function $d(){return e(d)({},"dependent-sdk-initialized-before-auth","Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.")}var Zd=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(){var t;return t={},e(d)(t,"admin-restricted-operation","This operation is restricted to administrators only."),e(d)(t,"argument-error",""),e(d)(t,"app-not-authorized","This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console."),e(d)(t,"app-not-installed","The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device."),e(d)(t,"captcha-check-failed","The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains."),e(d)(t,"code-expired","The SMS code has expired. Please re-send the verification code to try again."),e(d)(t,"cordova-not-ready","Cordova framework is not ready."),e(d)(t,"cors-unsupported","This browser is not supported."),e(d)(t,"credential-already-in-use","This credential is already associated with a different user account."),e(d)(t,"custom-token-mismatch","The custom token corresponds to a different audience."),e(d)(t,"requires-recent-login","This operation is sensitive and requires recent authentication. Log in again before retrying this request."),e(d)(t,"dependent-sdk-initialized-before-auth","Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."),e(d)(t,"dynamic-link-not-activated","Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions."),e(d)(t,"email-change-needs-verification","Multi-factor users must always have a verified email."),e(d)(t,"email-already-in-use","The email address is already in use by another account."),e(d)(t,"emulator-config-failed",'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.'),e(d)(t,"expired-action-code","The action code has expired."),e(d)(t,"cancelled-popup-request","This operation has been cancelled due to another conflicting popup being opened."),e(d)(t,"internal-error","An internal AuthError has occurred."),e(d)(t,"invalid-app-credential","The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired."),e(d)(t,"invalid-app-id","The mobile app identifier is not registed for the current project."),e(d)(t,"invalid-user-token","This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key."),e(d)(t,"invalid-auth-event","An internal AuthError has occurred."),e(d)(t,"invalid-verification-code","The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user."),e(d)(t,"invalid-continue-uri","The continue URL provided in the request is invalid."),e(d)(t,"invalid-cordova-configuration","The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme."),e(d)(t,"invalid-custom-token","The custom token format is incorrect. Please check the documentation."),e(d)(t,"invalid-dynamic-link-domain","The provided dynamic link domain is not configured or authorized for the current project."),e(d)(t,"invalid-email","The email address is badly formatted."),e(d)(t,"invalid-emulator-scheme","Emulator URL must start with a valid scheme (http:// or https://)."),e(d)(t,"invalid-api-key","Your API key is invalid, please check you have copied it correctly."),e(d)(t,"invalid-cert-hash","The SHA-1 certificate hash provided is invalid."),e(d)(t,"invalid-credential","The supplied auth credential is malformed or has expired."),e(d)(t,"invalid-message-payload","The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console."),e(d)(t,"invalid-multi-factor-session","The request does not contain a valid proof of first factor successful sign-in."),e(d)(t,"invalid-oauth-provider","EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers."),e(d)(t,"invalid-oauth-client-id","The OAuth client ID provided is either invalid or does not match the specified API key."),e(d)(t,"unauthorized-domain","This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console."),e(d)(t,"invalid-action-code","The action code is invalid. This can happen if the code is malformed, expired, or has already been used."),e(d)(t,"wrong-password","The password is invalid or the user does not have a password."),e(d)(t,"invalid-persistence-type","The specified persistence type is invalid. It can only be local, session or none."),e(d)(t,"invalid-phone-number","The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code]."),e(d)(t,"invalid-provider-id","The specified provider ID is invalid."),e(d)(t,"invalid-recipient-email","The email corresponding to this action failed to send as the provided recipient email address is invalid."),e(d)(t,"invalid-sender","The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console."),e(d)(t,"invalid-verification-id","The verification ID used to create the phone auth credential is invalid."),e(d)(t,"invalid-tenant-id","The Auth instance's tenant ID is invalid."),e(d)(t,"login-blocked","Login blocked by user-provided method: {$originalMessage}"),e(d)(t,"missing-android-pkg-name","An Android Package Name must be provided if the Android App is required to be installed."),e(d)(t,"auth-domain-config-required","Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console."),e(d)(t,"missing-app-credential","The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided."),e(d)(t,"missing-verification-code","The phone auth credential was created with an empty SMS verification code."),e(d)(t,"missing-continue-uri","A continue URL must be provided in the request."),e(d)(t,"missing-iframe-start","An internal AuthError has occurred."),e(d)(t,"missing-ios-bundle-id","An iOS Bundle ID must be provided if an App Store ID is provided."),e(d)(t,"missing-or-invalid-nonce","The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload."),e(d)(t,"missing-multi-factor-info","No second factor identifier is provided."),e(d)(t,"missing-multi-factor-session","The request is missing proof of first factor successful sign-in."),e(d)(t,"missing-phone-number","To send verification codes, provide a phone number for the recipient."),e(d)(t,"missing-verification-id","The phone auth credential was created with an empty verification ID."),e(d)(t,"app-deleted","This instance of FirebaseApp has been deleted."),e(d)(t,"multi-factor-info-not-found","The user does not have a second factor matching the identifier provided."),e(d)(t,"multi-factor-auth-required","Proof of ownership of a second factor is required to complete sign-in."),e(d)(t,"account-exists-with-different-credential","An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address."),e(d)(t,"network-request-failed","A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred."),e(d)(t,"no-auth-event","An internal AuthError has occurred."),e(d)(t,"no-such-provider","User was not linked to an account with the given provider."),e(d)(t,"null-user","A null user object was provided as the argument for an operation which requires a non-null user object."),e(d)(t,"operation-not-allowed","The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section."),e(d)(t,"operation-not-supported-in-this-environment",'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.'),e(d)(t,"popup-blocked","Unable to establish a connection with the popup. It may have been blocked by the browser."),e(d)(t,"popup-closed-by-user","The popup has been closed by the user before finalizing the operation."),e(d)(t,"provider-already-linked","User can only be linked to one identity for the given provider."),e(d)(t,"quota-exceeded","The project's quota for this operation has been exceeded."),e(d)(t,"redirect-cancelled-by-user","The redirect operation has been cancelled by the user before finalizing."),e(d)(t,"redirect-operation-pending","A redirect sign-in operation is already pending."),e(d)(t,"rejected-credential","The request contains malformed or mismatching credentials."),e(d)(t,"second-factor-already-in-use","The second factor is already enrolled on this account."),e(d)(t,"maximum-second-factor-count-exceeded","The maximum allowed number of second factors on a user has been exceeded."),e(d)(t,"tenant-id-mismatch","The provided tenant ID does not match the Auth instance's tenant ID"),e(d)(t,"timeout","The operation has timed out."),e(d)(t,"user-token-expired","The user's credential is no longer valid. The user must sign in again."),e(d)(t,"too-many-requests","We have blocked all requests from this device due to unusual activity. Try again later."),e(d)(t,"unauthorized-continue-uri","The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console."),e(d)(t,"unsupported-first-factor","Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor."),e(d)(t,"unsupported-persistence-type","The current environment does not support the specified persistence type."),e(d)(t,"unsupported-tenant-operation","This operation is not supported in a multi-tenant context."),e(d)(t,"unverified-email","The operation requires a verified email."),e(d)(t,"user-cancelled","The user did not grant your application the permissions it requested."),e(d)(t,"user-not-found","There is no user record corresponding to this identifier. The user may have been deleted."),e(d)(t,"user-disabled","The user account has been disabled by an administrator."),e(d)(t,"user-mismatch","The supplied credentials do not correspond to the previously signed in user."),e(d)(t,"user-signed-out",""),e(d)(t,"weak-password","The password must be 6 characters long or more."),e(d)(t,"web-storage-unsupported","This browser is not supported or 3rd party cookies and data may be disabled."),e(d)(t,"already-initialized","initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."),t},ep=$d,tp=new Me("auth","Firebase",$d()),np=new xt("@firebase/auth");function rp(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var a;np.logLevel<=pt.ERROR&&(a=np).error.apply(a,["Auth (".concat(hn,"): ").concat(t)].concat(e(p)(r)))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ip(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];throw up.apply(void 0,[t].concat(e(p)(r)))}function ap(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return up.apply(void 0,[t].concat(e(p)(r)))}function op(t,n,r){var i=Object.assign(Object.assign({},ep()),e(d)({},n,r));return new Me("auth","Firebase",i).create(n,{appName:t.name})}function sp(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&ip(e,"argument-error"),op(e,"argument-error","Type of ".concat(t.constructor.name," does not match expected instance.")+"Did you pass a reference from a different Auth SDK?")}function up(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var a;if("string"!=typeof t){var o,s=r[0],u=e(p)(r.slice(1));return u[0]&&(u[0].appName=t.name),(o=t._errorFactory).create.apply(o,[s].concat(e(p)(u)))}return(a=tp).create.apply(a,[t].concat(e(p)(r)))}function cp(t,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];if(!t)throw up.apply(void 0,[n].concat(e(p)(i)))}function lp(e){var t="INTERNAL ASSERTION FAILED: "+e;throw rp(t),new Error(t)}function hp(e,t){e||lp(t)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var fp=new Map;function dp(e){hp(e instanceof Function,"Expected a class definition");var t=fp.get(e);return t?(hp(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,fp.set(e,t),t)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pp(e,t){var n=an(e,"auth");if(n.isInitialized()){var r=n.getImmediate();if(Ge(n.getOptions(),null!=t?t:{}))return r;ip(r,"already-initialized")}return n.initialize({options:t})}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function vp(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function yp(){return"http:"===mp()||"https:"===mp()}function mp(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var gp=function(){"use strict";function t(n,r){e(l)(this,t),this.shortDelay=n,this.longDelay=r,hp(r>n,"Short delay should be less than long delay!"),this.isMobile=me()||_e()}return e(h)(t,[{key:"get",value:function(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(yp()||ke()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kp(e,t){hp(e.emulator,"Emulator should always be set here");var n=e.emulator.url;return t?"".concat(n).concat(t.startsWith("/")?t.slice(1):t):n}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _p,wp=function(){"use strict";function t(){e(l)(this,t)}return e(h)(t,null,[{key:"initialize",value:function(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}},{key:"fetch",value:function(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void lp("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"headers",value:function(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void lp("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"response",value:function(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void lp("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}]),t}(),bp=(_p={},e(d)(_p,"CREDENTIAL_MISMATCH","custom-token-mismatch"),e(d)(_p,"MISSING_CUSTOM_TOKEN","internal-error"),e(d)(_p,"INVALID_IDENTIFIER","invalid-email"),e(d)(_p,"MISSING_CONTINUE_URI","internal-error"),e(d)(_p,"INVALID_PASSWORD","wrong-password"),e(d)(_p,"MISSING_PASSWORD","internal-error"),e(d)(_p,"EMAIL_EXISTS","email-already-in-use"),e(d)(_p,"PASSWORD_LOGIN_DISABLED","operation-not-allowed"),e(d)(_p,"INVALID_IDP_RESPONSE","invalid-credential"),e(d)(_p,"INVALID_PENDING_TOKEN","invalid-credential"),e(d)(_p,"FEDERATED_USER_ID_ALREADY_LINKED","credential-already-in-use"),e(d)(_p,"MISSING_REQ_TYPE","internal-error"),e(d)(_p,"EMAIL_NOT_FOUND","user-not-found"),e(d)(_p,"RESET_PASSWORD_EXCEED_LIMIT","too-many-requests"),e(d)(_p,"EXPIRED_OOB_CODE","expired-action-code"),e(d)(_p,"INVALID_OOB_CODE","invalid-action-code"),e(d)(_p,"MISSING_OOB_CODE","internal-error"),e(d)(_p,"CREDENTIAL_TOO_OLD_LOGIN_AGAIN","requires-recent-login"),e(d)(_p,"INVALID_ID_TOKEN","invalid-user-token"),e(d)(_p,"TOKEN_EXPIRED","user-token-expired"),e(d)(_p,"USER_NOT_FOUND","user-token-expired"),e(d)(_p,"TOO_MANY_ATTEMPTS_TRY_LATER","too-many-requests"),e(d)(_p,"INVALID_CODE","invalid-verification-code"),e(d)(_p,"INVALID_SESSION_INFO","invalid-verification-id"),e(d)(_p,"INVALID_TEMPORARY_PROOF","invalid-credential"),e(d)(_p,"MISSING_SESSION_INFO","missing-verification-id"),e(d)(_p,"SESSION_EXPIRED","code-expired"),e(d)(_p,"MISSING_ANDROID_PACKAGE_NAME","missing-android-pkg-name"),e(d)(_p,"UNAUTHORIZED_DOMAIN","unauthorized-continue-uri"),e(d)(_p,"INVALID_OAUTH_CLIENT_ID","invalid-oauth-client-id"),e(d)(_p,"ADMIN_ONLY_OPERATION","admin-restricted-operation"),e(d)(_p,"INVALID_MFA_PENDING_CREDENTIAL","invalid-multi-factor-session"),e(d)(_p,"MFA_ENROLLMENT_NOT_FOUND","multi-factor-info-not-found"),e(d)(_p,"MISSING_MFA_ENROLLMENT_ID","missing-multi-factor-info"),e(d)(_p,"MISSING_MFA_PENDING_CREDENTIAL","missing-multi-factor-session"),e(d)(_p,"SECOND_FACTOR_EXISTS","second-factor-already-in-use"),e(d)(_p,"SECOND_FACTOR_LIMIT_EXCEEDED","maximum-second-factor-count-exceeded"),e(d)(_p,"BLOCKING_FUNCTION_ERROR_RESPONSE","internal-error"),_p),xp=new gp(3e4,6e4);function Ip(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}function Tp(e,t,n,r){return Ep.apply(this,arguments)}function Ep(){return Ep=e(u)(e(_).mark((function t(n,r,i,a){var o,s=arguments;return e(_).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=s.length>4&&void 0!==s[4]?s[4]:{},t.abrupt("return",Sp(n,o,e(u)(e(_).mark((function t(){var o,s,u,c;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={},s={},a&&("GET"===r?s=a:o={body:JSON.stringify(a)}),u=Qe(Object.assign({key:n.config.apiKey},s)).slice(1),e.next=6,n._getAdditionalHeaders();case 6:return(c=e.sent)["Content-Type"]="application/json",n.languageCode&&(c["X-Firebase-Locale"]=n.languageCode),e.abrupt("return",wp.fetch()(Rp(n,n.config.apiHost,i,u),Object.assign({method:r,headers:c,referrerPolicy:"no-referrer"},o)));case 10:case"end":return e.stop()}}),t)})))));case 2:case"end":return t.stop()}}),t)}))),Ep.apply(this,arguments)}function Sp(e,t,n){return Cp.apply(this,arguments)}function Cp(){return(Cp=e(u)(e(_).mark((function t(n,r,i){var a,o,s,u,c,l,h,f,d;return e(_).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n._canInitEmulator=!1,a=Object.assign(Object.assign({},bp),r),t.prev=2,o=new Dp(n),t.next=6,Promise.race([i(),o.promise]);case 6:return s=t.sent,o.clearNetworkTimeout(),t.next=10,s.json();case 10:if(!("needConfirmation"in(u=t.sent))){t.next=13;break}throw Pp(n,"account-exists-with-different-credential",u);case 13:if(!s.ok||"errorMessage"in u){t.next=17;break}return t.abrupt("return",u);case 17:if(c=s.ok?u.errorMessage:u.error.message,l=e(b)(c.split(" : "),2),h=l[0],f=l[1],"FEDERATED_USER_ID_ALREADY_LINKED"!==h){t.next=23;break}throw Pp(n,"credential-already-in-use",u);case 23:if("EMAIL_EXISTS"!==h){t.next=27;break}throw Pp(n,"email-already-in-use",u);case 27:if("USER_DISABLED"!==h){t.next=29;break}throw Pp(n,"user-disabled",u);case 29:if(d=a[h]||h.toLowerCase().replace(/[_\s]+/g,"-"),!f){t.next=34;break}throw op(n,d,f);case 34:ip(n,d);case 35:t.next=42;break;case 37:if(t.prev=37,t.t0=t.catch(2),!(t.t0 instanceof Oe)){t.next=41;break}throw t.t0;case 41:ip(n,"network-request-failed");case 42:case"end":return t.stop()}}),t,null,[[2,37]])})))).apply(this,arguments)}function Ap(e,t,n,r){return Np.apply(this,arguments)}function Np(){return Np=e(u)(e(_).mark((function t(n,r,i,a){var o,s,u=arguments;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=u.length>4&&void 0!==u[4]?u[4]:{},e.next=3,Tp(n,r,i,a,o);case 3:return"mfaPendingCredential"in(s=e.sent)&&ip(n,"multi-factor-auth-required",{_serverResponse:s}),e.abrupt("return",s);case 6:case"end":return e.stop()}}),t)}))),Np.apply(this,arguments)}function Rp(e,t,n,r){var i="".concat(t).concat(n,"?").concat(r);return e.config.emulator?kp(e.config,i):"".concat(e.config.apiScheme,"://").concat(i)}var Dp=function(){"use strict";function t(n){var r=this;e(l)(this,t),this.auth=n,this.timer=null,this.promise=new Promise((function(e,t){var n=r;r.timer=setTimeout((function(){return t(ap(n.auth,"network-request-failed"))}),xp.get())}))}return e(h)(t,[{key:"clearNetworkTimeout",value:function(){clearTimeout(this.timer)}}]),t}();function Pp(e,t,n){var r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);var i=ap(e,t,r);return i.customData._tokenResponse=n,i}function Op(e,t){return Mp.apply(this,arguments)}function Mp(){return(Mp=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(_).mark((function t(n,r){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Tp(n,"POST","/v1/accounts:delete",r));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Lp(e,t){return Fp.apply(this,arguments)}function Fp(){return(Fp=e(u)(e(_).mark((function t(n,r){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Tp(n,"POST","/v1/accounts:update",r));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Up(e,t){return qp.apply(this,arguments)}function qp(){return(qp=e(u)(e(_).mark((function t(n,r){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Tp(n,"POST","/v1/accounts:lookup",r));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vp(e){if(e)try{var t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jp(){return jp=e(u)(e(_).mark((function t(n){var r,i,a,o,s,u,c=arguments;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=c.length>1&&void 0!==c[1]&&c[1],i=lt(n),e.next=4,i.getIdToken(r);case 4:return a=e.sent,cp((o=Kp(a))&&o.exp&&o.auth_time&&o.iat,i.auth,"internal-error"),s="object"==typeof o.firebase?o.firebase:void 0,u=null==s?void 0:s.sign_in_provider,e.abrupt("return",{claims:o,token:a,authTime:Vp(Bp(o.auth_time)),issuedAtTime:Vp(Bp(o.iat)),expirationTime:Vp(Bp(o.exp)),signInProvider:u||null,signInSecondFactor:(null==s?void 0:s.sign_in_second_factor)||null});case 10:case"end":return e.stop()}}),t)}))),jp.apply(this,arguments)}function Bp(e){return 1e3*Number(e)}function Kp(t){var n=e(b)(t.split("."),3),r=n[0],i=n[1],a=n[2];if(void 0===r||void 0===i||void 0===a)return rp("JWT malformed, contained fewer than 3 sections"),null;try{var o=pe(i);return o?JSON.parse(o):(rp("Failed to decode base64 JWT payload"),null)}catch(e){return rp("Caught error parsing JWT payload as JSON",null==e?void 0:e.toString()),null}}function zp(e,t){return Wp.apply(this,arguments)}function Wp(){return Wp=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(_).mark((function t(n,r){var i=arguments;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i.length>2&&void 0!==i[2]&&i[2])){e.next=3;break}return e.abrupt("return",r);case 3:return e.prev=3,e.next=6,r;case 6:return e.abrupt("return",e.sent);case 9:if(e.prev=9,e.t0=e.catch(3),!(e.t0 instanceof Oe&&Gp(e.t0))){e.next=15;break}if(n.auth.currentUser!==n){e.next=15;break}return e.next=15,n.auth.signOut();case 15:throw e.t0;case 16:case"end":return e.stop()}}),t,null,[[3,9]])}))),Wp.apply(this,arguments)}function Gp(e){var t=e.code;return"auth/user-disabled"===t||"auth/user-token-expired"===t}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Hp=function(){"use strict";function t(n){e(l)(this,t),this.user=n,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}return e(h)(t,[{key:"_start",value:function(){this.isRunning||(this.isRunning=!0,this.schedule())}},{key:"_stop",value:function(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}},{key:"getInterval",value:function(e){var t;if(e){var n=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),n}this.errorBackoff=3e4;var r=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,r)}},{key:"schedule",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isRunning){var n=this.getInterval(t),r=this;this.timerId=setTimeout(e(u)(e(_).mark((function t(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.iteration();case 2:case"end":return e.stop()}}),t)}))),n)}}},{key:"iteration",value:function(){var t=this;return e(u)(e(_).mark((function n(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.user.getIdToken(!0);case 3:e.next=9;break;case 5:return e.prev=5,e.t0=e.catch(0),"auth/network-request-failed"===(null===e.t0||void 0===e.t0?void 0:e.t0.code)&&t.schedule(!0),e.abrupt("return");case 9:t.schedule();case 10:case"end":return e.stop()}}),n,null,[[0,5]])})))()}}]),t}(),Qp=function(){"use strict";function t(n,r){e(l)(this,t),this.createdAt=n,this.lastLoginAt=r,this._initializeTime()}return e(h)(t,[{key:"_initializeTime",value:function(){this.lastSignInTime=Vp(this.lastLoginAt),this.creationTime=Vp(this.createdAt)}},{key:"_copy",value:function(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}},{key:"toJSON",value:function(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yp(e){return Jp.apply(this,arguments)}function Jp(){return(Jp=
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(_).mark((function t(n){var r,i,a,o,s,u,c,l,h,f,d;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.auth,e.next=4,n.getIdToken();case 4:return a=e.sent,e.next=7,zp(n,Up(i,{idToken:a}));case 7:cp(null==(o=e.sent)?void 0:o.users.length,i,"internal-error"),s=o.users[0],n._notifyReloadListener(s),u=(null===(r=s.providerUserInfo)||void 0===r?void 0:r.length)?Zp(s.providerUserInfo):[],c=$p(n.providerData,u),l=n.isAnonymous,h=!(n.email&&s.passwordHash||(null==c?void 0:c.length)),f=!!l&&h,d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:c,metadata:new Qp(s.createdAt,s.lastLoginAt),isAnonymous:f},Object.assign(n,d);case 18:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Xp(){return(Xp=e(u)(e(_).mark((function t(n){var r;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=lt(n),e.next=3,Yp(r);case 3:return e.next=5,r.auth._persistUserIfCurrent(r);case 5:r.auth._notifyListenersIfCurrent(r);case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function $p(t,n){var r=t.filter((function(e){return!n.some((function(t){return t.providerId===e.providerId}))}));return e(p)(r).concat(e(p)(n))}function Zp(e){return e.map((function(e){var t=e.providerId,n=Vd(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}))}function ev(e,t){return tv.apply(this,arguments)}function tv(){return(tv=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(_).mark((function t(n,r){var i;return e(_).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Sp(n,{},e(u)(e(_).mark((function t(){var i,a,o,s,u,c;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Qe({grant_type:"refresh_token",refresh_token:r}).slice(1),a=n.config,o=a.tokenApiHost,s=a.apiKey,u=Rp(n,o,"/v1/token","key=".concat(s)),e.next=5,n._getAdditionalHeaders();case 5:return(c=e.sent)["Content-Type"]="application/x-www-form-urlencoded",e.abrupt("return",wp.fetch()(u,{method:"POST",headers:c,body:i}));case 8:case"end":return e.stop()}}),t)}))));case 2:return i=t.sent,t.abrupt("return",{accessToken:i.access_token,expiresIn:i.expires_in,refreshToken:i.refresh_token});case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var nv=function(){"use strict";function t(){e(l)(this,t),this.refreshToken=null,this.accessToken=null,this.expirationTime=null}return e(h)(t,[{key:"isExpired",get:function(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}},{key:"updateFromServerResponse",value:function(e){cp(e.idToken,"internal-error"),cp(void 0!==e.idToken,"internal-error"),cp(void 0!==e.refreshToken,"internal-error");var t,n,r="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):(t=e.idToken,cp(n=Kp(t),"internal-error"),cp(void 0!==n.exp,"internal-error"),cp(void 0!==n.iat,"internal-error"),Number(n.exp)-Number(n.iat));this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}},{key:"getToken",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this;return e(u)(e(_).mark((function i(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(cp(!r.accessToken||r.refreshToken,t,"user-token-expired"),n||!r.accessToken||r.isExpired){e.next=3;break}return e.abrupt("return",r.accessToken);case 3:if(!r.refreshToken){e.next=7;break}return e.next=6,r.refresh(t,r.refreshToken);case 6:return e.abrupt("return",r.accessToken);case 7:return e.abrupt("return",null);case 8:case"end":return e.stop()}}),i)})))()}},{key:"clearRefreshToken",value:function(){this.refreshToken=null}},{key:"refresh",value:function(t,n){var r=this;return e(u)(e(_).mark((function i(){var a,o,s,u;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ev(t,n);case 2:a=e.sent,o=a.accessToken,s=a.refreshToken,u=a.expiresIn,r.updateTokensAndExpiration(o,s,Number(u));case 7:case"end":return e.stop()}}),i)})))()}},{key:"updateTokensAndExpiration",value:function(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}},{key:"toJSON",value:function(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}},{key:"_assign",value:function(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}},{key:"_clone",value:function(){return Object.assign(new t,this.toJSON())}},{key:"_performRefresh",value:function(){return lp("not implemented")}}],[{key:"fromJSON",value:function(e,n){var r=n.refreshToken,i=n.accessToken,a=n.expirationTime,o=new t;return r&&(cp("string"==typeof r,"internal-error",{appName:e}),o.refreshToken=r),i&&(cp("string"==typeof i,"internal-error",{appName:e}),o.accessToken=i),a&&(cp("number"==typeof a,"internal-error",{appName:e}),o.expirationTime=a),o}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rv(e,t){cp("string"==typeof e||void 0===e,"internal-error",{appName:t})}var iv=function(){"use strict";function t(n){e(l)(this,t);var r=n.uid,i=n.auth,a=n.stsTokenManager,o=Vd(n,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Hp(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=i,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?e(p)(o.providerData):[],this.metadata=new Qp(o.createdAt||void 0,o.lastLoginAt||void 0)}return e(h)(t,[{key:"getIdToken",value:function(t){var n=this;return e(u)(e(_).mark((function r(){var i;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,zp(n,n.stsTokenManager.getToken(n.auth,t));case 2:if(cp(i=e.sent,n.auth,"internal-error"),n.accessToken===i){e.next=9;break}return n.accessToken=i,e.next=8,n.auth._persistUserIfCurrent(n);case 8:n.auth._notifyListenersIfCurrent(n);case 9:return e.abrupt("return",i);case 10:case"end":return e.stop()}}),r)})))()}},{key:"getIdTokenResult",value:function(e){return function(e){return jp.apply(this,arguments)}(this,e)}},{key:"reload",value:function(){return function(e){return Xp.apply(this,arguments)}(this)}},{key:"_assign",value:function(e){this!==e&&(cp(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((function(e){return Object.assign({},e)})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}},{key:"_clone",value:function(e){return new t(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}))}},{key:"_onReload",value:function(e){cp(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}},{key:"_notifyReloadListener",value:function(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}},{key:"_startProactiveRefresh",value:function(){this.proactiveRefresh._start()}},{key:"_stopProactiveRefresh",value:function(){this.proactiveRefresh._stop()}},{key:"_updateTokensIfNecessary",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this;return e(u)(e(_).mark((function i(){var a;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=!1,t.idToken&&t.idToken!==r.stsTokenManager.accessToken&&(r.stsTokenManager.updateFromServerResponse(t),a=!0),!n){e.next=5;break}return e.next=5,Yp(r);case 5:return e.next=7,r.auth._persistUserIfCurrent(r);case 7:a&&r.auth._notifyListenersIfCurrent(r);case 8:case"end":return e.stop()}}),i)})))()}},{key:"delete",value:function(){var t=this;return e(u)(e(_).mark((function n(){var r;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getIdToken();case 2:return r=e.sent,e.next=5,zp(t,Op(t.auth,{idToken:r}));case 5:return t.stsTokenManager.clearRefreshToken(),e.abrupt("return",t.auth.signOut());case 7:case"end":return e.stop()}}),n)})))()}},{key:"toJSON",value:function(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((function(e){return Object.assign({},e)})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}},{key:"refreshToken",get:function(){return this.stsTokenManager.refreshToken||""}}],[{key:"_fromJSON",value:function(e,n){var r,i,a,o,s,u,c,l,h=null!==(r=n.displayName)&&void 0!==r?r:void 0,f=null!==(i=n.email)&&void 0!==i?i:void 0,d=null!==(a=n.phoneNumber)&&void 0!==a?a:void 0,p=null!==(o=n.photoURL)&&void 0!==o?o:void 0,v=null!==(s=n.tenantId)&&void 0!==s?s:void 0,y=null!==(u=n._redirectEventId)&&void 0!==u?u:void 0,m=null!==(c=n.createdAt)&&void 0!==c?c:void 0,g=null!==(l=n.lastLoginAt)&&void 0!==l?l:void 0,k=n.uid,_=n.emailVerified,w=n.isAnonymous,b=n.providerData,x=n.stsTokenManager;cp(k&&x,e,"internal-error");var I=nv.fromJSON(this.name,x);cp("string"==typeof k,e,"internal-error"),rv(h,e.name),rv(f,e.name),cp("boolean"==typeof _,e,"internal-error"),cp("boolean"==typeof w,e,"internal-error"),rv(d,e.name),rv(p,e.name),rv(v,e.name),rv(y,e.name),rv(m,e.name),rv(g,e.name);var T=new t({uid:k,auth:e,email:f,emailVerified:_,displayName:h,isAnonymous:w,photoURL:p,phoneNumber:d,tenantId:v,stsTokenManager:I,createdAt:m,lastLoginAt:g});return b&&Array.isArray(b)&&(T.providerData=b.map((function(e){return Object.assign({},e)}))),y&&(T._redirectEventId=y),T}},{key:"_fromIdTokenResponse",value:function(n,r){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e(u)(e(_).mark((function a(){var o,s;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(o=new nv).updateFromServerResponse(r),s=new t({uid:r.localId,auth:n,stsTokenManager:o,isAnonymous:i}),e.next=5,Yp(s);case 5:return e.abrupt("return",s);case 6:case"end":return e.stop()}}),a)})))()}}]),t}(),av=function(){"use strict";function t(){e(l)(this,t),this.type="NONE",this.storage={}}return e(h)(t,[{key:"_isAvailable",value:function(){return e(u)(e(_).mark((function t(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}}),t)})))()}},{key:"_set",value:function(t,n){var r=this;return e(u)(e(_).mark((function i(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.storage[t]=n;case 1:case"end":return e.stop()}}),i)})))()}},{key:"_get",value:function(t){var n=this;return e(u)(e(_).mark((function r(){var i;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.storage[t],e.abrupt("return",void 0===i?null:i);case 2:case"end":return e.stop()}}),r)})))()}},{key:"_remove",value:function(t){var n=this;return e(u)(e(_).mark((function r(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:delete n.storage[t];case 1:case"end":return e.stop()}}),r)})))()}},{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),t}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */av.type="NONE";var ov=av;
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sv(e,t,n){return"firebase:".concat(e,":").concat(t,":").concat(n)}var uv=function(){"use strict";function t(n,r,i){e(l)(this,t),this.persistence=n,this.auth=r,this.userKey=i;var a=this.auth,o=a.config,s=a.name;this.fullUserKey=sv(this.userKey,o.apiKey,s),this.fullPersistenceKey=sv("persistence",o.apiKey,s),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}return e(h)(t,[{key:"setCurrentUser",value:function(e){return this.persistence._set(this.fullUserKey,e.toJSON())}},{key:"getCurrentUser",value:function(){var t=this;return e(u)(e(_).mark((function n(){var r;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.persistence._get(t.fullUserKey);case 2:return r=e.sent,e.abrupt("return",r?iv._fromJSON(t.auth,r):null);case 4:case"end":return e.stop()}}),n)})))()}},{key:"removeCurrentUser",value:function(){return this.persistence._remove(this.fullUserKey)}},{key:"savePersistenceForRedirect",value:function(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}},{key:"setPersistence",value:function(t){var n=this;return e(u)(e(_).mark((function r(){var i;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.persistence!==t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,n.getCurrentUser();case 4:return i=e.sent,e.next=7,n.removeCurrentUser();case 7:if(n.persistence=t,!i){e.next=10;break}return e.abrupt("return",n.setCurrentUser(i));case 10:case"end":return e.stop()}}),r)})))()}},{key:"delete",value:function(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}}],[{key:"create",value:function(n,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";return e(u)(e(_).mark((function a(){var o,s,c,l,h,f,d,p,v,y,m,g,k;return e(_).wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(r.length){a.next=2;break}return a.abrupt("return",new t(dp(ov),n,i));case 2:return a.next=4,Promise.all(r.map(function(){var t=e(u)(e(_).mark((function t(n){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n._isAvailable();case 2:if(!e.sent){e.next=4;break}return e.abrupt("return",n);case 4:return e.abrupt("return",void 0);case 5:case"end":return e.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 4:o=a.sent.filter((function(e){return e})),s=o[0]||dp(ov),c=sv(i,n.config.apiKey,n.name),l=null,h=!0,f=!1,d=void 0,a.prev=9,p=r[Symbol.iterator]();case 11:if(h=(v=p.next()).done){a.next=29;break}return y=v.value,a.prev=13,a.next=16,y._get(c);case 16:if(!(m=a.sent)){a.next=22;break}return g=iv._fromJSON(n,m),y!==s&&(l=g),s=y,a.abrupt("break",29);case 22:a.next=26;break;case 24:a.prev=24,a.t0=a.catch(13);case 26:h=!0,a.next=11;break;case 29:a.next=35;break;case 31:a.prev=31,a.t1=a.catch(9),f=!0,d=a.t1;case 35:a.prev=35,a.prev=36,h||null==p.return||p.return();case 38:if(a.prev=38,!f){a.next=41;break}throw d;case 41:return a.finish(38);case 42:return a.finish(35);case 43:if(k=o.filter((function(e){return e._shouldAllowMigration})),s._shouldAllowMigration&&k.length){a.next=46;break}return a.abrupt("return",new t(s,n,i));case 46:if(s=k[0],!l){a.next=50;break}return a.next=50,s._set(c,l.toJSON());case 50:return a.next=52,Promise.all(r.map(function(){var t=e(u)(e(_).mark((function t(n){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n===s){e.next=8;break}return e.prev=1,e.next=4,n._remove(c);case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:case"end":return e.stop()}}),t,null,[[1,6]])})));return function(e){return t.apply(this,arguments)}}()));case 52:return a.abrupt("return",new t(s,n,i));case 53:case"end":return a.stop()}}),a,null,[[9,31,35,43],[13,24],[36,,38,42]])})))()}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cv(e){var t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(dv(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(lv(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(vv(t))return"Blackberry";if(yv(t))return"Webos";if(hv(t))return"Safari";if((t.includes("chrome/")||fv(t))&&!t.includes("edge/"))return"Chrome";if(pv(t))return"Android";var n=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);return 2===(null==n?void 0:n.length)?n[1]:"Other"}function lv(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ye();return/firefox\//i.test(e)}function hv(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ye(),t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function fv(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ye();return/crios\//i.test(e)}function dv(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ye();return/iemobile/i.test(e)}function pv(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ye();return/android/i.test(e)}function vv(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ye();return/blackberry/i.test(e)}function yv(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ye();return/webos/i.test(e)}function mv(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ye();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function gv(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ye();return/(iPad|iPhone|iPod).*OS 7_\d/i.test(e)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(e)}function kv(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ye();return mv(t)&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}function _v(){return we()&&10===document.documentMode}function wv(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ye();return mv(e)||pv(e)||yv(e)||vv(e)||/windows phone/i.test(e)||dv(e)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function bv(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=cv(ye());break;case"Worker":t="".concat(cv(ye()),"-").concat(e);break;default:t=e}var r=n.length?n.join(","):"FirebaseCore-web";return"".concat(t,"/","JsCore","/").concat(hn,"/").concat(r)}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xv=function(){"use strict";function t(n){e(l)(this,t),this.auth=n,this.queue=[]}return e(h)(t,[{key:"pushCallback",value:function(e,t){var n=this,r=function(t){return new Promise((function(n,r){try{n(e(t))}catch(e){r(e)}}))};r.onAbort=t,this.queue.push(r);var i=this.queue.length-1;return function(){n.queue[i]=function(){return Promise.resolve()}}}},{key:"runMiddleware",value:function(t){var n=this;return e(u)(e(_).mark((function r(){var i,a,o,s,u,c,l,h,f,d,p,v,y;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.auth.currentUser!==t){e.next=2;break}return e.abrupt("return");case 2:i=[],e.prev=3,a=!0,o=!1,s=void 0,e.prev=5,u=n.queue[Symbol.iterator]();case 7:if(a=(c=u.next()).done){e.next=15;break}return l=c.value,e.next=11,l(t);case 11:l.onAbort&&i.push(l.onAbort);case 12:a=!0,e.next=7;break;case 15:e.next=21;break;case 17:e.prev=17,e.t0=e.catch(5),o=!0,s=e.t0;case 21:e.prev=21,e.prev=22,a||null==u.return||u.return();case 24:if(e.prev=24,!o){e.next=27;break}throw s;case 27:return e.finish(24);case 28:return e.finish(21);case 29:e.next=52;break;case 31:for(e.prev=31,e.t1=e.catch(3),i.reverse(),h=!0,f=!1,d=void 0,e.prev=35,p=i[Symbol.iterator]();!(h=(v=p.next()).done);h=!0){y=v.value;try{y()}catch(e){}}e.next=43;break;case 39:e.prev=39,e.t2=e.catch(35),f=!0,d=e.t2;case 43:e.prev=43,e.prev=44,h||null==p.return||p.return();case 46:if(e.prev=46,!f){e.next=49;break}throw d;case 49:return e.finish(46);case 50:return e.finish(43);case 51:throw n.auth._errorFactory.create("login-blocked",{originalMessage:null===e.t1||void 0===e.t1?void 0:e.t1.message});case 52:case"end":return e.stop()}}),r,null,[[3,31],[5,17,21,29],[22,,24,28],[35,39,43,51],[44,,46,50]])})))()}}]),t}(),Iv=function(){"use strict";function t(n,r,i){e(l)(this,t),this.app=n,this.heartbeatServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ev(this),this.idTokenSubscription=new Ev(this),this.beforeStateQueue=new xv(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=tp,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=n.name,this.clientVersion=i.sdkClientVersion}return e(h)(t,[{key:"_initializeWithPersistence",value:function(t,n){n&&(this._popupRedirectResolver=dp(n));var r=this;return this._initializationPromise=this.queue(e(u)(e(_).mark((function i(){var a,o;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r._deleted){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,uv.create(r,t);case 5:if(r.persistenceManager=e.sent,!r._deleted){e.next=8;break}return e.abrupt("return");case 8:if(!(null===(a=r._popupRedirectResolver)||void 0===a?void 0:a._shouldInitProactively)){e.next=16;break}return e.prev=9,e.next=12,r._popupRedirectResolver._initialize(r);case 12:e.next=16;break;case 14:e.prev=14,e.t0=e.catch(9);case 16:return e.next=18,r.initializeCurrentUser(n);case 18:if(r.lastNotifiedUid=(null===(o=r.currentUser)||void 0===o?void 0:o.uid)||null,!r._deleted){e.next=21;break}return e.abrupt("return");case 21:r._isInitialized=!0;case 22:case"end":return e.stop()}}),i,null,[[9,14]])})))),this._initializationPromise}},{key:"_onStorageEvent",value:function(){var t=this;return e(u)(e(_).mark((function n(){var r;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t._deleted){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t.assertedPersistence.getCurrentUser();case 4:if(r=e.sent,t.currentUser||r){e.next=7;break}return e.abrupt("return");case 7:if(!t.currentUser||!r||t.currentUser.uid!==r.uid){e.next=12;break}return t._currentUser._assign(r),e.next=11,t.currentUser.getIdToken();case 11:return e.abrupt("return");case 12:return e.next=14,t._updateCurrentUser(r,!0);case 14:case"end":return e.stop()}}),n)})))()}},{key:"initializeCurrentUser",value:function(t){var n=this;return e(u)(e(_).mark((function r(){var i,a,o,s,u,c,l;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,n.assertedPersistence.getCurrentUser();case 3:if(a=e.sent,o=a,s=!1,!t||!n.config.authDomain){e.next=15;break}return e.next=9,n.getOrInitRedirectPersistenceManager();case 9:return u=null===(i=n.redirectUser)||void 0===i?void 0:i._redirectEventId,c=null==o?void 0:o._redirectEventId,e.next=13,n.tryRedirectSignIn(t);case 13:l=e.sent,u&&u!==c||!(null==l?void 0:l.user)||(o=l.user,s=!0);case 15:if(o){e.next=17;break}return e.abrupt("return",n.directlySetCurrentUser(null));case 17:if(o._redirectEventId){e.next=33;break}if(!s){e.next=28;break}return e.prev=19,e.next=22,n.beforeStateQueue.runMiddleware(o);case 22:e.next=28;break;case 24:e.prev=24,e.t0=e.catch(19),o=a,n._popupRedirectResolver._overrideRedirectResult(n,(function(){return Promise.reject(e.t0)}));case 28:if(!o){e.next=32;break}return e.abrupt("return",n.reloadAndSetCurrentUserOrClear(o));case 32:return e.abrupt("return",n.directlySetCurrentUser(null));case 33:return cp(n._popupRedirectResolver,n,"argument-error"),e.next=36,n.getOrInitRedirectPersistenceManager();case 36:if(!n.redirectUser||n.redirectUser._redirectEventId!==o._redirectEventId){e.next=38;break}return e.abrupt("return",n.directlySetCurrentUser(o));case 38:return e.abrupt("return",n.reloadAndSetCurrentUserOrClear(o));case 39:case"end":return e.stop()}}),r,null,[[19,24]])})))()}},{key:"tryRedirectSignIn",value:function(t){var n=this;return e(u)(e(_).mark((function r(){var i;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=null,e.prev=1,e.next=4,n._popupRedirectResolver._completeRedirectFn(n,t,!0);case 4:i=e.sent,e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(1),e.next=11,n._setRedirectUser(null);case 11:return e.abrupt("return",i);case 12:case"end":return e.stop()}}),r,null,[[1,7]])})))()}},{key:"reloadAndSetCurrentUserOrClear",value:function(t){var n=this;return e(u)(e(_).mark((function r(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Yp(t);case 3:e.next=9;break;case 5:if(e.prev=5,e.t0=e.catch(0),"auth/network-request-failed"===(null===e.t0||void 0===e.t0?void 0:e.t0.code)){e.next=9;break}return e.abrupt("return",n.directlySetCurrentUser(null));case 9:return e.abrupt("return",n.directlySetCurrentUser(t));case 10:case"end":return e.stop()}}),r,null,[[0,5]])})))()}},{key:"useDeviceLanguage",value:function(){this.languageCode=function(){if("undefined"==typeof navigator)return null;var e=navigator;return e.languages&&e.languages[0]||e.language||null}()}},{key:"_delete",value:function(){var t=this;return e(u)(e(_).mark((function n(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t._deleted=!0;case 1:case"end":return e.stop()}}),n)})))()}},{key:"updateCurrentUser",value:function(t){var n=this;return e(u)(e(_).mark((function r(){var i;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(i=t?lt(t):null)&&cp(i.auth.config.apiKey===n.config.apiKey,n,"invalid-user-token"),e.abrupt("return",n._updateCurrentUser(i&&i._clone(n)));case 3:case"end":return e.stop()}}),r)})))()}},{key:"_updateCurrentUser",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this;return e(u)(e(_).mark((function i(){return e(_).wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!r._deleted){i.next=2;break}return i.abrupt("return");case 2:if(t&&cp(r.tenantId===t.tenantId,r,"tenant-id-mismatch"),n){i.next=6;break}return i.next=6,r.beforeStateQueue.runMiddleware(t);case 6:return i.abrupt("return",r.queue(e(u)(e(_).mark((function n(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.directlySetCurrentUser(t);case 2:r.notifyAuthListeners();case 3:case"end":return e.stop()}}),n)})))));case 7:case"end":return i.stop()}}),i)})))()}},{key:"signOut",value:function(){var t=this;return e(u)(e(_).mark((function n(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.beforeStateQueue.runMiddleware(null);case 2:if(!t.redirectPersistenceManager&&!t._popupRedirectResolver){e.next=5;break}return e.next=5,t._setRedirectUser(null);case 5:return e.abrupt("return",t._updateCurrentUser(null,!0));case 6:case"end":return e.stop()}}),n)})))()}},{key:"setPersistence",value:function(t){var n=this;return this.queue(e(u)(e(_).mark((function r(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.assertedPersistence.setPersistence(dp(t));case 2:case"end":return e.stop()}}),r)}))))}},{key:"_getPersistence",value:function(){return this.assertedPersistence.persistence.type}},{key:"_updateErrorMap",value:function(e){this._errorFactory=new Me("auth","Firebase",e())}},{key:"onAuthStateChanged",value:function(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}},{key:"beforeAuthStateChanged",value:function(e,t){return this.beforeStateQueue.pushCallback(e,t)}},{key:"onIdTokenChanged",value:function(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}},{key:"toJSON",value:function(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}},{key:"_setRedirectUser",value:function(t,n){var r=this;return e(u)(e(_).mark((function i(){var a;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.getOrInitRedirectPersistenceManager(n);case 2:return a=e.sent,e.abrupt("return",null===t?a.removeCurrentUser():a.setCurrentUser(t));case 4:case"end":return e.stop()}}),i)})))()}},{key:"getOrInitRedirectPersistenceManager",value:function(t){var n=this;return e(u)(e(_).mark((function r(){var i;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.redirectPersistenceManager){e.next=9;break}return cp(i=t&&dp(t)||n._popupRedirectResolver,n,"argument-error"),e.next=5,uv.create(n,[dp(i._redirectPersistence)],"redirectUser");case 5:return n.redirectPersistenceManager=e.sent,e.next=8,n.redirectPersistenceManager.getCurrentUser();case 8:n.redirectUser=e.sent;case 9:return e.abrupt("return",n.redirectPersistenceManager);case 10:case"end":return e.stop()}}),r)})))()}},{key:"_redirectUserForId",value:function(t){var n=this;return e(u)(e(_).mark((function r(){var i,a;return e(_).wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!n._isInitialized){r.next=4;break}return r.next=4,n.queue(e(u)(e(_).mark((function t(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),t)}))));case 4:if((null===(i=n._currentUser)||void 0===i?void 0:i._redirectEventId)!==t){r.next=6;break}return r.abrupt("return",n._currentUser);case 6:if((null===(a=n.redirectUser)||void 0===a?void 0:a._redirectEventId)!==t){r.next=8;break}return r.abrupt("return",n.redirectUser);case 8:return r.abrupt("return",null);case 9:case"end":return r.stop()}}),r)})))()}},{key:"_persistUserIfCurrent",value:function(t){var n=this;return e(u)(e(_).mark((function r(){return e(_).wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t!==n.currentUser){r.next=2;break}return r.abrupt("return",n.queue(e(u)(e(_).mark((function r(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.directlySetCurrentUser(t));case 1:case"end":return e.stop()}}),r)})))));case 2:case"end":return r.stop()}}),r)})))()}},{key:"_notifyListenersIfCurrent",value:function(e){e===this.currentUser&&this.notifyAuthListeners()}},{key:"_key",value:function(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}},{key:"_startProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}},{key:"_stopProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}},{key:"_currentUser",get:function(){return this.currentUser}},{key:"notifyAuthListeners",value:function(){var e,t;if(this._isInitialized){this.idTokenSubscription.next(this.currentUser);var n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}}},{key:"registerStateListener",value:function(e,t,n,r){var i=this;if(this._deleted)return function(){};var a="function"==typeof t?t:t.next.bind(t),o=this._isInitialized?Promise.resolve():this._initializationPromise;return cp(o,this,"internal-error"),o.then((function(){return a(i.currentUser)})),"function"==typeof t?e.addObserver(t,n,r):e.addObserver(t)}},{key:"directlySetCurrentUser",value:function(t){var n=this;return e(u)(e(_).mark((function r(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.currentUser&&n.currentUser!==t&&n._currentUser._stopProactiveRefresh(),t&&n.isProactiveRefreshEnabled&&t._startProactiveRefresh(),n.currentUser=t,!t){e.next=8;break}return e.next=6,n.assertedPersistence.setCurrentUser(t);case 6:e.next=10;break;case 8:return e.next=10,n.assertedPersistence.removeCurrentUser();case 10:case"end":return e.stop()}}),r)})))()}},{key:"queue",value:function(e){return this.operations=this.operations.then(e,e),this.operations}},{key:"assertedPersistence",get:function(){return cp(this.persistenceManager,this,"internal-error"),this.persistenceManager}},{key:"_logFramework",value:function(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=bv(this.config.clientPlatform,this._getFrameworks()))}},{key:"_getFrameworks",value:function(){return this.frameworks}},{key:"_getAdditionalHeaders",value:function(){var t=this;return e(u)(e(_).mark((function n(){var r,i,a;return e(_).wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=e(d)({},"X-Client-Version",t.clientVersion),t.app.options.appId&&(i["X-Firebase-gmpid"]=t.app.options.appId),n.next=5,null===(r=t.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===r?void 0:r.getHeartbeatsHeader();case 5:return(a=n.sent)&&(i["X-Firebase-Client"]=a),n.abrupt("return",i);case 8:case"end":return n.stop()}}),n)})))()}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tv(e){return lt(e)}var Ev=function(){"use strict";function t(n){var r=this;e(l)(this,t),this.auth=n,this.observer=null,this.addObserver=$e((function(e){return r.observer=e}))}return e(h)(t,[{key:"next",get:function(){return cp(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}]),t}();function Sv(t,n,r){var i=Tv(t);cp(i._canInitEmulator,i,"emulator-config-failed"),cp(/^https?:\/\//.test(n),i,"invalid-emulator-scheme");var a=!!(null==r?void 0:r.disableWarnings),o=Cv(n),s=function(t){var n=Cv(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(n.length));if(!r)return{host:"",port:null};var i=r[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(i);if(a){var o=a[1];return{host:o,port:Av(i.substr(o.length+1))}}var s=e(b)(i.split(":"),2);return{host:s[0],port:Av(s[1])}}(n),u=s.host,c=s.port,l=null===c?"":":".concat(c);i.config.emulator={url:"".concat(o,"//").concat(u).concat(l,"/")},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:u,port:c,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:a})}),a||function(){function e(){var e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */()}function Cv(e){var t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Av(e){if(!e)return null;var t=Number(e);return isNaN(t)?null:t}var Nv=function(){"use strict";function t(n,r){e(l)(this,t),this.providerId=n,this.signInMethod=r}return e(h)(t,[{key:"toJSON",value:function(){return lp("not implemented")}},{key:"_getIdTokenResponse",value:function(e){return lp("not implemented")}},{key:"_linkToIdToken",value:function(e,t){return lp("not implemented")}},{key:"_getReauthenticationResolver",value:function(e){return lp("not implemented")}}]),t}();function Rv(e,t){return Dv.apply(this,arguments)}function Dv(){return(Dv=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(_).mark((function t(n,r){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Tp(n,"POST","/v1/accounts:resetPassword",Ip(n,r)));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Pv(e,t){return Ov.apply(this,arguments)}function Ov(){return(Ov=e(u)(e(_).mark((function t(n,r){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Tp(n,"POST","/v1/accounts:update",r));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Mv(e,t){return Lv.apply(this,arguments)}function Lv(){return(Lv=e(u)(e(_).mark((function t(n,r){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Tp(n,"POST","/v1/accounts:update",Ip(n,r)));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Fv(e,t){return Uv.apply(this,arguments)}function Uv(){return(Uv=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(_).mark((function t(n,r){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ap(n,"POST","/v1/accounts:signInWithPassword",Ip(n,r)));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function qv(e,t){return Vv.apply(this,arguments)}function Vv(){return(Vv=e(u)(e(_).mark((function t(n,r){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Tp(n,"POST","/v1/accounts:sendOobCode",Ip(n,r)));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function jv(e,t){return Bv.apply(this,arguments)}function Bv(){return(Bv=e(u)(e(_).mark((function t(n,r){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",qv(n,r));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Kv(e,t){return zv.apply(this,arguments)}function zv(){return(zv=e(u)(e(_).mark((function t(n,r){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",qv(n,r));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Wv(e,t){return Gv.apply(this,arguments)}function Gv(){return(Gv=e(u)(e(_).mark((function t(n,r){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",qv(n,r));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Hv(e,t){return Qv.apply(this,arguments)}function Qv(){return(Qv=e(u)(e(_).mark((function t(n,r){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",qv(n,r));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Yv(e,t){return Jv.apply(this,arguments)}function Jv(){return(Jv=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(_).mark((function t(n,r){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ap(n,"POST","/v1/accounts:signInWithEmailLink",Ip(n,r)));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Xv(e,t){return $v.apply(this,arguments)}function $v(){return($v=e(u)(e(_).mark((function t(n,r){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ap(n,"POST","/v1/accounts:signInWithEmailLink",Ip(n,r)));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Zv=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i,a){var o,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return e(l)(this,r),(o=n.call(this,"password",a))._email=t,o._password=i,o._tenantId=s,o}return e(h)(r,[{key:"toJSON",value:function(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}},{key:"_getIdTokenResponse",value:function(t){var n=this;return e(u)(e(_).mark((function r(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=n.signInMethod,e.next="password"===e.t0?3:"emailLink"===e.t0?4:5;break;case 3:return e.abrupt("return",Fv(t,{returnSecureToken:!0,email:n._email,password:n._password}));case 4:return e.abrupt("return",Yv(t,{email:n._email,oobCode:n._password}));case 5:ip(t,"internal-error");case 6:case"end":return e.stop()}}),r)})))()}},{key:"_linkToIdToken",value:function(t,n){var r=this;return e(u)(e(_).mark((function i(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=r.signInMethod,e.next="password"===e.t0?3:"emailLink"===e.t0?4:5;break;case 3:return e.abrupt("return",Pv(t,{idToken:n,returnSecureToken:!0,email:r._email,password:r._password}));case 4:return e.abrupt("return",Xv(t,{idToken:n,email:r._email,oobCode:r._password}));case 5:ip(t,"internal-error");case 6:case"end":return e.stop()}}),i)})))()}},{key:"_getReauthenticationResolver",value:function(e){return this._getIdTokenResponse(e)}}],[{key:"_fromEmailAndPassword",value:function(e,t){return new r(e,t,"password")}},{key:"_fromEmailAndCode",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new r(e,t,"emailLink",n)}},{key:"fromJSON",value:function(e){var t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}}]),r}(Nv);function ey(e,t){return ty.apply(this,arguments)}function ty(){return(ty=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(_).mark((function t(n,r){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ap(n,"POST","/v1/accounts:signInWithIdp",Ip(n,r)));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ny=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(){var t;return e(l)(this,r),(t=n.call.apply(n,[this].concat(Array.prototype.slice.call(arguments)))).pendingToken=null,t}return e(h)(r,[{key:"toJSON",value:function(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}},{key:"_getIdTokenResponse",value:function(e){return ey(e,this.buildRequest())}},{key:"_linkToIdToken",value:function(e,t){var n=this.buildRequest();return n.idToken=t,ey(e,n)}},{key:"_getReauthenticationResolver",value:function(e){var t=this.buildRequest();return t.autoCreate=!1,ey(e,t)}},{key:"buildRequest",value:function(){var e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{var t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Qe(t)}return e}}],[{key:"_fromParams",value:function(e){var t=new r(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ip("argument-error"),t}},{key:"fromJSON",value:function(e){var t="string"==typeof e?JSON.parse(e):e,n=t.providerId,i=t.signInMethod,a=Vd(t,["providerId","signInMethod"]);if(!n||!i)return null;var o=new r(n,i);return o.idToken=a.idToken||void 0,o.accessToken=a.accessToken||void 0,o.secret=a.secret,o.nonce=a.nonce,o.pendingToken=a.pendingToken||null,o}}]),r}(Nv);function ry(e,t){return iy.apply(this,arguments)}function iy(){return(iy=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(_).mark((function t(n,r){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Tp(n,"POST","/v1/accounts:sendVerificationCode",Ip(n,r)));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function ay(){return(ay=e(u)(e(_).mark((function t(n,r){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ap(n,"POST","/v1/accounts:signInWithPhoneNumber",Ip(n,r)));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function oy(){return(oy=e(u)(e(_).mark((function t(n,r){var i;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ap(n,"POST","/v1/accounts:signInWithPhoneNumber",Ip(n,r));case 2:if(!(i=e.sent).temporaryProof){e.next=5;break}throw Pp(n,"account-exists-with-different-credential",i);case 5:return e.abrupt("return",i);case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}var sy=e(d)({},"USER_NOT_FOUND","user-not-found");function uy(){return(uy=e(u)(e(_).mark((function t(n,r){var i;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Object.assign(Object.assign({},r),{operation:"REAUTH"}),e.abrupt("return",Ap(n,"POST","/v1/accounts:signInWithPhoneNumber",Ip(n,i),sy));case 2:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var cy=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t){var i;return e(l)(this,r),(i=n.call(this,"phone","phone")).params=t,i}return e(h)(r,[{key:"_getIdTokenResponse",value:function(e){return function(e,t){return ay.apply(this,arguments)}(e,this._makeVerificationRequest())}},{key:"_linkToIdToken",value:function(e,t){return function(e,t){return oy.apply(this,arguments)}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}},{key:"_getReauthenticationResolver",value:function(e){return function(e,t){return uy.apply(this,arguments)}(e,this._makeVerificationRequest())}},{key:"_makeVerificationRequest",value:function(){var e=this.params,t=e.temporaryProof,n=e.phoneNumber,r=e.verificationId,i=e.verificationCode;return t&&n?{temporaryProof:t,phoneNumber:n}:{sessionInfo:r,code:i}}},{key:"toJSON",value:function(){var e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}}],[{key:"_fromVerification",value:function(e,t){return new r({verificationId:e,verificationCode:t})}},{key:"_fromTokenResponse",value:function(e,t){return new r({phoneNumber:e,temporaryProof:t})}},{key:"fromJSON",value:function(e){"string"==typeof e&&(e=JSON.parse(e));var t=e.verificationId,n=e.verificationCode,i=e.phoneNumber,a=e.temporaryProof;return n||t||i||a?new r({verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:a}):null}}]),r}(Nv);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ly=function(){"use strict";function t(n){var r,i,a,o,s,u;e(l)(this,t);var c=Ye(Je(n)),h=null!==(r=c.apiKey)&&void 0!==r?r:null,f=null!==(i=c.oobCode)&&void 0!==i?i:null,d=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(a=c.mode)&&void 0!==a?a:null);cp(h&&f&&d,"argument-error"),this.apiKey=h,this.operation=d,this.code=f,this.continueUrl=null!==(o=c.continueUrl)&&void 0!==o?o:null,this.languageCode=null!==(s=c.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(u=c.tenantId)&&void 0!==u?u:null}return e(h)(t,null,[{key:"parseLink",value:function(e){var n=function(e){var t=Ye(Je(e)).link,n=t?Ye(Je(t)).deep_link_id:null,r=Ye(Je(e)).deep_link_id;return(r?Ye(Je(r)).link:null)||r||n||t||e}(e);try{return new t(n)}catch(e){return null}}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var hy=function(){"use strict";function t(){e(l)(this,t),this.providerId=t.PROVIDER_ID}return e(h)(t,null,[{key:"credential",value:function(e,t){return Zv._fromEmailAndPassword(e,t)}},{key:"credentialWithLink",value:function(e,t){var n=ly.parseLink(t);return cp(n,"argument-error"),Zv._fromEmailAndCode(e,n.code,n.tenantId)}}]),t}();hy.PROVIDER_ID="password",hy.EMAIL_PASSWORD_SIGN_IN_METHOD="password",hy.EMAIL_LINK_SIGN_IN_METHOD="emailLink";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var fy=function(){"use strict";function t(n){e(l)(this,t),this.providerId=n,this.defaultLanguageCode=null,this.customParameters={}}return e(h)(t,[{key:"setDefaultLanguage",value:function(e){this.defaultLanguageCode=e}},{key:"setCustomParameters",value:function(e){return this.customParameters=e,this}},{key:"getCustomParameters",value:function(){return this.customParameters}}]),t}(),dy=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(){var t;return e(l)(this,r),(t=n.call.apply(n,[this].concat(Array.prototype.slice.call(arguments)))).scopes=[],t}return e(h)(r,[{key:"addScope",value:function(e){return this.scopes.includes(e)||this.scopes.push(e),this}},{key:"getScopes",value:function(){return e(p)(this.scopes)}}]),r}(fy),py=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(){return e(l)(this,r),n.apply(this,arguments)}return e(h)(r,[{key:"credential",value:function(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}},{key:"_credential",value:function(e){return cp(e.idToken||e.accessToken,"argument-error"),ny._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}}],[{key:"credentialFromJSON",value:function(e){var t="string"==typeof e?JSON.parse(e):e;return cp("providerId"in t&&"signInMethod"in t,"argument-error"),ny._fromParams(t)}},{key:"credentialFromResult",value:function(e){return r.oauthCredentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return r.oauthCredentialFromTaggedObject(e.customData||{})}},{key:"oauthCredentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var n=t.oauthIdToken,i=t.oauthAccessToken,a=t.oauthTokenSecret,o=t.pendingToken,s=t.nonce,u=t.providerId;if(!(i||a||n||o))return null;if(!u)return null;try{return new r(u)._credential({idToken:n,accessToken:i,nonce:s,pendingToken:o})}catch(e){return null}}}]),r}(dy),vy=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(){return e(l)(this,r),n.call(this,"facebook.com")}return e(h)(r,null,[{key:"credential",value:function(e){return ny._fromParams({providerId:r.PROVIDER_ID,signInMethod:r.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}},{key:"credentialFromResult",value:function(e){return r.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return r.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return r.credential(t.oauthAccessToken)}catch(e){return null}}}]),r}(dy);
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */vy.FACEBOOK_SIGN_IN_METHOD="facebook.com",vy.PROVIDER_ID="facebook.com";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var yy=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(){var t;return e(l)(this,r),(t=n.call(this,"google.com")).addScope("profile"),t}return e(h)(r,null,[{key:"credential",value:function(e,t){return ny._fromParams({providerId:r.PROVIDER_ID,signInMethod:r.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}},{key:"credentialFromResult",value:function(e){return r.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return r.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var n=t.oauthIdToken,i=t.oauthAccessToken;if(!n&&!i)return null;try{return r.credential(n,i)}catch(e){return null}}}]),r}(dy);yy.GOOGLE_SIGN_IN_METHOD="google.com",yy.PROVIDER_ID="google.com";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var my=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(){return e(l)(this,r),n.call(this,"github.com")}return e(h)(r,null,[{key:"credential",value:function(e){return ny._fromParams({providerId:r.PROVIDER_ID,signInMethod:r.GITHUB_SIGN_IN_METHOD,accessToken:e})}},{key:"credentialFromResult",value:function(e){return r.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return r.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return r.credential(t.oauthAccessToken)}catch(e){return null}}}]),r}(dy);my.GITHUB_SIGN_IN_METHOD="github.com",my.PROVIDER_ID="github.com";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var gy=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i){var a;return e(l)(this,r),(a=n.call(this,t,t)).pendingToken=i,a}return e(h)(r,[{key:"_getIdTokenResponse",value:function(e){return ey(e,this.buildRequest())}},{key:"_linkToIdToken",value:function(e,t){var n=this.buildRequest();return n.idToken=t,ey(e,n)}},{key:"_getReauthenticationResolver",value:function(e){var t=this.buildRequest();return t.autoCreate=!1,ey(e,t)}},{key:"toJSON",value:function(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}},{key:"buildRequest",value:function(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}],[{key:"fromJSON",value:function(e){var t="string"==typeof e?JSON.parse(e):e,n=t.providerId,i=t.signInMethod,a=t.pendingToken;return n&&i&&a&&n===i?new r(n,a):null}},{key:"_create",value:function(e,t){return new r(e,t)}}]),r}(Nv),ky=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t){return e(l)(this,r),cp(t.startsWith("saml."),"argument-error"),n.call(this,t)}return e(h)(r,null,[{key:"credentialFromResult",value:function(e){return r.samlCredentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return r.samlCredentialFromTaggedObject(e.customData||{})}},{key:"credentialFromJSON",value:function(e){var t=gy.fromJSON(e);return cp(t,"argument-error"),t}},{key:"samlCredentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var n=t.pendingToken,r=t.providerId;if(!n||!r)return null;try{return gy._create(r,n)}catch(e){return null}}}]),r}(fy),_y=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(){return e(l)(this,r),n.call(this,"twitter.com")}return e(h)(r,null,[{key:"credential",value:function(e,t){return ny._fromParams({providerId:r.PROVIDER_ID,signInMethod:r.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}},{key:"credentialFromResult",value:function(e){return r.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return r.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var n=t.oauthAccessToken,i=t.oauthTokenSecret;if(!n||!i)return null;try{return r.credential(n,i)}catch(e){return null}}}]),r}(dy);function wy(e,t){return by.apply(this,arguments)}function by(){return(by=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(_).mark((function t(n,r){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ap(n,"POST","/v1/accounts:signUp",Ip(n,r)));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */_y.TWITTER_SIGN_IN_METHOD="twitter.com",_y.PROVIDER_ID="twitter.com";var xy=function(){"use strict";function t(n){e(l)(this,t),this.user=n.user,this.providerId=n.providerId,this._tokenResponse=n._tokenResponse,this.operationType=n.operationType}return e(h)(t,null,[{key:"_fromIdTokenResponse",value:function(n,r,i){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return e(u)(e(_).mark((function o(){var s,u,c;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,iv._fromIdTokenResponse(n,i,a);case 2:return s=e.sent,u=Iy(i),c=new t({user:s,providerId:u,_tokenResponse:i,operationType:r}),e.abrupt("return",c);case 6:case"end":return e.stop()}}),o)})))()}},{key:"_forOperation",value:function(n,r,i){return e(u)(e(_).mark((function a(){var o;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n._updateTokensIfNecessary(i,!0);case 2:return o=Iy(i),e.abrupt("return",new t({user:n,providerId:o,_tokenResponse:i,operationType:r}));case 4:case"end":return e.stop()}}),a)})))()}}]),t}();function Iy(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}function Ty(){return(Ty=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(_).mark((function t(n){var r,i,a,o;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Tv(n),e.next=4,i._initializationPromise;case 4:if(!(null===(r=i.currentUser)||void 0===r?void 0:r.isAnonymous)){e.next=6;break}return e.abrupt("return",new xy({user:i.currentUser,providerId:null,operationType:"signIn"}));case 6:return e.next=8,wy(i,{returnSecureToken:!0});case 8:return a=e.sent,e.next=11,xy._fromIdTokenResponse(i,"signIn",a,!0);case 11:return o=e.sent,e.next=14,i._updateCurrentUser(o.user);case 14:return e.abrupt("return",o);case 15:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ey=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i,a,o){var s,u;return e(l)(this,r),(s=n.call(this,i.code,i.message)).operationType=a,s.user=o,Object.setPrototypeOf(e(C)(s),r.prototype),s.customData={appName:t.name,tenantId:null!==(u=t.tenantId)&&void 0!==u?u:void 0,_serverResponse:i.customData._serverResponse,operationType:a},s}return e(h)(r,null,[{key:"_fromErrorAndOperation",value:function(e,t,n,i){return new r(e,t,n,i)}}]),r}(Oe);function Sy(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((function(n){if("auth/multi-factor-auth-required"===n.code)throw Ey._fromErrorAndOperation(e,n,t,r);throw n}))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cy(e){return new Set(e.map((function(e){return e.providerId})).filter((function(e){return!!e})))}function Ay(e,t){return Ny.apply(this,arguments)}function Ny(){return(Ny=
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(_).mark((function t(n,r){var i,a,o;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=lt(n),e.next=3,Py(!0,i,r);case 3:return e.t0=Lp,e.t1=i.auth,e.next=7,i.getIdToken();case 7:return e.t2=e.sent,e.t3=[r],e.t4={idToken:e.t2,deleteProvider:e.t3},e.next=12,(0,e.t0)(e.t1,e.t4);case 12:return a=e.sent.providerUserInfo,o=Cy(a||[]),i.providerData=i.providerData.filter((function(e){return o.has(e.providerId)})),o.has("phone")||(i.phoneNumber=null),e.next=18,i.auth._persistUserIfCurrent(i);case 18:return e.abrupt("return",i);case 19:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Ry(e,t){return Dy.apply(this,arguments)}function Dy(){return Dy=e(u)(e(_).mark((function t(n,r){var i,a,o=arguments;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=o.length>2&&void 0!==o[2]&&o[2],e.t0=zp,e.t1=n,e.t2=r,e.t3=n.auth,e.next=7,n.getIdToken();case 7:return e.t4=e.sent,e.t5=e.t2._linkToIdToken.call(e.t2,e.t3,e.t4),e.t6=i,e.next=12,(0,e.t0)(e.t1,e.t5,e.t6);case 12:return a=e.sent,e.abrupt("return",xy._forOperation(n,"link",a));case 14:case"end":return e.stop()}}),t)}))),Dy.apply(this,arguments)}function Py(e,t,n){return Oy.apply(this,arguments)}function Oy(){return(Oy=e(u)(e(_).mark((function t(n,r,i){var a,o;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Yp(r);case 2:a=Cy(r.providerData),o=!1===n?"provider-already-linked":"no-such-provider",cp(a.has(i)===n,r.auth,o);case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function My(e,t){return Ly.apply(this,arguments)}function Ly(){return Ly=
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(_).mark((function t(n,r){var i,a,o,s,u,c,l=arguments;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=l.length>2&&void 0!==l[2]&&l[2],a=n.auth,o="reauthenticate",e.prev=3,e.next=6,zp(n,Sy(a,o,r,n),i);case 6:return cp((s=e.sent).idToken,a,"internal-error"),cp(u=Kp(s.idToken),a,"internal-error"),c=u.sub,cp(n.uid===c,a,"user-mismatch"),e.abrupt("return",xy._forOperation(n,o,s));case 15:throw e.prev=15,e.t0=e.catch(3),"auth/user-not-found"===(null===e.t0||void 0===e.t0?void 0:e.t0.code)&&ip(a,"user-mismatch"),e.t0;case 19:case"end":return e.stop()}}),t,null,[[3,15]])}))),Ly.apply(this,arguments)}function Fy(e,t){return Uy.apply(this,arguments)}function Uy(){return Uy=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(_).mark((function t(n,r){var i,a,o,s,u=arguments;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=u.length>2&&void 0!==u[2]&&u[2],a="signIn",e.next=4,Sy(n,a,r);case 4:return o=e.sent,e.next=7,xy._fromIdTokenResponse(n,a,o);case 7:if(s=e.sent,i){e.next=11;break}return e.next=11,n._updateCurrentUser(s.user);case 11:return e.abrupt("return",s);case 12:case"end":return e.stop()}}),t)}))),Uy.apply(this,arguments)}function qy(e,t){return Vy.apply(this,arguments)}function Vy(){return(Vy=e(u)(e(_).mark((function t(n,r){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Fy(Tv(n),r));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function jy(e,t){return By.apply(this,arguments)}function By(){return(By=e(u)(e(_).mark((function t(n,r){var i;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=lt(n),e.next=3,Py(!1,i,r.providerId);case 3:return e.abrupt("return",Ry(i,r));case 4:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Ky(e,t){return zy.apply(this,arguments)}function zy(){return(zy=e(u)(e(_).mark((function t(n,r){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",My(lt(n),r));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Wy(e,t){return Gy.apply(this,arguments)}function Gy(){return(Gy=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(_).mark((function t(n,r){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ap(n,"POST","/v1/accounts:signInWithCustomToken",Ip(n,r)));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Hy(){return(Hy=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(_).mark((function t(n,r){var i,a,o;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Tv(n),e.next=3,Wy(i,{token:r,returnSecureToken:!0});case 3:return a=e.sent,e.next=6,xy._fromIdTokenResponse(i,"signIn",a);case 6:return o=e.sent,e.next=9,i._updateCurrentUser(o.user);case 9:return e.abrupt("return",o);case 10:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Qy=function(){"use strict";function t(n,r){e(l)(this,t),this.factorId=n,this.uid=r.mfaEnrollmentId,this.enrollmentTime=new Date(r.enrolledAt).toUTCString(),this.displayName=r.displayName}return e(h)(t,null,[{key:"_fromServerResponse",value:function(e,t){return"phoneInfo"in t?Yy._fromServerResponse(e,t):ip(e,"internal-error")}}]),t}(),Yy=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t){var i;return e(l)(this,r),(i=n.call(this,"phone",t)).phoneNumber=t.phoneInfo,i}return e(h)(r,null,[{key:"_fromServerResponse",value:function(e,t){return new r(t)}}]),r}(Qy);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Jy(e,t,n){var r;cp((null===(r=n.url)||void 0===r?void 0:r.length)>0,e,"invalid-continue-uri"),cp(void 0===n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(cp(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(cp(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}function Xy(){return(Xy=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(_).mark((function t(n,r,i){var a,o;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=lt(n),o={requestType:"PASSWORD_RESET",email:r},i&&Jy(a,o,i),e.next=5,Kv(a,o);case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function $y(){return($y=e(u)(e(_).mark((function t(n,r,i){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Rv(lt(n),{oobCode:r,newPassword:i});case 2:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Zy(){return(Zy=e(u)(e(_).mark((function t(n,r){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Mv(lt(n),{oobCode:r});case 2:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function em(e,t){return tm.apply(this,arguments)}function tm(){return(tm=e(u)(e(_).mark((function t(n,r){var i,a,o,s;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=lt(n),e.next=3,Rv(i,{oobCode:r});case 3:a=e.sent,cp(o=a.requestType,i,"internal-error"),e.t0=o,e.next="EMAIL_SIGNIN"===e.t0?9:"VERIFY_AND_CHANGE_EMAIL"===e.t0?10:"REVERT_SECOND_FACTOR_ADDITION"===e.t0?12:13;break;case 9:return e.abrupt("break",14);case 10:return cp(a.newEmail,i,"internal-error"),e.abrupt("break",14);case 12:cp(a.mfaInfo,i,"internal-error");case 13:cp(a.email,i,"internal-error");case 14:return s=null,a.mfaInfo&&(s=Qy._fromServerResponse(Tv(i),a.mfaInfo)),e.abrupt("return",{data:{email:("VERIFY_AND_CHANGE_EMAIL"===a.requestType?a.newEmail:a.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===a.requestType?a.email:a.newEmail)||null,multiFactorInfo:s},operation:o});case 17:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function nm(){return(nm=e(u)(e(_).mark((function t(n,r){var i;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,em(lt(n),r);case 2:return i=e.sent.data,e.abrupt("return",i.email);case 4:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function rm(e,t,n){return im.apply(this,arguments)}function im(){return(im=e(u)(e(_).mark((function t(n,r,i){var a,o,s;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Tv(n),e.next=3,wy(a,{returnSecureToken:!0,email:r,password:i});case 3:return o=e.sent,e.next=6,xy._fromIdTokenResponse(a,"signIn",o);case 6:return s=e.sent,e.next=9,a._updateCurrentUser(s.user);case 9:return e.abrupt("return",s);case 10:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function am(){return(am=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(_).mark((function t(n,r,i){var a,o;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=lt(n),o={requestType:"EMAIL_SIGNIN",email:r},cp(i.handleCodeInApp,a,"argument-error"),i&&Jy(a,o,i),e.next=6,Wv(a,o);case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function om(){return(om=e(u)(e(_).mark((function t(n,r,i){var a,o;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=lt(n),cp((o=hy.credentialWithLink(r,i||vp()))._tenantId===(a.tenantId||null),a,"tenant-id-mismatch"),e.abrupt("return",qy(a,o));case 4:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function sm(e,t){return um.apply(this,arguments)}function um(){return(um=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(_).mark((function t(n,r){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Tp(n,"POST","/v1/accounts:createAuthUri",Ip(n,r)));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function cm(){return(cm=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(_).mark((function t(n,r){var i,a,o;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=yp()?vp():"http://localhost",a={identifier:r,continueUri:i},e.next=4,sm(lt(n),a);case 4:return o=e.sent.signinMethods,e.abrupt("return",o||[]);case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function lm(){return(lm=e(u)(e(_).mark((function t(n,r){var i,a,o;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=lt(n),e.next=3,n.getIdToken();case 3:return a=e.sent,o={requestType:"VERIFY_EMAIL",idToken:a},r&&Jy(i.auth,o,r),e.next=8,jv(i.auth,o);case 8:if(e.sent.email===n.email){e.next=12;break}return e.next=12,n.reload();case 12:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function hm(){return(hm=e(u)(e(_).mark((function t(n,r,i){var a,o,s;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=lt(n),e.next=3,n.getIdToken();case 3:return o=e.sent,s={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:o,newEmail:r},i&&Jy(a.auth,s,i),e.next=8,Hv(a.auth,s);case 8:if(e.sent.email===n.email){e.next=12;break}return e.next=12,n.reload();case 12:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function fm(e,t){return dm.apply(this,arguments)}function dm(){return(dm=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(_).mark((function t(n,r){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Tp(n,"POST","/v1/accounts:update",r));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function pm(){return(pm=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(_).mark((function t(n,r){var i,a,o,s,u,c,l;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=r.displayName,a=r.photoURL,void 0!==i||void 0!==a){e.next=3;break}return e.abrupt("return");case 3:return o=lt(n),e.next=6,o.getIdToken();case 6:return s=e.sent,u={idToken:s,displayName:i,photoUrl:a,returnSecureToken:!0},e.next=10,zp(o,fm(o.auth,u));case 10:return c=e.sent,o.displayName=c.displayName||null,o.photoURL=c.photoUrl||null,(l=o.providerData.find((function(e){return"password"===e.providerId})))&&(l.displayName=o.displayName,l.photoURL=o.photoURL),e.next=17,o._updateTokensIfNecessary(c);case 17:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function vm(e,t,n){return ym.apply(this,arguments)}function ym(){return(ym=e(u)(e(_).mark((function t(n,r,i){var a,o,s,u;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.auth,e.next=3,n.getIdToken();case 3:return o=e.sent,s={idToken:o,returnSecureToken:!0},r&&(s.email=r),i&&(s.password=i),e.next=9,zp(n,Pv(a,s));case 9:return u=e.sent,e.next=12,n._updateTokensIfNecessary(u,!0);case 12:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var mm=function t(n,r){"use strict";var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e(l)(this,t),this.isNewUser=n,this.providerId=r,this.profile=i},gm=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i,a,o){var s;return e(l)(this,r),(s=n.call(this,t,i,a)).username=o,s}return r}(mm),km=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i){return e(l)(this,r),n.call(this,t,"facebook.com",i)}return r}(mm),_m=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i){return e(l)(this,r),n.call(this,t,"github.com",i,"string"==typeof(null==i?void 0:i.login)?null==i?void 0:i.login:null)}return r}(gm),wm=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i){return e(l)(this,r),n.call(this,t,"google.com",i)}return r}(mm),bm=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i,a){return e(l)(this,r),n.call(this,t,"twitter.com",i,a)}return r}(gm);function xm(e){var t=e.user,n=e._tokenResponse;return t.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:function(e){var t,n;if(!e)return null;var r=e.providerId,i=e.rawUserInfo?JSON.parse(e.rawUserInfo):{},a=e.isNewUser||"identitytoolkit#SignupNewUserResponse"===e.kind;if(!r&&(null==e?void 0:e.idToken)){var o=null===(n=null===(t=Kp(e.idToken))||void 0===t?void 0:t.firebase)||void 0===n?void 0:n.sign_in_provider;if(o)return new mm(a,"anonymous"!==o&&"custom"!==o?o:null)}if(!r)return null;switch(r){case"facebook.com":return new km(a,i);case"github.com":return new _m(a,i);case"google.com":return new wm(a,i);case"twitter.com":return new bm(a,i,e.screenName||null);case"custom":case"anonymous":return new mm(a,null);default:return new mm(a,r,i)}}(n)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Im(e,t,n,r){return lt(e).onIdTokenChanged(t,n,r)}function Tm(e,t,n){return lt(e).beforeAuthStateChanged(t,n)}var Em=function(){"use strict";function t(n,r,i){e(l)(this,t),this.type=n,this.credential=r,this.auth=i}return e(h)(t,[{key:"toJSON",value:function(){var t="enroll"===this.type?"idToken":"pendingCredential";return{multiFactorSession:e(d)({},t,this.credential)}}}],[{key:"_fromIdtoken",value:function(e,n){return new t("enroll",e,n)}},{key:"_fromMfaPendingCredential",value:function(e){return new t("signin",e)}},{key:"fromJSON",value:function(e){var n,r;if(null==e?void 0:e.multiFactorSession){if(null===(n=e.multiFactorSession)||void 0===n?void 0:n.pendingCredential)return t._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(null===(r=e.multiFactorSession)||void 0===r?void 0:r.idToken)return t._fromIdtoken(e.multiFactorSession.idToken)}return null}}]),t}(),Sm=function(){"use strict";function t(n,r,i){e(l)(this,t),this.session=n,this.hints=r,this.signInResolver=i}return e(h)(t,[{key:"resolveSignIn",value:function(t){var n=this;return e(u)(e(_).mark((function r(){var i;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t,e.abrupt("return",n.signInResolver(i));case 2:case"end":return e.stop()}}),r)})))()}}],[{key:"_fromError",value:function(n,r){var i=Tv(n),a=r.customData._serverResponse,o=(a.mfaInfo||[]).map((function(e){return Qy._fromServerResponse(i,e)}));cp(a.mfaPendingCredential,i,"internal-error");var s,c=Em._fromMfaPendingCredential(a.mfaPendingCredential);return new t(c,o,(s=e(u)(e(_).mark((function t(n){var o,s,u;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n._process(i,c);case 2:o=e.sent,delete a.mfaInfo,delete a.mfaPendingCredential,s=Object.assign(Object.assign({},a),{idToken:o.idToken,refreshToken:o.refreshToken}),e.t0=r.operationType,e.next="signIn"===e.t0?9:"reauthenticate"===e.t0?15:17;break;case 9:return e.next=11,xy._fromIdTokenResponse(i,r.operationType,s);case 11:return u=e.sent,e.next=14,i._updateCurrentUser(u.user);case 14:return e.abrupt("return",u);case 15:return cp(r.user,i,"internal-error"),e.abrupt("return",xy._forOperation(r.user,r.operationType,s));case 17:ip(i,"internal-error");case 18:case"end":return e.stop()}}),t)}))),function(e){return s.apply(this,arguments)}))}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Cm(e,t){return Tp(e,"POST","/v2/accounts/mfaEnrollment:start",Ip(e,t))}var Am=function(){"use strict";function t(n){var r=this;e(l)(this,t),this.user=n,this.enrolledFactors=[],n._onReload((function(e){e.mfaInfo&&(r.enrolledFactors=e.mfaInfo.map((function(e){return Qy._fromServerResponse(n.auth,e)})))}))}return e(h)(t,[{key:"getSession",value:function(){var t=this;return e(u)(e(_).mark((function n(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Em,e.next=3,t.user.getIdToken();case 3:return e.t1=e.sent,e.t2=t.user.auth,e.abrupt("return",e.t0._fromIdtoken.call(e.t0,e.t1,e.t2));case 6:case"end":return e.stop()}}),n)})))()}},{key:"enroll",value:function(t,n){var r=this;return e(u)(e(_).mark((function i(){var a,o,s;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t,e.next=3,r.getSession();case 3:return o=e.sent,e.next=6,zp(r.user,a._process(r.user.auth,o,n));case 6:return s=e.sent,e.next=9,r.user._updateTokensIfNecessary(s);case 9:return e.abrupt("return",r.user.reload());case 10:case"end":return e.stop()}}),i)})))()}},{key:"unenroll",value:function(t){var n=this;return e(u)(e(_).mark((function r(){var i,a,o;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i="string"==typeof t?t:t.uid,e.next=3,n.user.getIdToken();case 3:return a=e.sent,e.next=6,zp(n.user,Tp(r=n.user.auth,"POST","/v2/accounts/mfaEnrollment:withdraw",Ip(r,{idToken:a,mfaEnrollmentId:i})));case 6:return o=e.sent,n.enrolledFactors=n.enrolledFactors.filter((function(e){return e.uid!==i})),e.next=10,n.user._updateTokensIfNecessary(o);case 10:return e.prev=10,e.next=13,n.user.reload();case 13:e.next=19;break;case 15:if(e.prev=15,e.t0=e.catch(10),"auth/user-token-expired"===(null===e.t0||void 0===e.t0?void 0:e.t0.code)){e.next=19;break}throw e.t0;case 19:case"end":return e.stop()}var r}),r,null,[[10,15]])})))()}}],[{key:"_fromUser",value:function(e){return new t(e)}}]),t}(),Nm=new WeakMap;var Rm="__sak",Dm=function(){"use strict";function t(n,r){e(l)(this,t),this.storageRetriever=n,this.type=r}return e(h)(t,[{key:"_isAvailable",value:function(){try{return this.storage?(this.storage.setItem(Rm,"1"),this.storage.removeItem(Rm),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}},{key:"_set",value:function(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}},{key:"_get",value:function(e){var t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}},{key:"_remove",value:function(e){return this.storage.removeItem(e),Promise.resolve()}},{key:"storage",get:function(){return this.storageRetriever()}}]),t}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Pm=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(){var t,i;return e(l)(this,r),(t=n.call(this,(function(){return window.localStorage}),"LOCAL")).boundEventHandler=function(e,n){return t.onStorageEvent(e,n)},t.listeners={},t.localCache={},t.pollTimer=null,t.safariLocalStorageNotSynced=(hv(i=ye())||mv(i))&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),t.fallbackToPolling=wv(),t._shouldAllowMigration=!0,t}return e(h)(r,[{key:"forAllChangedKeys",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=Object.keys(this.listeners)[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value,s=this.storage.getItem(o),u=this.localCache[o];s!==u&&e(o,u,s)}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}}},{key:"onStorageEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;if(e.key){var r=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){var i=this.storage.getItem(r);if(e.newValue!==i)null!==e.newValue?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!t)return}var a=function(){var e=n.storage.getItem(r);(t||n.localCache[r]!==e)&&n.notifyListeners(r,e)},o=this.storage.getItem(r);_v()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,10):a()}else{var s=this;this.forAllChangedKeys((function(e,t,n){s.notifyListeners(e,n)}))}}},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e],r=!0,i=!1,a=void 0;if(n)try{for(var o,s=Array.from(n)[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){(0,o.value)(t?JSON.parse(t):t)}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}}},{key:"startPolling",value:function(){var e=this;this.stopPolling(),this.pollTimer=setInterval((function(){var t=e;e.forAllChangedKeys((function(e,n,r){t.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)}))}),1e3)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"attachListener",value:function(){window.addEventListener("storage",this.boundEventHandler)}},{key:"detachListener",value:function(){window.removeEventListener("storage",this.boundEventHandler)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}},{key:"_set",value:function(t,n){var i=this,a=this;return e(u)(e(_).mark((function o(){return e(_).wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,e(Nd)(e(Pd)(r.prototype),"_set",i).call(a,t,n);case 2:a.localCache[t]=JSON.stringify(n);case 3:case"end":return o.stop()}}),o)})))()}},{key:"_get",value:function(t){var n=this,i=this;return e(u)(e(_).mark((function a(){var o;return e(_).wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e(Nd)(e(Pd)(r.prototype),"_get",n).call(i,t);case 2:return o=a.sent,i.localCache[t]=JSON.stringify(o),a.abrupt("return",o);case 5:case"end":return a.stop()}}),a)})))()}},{key:"_remove",value:function(t){var n=this,i=this;return e(u)(e(_).mark((function a(){return e(_).wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e(Nd)(e(Pd)(r.prototype),"_remove",n).call(i,t);case 2:delete i.localCache[t];case 3:case"end":return a.stop()}}),a)})))()}}]),r}(Dm);Pm.type="LOCAL";var Om=Pm,Mm=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(){return e(l)(this,r),n.call(this,(function(){return window.sessionStorage}),"SESSION")}return e(h)(r,[{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),r}(Dm);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Mm.type="SESSION";var Lm=Mm;
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fm(t){return Promise.all(t.map((n=e(u)(e(_).mark((function t(n){var r;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n;case 3:return r=e.sent,e.abrupt("return",{fulfilled:!0,value:r});case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",{fulfilled:!1,reason:e.t0});case 10:case"end":return e.stop()}}),t,null,[[0,7]])}))),function(e){return n.apply(this,arguments)})));var n}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Um=function(){"use strict";function t(n){e(l)(this,t),this.eventTarget=n,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}return e(h)(t,[{key:"isListeningto",value:function(e){return this.eventTarget===e}},{key:"handleEvent",value:function(t){var n=this;return e(u)(e(_).mark((function r(){var i,a,o,s,c,l,h,f;return e(_).wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(a=(i=t).data,o=a.eventId,s=a.eventType,c=a.data,null==(l=n.handlersMap[s])?void 0:l.size){r.next=5;break}return r.abrupt("return");case 5:return i.ports[0].postMessage({status:"ack",eventId:o,eventType:s}),h=Array.from(l).map(function(){var t=e(u)(e(_).mark((function t(n){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n(i.origin,c));case 1:case"end":return e.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),r.next=9,Fm(h);case 9:f=r.sent,i.ports[0].postMessage({status:"done",eventId:o,eventType:s,response:f});case 11:case"end":return r.stop()}}),r)})))()}},{key:"_subscribe",value:function(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}},{key:"_unsubscribe",value:function(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}],[{key:"_getInstance",value:function(e){var n=this.receivers.find((function(t){return t.isListeningto(e)}));if(n)return n;var r=new t(e);return this.receivers.push(r),r}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function qm(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="",r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Um.receivers=[];var Vm=function(){"use strict";function t(n){e(l)(this,t),this.target=n,this.handlers=new Set}return e(h)(t,[{key:"removeMessageHandler",value:function(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}},{key:"_send",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,i=this;return e(u)(e(_).mark((function a(){var o,s,u;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o="undefined"!=typeof MessageChannel?new MessageChannel:null){e.next=3;break}throw new Error("connection_unavailable");case 3:return e.abrupt("return",new Promise((function(e,a){var c=qm("",20);o.port1.start();var l=setTimeout((function(){a(new Error("unsupported_event"))}),r);u={messageChannel:o,onMessage:function(t){var n=t;if(n.data.eventId===c)switch(n.data.status){case"ack":clearTimeout(l),s=setTimeout((function(){a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(s),e(n.data.response);break;default:clearTimeout(l),clearTimeout(s),a(new Error("invalid_response"))}}},i.handlers.add(u),o.port1.addEventListener("message",u.onMessage),i.target.postMessage({eventType:t,eventId:c,data:n},[o.port2])})).finally((function(){u&&i.removeMessageHandler(u)})));case 6:case"end":return e.stop()}}),a)})))()}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jm(){return window}
/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Bm(){return void 0!==jm().WorkerGlobalScope&&"function"==typeof jm().importScripts}function Km(){return zm.apply(this,arguments)}function zm(){return(zm=e(u)(e(_).mark((function t(){var n;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===navigator||void 0===navigator?void 0:navigator.serviceWorker){e.next=2;break}return e.abrupt("return",null);case 2:return e.prev=2,e.next=5,navigator.serviceWorker.ready;case 5:return n=e.sent,e.abrupt("return",n.active);case 9:return e.prev=9,e.t0=e.catch(2),e.abrupt("return",null);case 12:case"end":return e.stop()}}),t,null,[[2,9]])})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Wm="firebaseLocalStorageDb",Gm="firebaseLocalStorage",Hm="fbase_key",Qm=function(){"use strict";function t(n){e(l)(this,t),this.request=n}return e(h)(t,[{key:"toPromise",value:function(){var e=this;return new Promise((function(t,n){var r=e;e.request.addEventListener("success",(function(){t(r.request.result)})),e.request.addEventListener("error",(function(){n(r.request.error)}))}))}}]),t}();function Ym(e,t){return e.transaction([Gm],t?"readwrite":"readonly").objectStore(Gm)}function Jm(){var e=indexedDB.deleteDatabase(Wm);return new Qm(e).toPromise()}function Xm(){var t=indexedDB.open(Wm,1);return new Promise((function(n,r){t.addEventListener("error",(function(){r(t.error)})),t.addEventListener("upgradeneeded",(function(){var e=t.result;try{e.createObjectStore(Gm,{keyPath:Hm})}catch(e){r(e)}})),t.addEventListener("success",e(u)(e(_).mark((function r(){var i;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((i=t.result).objectStoreNames.contains(Gm)){e.next=12;break}return i.close(),e.next=5,Jm();case 5:return e.t0=n,e.next=8,Xm();case 8:e.t1=e.sent,(0,e.t0)(e.t1),e.next=13;break;case 12:n(i);case 13:case"end":return e.stop()}}),r)}))))}))}function $m(e,t,n){return Zm.apply(this,arguments)}function Zm(){return(Zm=e(u)(e(_).mark((function t(n,r,i){var a,o;return e(_).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=Ym(n,!0).put((a={},e(d)(a,Hm,r),e(d)(a,"value",i),a)),t.abrupt("return",new Qm(o).toPromise());case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function eg(e,t){return tg.apply(this,arguments)}function tg(){return(tg=e(u)(e(_).mark((function t(n,r){var i,a;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Ym(n,!1).get(r),e.next=3,new Qm(i).toPromise();case 3:return a=e.sent,e.abrupt("return",void 0===a?null:a.value);case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function ng(e,t){var n=Ym(e,!0).delete(t);return new Qm(n).toPromise()}var rg=function(){"use strict";function t(){e(l)(this,t),this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((function(){}),(function(){}))}return e(h)(t,[{key:"_openDb",value:function(){var t=this;return e(u)(e(_).mark((function n(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.db){e.next=2;break}return e.abrupt("return",t.db);case 2:return e.next=4,Xm();case 4:return t.db=e.sent,e.abrupt("return",t.db);case 6:case"end":return e.stop()}}),n)})))()}},{key:"_withRetries",value:function(t){var n=this;return e(u)(e(_).mark((function r(){var i,a;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=0;case 1:return e.prev=2,e.next=5,n._openDb();case 5:return a=e.sent,e.next=8,t(a);case 8:return e.abrupt("return",e.sent);case 11:if(e.prev=11,e.t0=e.catch(2),!(i++>3)){e.next=15;break}throw e.t0;case 15:n.db&&(n.db.close(),n.db=void 0);case 16:e.next=1;break;case 18:case"end":return e.stop()}}),r,null,[[2,11]])})))()}},{key:"initializeServiceWorkerMessaging",value:function(){var t=this;return e(u)(e(_).mark((function n(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Bm()?t.initializeReceiver():t.initializeSender());case 1:case"end":return e.stop()}}),n)})))()}},{key:"initializeReceiver",value:function(){var t=this;return e(u)(e(_).mark((function n(){return e(_).wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t.receiver=Um._getInstance(Bm()?self:null),t.receiver._subscribe("keyChanged",function(){var n=e(u)(e(_).mark((function n(r,i){var a;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._poll();case 2:return a=e.sent,e.abrupt("return",{keyProcessed:a.includes(i.key)});case 4:case"end":return e.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}()),t.receiver._subscribe("ping",function(){var t=e(u)(e(_).mark((function t(n,r){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",["keyChanged"]);case 1:case"end":return e.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}());case 3:case"end":return n.stop()}}),n)})))()}},{key:"initializeSender",value:function(){var t=this;return e(u)(e(_).mark((function n(){var r,i,a;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,Km();case 3:if(t.activeServiceWorker=e.sent,t.activeServiceWorker){e.next=6;break}return e.abrupt("return");case 6:return t.sender=new Vm(t.activeServiceWorker),e.next=9,t.sender._send("ping",{},800);case 9:if(a=e.sent){e.next=12;break}return e.abrupt("return");case 12:(null===(r=a[0])||void 0===r?void 0:r.fulfilled)&&(null===(i=a[0])||void 0===i?void 0:i.value.includes("keyChanged"))&&(t.serviceWorkerReceiverAvailable=!0);case 13:case"end":return e.stop()}}),n)})))()}},{key:"notifyServiceWorker",value:function(t){var n=this;return e(u)(e(_).mark((function r(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.sender&&n.activeServiceWorker&&(r=void 0,((null===(r=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===r?void 0:r.controller)||null)===n.activeServiceWorker)){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,n.sender._send("keyChanged",{key:t},n.serviceWorkerReceiverAvailable?800:50);case 5:e.next=9;break;case 7:e.prev=7,e.t0=e.catch(2);case 9:case"end":return e.stop()}var r}),r,null,[[2,7]])})))()}},{key:"_isAvailable",value:function(){return e(u)(e(_).mark((function t(){var n;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,indexedDB){e.next=3;break}return e.abrupt("return",!1);case 3:return e.next=5,Xm();case 5:return n=e.sent,e.next=8,$m(n,Rm,"1");case 8:return e.next=10,ng(n,Rm);case 10:return e.abrupt("return",!0);case 13:e.prev=13,e.t0=e.catch(0);case 15:return e.abrupt("return",!1);case 16:case"end":return e.stop()}}),t,null,[[0,13]])})))()}},{key:"_withPendingWrite",value:function(t){var n=this;return e(u)(e(_).mark((function r(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.pendingWrites++,e.prev=1,e.next=4,t();case 4:return e.prev=4,n.pendingWrites--,e.finish(4);case 7:case"end":return e.stop()}}),r,null,[[1,,4,7]])})))()}},{key:"_set",value:function(t,n){var r=this;return e(u)(e(_).mark((function i(){return e(_).wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",r._withPendingWrite(e(u)(e(_).mark((function i(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r._withRetries((function(e){return $m(e,t,n)}));case 2:return r.localCache[t]=n,e.abrupt("return",r.notifyServiceWorker(t));case 4:case"end":return e.stop()}}),i)})))));case 1:case"end":return i.stop()}}),i)})))()}},{key:"_get",value:function(t){var n=this;return e(u)(e(_).mark((function r(){var i;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n._withRetries((function(e){return eg(e,t)}));case 2:return i=e.sent,n.localCache[t]=i,e.abrupt("return",i);case 5:case"end":return e.stop()}}),r)})))()}},{key:"_remove",value:function(t){var n=this;return e(u)(e(_).mark((function r(){return e(_).wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",n._withPendingWrite(e(u)(e(_).mark((function r(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n._withRetries((function(e){return ng(e,t)}));case 2:return delete n.localCache[t],e.abrupt("return",n.notifyServiceWorker(t));case 4:case"end":return e.stop()}}),r)})))));case 1:case"end":return r.stop()}}),r)})))()}},{key:"_poll",value:function(){var t=this;return e(u)(e(_).mark((function n(){var r,i,a,o,s,u,c,l,h,f,d,p,v,y,m,g,k;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._withRetries((function(e){var t=Ym(e,!1).getAll();return new Qm(t).toPromise()}));case 2:if(r=e.sent){e.next=5;break}return e.abrupt("return",[]);case 5:if(0===t.pendingWrites){e.next=7;break}return e.abrupt("return",[]);case 7:for(i=[],a=new Set,o=!0,s=!1,u=void 0,e.prev=10,c=r[Symbol.iterator]();!(o=(l=c.next()).done);o=!0)h=l.value,f=h.fbase_key,d=h.value,a.add(f),JSON.stringify(t.localCache[f])!==JSON.stringify(d)&&(t.notifyListeners(f,d),i.push(f));e.next=18;break;case 14:e.prev=14,e.t0=e.catch(10),s=!0,u=e.t0;case 18:e.prev=18,e.prev=19,o||null==c.return||c.return();case 21:if(e.prev=21,!s){e.next=24;break}throw u;case 24:return e.finish(21);case 25:return e.finish(18);case 26:for(p=!0,v=!1,y=void 0,e.prev=27,m=Object.keys(t.localCache)[Symbol.iterator]();!(p=(g=m.next()).done);p=!0)k=g.value,t.localCache[k]&&!a.has(k)&&(t.notifyListeners(k,null),i.push(k));e.next=35;break;case 31:e.prev=31,e.t1=e.catch(27),v=!0,y=e.t1;case 35:e.prev=35,e.prev=36,p||null==m.return||m.return();case 38:if(e.prev=38,!v){e.next=41;break}throw y;case 41:return e.finish(38);case 42:return e.finish(35);case 43:return e.abrupt("return",i);case 44:case"end":return e.stop()}}),n,null,[[10,14,18,26],[19,,21,25],[27,31,35,43],[36,,38,42]])})))()}},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e],r=!0,i=!1,a=void 0;if(n)try{for(var o,s=Array.from(n)[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){(0,o.value)(t)}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}}},{key:"startPolling",value:function(){this.stopPolling();var t=this;this.pollTimer=setInterval(e(u)(e(_).mark((function n(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t._poll());case 1:case"end":return e.stop()}}),n)}))),800)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}]),t}();rg.type="LOCAL";var ig=rg;
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ag(e,t){return Tp(e,"POST","/v2/accounts/mfaSignIn:start",Ip(e,t))}function og(e){return sg.apply(this,arguments)}function sg(){return(sg=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(_).mark((function t(n){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Tp(n,"GET","/v1/recaptchaParams");case 2:if(e.t0=e.sent.recaptchaSiteKey,e.t0){e.next=5;break}e.t0="";case 5:return e.abrupt("return",e.t0);case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ug(e){return new Promise((function(t,n){var r,i,a=document.createElement("script");a.setAttribute("src",e),a.onload=t,a.onerror=function(e){var t=ap("internal-error");t.customData=e,n(t)},a.type="text/javascript",a.charset="UTF-8",(null!==(i=null===(r=document.getElementsByTagName("head"))||void 0===r?void 0:r[0])&&void 0!==i?i:document).appendChild(a)}))}function cg(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var lg=1e12,hg=function(){"use strict";function t(n){e(l)(this,t),this.auth=n,this.counter=lg,this._widgets=new Map}return e(h)(t,[{key:"render",value:function(e,t){var n=this.counter;return this._widgets.set(n,new fg(e,this.auth.name,t||{})),this.counter++,n}},{key:"reset",value:function(e){var t,n=e||lg;null===(t=this._widgets.get(n))||void 0===t||t.delete(),this._widgets.delete(n)}},{key:"getResponse",value:function(e){var t,n=e||lg;return(null===(t=this._widgets.get(n))||void 0===t?void 0:t.getResponse())||""}},{key:"execute",value:function(t){var n=this;return e(u)(e(_).mark((function r(){var i,a;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t||lg,null===(i=n._widgets.get(a))||void 0===i||i.execute(),e.abrupt("return","");case 4:case"end":return e.stop()}}),r)})))()}}]),t}(),fg=function(){"use strict";function t(n,r,i){var a=this;e(l)(this,t),this.params=i,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=function(){a.execute()};var o="string"==typeof n?document.getElementById(n):n;cp(o,"argument-error",{appName:r}),this.container=o,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}return e(h)(t,[{key:"getResponse",value:function(){return this.checkIfDeleted(),this.responseToken}},{key:"delete",value:function(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}},{key:"execute",value:function(){var e=this;this.checkIfDeleted(),this.timerId||(this.timerId=window.setTimeout((function(){var t=e;e.responseToken=function(e){for(var t=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",r=0;r<e;r++)t.push(n.charAt(Math.floor(Math.random()*n.length)));return t.join("")}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(50);var n=e.params,r=n.callback,i=n["expired-callback"];if(r)try{r(e.responseToken)}catch(e){}e.timerId=window.setTimeout((function(){if(t.timerId=null,t.responseToken=null,i)try{i()}catch(e){}t.isVisible&&t.execute()}),6e4)}),500))}},{key:"checkIfDeleted",value:function(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}]),t}();var dg=cg("rcb"),pg=new gp(3e4,6e4),vg="https://www.google.com/recaptcha/api.js?",yg=function(){"use strict";function t(){var n;e(l)(this,t),this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(null===(n=jm().grecaptcha)||void 0===n?void 0:n.render)}return e(h)(t,[{key:"load",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=this;return cp(mg(t),e,"argument-error"),this.shouldResolveImmediately(t)?Promise.resolve(jm().grecaptcha):new Promise((function(r,i){var a=n,o=jm().setTimeout((function(){i(ap(e,"network-request-failed"))}),pg.get());jm()[dg]=function(){var n=a;jm().clearTimeout(o),delete jm()[dg];var s=jm().grecaptcha;if(s){var u=s.render;s.render=function(e,t){var r=u(e,t);return n.counter++,r},a.hostLanguage=t,r(s)}else i(ap(e,"internal-error"))},ug("".concat(vg,"?").concat(Qe({onload:dg,render:"explicit",hl:t}))).catch((function(){clearTimeout(o),i(ap(e,"internal-error"))}))}))}},{key:"clearedOneInstance",value:function(){this.counter--}},{key:"shouldResolveImmediately",value:function(e){var t;return!!(null===(t=jm().grecaptcha)||void 0===t?void 0:t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}]),t}();function mg(e){return e.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(e)}var gg=function(){"use strict";function t(){e(l)(this,t)}return e(h)(t,[{key:"load",value:function(t){return e(u)(e(_).mark((function n(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new hg(t));case 1:case"end":return e.stop()}}),n)})))()}},{key:"clearedOneInstance",value:function(){}}]),t}(),kg="recaptcha",_g={theme:"light",type:"image"},wg=function(){"use strict";function t(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object.assign({},_g),i=arguments.length>2?arguments[2]:void 0;e(l)(this,t),this.parameters=r,this.type=kg,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Tv(i),this.isInvisible="invisible"===this.parameters.size,cp("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment");var a="string"==typeof n?document.getElementById(n):n;cp(a,this.auth,"argument-error"),this.container=a,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new gg:new yg,this.validateStartingState()}return e(h)(t,[{key:"verify",value:function(){var t=this;return e(u)(e(_).mark((function n(){var r,i,a;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.assertNotDestroyed(),e.next=3,t.render();case 3:if(r=e.sent,i=t.getAssertedRecaptcha(),!(a=i.getResponse(r))){e.next=8;break}return e.abrupt("return",a);case 8:return e.abrupt("return",new Promise((function(e){var n=function(r){r&&(t.tokenChangeListeners.delete(n),e(r))};t.tokenChangeListeners.add(n),t.isInvisible&&i.execute(r)})));case 9:case"end":return e.stop()}}),n)})))()}},{key:"render",value:function(){var e=this;try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch((function(t){throw e.renderPromise=null,t}))),this.renderPromise}},{key:"_reset",value:function(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}},{key:"clear",value:function(){var e=this;this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach((function(t){e.container.removeChild(t)}))}},{key:"validateStartingState",value:function(){cp(!this.parameters.sitekey,this.auth,"argument-error"),cp(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),cp("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment")}},{key:"makeTokenCallback",value:function(e){var t=this;return function(n){if(t.tokenChangeListeners.forEach((function(e){return e(n)})),"function"==typeof e)e(n);else if("string"==typeof e){var r=jm()[e];"function"==typeof r&&r(n)}}}},{key:"assertNotDestroyed",value:function(){cp(!this.destroyed,this.auth,"internal-error")}},{key:"makeRenderPromise",value:function(){var t=this;return e(u)(e(_).mark((function n(){var r,i;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.init();case 2:return t.widgetId||(r=t.container,t.isInvisible||(i=document.createElement("div"),r.appendChild(i),r=i),t.widgetId=t.getAssertedRecaptcha().render(r,t.parameters)),e.abrupt("return",t.widgetId);case 4:case"end":return e.stop()}}),n)})))()}},{key:"init",value:function(){var t=this;return e(u)(e(_).mark((function n(){var r;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return cp(yp()&&!Bm(),t.auth,"internal-error"),e.next=3,bg();case 3:return e.next=5,t._recaptchaLoader.load(t.auth,t.auth.languageCode||void 0);case 5:return t.recaptcha=e.sent,e.next=8,og(t.auth);case 8:cp(r=e.sent,t.auth,"internal-error"),t.parameters.sitekey=r;case 11:case"end":return e.stop()}}),n)})))()}},{key:"getAssertedRecaptcha",value:function(){return cp(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bg(){var e=null;return new Promise((function(t){"complete"!==document.readyState?(e=function(){return t()},window.addEventListener("load",e)):t()})).catch((function(t){throw e&&window.removeEventListener("load",e),t}))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xg=function(){"use strict";function t(n,r){e(l)(this,t),this.verificationId=n,this.onConfirmation=r}return e(h)(t,[{key:"confirm",value:function(e){var t=cy._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}]),t}();function Ig(){return(Ig=e(u)(e(_).mark((function t(n,r,i){var a,o;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Tv(n),e.next=3,Cg(a,r,lt(i));case 3:return o=e.sent,e.abrupt("return",new xg(o,(function(e){return qy(a,e)})));case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Tg(e,t,n){return Eg.apply(this,arguments)}function Eg(){return(Eg=e(u)(e(_).mark((function t(n,r,i){var a,o;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=lt(n),e.next=3,Py(!1,a,"phone");case 3:return e.next=5,Cg(a.auth,r,lt(i));case 5:return o=e.sent,e.abrupt("return",new xg(o,(function(e){return jy(a,e)})));case 7:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Sg(){return(Sg=e(u)(e(_).mark((function t(n,r,i){var a,o;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=lt(n),e.next=3,Cg(a.auth,r,lt(i));case 3:return o=e.sent,e.abrupt("return",new xg(o,(function(e){return Ky(a,e)})));case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Cg(e,t,n){return Ag.apply(this,arguments)}function Ag(){return(Ag=e(u)(e(_).mark((function t(n,r,i){var a,o,s,u,c,l,h,f;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,i.verify();case 3:if(o=e.sent,e.prev=4,cp("string"==typeof o,n,"argument-error"),cp(i.type===kg,n,"argument-error"),!("session"in(s="string"==typeof r?{phoneNumber:r}:r))){e.next=28;break}if(u=s.session,!("phoneNumber"in s)){e.next=19;break}return cp("enroll"===u.type,n,"internal-error"),e.next=15,Cm(n,{idToken:u.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:o}});case 15:return c=e.sent,e.abrupt("return",c.phoneSessionInfo.sessionInfo);case 19:return cp("signin"===u.type,n,"internal-error"),cp(l=(null===(a=s.multiFactorHint)||void 0===a?void 0:a.uid)||s.multiFactorUid,n,"missing-multi-factor-info"),e.next=24,ag(n,{mfaPendingCredential:u.credential,mfaEnrollmentId:l,phoneSignInInfo:{recaptchaToken:o}});case 24:return h=e.sent,e.abrupt("return",h.phoneResponseInfo.sessionInfo);case 26:e.next=32;break;case 28:return e.next=30,ry(n,{phoneNumber:s.phoneNumber,recaptchaToken:o});case 30:return f=e.sent.sessionInfo,e.abrupt("return",f);case 32:return e.prev=32,i._reset(),e.finish(32);case 35:case"end":return e.stop()}}),t,null,[[4,,32,35]])})))).apply(this,arguments)}function Ng(){return(Ng=e(u)(e(_).mark((function t(n,r){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ry(lt(n),r);case 2:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Rg=function(){"use strict";function t(n){e(l)(this,t),this.providerId=t.PROVIDER_ID,this.auth=Tv(n)}return e(h)(t,[{key:"verifyPhoneNumber",value:function(e,t){return Cg(this.auth,e,lt(t))}}],[{key:"credential",value:function(e,t){return cy._fromVerification(e,t)}},{key:"credentialFromResult",value:function(e){var n=e;return t.credentialFromTaggedObject(n)}},{key:"credentialFromError",value:function(e){return t.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var n=t.phoneNumber,r=t.temporaryProof;return n&&r?cy._fromTokenResponse(n,r):null}}]),t}();
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Dg(e,t){return t?dp(t):(cp(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Rg.PROVIDER_ID="phone",Rg.PHONE_SIGN_IN_METHOD="phone";var Pg=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t){var i;return e(l)(this,r),(i=n.call(this,"custom","custom")).params=t,i}return e(h)(r,[{key:"_getIdTokenResponse",value:function(e){return ey(e,this._buildIdpRequest())}},{key:"_linkToIdToken",value:function(e,t){return ey(e,this._buildIdpRequest(t))}},{key:"_getReauthenticationResolver",value:function(e){return ey(e,this._buildIdpRequest())}},{key:"_buildIdpRequest",value:function(e){var t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}]),r}(Nv);function Og(e){return Fy(e.auth,new Pg(e),e.bypassAuthState)}function Mg(e){var t=e.auth,n=e.user;return cp(n,t,"internal-error"),My(n,new Pg(e),e.bypassAuthState)}function Lg(e){return Fg.apply(this,arguments)}function Fg(){return(Fg=e(u)(e(_).mark((function t(n){var r,i;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.auth,cp(i=n.user,r,"internal-error"),e.abrupt("return",Ry(i,new Pg(n),n.bypassAuthState));case 3:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ug=function(){"use strict";function t(n,r,i,a){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];e(l)(this,t),this.auth=n,this.resolver=i,this.user=a,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}return e(h)(t,[{key:"execute",value:function(){var t,n=this;return new Promise((t=e(u)(e(_).mark((function t(r,i){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.pendingPromise={resolve:r,reject:i},e.prev=1,e.next=4,n.resolver._initialize(n.auth);case 4:return n.eventManager=e.sent,e.next=7,n.onExecution();case 7:n.eventManager.registerConsumer(n),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),n.reject(e.t0);case 13:case"end":return e.stop()}}),t,null,[[1,10]])}))),function(e,n){return t.apply(this,arguments)}))}},{key:"onAuthEvent",value:function(t){var n=this;return e(u)(e(_).mark((function r(){var i,a,o,s,u,c,l;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.urlResponse,a=t.sessionId,o=t.postBody,s=t.tenantId,u=t.error,c=t.type,!u){e.next=4;break}return n.reject(u),e.abrupt("return");case 4:return l={auth:n.auth,requestUri:i,sessionId:a,tenantId:s||void 0,postBody:o||void 0,user:n.user,bypassAuthState:n.bypassAuthState},e.prev=5,e.t0=n,e.next=9,n.getIdpTask(c)(l);case 9:e.t1=e.sent,e.t0.resolve.call(e.t0,e.t1),e.next=16;break;case 13:e.prev=13,e.t2=e.catch(5),n.reject(e.t2);case 16:case"end":return e.stop()}}),r,null,[[5,13]])})))()}},{key:"onError",value:function(e){this.reject(e)}},{key:"getIdpTask",value:function(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Og;case"linkViaPopup":case"linkViaRedirect":return Lg;case"reauthViaPopup":case"reauthViaRedirect":return Mg;default:ip(this.auth,"internal-error")}}},{key:"resolve",value:function(e){hp(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}},{key:"reject",value:function(e){hp(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}},{key:"unregisterAndCleanUp",value:function(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}]),t}(),qg=new gp(2e3,1e4);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vg(e,t,n){return jg.apply(this,arguments)}function jg(){return(jg=e(u)(e(_).mark((function t(n,r,i){var a,o,s;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Tv(n),sp(n,r,fy),o=Dg(a,i),s=new Wg(a,"signInViaPopup",r,o),e.abrupt("return",s.executeNotNull());case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Bg(){return(Bg=e(u)(e(_).mark((function t(n,r,i){var a,o,s;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return sp((a=lt(n)).auth,r,fy),o=Dg(a.auth,i),s=new Wg(a.auth,"reauthViaPopup",r,o,a),e.abrupt("return",s.executeNotNull());case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Kg(e,t,n){return zg.apply(this,arguments)}function zg(){return(zg=e(u)(e(_).mark((function t(n,r,i){var a,o,s;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return sp((a=lt(n)).auth,r,fy),o=Dg(a.auth,i),s=new Wg(a.auth,"linkViaPopup",r,o,a),e.abrupt("return",s.executeNotNull());case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}var Wg=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i,a,o,s){var u;return e(l)(this,r),(u=n.call(this,t,i,o,s)).provider=a,u.authWindow=null,u.pollId=null,r.currentPopupAction&&r.currentPopupAction.cancel(),r.currentPopupAction=e(C)(u),u}return e(h)(r,[{key:"executeNotNull",value:function(){var t=this;return e(u)(e(_).mark((function n(){var r;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.execute();case 2:return cp(r=e.sent,t.auth,"internal-error"),e.abrupt("return",r);case 5:case"end":return e.stop()}}),n)})))()}},{key:"onExecution",value:function(){var t=this;return e(u)(e(_).mark((function n(){var r;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return hp(1===t.filter.length,"Popup operations only handle one event"),r=qm(),e.next=4,t.resolver._openPopup(t.auth,t.provider,t.filter[0],r);case 4:t.authWindow=e.sent,t.authWindow.associatedEvent=r,t.resolver._originValidation(t.auth).catch((function(e){t.reject(e)})),t.resolver._isIframeWebStorageSupported(t.auth,(function(e){e||t.reject(ap(t.auth,"web-storage-unsupported"))})),t.pollUserCancellation();case 9:case"end":return e.stop()}}),n)})))()}},{key:"eventId",get:function(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}},{key:"cancel",value:function(){this.reject(ap(this.auth,"cancelled-popup-request"))}},{key:"cleanUp",value:function(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,r.currentPopupAction=null}},{key:"pollUserCancellation",value:function(){var e=this,t=function(){var n,r;if(null===(r=null===(n=e.authWindow)||void 0===n?void 0:n.window)||void 0===r?void 0:r.closed){var i=e;e.pollId=window.setTimeout((function(){i.pollId=null,i.reject(ap(i.auth,"popup-closed-by-user"))}),2e3)}else e.pollId=window.setTimeout(t,qg.get())};t()}}]),r}(Ug);Wg.currentPopupAction=null;
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Gg=new Map,Hg=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i){var a,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e(l)(this,r),(a=n.call(this,t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],i,void 0,o)).eventId=null,a}return e(h)(r,[{key:"execute",value:function(){var t=this,n=this;return e(u)(e(_).mark((function i(){var a,o;return e(_).wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(a=Gg.get(n.auth._key())){i.next=21;break}return i.prev=2,i.next=5,Qg(n.resolver,n.auth);case 5:if(!i.sent){i.next=12;break}return i.next=9,e(Nd)(e(Pd)(r.prototype),"execute",t).call(n);case 9:i.t0=i.sent,i.next=13;break;case 12:i.t0=null;case 13:o=i.t0,a=function(){return Promise.resolve(o)},i.next=20;break;case 17:i.prev=17,i.t1=i.catch(2),a=function(){return Promise.reject(i.t1)};case 20:Gg.set(n.auth._key(),a);case 21:return n.bypassAuthState||Gg.set(n.auth._key(),(function(){return Promise.resolve(null)})),i.abrupt("return",a());case 23:case"end":return i.stop()}}),i,null,[[2,17]])})))()}},{key:"onAuthEvent",value:function(t){var n=this,i=this,a=function(){return e(Nd)(e(Pd)(r.prototype),"onAuthEvent",n)};return e(u)(e(_).mark((function n(){var r;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("signInViaRedirect"!==t.type){e.next=4;break}return e.abrupt("return",a().call(i,t));case 4:if("unknown"!==t.type){e.next=7;break}return i.resolve(null),e.abrupt("return");case 7:if(!t.eventId){e.next=17;break}return e.next=10,i.auth._redirectUserForId(t.eventId);case 10:if(!(r=e.sent)){e.next=16;break}return i.user=r,e.abrupt("return",a().call(i,t));case 16:i.resolve(null);case 17:case"end":return e.stop()}}),n)})))()}},{key:"onExecution",value:function(){return e(u)(e(_).mark((function t(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),t)})))()}},{key:"cleanUp",value:function(){}}]),r}(Ug);function Qg(e,t){return Yg.apply(this,arguments)}function Yg(){return(Yg=e(u)(e(_).mark((function t(n,r){var i,a,o;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=ek(r),a=Zg(n),e.next=4,a._isAvailable();case 4:if(e.sent){e.next=6;break}return e.abrupt("return",!1);case 6:return e.next=8,a._get(i);case 8:return e.t0=e.sent,o="true"===e.t0,e.next=12,a._remove(i);case 12:return e.abrupt("return",o);case 13:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Jg(e,t){return Xg.apply(this,arguments)}function Xg(){return(Xg=e(u)(e(_).mark((function t(n,r){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Zg(n)._set(ek(r),"true"));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function $g(e,t){Gg.set(e._key(),t)}function Zg(e){return dp(e._redirectPersistence)}function ek(e){return sv("pendingRedirect",e.config.apiKey,e.name)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tk(e,t,n){return function(e,t,n){return nk.apply(this,arguments)}(e,t,n)}function nk(){return(nk=e(u)(e(_).mark((function t(n,r,i){var a,o;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Tv(n),sp(n,r,fy),o=Dg(a,i),e.next=5,Jg(o,a);case 5:return e.abrupt("return",o._openRedirect(a,r,"signInViaRedirect"));case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function rk(e,t,n){return function(e,t,n){return ik.apply(this,arguments)}(e,t,n)}function ik(){return(ik=e(u)(e(_).mark((function t(n,r,i){var a,o,s;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return sp((a=lt(n)).auth,r,fy),o=Dg(a.auth,i),e.next=5,Jg(o,a.auth);case 5:return e.next=7,hk(a);case 7:return s=e.sent,e.abrupt("return",o._openRedirect(a.auth,r,"reauthViaRedirect",s));case 9:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function ak(e,t,n){return function(e,t,n){return ok.apply(this,arguments)}(e,t,n)}function ok(){return(ok=e(u)(e(_).mark((function t(n,r,i){var a,o,s;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return sp((a=lt(n)).auth,r,fy),o=Dg(a.auth,i),e.next=5,Py(!1,a,r.providerId);case 5:return e.next=7,Jg(o,a.auth);case 7:return e.next=9,hk(a);case 9:return s=e.sent,e.abrupt("return",o._openRedirect(a.auth,r,"linkViaRedirect",s));case 11:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function sk(e,t){return uk.apply(this,arguments)}function uk(){return(uk=e(u)(e(_).mark((function t(n,r){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Tv(n)._initializationPromise;case 2:return e.abrupt("return",ck(n,r,!1));case 3:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function ck(e,t){return lk.apply(this,arguments)}function lk(){return lk=e(u)(e(_).mark((function t(n,r){var i,a,o,s,u,c=arguments;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=c.length>2&&void 0!==c[2]&&c[2],a=Tv(n),o=Dg(a,r),s=new Hg(a,o,i),e.next=6,s.execute();case 6:if(!(u=e.sent)||i){e.next=13;break}return delete u.user._redirectEventId,e.next=11,a._persistUserIfCurrent(u.user);case 11:return e.next=13,a._setRedirectUser(null,r);case 13:return e.abrupt("return",u);case 14:case"end":return e.stop()}}),t)}))),lk.apply(this,arguments)}function hk(e){return fk.apply(this,arguments)}function fk(){return(fk=e(u)(e(_).mark((function t(n){var r;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=qm("".concat(n.uid,":::")),n._redirectEventId=r,e.next=4,n.auth._setRedirectUser(n);case 4:return e.next=6,n.auth._persistUserIfCurrent(n);case 6:return e.abrupt("return",r);case 7:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var dk=function(){"use strict";function t(n){e(l)(this,t),this.auth=n,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}return e(h)(t,[{key:"registerConsumer",value:function(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}},{key:"unregisterConsumer",value:function(e){this.consumers.delete(e)}},{key:"onEvent",value:function(e){var t=this;if(this.hasEventBeenHandled(e))return!1;var n=!1;return this.consumers.forEach((function(r){t.isEventForConsumer(e,r)&&(n=!0,t.sendToConsumer(e,r),t.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return vk(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}},{key:"sendToConsumer",value:function(e,t){var n;if(e.error&&!vk(e)){var r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(ap(this.auth,r))}else t.onAuthEvent(e)}},{key:"isEventForConsumer",value:function(e,t){var n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}},{key:"hasEventBeenHandled",value:function(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(pk(e))}},{key:"saveEventToCache",value:function(e){this.cachedEventUids.add(pk(e)),this.lastProcessedEventTime=Date.now()}}]),t}();function pk(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((function(e){return e})).join("-")}function vk(e){var t=e.type,n=e.error;return"unknown"===t&&"auth/no-auth-event"===(null==n?void 0:n.code)}function yk(e){return mk.apply(this,arguments)}function mk(){return mk=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(_).mark((function t(n){var r,i=arguments;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>1&&void 0!==i[1]?i[1]:{},e.abrupt("return",Tp(n,"GET","/v1/projects",r));case 2:case"end":return e.stop()}}),t)}))),mk.apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var gk=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,kk=/^https?/;function _k(){return(_k=e(u)(e(_).mark((function t(n){var r,i,a,o,s,u,c;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.config.emulator){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,yk(n);case 4:r=e.sent.authorizedDomains,i=!0,a=!1,o=void 0,e.prev=6,s=r[Symbol.iterator]();case 8:if(i=(u=s.next()).done){e.next=20;break}if(c=u.value,e.prev=10,!wk(c)){e.next=13;break}return e.abrupt("return");case 13:e.next=17;break;case 15:e.prev=15,e.t0=e.catch(10);case 17:i=!0,e.next=8;break;case 20:e.next=26;break;case 22:e.prev=22,e.t1=e.catch(6),a=!0,o=e.t1;case 26:e.prev=26,e.prev=27,i||null==s.return||s.return();case 29:if(e.prev=29,!a){e.next=32;break}throw o;case 32:return e.finish(29);case 33:return e.finish(26);case 34:ip(n,"unauthorized-domain");case 35:case"end":return e.stop()}}),t,null,[[6,22,26,34],[10,15],[27,,29,33]])})))).apply(this,arguments)}function wk(e){var t=vp(),n=new URL(t),r=n.protocol,i=n.hostname;if(e.startsWith("chrome-extension://")){var a=new URL(e);return""===a.hostname&&""===i?"chrome-extension:"===r&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===r&&a.hostname===i}if(!kk.test(r))return!1;if(gk.test(e))return i===e;var o=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(i)}
/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var bk=new gp(3e4,6e4);function xk(){var t=jm().___jsl,n=!0,r=!1,i=void 0;if(null==t?void 0:t.H)try{for(var a,o=Object.keys(t.H)[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;if(t.H[s].r=t.H[s].r||[],t.H[s].L=t.H[s].L||[],t.H[s].r=e(p)(t.H[s].L),t.CP)for(var u=0;u<t.CP.length;u++)t.CP[u]=null}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}}var Ik=null;function Tk(e){return Ik=Ik||function(e){return new Promise((function(t,n){var r,i,a;function o(){xk(),gapi.load("gapi.iframes",{callback:function(){t(gapi.iframes.getContext())},ontimeout:function(){xk(),n(ap(e,"network-request-failed"))},timeout:bk.get()})}if(null===(i=null===(r=jm().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(a=jm().gapi)||void 0===a?void 0:a.load)){var s=cg("iframefcb");return jm()[s]=function(){gapi.load?o():n(ap(e,"network-request-failed"))},ug("https://apis.google.com/js/api.js?onload=".concat(s)).catch((function(e){return n(e)}))}o()}})).catch((function(e){throw Ik=null,e}))}(e),Ik}
/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ek=new gp(5e3,15e3),Sk={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Ck=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Ak(e){var t=e.config;cp(t.authDomain,e,"auth-domain-config-required");var n=t.emulator?kp(t,"emulator/auth/iframe"):"https://".concat(e.config.authDomain,"/").concat("__/auth/iframe"),r={apiKey:t.apiKey,appName:e.name,v:hn},i=Ck.get(e.config.apiHost);i&&(r.eid=i);var a=e._getFrameworks();return a.length&&(r.fw=a.join(",")),"".concat(n,"?").concat(Qe(r).slice(1))}function Nk(e){return Rk.apply(this,arguments)}function Rk(){return Rk=e(u)(e(_).mark((function t(n){var r,i;return e(_).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Tk(n);case 2:return r=t.sent,cp(i=jm().gapi,n,"internal-error"),t.abrupt("return",r.open({where:document.body,url:Ak(n),messageHandlersFilter:i.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Sk,dontclear:!0},(function(t){return new Promise((r=e(u)(e(_).mark((function r(i,a){var o,s,u;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=function(){jm().clearTimeout(s),i(t)},e.next=3,t.restyle({setHideOnLeave:!1});case 3:o=ap(n,"network-request-failed"),s=jm().setTimeout((function(){a(o)}),Ek.get()),t.ping(u).then(u,(function(){a(o)}));case 7:case"end":return e.stop()}}),r)}))),function(e,t){return r.apply(this,arguments)}));var r})));case 6:case"end":return t.stop()}}),t)}))),Rk.apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Dk={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Pk="_blank",Ok="http://localhost",Mk=function(){"use strict";function t(n){e(l)(this,t),this.window=n,this.associatedEvent=null}return e(h)(t,[{key:"close",value:function(){if(this.window)try{this.window.close()}catch(e){}}}]),t}();function Lk(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600,o=Math.max((window.screen.availHeight-a)/2,0).toString(),s=Math.max((window.screen.availWidth-i)/2,0).toString(),u="",c=Object.assign(Object.assign({},Dk),{width:i.toString(),height:a.toString(),top:o,left:s}),l=ye().toLowerCase();r&&(u=fv(l)?Pk:r),lv(l)&&(n=n||Ok,c.scrollbars="yes");var h=Object.entries(c).reduce((function(t,n){var r=e(b)(n,2),i=r[0],a=r[1];return"".concat(t).concat(i,"=").concat(a,",")}),"");if(kv(l)&&"_self"!==u)return Fk(n||"",u),new Mk(null);var f=window.open(n||"",u,h);cp(f,t,"popup-blocked");try{f.focus()}catch(e){}return new Mk(f)}function Fk(e,t){var n=document.createElement("a");n.href=e,n.target=t;var r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Uk="__/auth/handler",qk="emulator/auth/handler";function Vk(t,n,r,i,a,o){cp(t.config.authDomain,t,"auth-domain-config-required"),cp(t.config.apiKey,t,"invalid-api-key");var s={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:i,v:hn,eventId:a};if(n instanceof fy){n.setDefaultLanguage(t.languageCode),s.providerId=n.providerId||"",ze(n.getCustomParameters())||(s.customParameters=JSON.stringify(n.getCustomParameters()));var u=!0,c=!1,l=void 0;try{for(var h,f=Object.entries(o||{})[Symbol.iterator]();!(u=(h=f.next()).done);u=!0){var d=e(b)(h.value,2),p=d[0],v=d[1];s[p]=v}}catch(e){c=!0,l=e}finally{try{u||null==f.return||f.return()}finally{if(c)throw l}}}if(n instanceof dy){var y=n.getScopes().filter((function(e){return""!==e}));y.length>0&&(s.scopes=y.join(","))}t.tenantId&&(s.tid=t.tenantId);var m,g,k=s,_=!0,w=!1,x=void 0;try{for(var I,T=Object.keys(k)[Symbol.iterator]();!(_=(I=T.next()).done);_=!0){var E=I.value;void 0===k[E]&&delete k[E]}}catch(e){w=!0,x=e}finally{try{_||null==T.return||T.return()}finally{if(w)throw x}}return"".concat((m=t,g=m.config,g.emulator?kp(g,qk):"https://".concat(g.authDomain,"/").concat(Uk)),"?").concat(Qe(k).slice(1))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var jk="webStorageSupport",Bk=function(){"use strict";function t(){e(l)(this,t),this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Lm,this._completeRedirectFn=ck,this._overrideRedirectResult=$g}return e(h)(t,[{key:"_openPopup",value:function(t,n,r,i){var a=this;return e(u)(e(_).mark((function o(){var s,u;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return hp(null===(s=a.eventManagers[t._key()])||void 0===s?void 0:s.manager,"_initialize() not called before _openPopup()"),u=Vk(t,n,r,vp(),i),e.abrupt("return",Lk(t,u,qm()));case 4:case"end":return e.stop()}}),o)})))()}},{key:"_openRedirect",value:function(t,n,r,i){var a=this;return e(u)(e(_).mark((function o(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a._originValidation(t);case 2:return o=Vk(t,n,r,vp(),i),jm().location.href=o,e.abrupt("return",new Promise((function(){})));case 4:case"end":return e.stop()}var o}),o)})))()}},{key:"_initialize",value:function(e){var t=this,n=e._key();if(this.eventManagers[n]){var r=this.eventManagers[n],i=r.manager,a=r.promise;return i?Promise.resolve(i):(hp(a,"If manager is not set, promise should be"),a)}var o=this.initAndGetManager(e);return this.eventManagers[n]={promise:o},o.catch((function(){delete t.eventManagers[n]})),o}},{key:"initAndGetManager",value:function(t){var n=this;return e(u)(e(_).mark((function r(){var i,a;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Nk(t);case 2:return i=e.sent,a=new dk(t),i.register("authEvent",(function(e){return cp(null==e?void 0:e.authEvent,t,"invalid-auth-event"),{status:a.onEvent(e.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),n.eventManagers[t._key()]={manager:a},n.iframes[t._key()]=i,e.abrupt("return",a);case 8:case"end":return e.stop()}}),r)})))()}},{key:"_isIframeWebStorageSupported",value:function(e,t){this.iframes[e._key()].send(jk,{type:jk},(function(n){var r,i=null===(r=null==n?void 0:n[0])||void 0===r?void 0:r.webStorageSupport;void 0!==i&&t(!!i),ip(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}},{key:"_originValidation",value:function(e){var t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=function(e){return _k.apply(this,arguments)}(e)),this.originValidationPromises[t]}},{key:"_shouldInitProactively",get:function(){return wv()||hv()||mv()}}]),t}(),Kk=Bk,zk=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t){var i;return e(l)(this,r),(i=n.call(this,"phone")).credential=t,i}return e(h)(r,[{key:"_finalizeEnroll",value:function(e,t,n){return function(e,t){return Tp(e,"POST","/v2/accounts/mfaEnrollment:finalize",Ip(e,t))}(e,{idToken:t,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}},{key:"_finalizeSignIn",value:function(e,t){return function(e,t){return Tp(e,"POST","/v2/accounts/mfaSignIn:finalize",Ip(e,t))}(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}],[{key:"_fromCredential",value:function(e){return new r(e)}}]),r}(function(){"use strict";function t(n){e(l)(this,t),this.factorId=n}return e(h)(t,[{key:"_process",value:function(e,t,n){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,n);case"signin":return this._finalizeSignIn(e,t.credential);default:return lp("unexpected MultiFactorSessionType")}}}]),t}()),Wk=function(){"use strict";function t(){e(l)(this,t)}return e(h)(t,null,[{key:"assertion",value:function(e){return zk._fromCredential(e)}}]),t}();Wk.FACTOR_ID="phone";var Gk="@firebase/auth",Hk="0.21.0",Qk=function(){"use strict";function t(n){e(l)(this,t),this.auth=n,this.internalListeners=new Map}return e(h)(t,[{key:"getUid",value:function(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}},{key:"getToken",value:function(t){var n=this;return e(u)(e(_).mark((function r(){var i;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.assertAuthConfigured(),e.next=3,n.auth._initializationPromise;case 3:if(n.auth.currentUser){e.next=5;break}return e.abrupt("return",null);case 5:return e.next=7,n.auth.currentUser.getIdToken(t);case 7:return i=e.sent,e.abrupt("return",{accessToken:i});case 9:case"end":return e.stop()}}),r)})))()}},{key:"addAuthTokenListener",value:function(e){if(this.assertAuthConfigured(),!this.internalListeners.has(e)){var t=this.auth.onIdTokenChanged((function(t){e((null==t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}}},{key:"removeAuthTokenListener",value:function(e){this.assertAuthConfigured();var t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}},{key:"assertAuthConfigured",value:function(){cp(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}},{key:"updateProactiveRefresh",value:function(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}]),t}();
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Yk,Jk=Re("authIdTokenMaxAge")||300,Xk=null,$k=function(t){return n=e(u)(e(_).mark((function n(r){var i,a,o;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=r,!e.t0){e.next=5;break}return e.next=4,r.getIdTokenResult();case 4:e.t0=e.sent;case 5:if(i=e.t0,!((a=i&&((new Date).getTime()-Date.parse(i.issuedAtTime))/1e3)&&a>Jk)){e.next=9;break}return e.abrupt("return");case 9:if(o=null==i?void 0:i.token,Xk!==o){e.next=12;break}return e.abrupt("return");case 12:return Xk=o,e.next=15,fetch(t,{method:o?"POST":"DELETE",headers:o?{Authorization:"Bearer ".concat(o)}:{}});case 15:case"end":return e.stop()}}),n)}))),function(e){return n.apply(this,arguments)};var n};
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Zk(){return window}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Yk="Browser",rn(new ht("auth",(function(e,t){var n=t.options,r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),a=r.options,o=a.apiKey,s=a.authDomain;return function(e,t){cp(o&&!o.includes(":"),"invalid-api-key",{appName:e.name}),cp(!(null==s?void 0:s.includes(":")),"argument-error",{appName:e.name});var r={apiKey:o,authDomain:s,clientPlatform:Yk,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:bv(Yk)},i=new Iv(e,t,r);return function(e,t){var n=(null==t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(dp);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null==t?void 0:t.popupRedirectResolver)}(i,n),i}(r,i)}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((function(e,t,n){e.getProvider("auth-internal").initialize()}))),rn(new ht("auth-internal",(function(e){var t=Tv(e.getProvider("auth").getImmediate());return new Qk(t)}),"PRIVATE").setInstantiationMode("EXPLICIT")),mn(Gk,Hk,
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(Yk)),mn(Gk,Hk,"esm2017");function e_(e,t,n){return t_.apply(this,arguments)}function t_(){return(t_=e(u)(e(_).mark((function t(n,r,i){var a,o,s,u;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=Zk().BuildInfo,hp(r.sessionId,"AuthEvent did not contain a session ID"),e.next=5,s_(r.sessionId);case 5:return s=e.sent,u={},mv()?u.ibi=o.packageName:pv()?u.apn=o.packageName:ip(n,"operation-not-supported-in-this-environment"),o.displayName&&(u.appDisplayName=o.displayName),u.sessionId=s,e.abrupt("return",Vk(n,i,r.type,void 0,null!==(a=r.eventId)&&void 0!==a?a:void 0,u));case 11:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function n_(){return(n_=e(u)(e(_).mark((function t(n){var r,i;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Zk().BuildInfo,i={},mv()?i.iosBundleId=r.packageName:pv()?i.androidPackageName=r.packageName:ip(n,"operation-not-supported-in-this-environment"),e.next=5,yk(n,i);case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function r_(e){var t=Zk().cordova;return new Promise((function(n){t.plugins.browsertab.isAvailable((function(r){var i=null;r?t.plugins.browsertab.openUrl(e):i=t.InAppBrowser.open(e,gv()?"_blank":"_system","location=yes"),n(i)}))}))}function i_(e,t,n){return a_.apply(this,arguments)}function a_(){return(a_=e(u)(e(_).mark((function t(n,r,i){var a,o;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Zk().cordova,o=function(){},e.prev=2,e.next=5,new Promise((function(e,t){var s=null;function u(){var t;e();var n=null===(t=a.plugins.browsertab)||void 0===t?void 0:t.close;"function"==typeof n&&n(),"function"==typeof(null==i?void 0:i.close)&&i.close()}function c(){s||(s=window.setTimeout((function(){t(ap(n,"redirect-cancelled-by-user"))}),2e3))}function l(){"visible"===(null===document||void 0===document?void 0:document.visibilityState)&&c()}r.addPassiveListener(u),document.addEventListener("resume",c,!1),pv()&&document.addEventListener("visibilitychange",l,!1),o=function(){r.removePassiveListener(u),document.removeEventListener("resume",c,!1),document.removeEventListener("visibilitychange",l,!1),s&&window.clearTimeout(s)}}));case 5:return e.prev=5,o(),e.finish(5);case 8:case"end":return e.stop()}}),t,null,[[2,,5,8]])})))).apply(this,arguments)}function o_(e){var t,n,r,i,a,o,s,u,c,l,h=Zk();cp("function"==typeof(null===(t=null==h?void 0:h.universalLinks)||void 0===t?void 0:t.subscribe),e,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),cp(void 0!==(null===(n=null==h?void 0:h.BuildInfo)||void 0===n?void 0:n.packageName),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),cp("function"==typeof(null===(a=null===(i=null===(r=null==h?void 0:h.cordova)||void 0===r?void 0:r.plugins)||void 0===i?void 0:i.browsertab)||void 0===a?void 0:a.openUrl),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),cp("function"==typeof(null===(u=null===(s=null===(o=null==h?void 0:h.cordova)||void 0===o?void 0:o.plugins)||void 0===s?void 0:s.browsertab)||void 0===u?void 0:u.isAvailable),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),cp("function"==typeof(null===(l=null===(c=null==h?void 0:h.cordova)||void 0===c?void 0:c.InAppBrowser)||void 0===l?void 0:l.open),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}function s_(e){return u_.apply(this,arguments)}function u_(){return(u_=e(u)(e(_).mark((function t(n){var r,i,a;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=c_(n),e.next=3,crypto.subtle.digest("SHA-256",r);case 3:return i=e.sent,a=Array.from(new Uint8Array(i)),e.abrupt("return",a.map((function(e){return e.toString(16).padStart(2,"0")})).join(""));case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function c_(e){if(hp(/[0-9a-zA-Z]+/.test(e),"Can only convert alpha-numeric strings"),"undefined"!=typeof TextEncoder)return(new TextEncoder).encode(e);for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var l_=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(){var t;return e(l)(this,r),(t=n.call.apply(n,[this].concat(Array.prototype.slice.call(arguments)))).passiveListeners=new Set,t.initPromise=new Promise((function(e){t.resolveInialized=e})),t}return e(h)(r,[{key:"addPassiveListener",value:function(e){this.passiveListeners.add(e)}},{key:"removePassiveListener",value:function(e){this.passiveListeners.delete(e)}},{key:"resetRedirect",value:function(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}},{key:"onEvent",value:function(t){return this.resolveInialized(),this.passiveListeners.forEach((function(e){return e(t)})),e(Nd)(e(Pd)(r.prototype),"onEvent",this).call(this,t)}},{key:"initialized",value:function(){var t=this;return e(u)(e(_).mark((function n(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.initPromise;case 2:case"end":return e.stop()}}),n)})))()}}]),r}(dk);function h_(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{type:t,eventId:n,urlResponse:null,sessionId:y_(),postBody:null,tenantId:e.tenantId,error:ap(e,"no-auth-event")}}function f_(e,t){return m_()._set(g_(e),t)}function d_(e){return p_.apply(this,arguments)}function p_(){return(p_=e(u)(e(_).mark((function t(n){var r;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m_()._get(g_(n));case 2:if(!(r=e.sent)){e.next=6;break}return e.next=6,m_()._remove(g_(n));case 6:return e.abrupt("return",r);case 7:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function v_(e,t){var n,r,i=function(e){var t=k_(e),n=t.link?decodeURIComponent(t.link):void 0,r=k_(n).link,i=t.deep_link_id?decodeURIComponent(t.deep_link_id):void 0;return k_(i).link||i||r||n||e}(t);if(i.includes("/__/auth/callback")){var a=k_(i),o=a.firebaseError?function(e){try{return JSON.parse(e)}catch(e){return null}}(decodeURIComponent(a.firebaseError)):null,s=null===(r=null===(n=null==o?void 0:o.code)||void 0===n?void 0:n.split("auth/"))||void 0===r?void 0:r[1],u=s?ap(s):null;return u?{type:e.type,eventId:e.eventId,tenantId:e.tenantId,error:u,urlResponse:null,sessionId:null,postBody:null}:{type:e.type,eventId:e.eventId,tenantId:e.tenantId,sessionId:e.sessionId,urlResponse:i,postBody:null}}return null}function y_(){for(var e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",n=0;n<20;n++){var r=Math.floor(Math.random()*t.length);e.push(t.charAt(r))}return e.join("")}function m_(){return dp(Om)}function g_(e){return sv("authEvent",e.config.apiKey,e.name)}function k_(t){if(!(null==t?void 0:t.includes("?")))return{};var n=e(Od)(t.split("?"));n[0];return Ye(n.slice(1).join("?"))}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var __=function(){"use strict";function t(){e(l)(this,t),this._redirectPersistence=Lm,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=ck,this._overrideRedirectResult=$g}return e(h)(t,[{key:"_initialize",value:function(t){var n=this;return e(u)(e(_).mark((function r(){var i,a;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t._key(),(a=n.eventManagers.get(i))||(a=new l_(t),n.eventManagers.set(i,a),n.attachCallbackListeners(t,a)),e.abrupt("return",a);case 4:case"end":return e.stop()}}),r)})))()}},{key:"_openPopup",value:function(e){ip(e,"operation-not-supported-in-this-environment")}},{key:"_openRedirect",value:function(t,n,r,i){var a=this;return e(u)(e(_).mark((function o(){var s,u,c,l;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o_(t),e.next=3,a._initialize(t);case 3:return s=e.sent,e.next=6,s.initialized();case 6:return s.resetRedirect(),Gg.clear(),e.next=10,a._originValidation(t);case 10:return u=h_(t,r,i),e.next=13,f_(t,u);case 13:return e.next=15,e_(t,u,n);case 15:return c=e.sent,e.next=18,r_(c);case 18:return l=e.sent,e.abrupt("return",i_(t,s,l));case 20:case"end":return e.stop()}}),o)})))()}},{key:"_isIframeWebStorageSupported",value:function(e,t){throw new Error("Method not implemented.")}},{key:"_originValidation",value:function(e){var t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=function(e){return n_.apply(this,arguments)}(e)),this.originValidationPromises[t]}},{key:"attachCallbackListeners",value:function(t,n){var r,i=Zk(),a=i.universalLinks,o=i.handleOpenURL,s=i.BuildInfo,c=setTimeout(e(u)(e(_).mark((function r(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d_(t);case 2:n.onEvent(b_());case 3:case"end":return e.stop()}}),r)}))),500),l=(r=e(u)(e(_).mark((function r(i){var a,o;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return clearTimeout(c),e.next=3,d_(t);case 3:a=e.sent,o=null,a&&(null==i?void 0:i.url)&&(o=v_(a,i.url)),n.onEvent(o||b_());case 7:case"end":return e.stop()}}),r)}))),function(e){return r.apply(this,arguments)});void 0!==a&&"function"==typeof a.subscribe&&a.subscribe(null,l);var h=o,f="".concat(s.packageName.toLowerCase(),"://");Zk().handleOpenURL=function(){var t=e(u)(e(_).mark((function t(n){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.toLowerCase().startsWith(f)&&l({url:n}),"function"==typeof h)try{h(n)}catch(e){console.error(e)}case 2:case"end":return e.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}]),t}(),w_=__;function b_(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:ap("no-auth-event")}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x_(){var e;return(null===(e=null===self||void 0===self?void 0:self.location)||void 0===e?void 0:e.protocol)||null}function I_(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ye();return!("file:"!==x_()&&"ionic:"!==x_()&&"capacitor:"!==x_()||!e.toLowerCase().match(/iphone|ipad|ipod|android/))}function T_(){return we()&&11===(null===document||void 0===document?void 0:document.documentMode)}function E_(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ye();return/Edge\/\d+/.test(e)}function S_(){try{var e=self.localStorage,t=qm();if(e)return e.setItem(t,"1"),e.removeItem(t),!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ye();return T_()||E_(e)}()||xe()}catch(e){return C_()&&xe()}return!1}function C_(){return void 0!==n&&"WorkerGlobalScope"in n&&"importScripts"in n}function A_(){return("http:"===x_()||"https:"===x_()||ke()||I_())&&!(_e()||ge())&&S_()&&!C_()}function N_(){return I_()&&"undefined"!=typeof document}function R_(){return D_.apply(this,arguments)}function D_(){return(D_=e(u)(e(_).mark((function t(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(N_()){e.next=2;break}return e.abrupt("return",!1);case 2:return e.abrupt("return",new Promise((function(e){var t=setTimeout((function(){e(!1)}),1e3);document.addEventListener("deviceready",(function(){clearTimeout(t),e(!0)}))})));case 3:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var P_={LOCAL:"local",NONE:"none",SESSION:"session"},O_=cp,M_="persistence";function L_(e,t){O_(Object.values(P_).includes(t),e,"invalid-persistence-type"),_e()?O_(t!==P_.SESSION,e,"unsupported-persistence-type"):ge()?O_(t===P_.NONE,e,"unsupported-persistence-type"):C_()?O_(t===P_.NONE||t===P_.LOCAL&&xe(),e,"unsupported-persistence-type"):O_(t===P_.NONE||S_(),e,"unsupported-persistence-type")}function F_(e){return U_.apply(this,arguments)}function U_(){return(U_=e(u)(e(_).mark((function t(n){var r,i;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n._initializationPromise;case 2:r=q_(),i=sv(M_,n.config.apiKey,n.name),r&&r.setItem(i,n._getPersistence());case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function q_(){var e;try{return(null===(e="undefined"!=typeof window?window:null)||void 0===e?void 0:e.sessionStorage)||null}catch(e){return null}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var V_=cp,j_=function(){"use strict";function t(){e(l)(this,t),this.browserResolver=dp(Kk),this.cordovaResolver=dp(w_),this.underlyingResolver=null,this._redirectPersistence=Lm,this._completeRedirectFn=ck,this._overrideRedirectResult=$g}return e(h)(t,[{key:"_initialize",value:function(t){var n=this;return e(u)(e(_).mark((function r(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.selectUnderlyingResolver();case 2:return e.abrupt("return",n.assertedUnderlyingResolver._initialize(t));case 3:case"end":return e.stop()}}),r)})))()}},{key:"_openPopup",value:function(t,n,r,i){var a=this;return e(u)(e(_).mark((function o(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.selectUnderlyingResolver();case 2:return e.abrupt("return",a.assertedUnderlyingResolver._openPopup(t,n,r,i));case 3:case"end":return e.stop()}}),o)})))()}},{key:"_openRedirect",value:function(t,n,r,i){var a=this;return e(u)(e(_).mark((function o(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.selectUnderlyingResolver();case 2:return e.abrupt("return",a.assertedUnderlyingResolver._openRedirect(t,n,r,i));case 3:case"end":return e.stop()}}),o)})))()}},{key:"_isIframeWebStorageSupported",value:function(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}},{key:"_originValidation",value:function(e){return this.assertedUnderlyingResolver._originValidation(e)}},{key:"_shouldInitProactively",get:function(){return N_()||this.browserResolver._shouldInitProactively}},{key:"assertedUnderlyingResolver",get:function(){return V_(this.underlyingResolver,"internal-error"),this.underlyingResolver}},{key:"selectUnderlyingResolver",value:function(){var t=this;return e(u)(e(_).mark((function n(){var r;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.underlyingResolver){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,R_();case 4:r=e.sent,t.underlyingResolver=r?t.cordovaResolver:t.browserResolver;case 6:case"end":return e.stop()}}),n)})))()}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function B_(e){return e.unwrap()}function K_(e,t){var n,r=null===(n=t.customData)||void 0===n?void 0:n._tokenResponse;if("auth/multi-factor-auth-required"===(null==t?void 0:t.code))t.resolver=new Q_(e,function(e,t){var n,r=lt(e),i=t;return cp(t.customData.operationType,r,"argument-error"),cp(null===(n=i.customData._serverResponse)||void 0===n?void 0:n.mfaPendingCredential,r,"argument-error"),Sm._fromError(r,i)}(e,t));else if(r){var i=z_(t),a=t;i&&(a.credential=i,a.tenantId=r.tenantId||void 0,a.email=r.email||void 0,a.phoneNumber=r.phoneNumber||void 0)}}function z_(e){var t=(e instanceof Oe?e.customData:e)._tokenResponse;if(!t)return null;if(!(e instanceof Oe)&&"temporaryProof"in t&&"phoneNumber"in t)return Rg.credentialFromResult(e);var n,r=t.providerId;if(!r||r===zd)return null;switch(r){case Kd:n=yy;break;case jd:n=vy;break;case Bd:n=my;break;case Wd:n=_y;break;default:var i=t.oauthIdToken,a=t.oauthAccessToken,o=t.oauthTokenSecret,s=t.pendingToken,u=t.nonce;return a||o||i||s?s?r.startsWith("saml.")?gy._create(r,s):ny._fromParams({providerId:r,signInMethod:r,pendingToken:s,idToken:i,accessToken:a}):new py(r).credential({idToken:i,accessToken:a,rawNonce:u}):null}return e instanceof Oe?n.credentialFromError(e):n.credentialFromResult(e)}function W_(e,t){return t.catch((function(t){throw t instanceof Oe&&K_(e,t),t})).then((function(e){var t,n=e.operationType,r=e.user;return{operationType:n,credential:(t=e,z_(t)),additionalUserInfo:xm(e),user:Y_.getOrCreate(r)}}))}function G_(e,t){return H_.apply(this,arguments)}function H_(){return(H_=e(u)(e(_).mark((function t(n,r){var i;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r;case 2:return i=e.sent,e.abrupt("return",{verificationId:i.verificationId,confirm:function(e){return W_(n,i.confirm(e))}});case 4:case"end":return e.stop()}}),t)})))).apply(this,arguments)}var Q_=function(){"use strict";function t(n,r){e(l)(this,t),this.resolver=r,this.auth=n.wrapped()}return e(h)(t,[{key:"session",get:function(){return this.resolver.session}},{key:"hints",get:function(){return this.resolver.hints}},{key:"resolveSignIn",value:function(e){return W_(B_(this.auth),this.resolver.resolveSignIn(e))}}]),t}(),Y_=function(){"use strict";function t(n){var r;e(l)(this,t),this._delegate=n,this.multiFactor=(r=lt(n),Nm.has(r)||Nm.set(r,Am._fromUser(r)),Nm.get(r))}return e(h)(t,[{key:"delete",value:function(){return this._delegate.delete()}},{key:"reload",value:function(){return this._delegate.reload()}},{key:"toJSON",value:function(){return this._delegate.toJSON()}},{key:"getIdTokenResult",value:function(e){return this._delegate.getIdTokenResult(e)}},{key:"getIdToken",value:function(e){return this._delegate.getIdToken(e)}},{key:"linkAndRetrieveDataWithCredential",value:function(e){return this.linkWithCredential(e)}},{key:"linkWithCredential",value:function(t){var n=this;return e(u)(e(_).mark((function r(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",W_(n.auth,jy(n._delegate,t)));case 1:case"end":return e.stop()}}),r)})))()}},{key:"linkWithPhoneNumber",value:function(t,n){var r=this;return e(u)(e(_).mark((function i(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",G_(r.auth,Tg(r._delegate,t,n)));case 1:case"end":return e.stop()}}),i)})))()}},{key:"linkWithPopup",value:function(t){var n=this;return e(u)(e(_).mark((function r(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",W_(n.auth,Kg(n._delegate,t,j_)));case 1:case"end":return e.stop()}}),r)})))()}},{key:"linkWithRedirect",value:function(t){var n=this;return e(u)(e(_).mark((function r(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F_(Tv(n.auth));case 2:return e.abrupt("return",ak(n._delegate,t,j_));case 3:case"end":return e.stop()}}),r)})))()}},{key:"reauthenticateAndRetrieveDataWithCredential",value:function(e){return this.reauthenticateWithCredential(e)}},{key:"reauthenticateWithCredential",value:function(t){var n=this;return e(u)(e(_).mark((function r(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",W_(n.auth,Ky(n._delegate,t)));case 1:case"end":return e.stop()}}),r)})))()}},{key:"reauthenticateWithPhoneNumber",value:function(e,t){return G_(this.auth,function(e,t,n){return Sg.apply(this,arguments)}(this._delegate,e,t))}},{key:"reauthenticateWithPopup",value:function(e){return W_(this.auth,function(e,t,n){return Bg.apply(this,arguments)}(this._delegate,e,j_))}},{key:"reauthenticateWithRedirect",value:function(t){var n=this;return e(u)(e(_).mark((function r(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F_(Tv(n.auth));case 2:return e.abrupt("return",rk(n._delegate,t,j_));case 3:case"end":return e.stop()}}),r)})))()}},{key:"sendEmailVerification",value:function(e){return function(e,t){return lm.apply(this,arguments)}(this._delegate,e)}},{key:"unlink",value:function(t){var n=this;return e(u)(e(_).mark((function r(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ay(n._delegate,t);case 2:return e.abrupt("return",n);case 3:case"end":return e.stop()}}),r)})))()}},{key:"updateEmail",value:function(e){return function(e,t){return vm(lt(e),t,null)}(this._delegate,e)}},{key:"updatePassword",value:function(e){return function(e,t){return vm(lt(e),null,t)}(this._delegate,e)}},{key:"updatePhoneNumber",value:function(e){return function(e,t){return Ng.apply(this,arguments)}(this._delegate,e)}},{key:"updateProfile",value:function(e){return function(e,t){return pm.apply(this,arguments)}(this._delegate,e)}},{key:"verifyBeforeUpdateEmail",value:function(e,t){return function(e,t,n){return hm.apply(this,arguments)}(this._delegate,e,t)}},{key:"emailVerified",get:function(){return this._delegate.emailVerified}},{key:"isAnonymous",get:function(){return this._delegate.isAnonymous}},{key:"metadata",get:function(){return this._delegate.metadata}},{key:"phoneNumber",get:function(){return this._delegate.phoneNumber}},{key:"providerData",get:function(){return this._delegate.providerData}},{key:"refreshToken",get:function(){return this._delegate.refreshToken}},{key:"tenantId",get:function(){return this._delegate.tenantId}},{key:"displayName",get:function(){return this._delegate.displayName}},{key:"email",get:function(){return this._delegate.email}},{key:"photoURL",get:function(){return this._delegate.photoURL}},{key:"providerId",get:function(){return this._delegate.providerId}},{key:"uid",get:function(){return this._delegate.uid}},{key:"auth",get:function(){return this._delegate.auth}}],[{key:"getOrCreate",value:function(e){return t.USER_MAP.has(e)||t.USER_MAP.set(e,new t(e)),t.USER_MAP.get(e)}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Y_.USER_MAP=new WeakMap;
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var J_=cp,X_=function(){"use strict";function t(n,r){if(e(l)(this,t),this.app=n,r.isInitialized())return this._delegate=r.getImmediate(),void this.linkUnderlyingAuth();var i=n.options.apiKey;J_(i,"invalid-api-key",{appName:n.name}),J_(i,"invalid-api-key",{appName:n.name});var a="undefined"!=typeof window?j_:void 0;this._delegate=r.initialize({options:{persistence:Z_(i,n.name),popupRedirectResolver:a}}),this._delegate._updateErrorMap(Zd),this.linkUnderlyingAuth()}return e(h)(t,[{key:"emulatorConfig",get:function(){return this._delegate.emulatorConfig}},{key:"currentUser",get:function(){return this._delegate.currentUser?Y_.getOrCreate(this._delegate.currentUser):null}},{key:"languageCode",get:function(){return this._delegate.languageCode},set:function(e){this._delegate.languageCode=e}},{key:"settings",get:function(){return this._delegate.settings}},{key:"tenantId",get:function(){return this._delegate.tenantId},set:function(e){this._delegate.tenantId=e}},{key:"useDeviceLanguage",value:function(){this._delegate.useDeviceLanguage()}},{key:"signOut",value:function(){return this._delegate.signOut()}},{key:"useEmulator",value:function(e,t){Sv(this._delegate,e,t)}},{key:"applyActionCode",value:function(e){return function(e,t){return Zy.apply(this,arguments)}(this._delegate,e)}},{key:"checkActionCode",value:function(e){return em(this._delegate,e)}},{key:"confirmPasswordReset",value:function(e,t){return function(e,t,n){return $y.apply(this,arguments)}(this._delegate,e,t)}},{key:"createUserWithEmailAndPassword",value:function(t,n){var r=this;return e(u)(e(_).mark((function i(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",W_(r._delegate,rm(r._delegate,t,n)));case 1:case"end":return e.stop()}}),i)})))()}},{key:"fetchProvidersForEmail",value:function(e){return this.fetchSignInMethodsForEmail(e)}},{key:"fetchSignInMethodsForEmail",value:function(e){return function(e,t){return cm.apply(this,arguments)}(this._delegate,e)}},{key:"isSignInWithEmailLink",value:function(e){return function(e,t){var n=ly.parseLink(t);return"EMAIL_SIGNIN"===(null==n?void 0:n.operation)}(this._delegate,e)}},{key:"getRedirectResult",value:function(){var t=this;return e(u)(e(_).mark((function n(){var r;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return J_(A_(),t._delegate,"operation-not-supported-in-this-environment"),e.next=3,sk(t._delegate,j_);case 3:if(r=e.sent){e.next=6;break}return e.abrupt("return",{credential:null,user:null});case 6:return e.abrupt("return",W_(t._delegate,Promise.resolve(r)));case 7:case"end":return e.stop()}}),n)})))()}},{key:"addFrameworkForLogging",value:function(e){!function(e,t){Tv(e)._logFramework(t)}(this._delegate,e)}},{key:"onAuthStateChanged",value:function(e,t,n){var r=$_(e,t,n),i=r.next,a=r.error,o=r.complete;return this._delegate.onAuthStateChanged(i,a,o)}},{key:"onIdTokenChanged",value:function(e,t,n){var r=$_(e,t,n),i=r.next,a=r.error,o=r.complete;return this._delegate.onIdTokenChanged(i,a,o)}},{key:"sendSignInLinkToEmail",value:function(e,t){return function(e,t,n){return am.apply(this,arguments)}(this._delegate,e,t)}},{key:"sendPasswordResetEmail",value:function(e,t){return function(e,t,n){return Xy.apply(this,arguments)}(this._delegate,e,t||void 0)}},{key:"setPersistence",value:function(t){var n=this;return e(u)(e(_).mark((function r(){var i,a;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:L_(n._delegate,t),e.t0=t,e.next=e.t0===P_.SESSION?5:e.t0===P_.LOCAL?7:e.t0===P_.NONE?12:14;break;case 5:return i=Lm,e.abrupt("break",15);case 7:return e.next=9,dp(ig)._isAvailable();case 9:return a=e.sent,i=a?ig:Om,e.abrupt("break",15);case 12:return i=ov,e.abrupt("break",15);case 14:return e.abrupt("return",ip("argument-error",{appName:n._delegate.name}));case 15:return e.abrupt("return",n._delegate.setPersistence(i));case 16:case"end":return e.stop()}}),r)})))()}},{key:"signInAndRetrieveDataWithCredential",value:function(e){return this.signInWithCredential(e)}},{key:"signInAnonymously",value:function(){return W_(this._delegate,function(e){return Ty.apply(this,arguments)}(this._delegate))}},{key:"signInWithCredential",value:function(e){return W_(this._delegate,qy(this._delegate,e))}},{key:"signInWithCustomToken",value:function(e){return W_(this._delegate,function(e,t){return Hy.apply(this,arguments)}(this._delegate,e))}},{key:"signInWithEmailAndPassword",value:function(e,t){return W_(this._delegate,function(e,t,n){return qy(lt(e),hy.credential(t,n))}(this._delegate,e,t))}},{key:"signInWithEmailLink",value:function(e,t){return W_(this._delegate,function(e,t,n){return om.apply(this,arguments)}(this._delegate,e,t))}},{key:"signInWithPhoneNumber",value:function(e,t){return G_(this._delegate,function(e,t,n){return Ig.apply(this,arguments)}(this._delegate,e,t))}},{key:"signInWithPopup",value:function(t){var n=this;return e(u)(e(_).mark((function r(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return J_(A_(),n._delegate,"operation-not-supported-in-this-environment"),e.abrupt("return",W_(n._delegate,Vg(n._delegate,t,j_)));case 2:case"end":return e.stop()}}),r)})))()}},{key:"signInWithRedirect",value:function(t){var n=this;return e(u)(e(_).mark((function r(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return J_(A_(),n._delegate,"operation-not-supported-in-this-environment"),e.next=3,F_(n._delegate);case 3:return e.abrupt("return",tk(n._delegate,t,j_));case 4:case"end":return e.stop()}}),r)})))()}},{key:"updateCurrentUser",value:function(e){return this._delegate.updateCurrentUser(e)}},{key:"verifyPasswordResetCode",value:function(e){return function(e,t){return nm.apply(this,arguments)}(this._delegate,e)}},{key:"unwrap",value:function(){return this._delegate}},{key:"_delete",value:function(){return this._delegate._delete()}},{key:"linkUnderlyingAuth",value:function(){var e=this;this._delegate.wrapped=function(){return e}}}]),t}();function $_(e,t,n){var r,i=e;"function"!=typeof e&&(i=(r=e).next,t=r.error,n=r.complete);var a=i;return{next:function(e){return a(e&&Y_.getOrCreate(e))},error:t,complete:n}}function Z_(e,t){var n=function(e,t){var n=q_();if(!n)return[];var r=sv(M_,e,t);switch(n.getItem(r)){case P_.NONE:return[ov];case P_.LOCAL:return[ig,Lm];case P_.SESSION:return[Lm];default:return[]}}(e,t);if("undefined"==typeof self||n.includes(ig)||n.push(ig),"undefined"!=typeof window){var r=!0,i=!1,a=void 0;try{for(var o,s=[Om,Lm][Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;n.includes(u)||n.push(u)}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}}return n.includes(ov)||n.push(ov),n}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */X_.Persistence=P_;var ew=function(){"use strict";function t(){e(l)(this,t),this.providerId="phone",this._delegate=new Rg(B_(Fc.auth()))}return e(h)(t,[{key:"verifyPhoneNumber",value:function(e,t){return this._delegate.verifyPhoneNumber(e,t)}},{key:"unwrap",value:function(){return this._delegate}}],[{key:"credential",value:function(e,t){return Rg.credential(e,t)}}]),t}();ew.PHONE_SIGN_IN_METHOD=Rg.PHONE_SIGN_IN_METHOD,ew.PROVIDER_ID=Rg.PROVIDER_ID;
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var tw,nw=cp,rw=function(){"use strict";function t(n,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Fc.app();e(l)(this,t),nw(null===(i=a.options)||void 0===i?void 0:i.apiKey,"invalid-api-key",{appName:a.name}),this._delegate=new wg(n,r,a.auth()),this.type=this._delegate.type}return e(h)(t,[{key:"clear",value:function(){this._delegate.clear()}},{key:"render",value:function(){return this._delegate.render()}},{key:"verify",value:function(){return this._delegate.verify()}}]),t}();(tw=Fc).INTERNAL.registerComponent(new ht("auth-compat",(function(e){var t=e.getProvider("app-compat").getImmediate(),n=e.getProvider("auth");return new X_(t,n)}),"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Gd,PASSWORD_RESET:Hd,RECOVER_EMAIL:Qd,REVERT_SECOND_FACTOR_ADDITION:Yd,VERIFY_AND_CHANGE_EMAIL:Jd,VERIFY_EMAIL:Xd}},EmailAuthProvider:hy,FacebookAuthProvider:vy,GithubAuthProvider:my,GoogleAuthProvider:yy,OAuthProvider:py,SAMLAuthProvider:ky,PhoneAuthProvider:ew,PhoneMultiFactorGenerator:Wk,RecaptchaVerifier:rw,TwitterAuthProvider:_y,Auth:X_,AuthCredential:Nv,Error:Oe}).setInstantiationMode("LAZY").setMultipleInstances(!1)),tw.registerVersion("@firebase/auth-compat","0.3.0");var iw=new xt("@firebase/database-compat"),aw=function(e){var t="FIREBASE WARNING: "+e;iw.warn(t)},ow=function(e,t,n,r){if((!r||void 0!==n)&&"boolean"!=typeof n)throw new Error(nt(e,t)+"must be a boolean.")},sw=function(e,t,n){if(!n||void 0!==t)switch(t){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(nt(e,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},uw=function(){"use strict";function t(n){e(l)(this,t),this._delegate=n}return e(h)(t,[{key:"cancel",value:function(e){tt("OnDisconnect.cancel",0,1,arguments.length),rt("OnDisconnect.cancel","onComplete",e,!0);var t=this._delegate.cancel();return e&&t.then((function(){return e(null)}),(function(t){return e(t)})),t}},{key:"remove",value:function(e){tt("OnDisconnect.remove",0,1,arguments.length),rt("OnDisconnect.remove","onComplete",e,!0);var t=this._delegate.remove();return e&&t.then((function(){return e(null)}),(function(t){return e(t)})),t}},{key:"set",value:function(e,t){tt("OnDisconnect.set",1,2,arguments.length),rt("OnDisconnect.set","onComplete",t,!0);var n=this._delegate.set(e);return t&&n.then((function(){return t(null)}),(function(e){return t(e)})),n}},{key:"setWithPriority",value:function(e,t,n){tt("OnDisconnect.setWithPriority",2,3,arguments.length),rt("OnDisconnect.setWithPriority","onComplete",n,!0);var r=this._delegate.setWithPriority(e,t);return n&&r.then((function(){return n(null)}),(function(e){return n(e)})),r}},{key:"update",value:function(e,t){if(tt("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){for(var n={},r=0;r<e.length;++r)n[""+r]=e[r];e=n,aw("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}rt("OnDisconnect.update","onComplete",t,!0);var i=this._delegate.update(e);return t&&i.then((function(){return t(null)}),(function(e){return t(e)})),i}}]),t}(),cw=function(){"use strict";function t(n,r){e(l)(this,t),this.committed=n,this.snapshot=r}return e(h)(t,[{key:"toJSON",value:function(){return tt("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}]),t}(),lw=function(){"use strict";function t(n,r){e(l)(this,t),this._database=n,this._delegate=r}return e(h)(t,[{key:"val",value:function(){return tt("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}},{key:"exportVal",value:function(){return tt("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}},{key:"toJSON",value:function(){return tt("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}},{key:"exists",value:function(){return tt("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}},{key:"child",value:function(e){return tt("DataSnapshot.child",0,1,arguments.length),e=String(e),Cs("DataSnapshot.child","path",e,!1),new t(this._database,this._delegate.child(e))}},{key:"hasChild",value:function(e){return tt("DataSnapshot.hasChild",1,1,arguments.length),Cs("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}},{key:"getPriority",value:function(){return tt("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}},{key:"forEach",value:function(e){var n=this;return tt("DataSnapshot.forEach",1,1,arguments.length),rt("DataSnapshot.forEach","action",e,!1),this._delegate.forEach((function(r){return e(new t(n._database,r))}))}},{key:"hasChildren",value:function(){return tt("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}},{key:"key",get:function(){return this._delegate.key}},{key:"numChildren",value:function(){return tt("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}},{key:"getRef",value:function(){return tt("DataSnapshot.ref",0,0,arguments.length),new fw(this._database,this._delegate.ref)}},{key:"ref",get:function(){return this.getRef()}}]),t}(),hw=function(){"use strict";function t(n,r){e(l)(this,t),this.database=n,this._delegate=r}return e(h)(t,[{key:"on",value:function(e,n,r,i){var a,o=this;tt("Query.on",2,4,arguments.length),rt("Query.on","callback",n,!1);var s=t.getCancelAndContextArgs_("Query.on",r,i),u=function(e,t){n.call(s.context,new lw(o.database,e),t)};u.userCallback=n,u.context=s.context;var c=null===(a=s.cancel)||void 0===a?void 0:a.bind(s.context);switch(e){case"value":return Uu(this._delegate,u,c),n;case"child_added":return qu(this._delegate,u,c),n;case"child_removed":return Bu(this._delegate,u,c),n;case"child_changed":return Vu(this._delegate,u,c),n;case"child_moved":return ju(this._delegate,u,c),n;default:throw new Error(nt("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}},{key:"off",value:function(e,t,n){if(tt("Query.off",0,3,arguments.length),sw("Query.off",e,!0),rt("Query.off","callback",t,!0),it("Query.off","context",n,!0),t){var r=function(){};r.userCallback=t,r.context=n,Ku(this._delegate,e,r)}else Ku(this._delegate,e)}},{key:"get",value:function(){var e=this;return Ou(this._delegate).then((function(t){return new lw(e.database,t)}))}},{key:"once",value:function(e,n,r,i){var a=this;tt("Query.once",1,4,arguments.length),rt("Query.once","callback",n,!0);var o=t.getCancelAndContextArgs_("Query.once",r,i),s=new De,u=function(e,t){var r=new lw(a.database,e);n&&n.call(o.context,r,t),s.resolve(r)};u.userCallback=n,u.context=o.context;var c=function(e){o.cancel&&o.cancel.call(o.context,e),s.reject(e)};switch(e){case"value":Uu(this._delegate,u,c,{onlyOnce:!0});break;case"child_added":qu(this._delegate,u,c,{onlyOnce:!0});break;case"child_removed":Bu(this._delegate,u,c,{onlyOnce:!0});break;case"child_changed":Vu(this._delegate,u,c,{onlyOnce:!0});break;case"child_moved":ju(this._delegate,u,c,{onlyOnce:!0});break;default:throw new Error(nt("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return s.promise}},{key:"limitToFirst",value:function(e){return tt("Query.limitToFirst",1,1,arguments.length),new t(this.database,dc(this._delegate,ec(e)))}},{key:"limitToLast",value:function(e){return tt("Query.limitToLast",1,1,arguments.length),new t(this.database,dc(this._delegate,nc(e)))}},{key:"orderByChild",value:function(e){return tt("Query.orderByChild",1,1,arguments.length),new t(this.database,dc(this._delegate,ic(e)))}},{key:"orderByKey",value:function(){return tt("Query.orderByKey",0,0,arguments.length),new t(this.database,dc(this._delegate,oc()))}},{key:"orderByPriority",value:function(){return tt("Query.orderByPriority",0,0,arguments.length),new t(this.database,dc(this._delegate,uc()))}},{key:"orderByValue",value:function(){return tt("Query.orderByValue",0,0,arguments.length),new t(this.database,dc(this._delegate,lc()))}},{key:"startAt",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0;return tt("Query.startAt",0,2,arguments.length),new t(this.database,dc(this._delegate,Ju(e,n)))}},{key:"startAfter",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0;return tt("Query.startAfter",0,2,arguments.length),new t(this.database,dc(this._delegate,$u(e,n)))}},{key:"endAt",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0;return tt("Query.endAt",0,2,arguments.length),new t(this.database,dc(this._delegate,Gu(e,n)))}},{key:"endBefore",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0;return tt("Query.endBefore",0,2,arguments.length),new t(this.database,dc(this._delegate,Qu(e,n)))}},{key:"equalTo",value:function(e,n){return tt("Query.equalTo",1,2,arguments.length),new t(this.database,dc(this._delegate,fc(e,n)))}},{key:"toString",value:function(){return tt("Query.toString",0,0,arguments.length),this._delegate.toString()}},{key:"toJSON",value:function(){return tt("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}},{key:"isEqual",value:function(e){if(tt("Query.isEqual",1,1,arguments.length),!(e instanceof t)){var n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)}},{key:"ref",get:function(){return new fw(this.database,new xu(this._delegate._repo,this._delegate._path))}}],[{key:"getCancelAndContextArgs_",value:function(e,t,n){var r={cancel:void 0,context:void 0};if(t&&n)r.cancel=t,rt(e,"cancel",r.cancel,!0),r.context=n,it(e,"context",r.context,!0);else if(t)if("object"==typeof t&&null!==t)r.context=t;else{if("function"!=typeof t)throw new Error(nt(e,"cancelOrContext")+" must either be a cancel callback or a context object.");r.cancel=t}return r}}]),t}(),fw=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i){var a;return e(l)(this,r),(a=n.call(this,t,new ku(i._repo,i._path,new Qi,!1))).database=t,a._delegate=i,a}return e(h)(r,[{key:"getKey",value:function(){return tt("Reference.key",0,0,arguments.length),this._delegate.key}},{key:"child",value:function(e){return tt("Reference.child",1,1,arguments.length),"number"==typeof e&&(e=String(e)),new r(this.database,Su(this._delegate,e))}},{key:"getParent",value:function(){tt("Reference.parent",0,0,arguments.length);var e=this._delegate.parent;return e?new r(this.database,e):null}},{key:"getRoot",value:function(){return tt("Reference.root",0,0,arguments.length),new r(this.database,this._delegate.root)}},{key:"set",value:function(e,t){tt("Reference.set",1,2,arguments.length),rt("Reference.set","onComplete",t,!0);var n=Nu(this._delegate,e);return t&&n.then((function(){return t(null)}),(function(e){return t(e)})),n}},{key:"update",value:function(e,t){if(tt("Reference.update",1,2,arguments.length),Array.isArray(e)){for(var n={},r=0;r<e.length;++r)n[""+r]=e[r];e=n,aw("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}As("Reference.update",this._delegate._path),rt("Reference.update","onComplete",t,!0);var i=Pu(this._delegate,e);return t&&i.then((function(){return t(null)}),(function(e){return t(e)})),i}},{key:"setWithPriority",value:function(e,t,n){tt("Reference.setWithPriority",2,3,arguments.length),rt("Reference.setWithPriority","onComplete",n,!0);var r=Du(this._delegate,e,t);return n&&r.then((function(){return n(null)}),(function(e){return n(e)})),r}},{key:"remove",value:function(e){tt("Reference.remove",0,1,arguments.length),rt("Reference.remove","onComplete",e,!0);var t=Au(this._delegate);return e&&t.then((function(){return e(null)}),(function(t){return e(t)})),t}},{key:"transaction",value:function(e,t,n){var r=this;tt("Reference.transaction",1,3,arguments.length),rt("Reference.transaction","transactionUpdate",e,!1),rt("Reference.transaction","onComplete",t,!0),ow("Reference.transaction","applyLocally",n,!0);var i=Ac(this._delegate,e,{applyLocally:n}).then((function(e){return new cw(e.committed,new lw(r.database,e.snapshot))}));return t&&i.then((function(e){return t(null,e.committed,e.snapshot)}),(function(e){return t(e,!1,null)})),i}},{key:"setPriority",value:function(e,t){tt("Reference.setPriority",1,2,arguments.length),rt("Reference.setPriority","onComplete",t,!0);var n=Ru(this._delegate,e);return t&&n.then((function(){return t(null)}),(function(e){return t(e)})),n}},{key:"push",value:function(e,t){var n=this;tt("Reference.push",0,2,arguments.length),rt("Reference.push","onComplete",t,!0);var i=Cu(this._delegate,e),a=i.then((function(e){return new r(n.database,e)}));t&&a.then((function(){return t(null)}),(function(e){return t(e)}));var o=new r(this.database,i);return o.then=a.then.bind(a),o.catch=a.catch.bind(a,void 0),o}},{key:"onDisconnect",value:function(){return As("Reference.onDisconnect",this._delegate._path),new uw(new gu(this._delegate._repo,this._delegate._path))}},{key:"key",get:function(){return this.getKey()}},{key:"parent",get:function(){return this.getParent()}},{key:"root",get:function(){return this.getRoot()}}]),r}(hw),dw=function(){"use strict";function t(n,r){var i=this;e(l)(this,t),this._delegate=n,this.app=r,this.INTERNAL={delete:function(){return i._delegate._delete()},forceWebSockets:_c,forceLongPolling:wc}}return e(h)(t,[{key:"useEmulator",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};bc(this._delegate,e,t,n)}},{key:"ref",value:function(e){if(tt("database.ref",0,1,arguments.length),e instanceof fw){var t=Eu(this._delegate,e.toString());return new fw(this,t)}var n=Tu(this._delegate,e);return new fw(this,n)}},{key:"refFromURL",value:function(e){var t="database.refFromURL";tt(t,1,1,arguments.length);var n=Eu(this._delegate,e);return new fw(this,n)}},{key:"goOffline",value:function(){return tt("database.goOffline",0,0,arguments.length),xc(this._delegate)}},{key:"goOnline",value:function(){return tt("database.goOnline",0,0,arguments.length),Ic(this._delegate)}}]),t}();dw.ServerValue={TIMESTAMP:Ec,increment:function(e){return Sc(e)}};var pw=Object.freeze({__proto__:null,initStandalone:
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(e){var t=e.app,n=e.url,r=e.version,i=e.customAuthImpl,a=e.namespace,o=e.nodeAdmin,s=void 0!==o&&o;Un(r);var u=new dt("auth-internal",new yt("database-standalone"));return u.setComponent(new ht("auth-internal",(function(){return i}),"PRIVATE")),{instance:new dw(mc(t,u,void 0,n,s),t),namespace:a}}}),vw=dw.ServerValue;
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */!function(e){e.INTERNAL.registerComponent(new ht("database-compat",(function(e,t){var n=t.instanceIdentifier,r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:n});return new dw(i,r)}),"PUBLIC").setServiceProps({Reference:fw,Query:hw,Database:dw,DataSnapshot:lw,enableLogging:Tc,INTERNAL:pw,ServerValue:vw}).setMultipleInstances(!0)),e.registerVersion("@firebase/database-compat","0.3.0")}(Fc);var yw,mw=o("ge8co"),gw=(mw=o("ge8co"),Pd=o("fVNic"),o("jmhxu")),kw=(On=o("l5bVx"),Pd=o("fVNic"),On=o("l5bVx"),"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n?n:"undefined"!=typeof self?self:{}),_w={},ww=ww||{},bw=kw||self;function xw(){}function Iw(t){var n=void 0===t?"undefined":e(On)(t);return"array"==(n="object"!=n?n:t?Array.isArray(t)?"array":n:"null")||"object"==n&&"number"==typeof t.length}function Tw(t){var n=void 0===t?"undefined":e(On)(t);return"object"==n&&null!=t||"function"==n}var Ew="closure_uid_"+(1e9*Math.random()>>>0),Sw=0;function Cw(e,t,n){return e.call.apply(e.bind,arguments)}function Aw(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function Nw(e,t,n){return(Nw=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Cw:Aw).apply(null,arguments)}function Rw(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function Dw(e,t){function n(){}n.prototype=t.prototype,e.X=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Wb=function(e,n,r){for(var i=Array(arguments.length-2),a=2;a<arguments.length;a++)i[a-2]=arguments[a];return t.prototype[n].apply(e,i)}}function Pw(){this.s=this.s,this.o=this.o}Pw.prototype.s=!1,Pw.prototype.na=function(){var e;!this.s&&(this.s=!0,this.M(),0)&&(e=this,Object.prototype.hasOwnProperty.call(e,Ew)&&e[Ew]||(e[Ew]=++Sw))},Pw.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var Ow=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1};function Mw(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function Lw(e,t){for(var n=1;n<arguments.length;n++){var r=arguments[n];if(Iw(r)){var i=e.length||0,a=r.length||0;e.length=i+a;for(var o=0;o<a;o++)e[i+o]=r[o]}else e.push(r)}}function Fw(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}Fw.prototype.h=function(){this.defaultPrevented=!0};var Uw=function(){if(!bw.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{bw.addEventListener("test",xw,t),bw.removeEventListener("test",xw,t)}catch(e){}return e}();function qw(e){return/^[\s\xa0]*$/.test(e)}var Vw=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function jw(e,t){return e<t?-1:e>t?1:0}function Bw(){var e=bw.navigator;return e&&(e=e.userAgent)?e:""}function Kw(e){return-1!=Bw().indexOf(e)}function zw(e){return zw[" "](e),e}zw[" "]=xw;var Ww,Gw,Hw=Kw("Opera"),Qw=Kw("Trident")||Kw("MSIE"),Yw=Kw("Edge"),Jw=Yw||Qw,Xw=Kw("Gecko")&&!(-1!=Bw().toLowerCase().indexOf("webkit")&&!Kw("Edge"))&&!(Kw("Trident")||Kw("MSIE"))&&!Kw("Edge"),$w=-1!=Bw().toLowerCase().indexOf("webkit")&&!Kw("Edge");function Zw(){var e=bw.document;return e?e.documentMode:void 0}e:{var eb="",tb=(Gw=Bw(),Xw?/rv:([^\);]+)(\)|;)/.exec(Gw):Yw?/Edge\/([\d\.]+)/.exec(Gw):Qw?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Gw):$w?/WebKit\/(\S+)/.exec(Gw):Hw?/(?:Version)[ \/]?(\S+)/.exec(Gw):void 0);if(tb&&(eb=tb?tb[1]:""),Qw){var nb=Zw();if(null!=nb&&nb>parseFloat(eb)){Ww=String(nb);break e}}Ww=eb}var rb,ib={};function ab(){return function(e){var t=ib;return Object.prototype.hasOwnProperty.call(t,9)?t[9]:t[9]=e(9)}((function(){for(var e=0,t=Vw(String(Ww)).split("."),n=Vw("9").split("."),r=Math.max(t.length,n.length),i=0;0==e&&i<r;i++){var a=t[i]||"",o=n[i]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],0==a[0].length&&0==o[0].length)break;e=jw(0==a[1].length?0:parseInt(a[1],10),0==o[1].length?0:parseInt(o[1],10))||jw(0==a[2].length,0==o[2].length)||jw(a[2],o[2]),a=a[3],o=o[3]}while(0==e)}return 0<=e}))}if(bw.document&&Qw){var ob=Zw();rb=ob||(parseInt(Ww,10)||void 0)}else rb=void 0;var sb=rb;function ub(e,t){if(Fw.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(Xw){e:{try{zw(t.nodeName);var i=!0;break e}catch(e){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:cb[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&ub.X.h.call(this)}}Dw(ub,Fw);var cb={2:"touch",3:"pen",4:"mouse"};ub.prototype.h=function(){ub.X.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var lb="closure_listenable_"+(1e6*Math.random()|0),hb=0;function fb(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=i,this.key=++hb,this.ba=this.ea=!1}function db(e){e.ba=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function pb(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function vb(e){var t={};for(var n in e)t[n]=e[n];return t}var yb="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function mb(e,t){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(var a=0;a<yb.length;a++)n=yb[a],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function gb(e){this.src=e,this.g={},this.h=0}function kb(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],a=Ow(i,t);(r=0<=a)&&Array.prototype.splice.call(i,a,1),r&&(db(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function _b(e,t,n,r){for(var i=0;i<e.length;++i){var a=e[i];if(!a.ba&&a.listener==t&&a.capture==!!n&&a.ha==r)return i}return-1}gb.prototype.add=function(e,t,n,r,i){var a=e.toString();(e=this.g[a])||(e=this.g[a]=[],this.h++);var o=_b(e,t,r,i);return-1<o?(t=e[o],n||(t.ea=!1)):((t=new fb(t,this.src,a,!!r,i)).ea=n,e.push(t)),t};var wb="closure_lm_"+(1e6*Math.random()|0),bb={};function xb(e,t,n,r,i){if(r&&r.once)return Tb(e,t,n,r,i);if(Array.isArray(t)){for(var a=0;a<t.length;a++)xb(e,t[a],n,r,i);return null}return n=Db(n),e&&e[lb]?e.N(t,n,Tw(r)?!!r.capture:!!r,i):Ib(e,t,n,!1,r,i)}function Ib(e,t,n,r,i,a){if(!t)throw Error("Invalid event type");var o=Tw(i)?!!i.capture:!!i,s=Nb(e);if(s||(e[wb]=s=new gb(e)),(n=s.add(t,n,r,o,a)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}var t=Ab;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)Uw||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(Cb(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function Tb(e,t,n,r,i){if(Array.isArray(t)){for(var a=0;a<t.length;a++)Tb(e,t[a],n,r,i);return null}return n=Db(n),e&&e[lb]?e.O(t,n,Tw(r)?!!r.capture:!!r,i):Ib(e,t,n,!0,r,i)}function Eb(e,t,n,r,i){if(Array.isArray(t))for(var a=0;a<t.length;a++)Eb(e,t[a],n,r,i);else r=Tw(r)?!!r.capture:!!r,n=Db(n),e&&e[lb]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=_b(a=e.g[t],n,r,i))&&(db(a[n]),Array.prototype.splice.call(a,n,1),0==a.length&&(delete e.g[t],e.h--)))):e&&(e=Nb(e))&&(t=e.g[t.toString()],e=-1,t&&(e=_b(t,n,r,i)),(n=-1<e?t[e]:null)&&Sb(n))}function Sb(e){if("number"!=typeof e&&e&&!e.ba){var t=e.src;if(t&&t[lb])kb(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(Cb(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Nb(t))?(kb(n,e),0==n.h&&(n.src=null,t[wb]=null)):db(e)}}}function Cb(e){return e in bb?bb[e]:bb[e]="on"+e}function Ab(e,t){if(e.ba)e=!0;else{t=new ub(t,this);var n=e.listener,r=e.ha||e.src;e.ea&&Sb(e),e=n.call(r,t)}return e}function Nb(e){return(e=e[wb])instanceof gb?e:null}var Rb="__closure_events_fn_"+(1e9*Math.random()>>>0);function Db(e){return"function"==typeof e?e:(e[Rb]||(e[Rb]=function(t){return e.handleEvent(t)}),e[Rb])}function Pb(){Pw.call(this),this.i=new gb(this),this.P=this,this.I=null}function Ob(e,t){var n,r=e.I;if(r)for(n=[];r;r=r.I)n.push(r);if(e=e.P,r=t.type||t,"string"==typeof t)t=new Fw(t,e);else if(t instanceof Fw)t.target=t.target||e;else{var i=t;mb(t=new Fw(r,e),i)}if(i=!0,n)for(var a=n.length-1;0<=a;a--){var o=t.g=n[a];i=Mb(o,r,!0,t)&&i}if(i=Mb(o=t.g=e,r,!0,t)&&i,i=Mb(o,r,!1,t)&&i,n)for(a=0;a<n.length;a++)i=Mb(o=t.g=n[a],r,!1,t)&&i}function Mb(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,a=0;a<t.length;++a){var o=t[a];if(o&&!o.ba&&o.capture==n){var s=o.listener,u=o.ha||o.src;o.ea&&kb(e.i,o),i=!1!==s.call(u,r)&&i}}return i&&!r.defaultPrevented}Dw(Pb,Pw),Pb.prototype[lb]=!0,Pb.prototype.removeEventListener=function(e,t,n,r){Eb(this,e,t,n,r)},Pb.prototype.M=function(){if(Pb.X.M.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)db(n[r]);delete t.g[e],t.h--}}this.I=null},Pb.prototype.N=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},Pb.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var Lb=bw.JSON.stringify;function Fb(){var e=Wb,t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var Ub,qb=function(){"use strict";function t(){e(l)(this,t),this.h=this.g=null}return e(h)(t,[{key:"add",value:function(e,t){var n=Vb.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}}]),t}(),Vb=new(function(){"use strict";function t(n,r){e(l)(this,t),this.i=n,this.j=r,this.h=0,this.g=null}return e(h)(t,[{key:"get",value:function(){var e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}]),t}())((function(){return new jb}),(function(e){return e.reset()})),jb=function(){"use strict";function t(){e(l)(this,t),this.next=this.g=this.h=null}return e(h)(t,[{key:"set",value:function(e,t){this.h=e,this.g=t,this.next=null}},{key:"reset",value:function(){this.next=this.g=this.h=null}}]),t}();function Bb(e){bw.setTimeout((function(){throw e}),0)}function Kb(e,t){Ub||function(){var e=bw.Promise.resolve(void 0);Ub=function(){e.then(Gb)}}(),zb||(Ub(),zb=!0),Wb.add(e,t)}var zb=!1,Wb=new qb;function Gb(){for(var e;e=Fb();){try{e.h.call(e.g)}catch(e){Bb(e)}var t=Vb;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}zb=!1}function Hb(e,t){Pb.call(this),this.h=e||1,this.g=t||bw,this.j=Nw(this.lb,this),this.l=Date.now()}function Qb(e){e.ca=!1,e.R&&(e.g.clearTimeout(e.R),e.R=null)}function Yb(e,t,n){if("function"==typeof e)n&&(e=Nw(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=Nw(e.handleEvent,e)}return 2147483647<Number(t)?-1:bw.setTimeout(e,t||0)}function Jb(e){e.g=Yb((function(){e.g=null,e.i&&(e.i=!1,Jb(e))}),e.j);var t=e.h;e.h=null,e.m.apply(null,t)}Dw(Hb,Pb),(yw=Hb.prototype).ca=!1,yw.R=null,yw.lb=function(){if(this.ca){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.R=this.g.setTimeout(this.j,this.h-e):(this.R&&(this.g.clearTimeout(this.R),this.R=null),Ob(this,"tick"),this.ca&&(Qb(this),this.start()))}},yw.start=function(){this.ca=!0,this.R||(this.R=this.g.setTimeout(this.j,this.h),this.l=Date.now())},yw.M=function(){Hb.X.M.call(this),Qb(this),delete this.g};var Xb=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i){var a;return e(l)(this,r),(a=n.call(this)).m=t,a.j=i,a.h=null,a.i=!1,a.g=null,a}return e(h)(r,[{key:"l",value:function(e){this.h=arguments,this.g?this.i=!0:Jb(this)}},{key:"M",value:function(){e(Nd)(e(Pd)(r.prototype),"M",this).call(this),this.g&&(bw.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}]),r}(Pw);function $b(e){Pw.call(this),this.h=e,this.g={}}Dw($b,Pw);var Zb=[];function ex(e,t,n,r){Array.isArray(n)||(n&&(Zb[0]=n.toString()),n=Zb);for(var i=0;i<n.length;i++){var a=xb(t,n[i],r||e.handleEvent,!1,e.h||e);if(!a)break;e.g[a.key]=a}}function tx(e){pb(e.g,(function(e,t){this.g.hasOwnProperty(t)&&Sb(e)}),e),e.g={}}function nx(){this.g=!0}function rx(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var a=i[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var o=1;o<i.length;o++)i[o]=""}}}return Lb(n)}catch(e){return t}}(e,n)+(r?" "+r:"")}))}$b.prototype.M=function(){$b.X.M.call(this),tx(this)},$b.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},nx.prototype.Aa=function(){this.g=!1},nx.prototype.info=function(){};var ix={},ax=null;function ox(){return ax=ax||new Pb}function sx(e){Fw.call(this,ix.Pa,e)}function ux(e){var t=ox();Ob(t,new sx(t))}function cx(e,t){Fw.call(this,ix.STAT_EVENT,e),this.stat=t}function lx(e){var t=ox();Ob(t,new cx(t,e))}function hx(e,t){Fw.call(this,ix.Qa,e),this.size=t}function fx(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return bw.setTimeout((function(){e()}),t)}ix.Pa="serverreachability",Dw(sx,Fw),ix.STAT_EVENT="statevent",Dw(cx,Fw),ix.Qa="timingevent",Dw(hx,Fw);var dx={NO_ERROR:0,mb:1,zb:2,yb:3,tb:4,xb:5,Ab:6,Ma:7,TIMEOUT:8,Db:9},px={rb:"complete",Nb:"success",Na:"error",Ma:"abort",Fb:"ready",Gb:"readystatechange",TIMEOUT:"timeout",Bb:"incrementaldata",Eb:"progress",ub:"downloadprogress",Vb:"uploadprogress"};function vx(){}function yx(e){return e.h||(e.h=e.i())}function mx(){}vx.prototype.h=null;var gx,kx={OPEN:"a",qb:"b",Na:"c",Cb:"d"};function _x(){Fw.call(this,"d")}function wx(){Fw.call(this,"c")}function bx(){}function xx(e,t,n,r){this.l=e,this.j=t,this.m=n,this.U=r||1,this.S=new $b(this),this.O=Tx,e=Jw?125:void 0,this.T=new Hb(e),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.V=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.Y=-1,this.I=!1,this.N=0,this.L=null,this.$=this.J=this.Z=this.P=!1,this.h=new Ix}function Ix(){this.i=null,this.g="",this.h=!1}Dw(_x,Fw),Dw(wx,Fw),Dw(bx,vx),bx.prototype.g=function(){return new XMLHttpRequest},bx.prototype.i=function(){return{}},gx=new bx;var Tx=45e3,Ex={},Sx={};function Cx(e,t,n){e.K=1,e.v=Hx(Bx(t)),e.s=n,e.P=!0,Ax(e,null)}function Ax(e,t){e.F=Date.now(),Px(e),e.A=Bx(e.v);var n=e.A,r=e.U;Array.isArray(r)||(r=[String(r)]),oI(n.i,"t",r),e.C=0,n=e.l.H,e.h=new Ix,e.g=oT(e.l,n?t:null,!e.s),0<e.N&&(e.L=new Xb(Nw(e.La,e,e.g),e.N)),ex(e.S,e.g,"readystatechange",e.ib),t=e.H?vb(e.H):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.da(e.A,e.u,e.s,t)):(e.u="GET",e.g.da(e.A,e.u,null,t)),ux(),function(e,t,n,r,i,a){e.info((function(){if(e.g)if(a)for(var o="",s=a.split("&"),u=0;u<s.length;u++){var c=s[u].split("=");if(1<c.length){var l=c[0];c=c[1];var h=l.split("_");o=2<=h.length&&"type"==h[1]?o+(l+"=")+c+"&":o+(l+"=redacted&")}}else o=null;else o=a;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o}))}(e.j,e.u,e.A,e.m,e.U,e.s)}function Nx(e){return!!e.g&&("GET"==e.u&&2!=e.K&&e.l.Da)}function Rx(e,t,n){for(var r,i=!0;!e.I&&e.C<n.length;){if((r=Dx(e,n))==Sx){4==t&&(e.o=4,lx(14),i=!1),rx(e.j,e.m,null,"[Incomplete Response]");break}if(r==Ex){e.o=4,lx(15),rx(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}rx(e.j,e.m,r,null),Ux(e,r)}Nx(e)&&r!=Sx&&r!=Ex&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,lx(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.$&&(e.$=!0,(t=e.l).g==e&&t.$&&!t.K&&(t.j.info("Great, no buffering proxy detected. Bytes received: "+n.length),$I(t),t.K=!0,lx(11))):(rx(e.j,e.m,n,"[Invalid Chunked Response]"),Fx(e),Lx(e))}function Dx(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?Sx:(n=Number(t.substring(n,r)),isNaN(n)?Ex:(r+=1)+n>t.length?Sx:(t=t.substr(r,n),e.C=r+n,t))}function Px(e){e.V=Date.now()+e.O,Ox(e,e.O)}function Ox(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=fx(Nw(e.gb,e),t)}function Mx(e){e.B&&(bw.clearTimeout(e.B),e.B=null)}function Lx(e){0==e.l.G||e.I||tT(e.l,e)}function Fx(e){Mx(e);var t=e.L;t&&"function"==typeof t.na&&t.na(),e.L=null,Qb(e.T),tx(e.S),e.g&&(t=e.g,e.g=null,t.abort(),t.na())}function Ux(e,t){try{var n=e.l;if(0!=n.G&&(n.g==e||dI(n.h,e)))if(!e.J&&dI(n.h,e)&&3==n.G){try{var r=n.Fa.g.parse(t)}catch(a){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;eT(n),zI(n)}XI(n),lx(18)}}else n.Ba=i[1],0<n.Ba-n.T&&37500>i[2]&&n.L&&0==n.A&&!n.v&&(n.v=fx(Nw(n.cb,n),6e3));if(1>=fI(n.h)&&n.ja){try{n.ja()}catch(a){}n.ja=void 0}}else rT(n,11)}else if((e.J||n.g==e)&&eT(n),!qw(t))for(i=n.Fa.g.parse(t),t=0;t<i.length;t++){var a=i[t];if(n.T=a[0],a=a[1],2==n.G)if("c"==a[0]){n.I=a[1],n.ka=a[2];var o=a[3];null!=o&&(n.ma=o,n.j.info("VER="+n.ma));var s=a[4];null!=s&&(n.Ca=s,n.j.info("SVER="+n.Ca));var u=a[5];null!=u&&"number"==typeof u&&0<u&&(r=1.5*u,n.J=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=e.g;if(c){var l=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var h=r.h;h.g||-1==l.indexOf("spdy")&&-1==l.indexOf("quic")&&-1==l.indexOf("h2")||(h.j=h.l,h.g=new Set,h.h&&(pI(h,h.h),h.h=null))}if(r.D){var f=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;f&&(r.za=f,Gx(r.F,r.D,f))}}n.G=3,n.l&&n.l.xa(),n.$&&(n.P=Date.now()-e.F,n.j.info("Handshake RTT: "+n.P+"ms"));var d=e;if((r=n).sa=aT(r,r.H?r.ka:null,r.V),d.J){vI(r.h,d);var p=d,v=r.J;v&&p.setTimeout(v),p.B&&(Mx(p),Px(p)),r.g=d}else JI(r);0<n.i.length&&GI(n)}else"stop"!=a[0]&&"close"!=a[0]||rT(n,7);else 3==n.G&&("stop"==a[0]||"close"==a[0]?"stop"==a[0]?rT(n,7):KI(n):"noop"!=a[0]&&n.l&&n.l.wa(a),n.A=0)}ux()}catch(a){}}function qx(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(Iw(e)||"string"==typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.oa&&"function"==typeof e.oa)return e.oa();if(!e.W||"function"!=typeof e.W){if("undefined"!=typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!=typeof Set&&e instanceof Set)){if(Iw(e)||"string"==typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}for(var r in t=[],n=0,e)t[n++]=r;return t}}}(e),r=function(e){if(e.W&&"function"==typeof e.W)return e.W();if("undefined"!=typeof Map&&e instanceof Map||"undefined"!=typeof Set&&e instanceof Set)return Array.from(e.values());if("string"==typeof e)return e.split("");if(Iw(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length,a=0;a<i;a++)t.call(void 0,r[a],n&&n[a],e)}(yw=xx.prototype).setTimeout=function(e){this.O=e},yw.ib=function(e){e=e.target;var t=this.L;t&&3==FI(e)?t.l():this.La(e)},yw.La=function(e){try{if(e==this.g)e:{var t=FI(this.g),n=this.g.Ea();this.g.aa();if(!(3>t)&&(3!=t||Jw||this.g&&(this.h.h||this.g.fa()||UI(this.g)))){this.I||4!=t||7==n||ux(),Mx(this);var r=this.g.aa();this.Y=r;t:if(Nx(this)){var i=UI(this.g);e="";var a=i.length,o=4==FI(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Fx(this),Lx(this);var s="";break t}this.h.i=new bw.TextDecoder}for(n=0;n<a;n++)this.h.h=!0,e+=this.h.i.decode(i[n],{stream:o&&n==a-1});i.splice(0,a),this.h.g+=e,this.C=0,s=this.h.g}else s=this.g.fa();if(this.i=200==r,function(e,t,n,r,i,a,o){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+a+" "+o}))}(this.j,this.u,this.A,this.m,this.U,t,r),this.i){if(this.Z&&!this.J){t:{if(this.g){var u,c=this.g;if((u=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!qw(u)){var l=u;break t}}l=null}if(!(r=l)){this.i=!1,this.o=3,lx(12),Fx(this),Lx(this);break e}rx(this.j,this.m,r,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Ux(this,r)}this.P?(Rx(this,t,s),Jw&&this.i&&3==t&&(ex(this.S,this.T,"tick",this.hb),this.T.start())):(rx(this.j,this.m,s,null),Ux(this,s)),4==t&&Fx(this),this.i&&!this.I&&(4==t?tT(this.l,this):(this.i=!1,Px(this)))}else 400==r&&0<s.indexOf("Unknown SID")?(this.o=3,lx(12)):(this.o=0,lx(13)),Fx(this),Lx(this)}}}catch(t){}},yw.hb=function(){if(this.g){var e=FI(this.g),t=this.g.fa();this.C<t.length&&(Mx(this),Rx(this,e,t),this.i&&4!=e&&Px(this))}},yw.cancel=function(){this.I=!0,Fx(this)},yw.gb=function(){this.B=null;var e=Date.now();0<=e-this.V?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.j,this.A),2!=this.K&&(ux(),lx(17)),Fx(this),this.o=2,Lx(this)):Ox(this,this.V-e)};var Vx=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function jx(e,t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,e instanceof jx){this.h=void 0!==t?t:e.h,Kx(this,e.j),this.s=e.s,this.g=e.g,zx(this,e.m),this.l=e.l,t=e.i;var n=new nI;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),Wx(this,n),this.o=e.o}else e&&(n=String(e).match(Vx))?(this.h=!!t,Kx(this,n[1]||"",!0),this.s=Qx(n[2]||""),this.g=Qx(n[3]||"",!0),zx(this,n[4]),this.l=Qx(n[5]||"",!0),Wx(this,n[6]||"",!0),this.o=Qx(n[7]||"")):(this.h=!!t,this.i=new nI(null,this.h))}function Bx(e){return new jx(e)}function Kx(e,t,n){e.j=n?Qx(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function zx(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function Wx(e,t,n){t instanceof nI?(e.i=t,function(e,t){t&&!e.j&&(rI(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(iI(this,t),oI(this,n,e))}),e)),e.j=t}(e.i,e.h)):(n||(t=Yx(t,eI)),e.i=new nI(t,e.h))}function Gx(e,t,n){e.i.set(t,n)}function Hx(e){return Gx(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function Qx(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Yx(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,Jx),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Jx(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}jx.prototype.toString=function(){var e=[],t=this.j;t&&e.push(Yx(t,Xx,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(Yx(t,Xx,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(Yx(n,"/"==n.charAt(0)?Zx:$x,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.o)&&e.push("#",Yx(n,tI)),e.join("")};var Xx=/[#\/\?@]/g,$x=/[#\?:]/g,Zx=/[#\?]/g,eI=/[#\?@]/g,tI=/#/g;function nI(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function rI(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var a=e[n].substring(0,r);i=e[n].substring(r+1)}else a=e[n];t(a,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function iI(e,t){rI(e),t=sI(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function aI(e,t){return rI(e),t=sI(e,t),e.g.has(t)}function oI(e,t,n){iI(e,t),0<n.length&&(e.i=null,e.g.set(sI(e,t),Mw(n)),e.h+=n.length)}function sI(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}(yw=nI.prototype).add=function(e,t){rI(this),this.i=null,e=sI(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},yw.forEach=function(e,t){rI(this),this.g.forEach((function(n,r){n.forEach((function(n){e.call(t,n,r,this)}),this)}),this)},yw.oa=function(){rI(this);for(var e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[],r=0;r<t.length;r++)for(var i=e[r],a=0;a<i.length;a++)n.push(t[r]);return n},yw.W=function(e){rI(this);var t=[];if("string"==typeof e)aI(this,e)&&(t=t.concat(this.g.get(sI(this,e))));else{e=Array.from(this.g.values());for(var n=0;n<e.length;n++)t=t.concat(e[n])}return t},yw.set=function(e,t){return rI(this),this.i=null,aI(this,e=sI(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},yw.get=function(e,t){return e&&0<(e=this.W(e)).length?String(e[0]):t},yw.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=Array.from(this.g.keys()),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r)),a=this.W(r);for(r=0;r<a.length;r++){var o=i;""!==a[r]&&(o+="="+encodeURIComponent(String(a[r]))),e.push(o)}}return this.i=e.join("&")};var uI=function t(n,r){"use strict";e(l)(this,t),this.h=n,this.g=r};function cI(e){this.l=e||lI,bw.PerformanceNavigationTiming?e=0<(e=bw.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(bw.g&&bw.g.Ga&&bw.g.Ga()&&bw.g.Ga().$b),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var lI=10;function hI(e){return!!e.h||!!e.g&&e.g.size>=e.j}function fI(e){return e.h?1:e.g?e.g.size:0}function dI(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function pI(e,t){e.g?e.g.add(t):e.h=t}function vI(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function yI(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){var t=e.i,n=!0,r=!1,i=void 0;try{for(var a,o=e.g.values()[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;t=t.concat(s.D)}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return t}return Mw(e.i)}function mI(){}function gI(){this.g=new mI}function kI(e,t,n){var r=n||"";try{qx(e,(function(e,n){var i=e;Tw(e)&&(i=Lb(e)),t.push(r+n+"="+encodeURIComponent(i))}))}catch(e){throw t.push(r+"type="+encodeURIComponent("_badmap")),e}}function _I(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(e){}}function wI(e){this.l=e.ac||null,this.j=e.jb||!1}function bI(e,t){Pb.call(this),this.D=e,this.u=t,this.m=void 0,this.readyState=xI,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}cI.prototype.cancel=function(){if(this.i=yI(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){var e=!0,t=!1,n=void 0;try{for(var r,i=this.g.values()[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){r.value.cancel()}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}this.g.clear()}},mI.prototype.stringify=function(e){return bw.JSON.stringify(e,void 0)},mI.prototype.parse=function(e){return bw.JSON.parse(e,void 0)},Dw(wI,vx),wI.prototype.g=function(){return new bI(this.l,this.j)},wI.prototype.i=function(e){return function(){return e}}({}),Dw(bI,Pb);var xI=0;function II(e){e.j.read().then(e.Ta.bind(e)).catch(e.ga.bind(e))}function TI(e){e.readyState=4,e.l=null,e.j=null,e.A=null,EI(e)}function EI(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(yw=bI.prototype).open=function(e,t){if(this.readyState!=xI)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,EI(this)},yw.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||bw).fetch(new Request(this.B,t)).then(this.Wa.bind(this),this.ga.bind(this))},yw.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((function(){})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,TI(this)),this.readyState=xI},yw.Wa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,EI(this)),this.g&&(this.readyState=3,EI(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ua.bind(this),this.ga.bind(this));else if(void 0!==bw.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;II(this)}else e.text().then(this.Va.bind(this),this.ga.bind(this))},yw.Ta=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?TI(this):EI(this),3==this.readyState&&II(this)}},yw.Va=function(e){this.g&&(this.response=this.responseText=e,TI(this))},yw.Ua=function(e){this.g&&(this.response=e,TI(this))},yw.ga=function(){this.g&&TI(this)},yw.setRequestHeader=function(e,t){this.v.append(e,t)},yw.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},yw.getAllResponseHeaders=function(){if(!this.h)return"";for(var e=[],t=this.h.entries(),n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(bI.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var SI=bw.JSON.parse;function CI(e){Pb.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=AI,this.K=this.L=!1}Dw(CI,Pb);var AI="",NI=/^https?$/i,RI=["POST","PUT"];function DI(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,PI(e),MI(e)}function PI(e){e.D||(e.D=!0,Ob(e,"complete"),Ob(e,"error"))}function OI(e){if(e.h&&void 0!==ww&&(!e.C[1]||4!=FI(e)||2!=e.aa()))if(e.v&&4==FI(e))Yb(e.Ha,0,e);else if(Ob(e,"readystatechange"),4==FI(e)){e.h=!1;try{var t,n=e.aa();e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var i;if(i=0===n){var a=String(e.H).match(Vx)[1]||null;if(!a&&bw.self&&bw.self.location){var o=bw.self.location.protocol;a=o.substr(0,o.length-1)}i=!NI.test(a?a.toLowerCase():"")}t=i}if(t)Ob(e,"complete"),Ob(e,"success");else{e.m=6;try{var s=2<FI(e)?e.g.statusText:""}catch(e){s=""}e.j=s+" ["+e.aa()+"]",PI(e)}}finally{MI(e)}}}function MI(e,t){if(e.g){LI(e);var n=e.g,r=e.C[0]?xw:null;e.g=null,e.C=null,t||Ob(e,"ready");try{n.onreadystatechange=r}catch(e){}}}function LI(e){e.g&&e.K&&(e.g.ontimeout=null),e.A&&(bw.clearTimeout(e.A),e.A=null)}function FI(e){return e.g?e.g.readyState:0}function UI(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.J){case AI:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(e){return null}}function qI(e){var t="";return pb(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function VI(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=qI(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):Gx(e,t,n))}function jI(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function BI(e){this.Ca=0,this.i=[],this.j=new nx,this.ka=this.sa=this.F=this.V=this.g=this.za=this.D=this.ia=this.o=this.S=this.s=null,this.ab=this.U=0,this.Za=jI("failFast",!1,e),this.L=this.v=this.u=this.m=this.l=null,this.Y=!0,this.pa=this.Ba=this.T=-1,this.Z=this.A=this.C=0,this.Xa=jI("baseRetryDelayMs",5e3,e),this.bb=jI("retryDelaySeedMs",1e4,e),this.$a=jI("forwardChannelMaxRetries",2,e),this.ta=jI("forwardChannelRequestTimeoutMs",2e4,e),this.ra=e&&e.xmlHttpFactory||void 0,this.Da=e&&e.Zb||!1,this.J=void 0,this.H=e&&e.supportsCrossDomainXhr||!1,this.I="",this.h=new cI(e&&e.concurrentRequestLimit),this.Fa=new gI,this.O=e&&e.fastHandshake||!1,this.N=e&&e.encodeInitMessageHeaders||!1,this.O&&this.N&&(this.N=!1),this.Ya=e&&e.Xb||!1,e&&e.Aa&&this.j.Aa(),e&&e.forceLongPolling&&(this.Y=!1),this.$=!this.O&&this.Y&&e&&e.detectBufferingProxy||!1,this.ja=void 0,this.P=0,this.K=!1,this.la=this.B=null}function KI(e){if(WI(e),3==e.G){var t=e.U++,n=Bx(e.F);Gx(n,"SID",e.I),Gx(n,"RID",t),Gx(n,"TYPE","terminate"),QI(e,n),(t=new xx(e,e.j,t,void 0)).K=2,t.v=Hx(Bx(n)),n=!1,bw.navigator&&bw.navigator.sendBeacon&&(n=bw.navigator.sendBeacon(t.v.toString(),"")),!n&&bw.Image&&((new Image).src=t.v,n=!0),n||(t.g=oT(t.l,null),t.g.da(t.v)),t.F=Date.now(),Px(t)}iT(e)}function zI(e){e.g&&($I(e),e.g.cancel(),e.g=null)}function WI(e){zI(e),e.u&&(bw.clearTimeout(e.u),e.u=null),eT(e),e.h.cancel(),e.m&&("number"==typeof e.m&&bw.clearTimeout(e.m),e.m=null)}function GI(e){hI(e.h)||e.m||(e.m=!0,Kb(e.Ja,e),e.C=0)}function HI(e,t){var n;n=t?t.m:e.U++;var r=Bx(e.F);Gx(r,"SID",e.I),Gx(r,"RID",n),Gx(r,"AID",e.T),QI(e,r),e.o&&e.s&&VI(r,e.o,e.s),n=new xx(e,e.j,n,e.C+1),null===e.o&&(n.H=e.s),t&&(e.i=t.D.concat(e.i)),t=YI(e,n,1e3),n.setTimeout(Math.round(.5*e.ta)+Math.round(.5*e.ta*Math.random())),pI(e.h,n),Cx(n,r,t)}function QI(e,t){e.ia&&pb(e.ia,(function(e,n){Gx(t,n,e)})),e.l&&qx({},(function(e,n){Gx(t,n,e)}))}function YI(e,t,n){n=Math.min(e.i.length,n);var r=e.l?Nw(e.l.Ra,e.l,e):null;e:for(var i=e.i,a=-1;;){var o=["count="+n];-1==a?0<n?(a=i[0].h,o.push("ofs="+a)):a=0:o.push("ofs="+a);for(var s=!0,u=0;u<n;u++){var c=i[u].h,l=i[u].g;if(0>(c-=a))a=Math.max(0,i[u].h-100),s=!1;else try{kI(l,o,"req"+c+"_")}catch(e){r&&r(l)}}if(s){r=o.join("&");break e}}return e=e.i.splice(0,n),t.D=e,r}function JI(e){e.g||e.u||(e.Z=1,Kb(e.Ia,e),e.A=0)}function XI(e){return!(e.g||e.u||3<=e.A)&&(e.Z++,e.u=fx(Nw(e.Ia,e),nT(e,e.A)),e.A++,!0)}function $I(e){null!=e.B&&(bw.clearTimeout(e.B),e.B=null)}function ZI(e){e.g=new xx(e,e.j,"rpc",e.Z),null===e.o&&(e.g.H=e.s),e.g.N=0;var t=Bx(e.sa);Gx(t,"RID","rpc"),Gx(t,"SID",e.I),Gx(t,"CI",e.L?"0":"1"),Gx(t,"AID",e.T),Gx(t,"TYPE","xmlhttp"),QI(e,t),e.o&&e.s&&VI(t,e.o,e.s),e.J&&e.g.setTimeout(e.J);var n=e.g;e=e.ka,n.K=1,n.v=Hx(Bx(t)),n.s=null,n.P=!0,Ax(n,e)}function eT(e){null!=e.v&&(bw.clearTimeout(e.v),e.v=null)}function tT(e,t){var n=null;if(e.g==t){eT(e),$I(e),e.g=null;var r=2}else{if(!dI(e.h,t))return;n=t.D,vI(e.h,t),r=1}if(0!=e.G)if(e.pa=t.Y,t.i)if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.F;var i=e.C;Ob(r=ox(),new hx(r,n)),GI(e)}else JI(e);else if(3==(i=t.o)||0==i&&0<e.pa||!(1==r&&function(e,t){return!(fI(e.h)>=e.h.j-(e.m?1:0)||(e.m?(e.i=t.D.concat(e.i),0):1==e.G||2==e.G||e.C>=(e.Za?0:e.$a)||(e.m=fx(Nw(e.Ja,e,t),nT(e,e.C)),e.C++,0)))}(e,t)||2==r&&XI(e)))switch(n&&0<n.length&&(t=e.h,t.i=t.i.concat(n)),i){case 1:rT(e,5);break;case 4:rT(e,10);break;case 3:rT(e,6);break;default:rT(e,2)}}function nT(e,t){var n=e.Xa+Math.floor(Math.random()*e.bb);return e.l||(n*=2),n*t}function rT(e,t){if(e.j.info("Error code "+t),2==t){var n=null;e.l&&(n=null);var r=Nw(e.kb,e);n||(n=new jx("//www.google.com/images/cleardot.gif"),bw.location&&"http"==bw.location.protocol||Kx(n,"https"),Hx(n)),function(e,t){var n=new nx;if(bw.Image){var r=new Image;r.onload=Rw(_I,n,r,"TestLoadImage: loaded",!0,t),r.onerror=Rw(_I,n,r,"TestLoadImage: error",!1,t),r.onabort=Rw(_I,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=Rw(_I,n,r,"TestLoadImage: timeout",!1,t),bw.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(n.toString(),r)}else lx(2);e.G=0,e.l&&e.l.va(t),iT(e),WI(e)}function iT(e){if(e.G=0,e.la=[],e.l){var t=yI(e.h);0==t.length&&0==e.i.length||(Lw(e.la,t),Lw(e.la,e.i),e.h.i.length=0,Mw(e.i),e.i.length=0),e.l.ua()}}function aT(e,t,n){var r=n instanceof jx?Bx(n):new jx(n,void 0);if(""!=r.g)t&&(r.g=t+"."+r.g),zx(r,r.m);else{var i=bw.location;r=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var a=new jx(null,void 0);r&&Kx(a,r),t&&(a.g=t),i&&zx(a,i),n&&(a.l=n),r=a}return n=e.D,t=e.za,n&&t&&Gx(r,n,t),Gx(r,"VER",e.ma),QI(e,r),r}function oT(e,t,n){if(t&&!e.H)throw Error("Can't create secondary domain capable XhrIo object.");return(t=n&&e.Da&&!e.ra?new CI(new wI({jb:!0})):new CI(e.ra)).Ka(e.H),t}function sT(){}function uT(){if(Qw&&!(10<=Number(sb)))throw Error("Environmental error: no available transport.")}function cT(e,t){Pb.call(this),this.g=new BI(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(e?e["X-WebChannel-Client-Profile"]=t.ya:e={"X-WebChannel-Client-Profile":t.ya}),this.g.S=e,(e=t&&t.Yb)&&!qw(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!qw(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new fT(this)}function lT(e){_x.call(this);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function hT(){wx.call(this),this.status=1}function fT(e){this.g=e}(yw=CI.prototype).Ka=function(e){this.L=e},yw.da=function(t,n,r,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);n=n?n.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():gx.g(),this.C=this.u?yx(this.u):yx(gx),this.g.onreadystatechange=Nw(this.Ha,this);try{this.F=!0,this.g.open(n,String(t),!0),this.F=!1}catch(e){return void DI(this,e)}if(t=r||"",r=new Map(this.headers),i){var a=!0,o=!1,s=void 0;if(Object.getPrototypeOf(i)===Object.prototype)for(var u in i)r.set(u,i[u]);else{if("function"!=typeof i.keys||"function"!=typeof i.get)throw Error("Unknown input type for opt_headers: "+String(i));try{for(var c,l=i.keys()[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){var h=c.value;r.set(h,i.get(h))}}catch(e){o=!0,s=e}finally{try{a||null==l.return||l.return()}finally{if(o)throw s}}}}i=Array.from(r.keys()).find((function(e){return"content-type"==e.toLowerCase()})),u=bw.FormData&&t instanceof bw.FormData,!(0<=Ow(RI,n))||i||u||r.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");var f=!0,d=!1,p=void 0;try{for(var v,y=r[Symbol.iterator]();!(f=(v=y.next()).done);f=!0){var m=e(b)(v.value,2),g=m[0],k=m[1];this.g.setRequestHeader(g,k)}}catch(e){d=!0,p=e}finally{try{f||null==y.return||y.return()}finally{if(d)throw p}}this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{LI(this),0<this.B&&((this.K=function(e){return Qw&&ab()&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Nw(this.qa,this)):this.A=Yb(this.qa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(e){DI(this,e)}},yw.qa=function(){void 0!==ww&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Ob(this,"timeout"),this.abort(8))},yw.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,Ob(this,"complete"),Ob(this,"abort"),MI(this))},yw.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),MI(this,!0)),CI.X.M.call(this)},yw.Ha=function(){this.s||(this.F||this.v||this.l?OI(this):this.fb())},yw.fb=function(){OI(this)},yw.aa=function(){try{return 2<FI(this)?this.g.status:-1}catch(e){return-1}},yw.fa=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},yw.Sa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),SI(t)}},yw.Ea=function(){return this.m},yw.Oa=function(){return"string"==typeof this.j?this.j:String(this.j)},(yw=BI.prototype).ma=8,yw.G=1,yw.Ja=function(e){if(this.m)if(this.m=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;var t=new xx(this,this.j,e,void 0),n=this.s;if(this.S&&(n?mb(n=vb(n),this.S):n=this.S),null!==this.o||this.N||(t.H=n,n=null),this.O)e:{for(var r=0,i=0;i<this.i.length;i++){var a=this.i[i];if(void 0===(a="__data__"in a.g&&"string"==typeof(a=a.g.__data__)?a.length:void 0))break;if(4096<(r+=a)){r=i;break e}if(4096===r||i===this.i.length-1){r=i+1;break e}}r=1e3}else r=1e3;r=YI(this,t,r),Gx(i=Bx(this.F),"RID",e),Gx(i,"CVER",22),this.D&&Gx(i,"X-HTTP-Session-Id",this.D),QI(this,i),n&&(this.N?r="headers="+encodeURIComponent(String(qI(n)))+"&"+r:this.o&&VI(i,this.o,n)),pI(this.h,t),this.Ya&&Gx(i,"TYPE","init"),this.O?(Gx(i,"$req",r),Gx(i,"SID","null"),t.Z=!0,Cx(t,i,null)):Cx(t,i,r),this.G=2}}else 3==this.G&&(e?HI(this,e):0==this.i.length||hI(this.h)||HI(this))},yw.Ia=function(){if(this.u=null,ZI(this),this.$&&!(this.K||null==this.g||0>=this.P)){var e=2*this.P;this.j.info("BP detection timer enabled: "+e),this.B=fx(Nw(this.eb,this),e)}},yw.eb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.L=!1,this.K=!0,lx(10),zI(this),ZI(this))},yw.cb=function(){null!=this.v&&(this.v=null,zI(this),XI(this),lx(19))},yw.kb=function(e){e?(this.j.info("Successfully pinged google.com"),lx(2)):(this.j.info("Failed to ping google.com"),lx(1))},(yw=sT.prototype).xa=function(){},yw.wa=function(){},yw.va=function(){},yw.ua=function(){},yw.Ra=function(){},uT.prototype.g=function(e,t){return new cT(e,t)},Dw(cT,Pb),cT.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.H=!0);var e=this.g,t=this.l,n=this.h||void 0;lx(0),e.V=t,e.ia=n||{},e.L=e.Y,e.F=aT(e,null,e.V),GI(e)},cT.prototype.close=function(){KI(this.g)},cT.prototype.u=function(e){var t=this.g;if("string"==typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=Lb(e),e=n);t.i.push(new uI(t.ab++,e)),3==t.G&&GI(t)},cT.prototype.M=function(){this.g.l=null,delete this.j,KI(this.g),delete this.g,cT.X.M.call(this)},Dw(lT,_x),Dw(hT,wx),Dw(fT,sT),fT.prototype.xa=function(){Ob(this.g,"a")},fT.prototype.wa=function(e){Ob(this.g,new lT(e))},fT.prototype.va=function(e){Ob(this.g,new hT)},fT.prototype.ua=function(){Ob(this.g,"b")},uT.prototype.createWebChannel=uT.prototype.g,cT.prototype.send=cT.prototype.u,cT.prototype.open=cT.prototype.m,cT.prototype.close=cT.prototype.close,dx.NO_ERROR=0,dx.TIMEOUT=8,dx.HTTP_ERROR=6,px.COMPLETE="complete",mx.EventType=kx,kx.OPEN="a",kx.CLOSE="b",kx.ERROR="c",kx.MESSAGE="d",Pb.prototype.listen=Pb.prototype.N,CI.prototype.listenOnce=CI.prototype.O,CI.prototype.getLastError=CI.prototype.Oa,CI.prototype.getLastErrorCode=CI.prototype.Ea,CI.prototype.getStatus=CI.prototype.aa,CI.prototype.getResponseJson=CI.prototype.Sa,CI.prototype.getResponseText=CI.prototype.fa,CI.prototype.send=CI.prototype.da,CI.prototype.setWithCredentials=CI.prototype.Ka;var dT=_w.createWebChannelTransport=function(){return new uT},pT=_w.getStatEventTarget=function(){return ox()},vT=_w.ErrorCode=dx,yT=_w.EventType=px,mT=_w.Event=ix,gT=_w.Stat={sb:0,vb:1,wb:2,Pb:3,Ub:4,Rb:5,Sb:6,Qb:7,Ob:8,Tb:9,PROXY:10,NOPROXY:11,Mb:12,Ib:13,Jb:14,Hb:15,Kb:16,Lb:17,ob:18,nb:19,pb:20},kT=_w.FetchXmlHttpFactory=wI,_T=_w.WebChannel=mx,wT=_w.XhrIo=CI,bT="@firebase/firestore",xT=function(){"use strict";function t(n){e(l)(this,t),this.uid=n}return e(h)(t,[{key:"isAuthenticated",value:function(){return null!=this.uid}},{key:"toKey",value:function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}},{key:"isEqual",value:function(e){return e.uid===this.uid}}]),t}();xT.UNAUTHENTICATED=new xT(null),xT.GOOGLE_CREDENTIALS=new xT("google-credentials-uid"),xT.FIRST_PARTY=new xT("first-party-uid"),xT.MOCK_USER=new xT("mock-user");
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var IT="9.15.0",TT=new xt("@firebase/firestore");
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ET(){return TT.logLevel}function ST(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if(TT.logLevel<=pt.DEBUG){var a,o=r.map(NT);(a=TT).debug.apply(a,["Firestore (".concat(IT,"): ").concat(t)].concat(e(p)(o)))}}function CT(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if(TT.logLevel<=pt.ERROR){var a,o=r.map(NT);(a=TT).error.apply(a,["Firestore (".concat(IT,"): ").concat(t)].concat(e(p)(o)))}}function AT(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if(TT.logLevel<=pt.WARN){var a,o=r.map(NT);(a=TT).warn.apply(a,["Firestore (".concat(IT,"): ").concat(t)].concat(e(p)(o)))}}function NT(e){if("string"==typeof e)return e;try{return t=e,JSON.stringify(t)}catch(t){return e}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RT(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state",t="FIRESTORE (".concat(IT,") INTERNAL ASSERTION FAILED: ")+e;throw CT(t),new Error(t)}function DT(e,t){e||RT()}function PT(e,t){return e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var OT={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},MT=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i){var a;return e(l)(this,r),(a=n.call(this,t,i)).code=t,a.message=i,a.toString=function(){return"".concat(a.name,": [code=").concat(a.code,"]: ").concat(a.message)},e(gw)(a)}return r}(Oe),LT=function t(){"use strict";var n=this;e(l)(this,t),this.promise=new Promise((function(e,t){n.resolve=e,n.reject=t}))},FT=function t(n,r){"use strict";e(l)(this,t),this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(n))},UT=function(){"use strict";function t(){e(l)(this,t)}return e(h)(t,[{key:"getToken",value:function(){return Promise.resolve(null)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){e.enqueueRetryable((function(){return t(xT.UNAUTHENTICATED)}))}},{key:"shutdown",value:function(){}}]),t}(),qT=function(){"use strict";function t(n){e(l)(this,t),this.token=n,this.changeListener=null}return e(h)(t,[{key:"getToken",value:function(){return Promise.resolve(this.token)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){var n=this;this.changeListener=t,e.enqueueRetryable((function(){return t(n.token.user)}))}},{key:"shutdown",value:function(){this.changeListener=null}}]),t}(),VT=function(){"use strict";function t(n){e(l)(this,t),this.t=n,this.currentUser=xT.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}return e(h)(t,[{key:"start",value:function(t,n){var r=this,i=this.i,a=function(e){return r.i!==i?(i=r.i,n(e)):Promise.resolve()},o=new LT;this.o=function(){var e=r;r.i++,r.currentUser=r.u(),o.resolve(),o=new LT,t.enqueueRetryable((function(){return a(e.currentUser)}))};var s=function(){var n=o,i=r;t.enqueueRetryable(e(u)(e(_).mark((function t(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.promise;case 2:return e.next=4,a(i.currentUser);case 4:case"end":return e.stop()}}),t)}))))},c=function(e){ST("FirebaseAuthCredentialsProvider","Auth detected"),r.auth=e,r.auth.addAuthTokenListener(r.o),s()};this.t.onInit((function(e){return c(e)})),setTimeout((function(){if(!r.auth){var e=r.t.getImmediate({optional:!0});e?c(e):(ST("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new LT)}}),0),s()}},{key:"getToken",value:function(){var e=this,t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return e.i!==t?(ST("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),e.getToken()):n?(DT("string"==typeof n.accessToken),new FT(n.accessToken,e.currentUser)):null})):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.auth&&this.auth.removeAuthTokenListener(this.o)}},{key:"u",value:function(){var e=this.auth&&this.auth.getUid();return DT(null===e||"string"==typeof e),new xT(e)}}]),t}(),jT=function(){"use strict";function t(n,r,i,a){e(l)(this,t),this.h=n,this.l=r,this.m=i,this.g=a,this.type="FirstParty",this.user=xT.FIRST_PARTY,this.p=new Map}return e(h)(t,[{key:"I",value:function(){return this.g?this.g():(DT(!("object"!=typeof this.h||null===this.h||!this.h.auth||!this.h.auth.getAuthHeaderValueForFirstParty)),this.h.auth.getAuthHeaderValueForFirstParty([]))}},{key:"headers",get:function(){this.p.set("X-Goog-AuthUser",this.l);var e=this.I();return e&&this.p.set("Authorization",e),this.m&&this.p.set("X-Goog-Iam-Authorization-Token",this.m),this.p}}]),t}(),BT=function(){"use strict";function t(n,r,i,a){e(l)(this,t),this.h=n,this.l=r,this.m=i,this.g=a}return e(h)(t,[{key:"getToken",value:function(){return Promise.resolve(new jT(this.h,this.l,this.m,this.g))}},{key:"start",value:function(e,t){e.enqueueRetryable((function(){return t(xT.FIRST_PARTY)}))}},{key:"shutdown",value:function(){}},{key:"invalidateToken",value:function(){}}]),t}(),KT=function t(n){"use strict";e(l)(this,t),this.value=n,this.type="AppCheck",this.headers=new Map,n&&n.length>0&&this.headers.set("x-firebase-appcheck",this.value)},zT=function(){"use strict";function t(n){e(l)(this,t),this.T=n,this.forceRefresh=!1,this.appCheck=null,this.A=null}return e(h)(t,[{key:"start",value:function(e,t){var n=this;this.o=function(r){e.enqueueRetryable((function(){return function(e){null!=e.error&&ST("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));var r=e.token!==n.A;return n.A=e.token,ST("FirebaseAppCheckTokenProvider","Received ".concat(r?"new":"existing"," token.")),r?t(e.token):Promise.resolve()}(r)}))};var r=function(e){ST("FirebaseAppCheckTokenProvider","AppCheck detected"),n.appCheck=e,n.appCheck.addTokenListener(n.o)};this.T.onInit((function(e){return r(e)})),setTimeout((function(){if(!n.appCheck){var e=n.T.getImmediate({optional:!0});e?r(e):ST("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}},{key:"getToken",value:function(){var e=this,t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((function(t){return t?(DT("string"==typeof t.token),e.A=t.token,new KT(t.token)):null})):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function WT(e){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(var r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var GT=function(){"use strict";function t(){e(l)(this,t)}return e(h)(t,null,[{key:"R",value:function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,n="";n.length<20;)for(var r=WT(40),i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%e.length));return n}}]),t}();function HT(e,t){return e<t?-1:e>t?1:0}function QT(e,t,n){return e.length===t.length&&e.every((function(e,r){return n(e,t[r])}))}function YT(e){return e+"\0"}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var JT=function(){"use strict";function t(n,r){if(e(l)(this,t),this.seconds=n,this.nanoseconds=r,r<0)throw new MT(OT.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new MT(OT.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(n<-62135596800)throw new MT(OT.INVALID_ARGUMENT,"Timestamp seconds out of range: "+n);if(n>=253402300800)throw new MT(OT.INVALID_ARGUMENT,"Timestamp seconds out of range: "+n)}return e(h)(t,[{key:"toDate",value:function(){return new Date(this.toMillis())}},{key:"toMillis",value:function(){return 1e3*this.seconds+this.nanoseconds/1e6}},{key:"_compareTo",value:function(e){return this.seconds===e.seconds?HT(this.nanoseconds,e.nanoseconds):HT(this.seconds,e.seconds)}},{key:"isEqual",value:function(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}},{key:"toString",value:function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}},{key:"toJSON",value:function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}},{key:"valueOf",value:function(){var e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}],[{key:"now",value:function(){return t.fromMillis(Date.now())}},{key:"fromDate",value:function(e){return t.fromMillis(e.getTime())}},{key:"fromMillis",value:function(e){var n=Math.floor(e/1e3);return new t(n,Math.floor(1e6*(e-1e3*n)))}}]),t}(),XT=function(){"use strict";function t(n){e(l)(this,t),this.timestamp=n}return e(h)(t,[{key:"compareTo",value:function(e){return this.timestamp._compareTo(e.timestamp)}},{key:"isEqual",value:function(e){return this.timestamp.isEqual(e.timestamp)}},{key:"toMicroseconds",value:function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}},{key:"toString",value:function(){return"SnapshotVersion("+this.timestamp.toString()+")"}},{key:"toTimestamp",value:function(){return this.timestamp}}],[{key:"fromTimestamp",value:function(e){return new t(e)}},{key:"min",value:function(){return new t(new JT(0,0))}},{key:"max",value:function(){return new t(new JT(253402300799,999999999))}}]),t}(),$T=function(){"use strict";function t(n,r,i){e(l)(this,t),void 0===r?r=0:r>n.length&&RT(),void 0===i?i=n.length-r:i>n.length-r&&RT(),this.segments=n,this.offset=r,this.len=i}return e(h)(t,[{key:"length",get:function(){return this.len}},{key:"isEqual",value:function(e){return 0===t.comparator(this,e)}},{key:"child",value:function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(e){n.push(e)})):n.push(e),this.construct(n)}},{key:"limit",value:function(){return this.offset+this.length}},{key:"popFirst",value:function(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}},{key:"popLast",value:function(){return this.construct(this.segments,this.offset,this.length-1)}},{key:"firstSegment",value:function(){return this.segments[this.offset]}},{key:"lastSegment",value:function(){return this.get(this.length-1)}},{key:"get",value:function(e){return this.segments[this.offset+e]}},{key:"isEmpty",value:function(){return 0===this.length}},{key:"isPrefixOf",value:function(e){if(e.length<this.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"isImmediateParentOf",value:function(e){if(this.length+1!==e.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"forEach",value:function(e){for(var t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}},{key:"toArray",value:function(){return this.segments.slice(this.offset,this.limit())}}],[{key:"comparator",value:function(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var i=e.get(r),a=t.get(r);if(i<a)return-1;if(i>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}]),t}(),ZT=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(){return e(l)(this,r),n.apply(this,arguments)}return e(h)(r,[{key:"construct",value:function(e,t,n){return new r(e,t,n)}},{key:"canonicalString",value:function(){return this.toArray().join("/")}},{key:"toString",value:function(){return this.canonicalString()}}],[{key:"fromString",value:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var a=[],o=!0,s=!1,u=void 0;try{for(var c,l=n[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var h,f=c.value;if(f.indexOf("//")>=0)throw new MT(OT.INVALID_ARGUMENT,"Invalid segment (".concat(f,"). Paths must not contain // in them."));(h=a).push.apply(h,e(p)(f.split("/").filter((function(e){return e.length>0}))))}}catch(e){s=!0,u=e}finally{try{o||null==l.return||l.return()}finally{if(s)throw u}}return new r(a)}},{key:"emptyPath",value:function(){return new r([])}}]),r}($T),eE=/^[_a-zA-Z][_a-zA-Z0-9]*$/,tE=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(){return e(l)(this,r),n.apply(this,arguments)}return e(h)(r,[{key:"construct",value:function(e,t,n){return new r(e,t,n)}},{key:"canonicalString",value:function(){return this.toArray().map((function(e){return e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),r.isValidIdentifier(e)||(e="`"+e+"`"),e})).join(".")}},{key:"toString",value:function(){return this.canonicalString()}},{key:"isKeyField",value:function(){return 1===this.length&&"__name__"===this.get(0)}}],[{key:"isValidIdentifier",value:function(e){return eE.test(e)}},{key:"keyField",value:function(){return new r(["__name__"])}},{key:"fromServerFormat",value:function(e){for(var t=[],n="",i=0,a=function(){if(0===n.length)throw new MT(OT.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(n),n=""},o=!1;i<e.length;){var s=e[i];if("\\"===s){if(i+1===e.length)throw new MT(OT.INVALID_ARGUMENT,"Path has trailing escape character: "+e);var u=e[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new MT(OT.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=u,i+=2}else"`"===s?(o=!o,i++):"."!==s||o?(n+=s,i++):(a(),i++)}if(a(),o)throw new MT(OT.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new r(t)}},{key:"emptyPath",value:function(){return new r([])}}]),r}($T),nE=function(){"use strict";function t(n){e(l)(this,t),this.path=n}return e(h)(t,[{key:"collectionGroup",get:function(){return this.path.popLast().lastSegment()}},{key:"hasCollectionId",value:function(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}},{key:"getCollectionGroup",value:function(){return this.path.get(this.path.length-2)}},{key:"getCollectionPath",value:function(){return this.path.popLast()}},{key:"isEqual",value:function(e){return null!==e&&0===ZT.comparator(this.path,e.path)}},{key:"toString",value:function(){return this.path.toString()}}],[{key:"fromPath",value:function(e){return new t(ZT.fromString(e))}},{key:"fromName",value:function(e){return new t(ZT.fromString(e).popFirst(5))}},{key:"empty",value:function(){return new t(ZT.emptyPath())}},{key:"comparator",value:function(e,t){return ZT.comparator(e.path,t.path)}},{key:"isDocumentKey",value:function(e){return e.length%2==0}},{key:"fromSegments",value:function(e){return new t(new ZT(e.slice()))}}]),t}(),rE=function t(n,r,i,a){"use strict";e(l)(this,t),this.indexId=n,this.collectionGroup=r,this.fields=i,this.indexState=a};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iE(e){return e.fields.find((function(e){return 2===e.kind}))}function aE(e){return e.fields.filter((function(e){return 2!==e.kind}))}rE.UNKNOWN_ID=-1;var oE=function t(n,r){"use strict";e(l)(this,t),this.fieldPath=n,this.kind=r};var sE=function(){"use strict";function t(n,r){e(l)(this,t),this.sequenceNumber=n,this.offset=r}return e(h)(t,null,[{key:"empty",value:function(){return new t(0,lE.min())}}]),t}();function uE(e,t){var n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=XT.fromTimestamp(1e9===r?new JT(n+1,0):new JT(n,r));return new lE(i,nE.empty(),t)}function cE(e){return new lE(e.readTime,e.key,-1)}var lE=function(){"use strict";function t(n,r,i){e(l)(this,t),this.readTime=n,this.documentKey=r,this.largestBatchId=i}return e(h)(t,null,[{key:"min",value:function(){return new t(XT.min(),nE.empty(),-1)}},{key:"max",value:function(){return new t(XT.max(),nE.empty(),-1)}}]),t}();function hE(e,t){var n=e.readTime.compareTo(t.readTime);return 0!==n?n:0!==(n=nE.comparator(e.documentKey,t.documentKey))?n:HT(e.largestBatchId,t.largestBatchId)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var fE="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",dE=function(){"use strict";function t(){e(l)(this,t),this.onCommittedListeners=[]}return e(h)(t,[{key:"addOnCommittedListener",value:function(e){this.onCommittedListeners.push(e)}},{key:"raiseOnCommittedEvent",value:function(){this.onCommittedListeners.forEach((function(e){return e()}))}}]),t}();function pE(e){return vE.apply(this,arguments)}function vE(){return(vE=
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(_).mark((function t(n){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.code===OT.FAILED_PRECONDITION&&n.message===fE){e.next=2;break}throw n;case 2:ST("LocalStore","Unexpectedly lost primary lease");case 3:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var yE=function(){"use strict";function t(n){var r=this;e(l)(this,t),this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,n((function(e){r.isDone=!0,r.result=e,r.nextCallback&&r.nextCallback(e)}),(function(e){r.isDone=!0,r.error=e,r.catchCallback&&r.catchCallback(e)}))}return e(h)(t,[{key:"catch",value:function(e){return this.next(void 0,e)}},{key:"next",value:function(e,n){var r=this;return this.callbackAttached&&RT(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((function(t,i){var a=r;r.nextCallback=function(n){a.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){a.wrapFailure(n,e).next(t,i)}}))}},{key:"toPromise",value:function(){var e=this;return new Promise((function(t,n){e.next(t,n)}))}},{key:"wrapUserFunction",value:function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}}},{key:"wrapSuccess",value:function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.resolve(n)}},{key:"wrapFailure",value:function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.reject(n)}}],[{key:"resolve",value:function(e){return new t((function(t,n){t(e)}))}},{key:"reject",value:function(e){return new t((function(t,n){n(e)}))}},{key:"waitFor",value:function(e){return new t((function(t,n){var r=0,i=0,a=!1;e.forEach((function(e){++r,e.next((function(){++i,a&&i===r&&t()}),(function(e){return n(e)}))})),a=!0,i===r&&t()}))}},{key:"or",value:function(e){var n=t.resolve(!1),r=!0,i=!1,a=void 0;try{for(var o,s=function(e,r){var i=r.value;n=n.next((function(e){return e?t.resolve(e):i()}))},u=e[Symbol.iterator]();!(r=(o=u.next()).done);r=!0)s(0,o)}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return n}},{key:"forEach",value:function(e,t){var n=this,r=[];return e.forEach((function(e,i){r.push(t.call(n,e,i))})),this.waitFor(r)}},{key:"mapArray",value:function(e,n){return new t((function(t,r){for(var i=function(i){var u=i;n(e[u]).next((function(e){o[u]=e,++s===a&&t(o)}),(function(e){return r(e)}))},a=e.length,o=new Array(a),s=0,u=0;u<a;u++)i(u)}))}},{key:"doWhile",value:function(e,n){return new t((function(t,r){var i=function(){!0===e()?n().next((function(){i()}),r):t()};i()}))}}]),t}(),mE=function(){"use strict";function t(n,r){var i=this;e(l)(this,t),this.action=n,this.transaction=r,this.aborted=!1,this.P=new LT,this.transaction.oncomplete=function(){i.P.resolve()},this.transaction.onabort=function(){r.error?i.P.reject(new _E(n,r.error)):i.P.resolve()},this.transaction.onerror=function(e){var t=TE(e.target.error);i.P.reject(new _E(n,t))}}return e(h)(t,[{key:"v",get:function(){return this.P.promise}},{key:"abort",value:function(e){e&&this.P.reject(e),this.aborted||(ST("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}},{key:"V",value:function(){var e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}},{key:"store",value:function(e){var t=this.transaction.objectStore(e);return new bE(t)}}],[{key:"open",value:function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new _E(n,e)}}}]),t}(),gE=function(){"use strict";function t(n,r,i){e(l)(this,t),this.name=n,this.version=r,this.S=i,12.2===t.D(ye())&&CT("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return e(h)(t,[{key:"F",value:function(t){var n=this;return e(u)(e(_).mark((function r(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n.db,e.t0){e.next=6;break}return ST("SimpleDb","Opening database:",n.name),e.next=5,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){r(new _E(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new MT(OT.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===n.name?r(new MT(OT.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+n)):r(new _E(t,n))},i.onupgradeneeded=function(e){ST("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',e.oldVersion);var t=e.target.result;n.S.$(t,i.transaction,e.oldVersion,n.version).next((function(){ST("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}));case 5:n.db=e.sent;case 6:return n.B&&(n.db.onversionchange=function(e){return n.B(e)}),e.abrupt("return",(e.t0,n.db));case 8:case"end":return e.stop()}}),r)})))()}},{key:"L",value:function(e){this.B=e,this.db&&(this.db.onversionchange=function(t){return e(t)})}},{key:"runTransaction",value:function(t,n,r,i){var a=this;return e(u)(e(_).mark((function o(){var s,u,c,l,h,f;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s="readonly"===n,u=0;case 2:return++u,e.prev=3,e.next=6,a.F(t);case 6:return a.db=e.sent,c=mE.open(a.db,t,s?"readonly":"readwrite",r),(l=i(c).next((function(e){return c.V(),e})).catch((function(e){return c.abort(e),yE.reject(e)})).toPromise()).catch((function(){})),e.next=11,c.v;case 11:return e.abrupt("return",(e.sent,l));case 14:if(e.prev=14,e.t0=e.catch(3),h=e.t0,f="FirebaseError"!==h.name&&u<3,ST("SimpleDb","Transaction failed with error:",h.message,"Retrying:",f),a.close(),f){e.next=19;break}return e.abrupt("return",Promise.reject(h));case 19:e.next=2;break;case 21:case"end":return e.stop()}}),o,null,[[3,14]])})))()}},{key:"close",value:function(){this.db&&this.db.close(),this.db=void 0}}],[{key:"delete",value:function(e){return ST("SimpleDb","Removing database:",e),xE(window.indexedDB.deleteDatabase(e)).toPromise()}},{key:"C",value:function(){if(!xe())return!1;if(t.N())return!0;var e=ye(),n=t.D(e),r=0<n&&n<10,i=t.k(e),a=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||a)}},{key:"N",value:function(){var e;return void 0!==z&&"YES"===(void 0===(e={})?void 0:e.O)}},{key:"M",value:function(e,t){return e.store(t)}},{key:"D",value:function(e){var t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}},{key:"k",value:function(e){var t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}}]),t}(),kE=function(){"use strict";function t(n){e(l)(this,t),this.q=n,this.U=!1,this.K=null}return e(h)(t,[{key:"isDone",get:function(){return this.U}},{key:"G",get:function(){return this.K}},{key:"cursor",set:function(e){this.q=e}},{key:"done",value:function(){this.U=!0}},{key:"j",value:function(e){this.K=e}},{key:"delete",value:function(){return xE(this.q.delete())}}]),t}(),_E=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i){var a;return e(l)(this,r),(a=n.call(this,OT.UNAVAILABLE,"IndexedDB transaction '".concat(t,"' failed: ").concat(i))).name="IndexedDbTransactionError",e(gw)(a)}return r}(MT);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wE(e){return"IndexedDbTransactionError"===e.name}var bE=function(){"use strict";function t(n){e(l)(this,t),this.store=n}return e(h)(t,[{key:"put",value:function(e,t){var n;return void 0!==t?(ST("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(ST("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),xE(n)}},{key:"add",value:function(e){return ST("SimpleDb","ADD",this.store.name,e,e),xE(this.store.add(e))}},{key:"get",value:function(e){var t=this;return xE(this.store.get(e)).next((function(n){return void 0===n&&(n=null),ST("SimpleDb","GET",t.store.name,e,n),n}))}},{key:"delete",value:function(e){return ST("SimpleDb","DELETE",this.store.name,e),xE(this.store.delete(e))}},{key:"count",value:function(){return ST("SimpleDb","COUNT",this.store.name),xE(this.store.count())}},{key:"W",value:function(e,t){var n=this.options(e,t);if(n.index||"function"!=typeof this.store.getAll){var r=this.cursor(n),i=[];return this.H(r,(function(e,t){i.push(t)})).next((function(){return i}))}var a=this.store.getAll(n.range);return new yE((function(e,t){a.onerror=function(e){t(e.target.error)},a.onsuccess=function(t){e(t.target.result)}}))}},{key:"J",value:function(e,t){var n=this.store.getAll(e,null===t?void 0:t);return new yE((function(e,t){n.onerror=function(e){t(e.target.error)},n.onsuccess=function(t){e(t.target.result)}}))}},{key:"Y",value:function(e,t){ST("SimpleDb","DELETE ALL",this.store.name);var n=this.options(e,t);n.X=!1;var r=this.cursor(n);return this.H(r,(function(e,t,n){return n.delete()}))}},{key:"Z",value:function(e,t){var n;t?n=e:(n={},t=e);var r=this.cursor(n);return this.H(r,t)}},{key:"tt",value:function(e){var t=this.cursor({});return new yE((function(n,r){t.onerror=function(e){var t=TE(e.target.error);r(t)},t.onsuccess=function(t){var r=t.target.result;r?e(r.primaryKey,r.value).next((function(e){e?r.continue():n()})):n()}}))}},{key:"H",value:function(e,t){var n=[];return new yE((function(r,i){e.onerror=function(e){i(e.target.error)},e.onsuccess=function(e){var i=e.target.result;if(i){var a=new kE(i),o=t(i.primaryKey,i.value,a);if(o instanceof yE){var s=o.catch((function(e){return a.done(),yE.reject(e)}));n.push(s)}a.isDone?r():null===a.G?i.continue():i.continue(a.G)}else r()}})).next((function(){return yE.waitFor(n)}))}},{key:"options",value:function(e,t){var n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}},{key:"cursor",value:function(e){var t="next";if(e.reverse&&(t="prev"),e.index){var n=this.store.index(e.index);return e.X?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}]),t}();function xE(e){return new yE((function(t,n){e.onsuccess=function(e){var n=e.target.result;t(n)},e.onerror=function(e){var t=TE(e.target.error);n(t)}}))}var IE=!1;function TE(e){var t=gE.D(ye());if(t>=12.2&&t<13){var n="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(n)>=0){var r=new MT("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '".concat(n,"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround."));return IE||(IE=!0,setTimeout((function(){throw r}),0)),r}}return e}var EE=function(){"use strict";function t(n,r){e(l)(this,t),this.asyncQueue=n,this.et=r,this.task=null}return e(h)(t,[{key:"start",value:function(){this.nt(15e3)}},{key:"stop",value:function(){this.task&&(this.task.cancel(),this.task=null)}},{key:"started",get:function(){return null!==this.task}},{key:"nt",value:function(t){var n=this;ST("IndexBackiller","Scheduled in ".concat(t,"ms")),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",t,e(u)(e(_).mark((function t(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.task=null,e.prev=1,e.t0=ST,e.t1="Documents written: ",e.next=6,n.et.st();case 6:e.t2=e.sent,e.t3=e.t1.concat.call(e.t1,e.t2),(0,e.t0)("IndexBackiller",e.t3),e.next=19;break;case 11:if(e.prev=11,e.t4=e.catch(1),!wE(e.t4)){e.next=17;break}ST("IndexBackiller","Ignoring IndexedDB error during index backfill: ",e.t4),e.next=19;break;case 17:return e.next=19,pE(e.t4);case 19:return e.next=21,n.nt(6e4);case 21:case"end":return e.stop()}}),t,null,[[1,11]])}))))}}]),t}(),SE=function(){"use strict";function t(n,r){e(l)(this,t),this.localStore=n,this.persistence=r}return e(h)(t,[{key:"st",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,n=this;return e(u)(e(_).mark((function r(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.persistence.runTransaction("Backfill Indexes","readwrite-primary",(function(e){return n.it(e,t)})));case 1:case"end":return e.stop()}}),r)})))()}},{key:"it",value:function(e,t){var n=this,r=new Set,i=t,a=!0;return yE.doWhile((function(){return!0===a&&i>0}),(function(){return n.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((function(t){if(null!==t&&!r.has(t))return ST("IndexBackiller","Processing collection: ".concat(t)),n.rt(e,t,i).next((function(e){i-=e,r.add(t)}));a=!1}))})).next((function(){return t-i}))}},{key:"rt",value:function(e,t,n){var r=this;return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((function(i){return r.localStore.localDocuments.getNextDocuments(e,t,i,n).next((function(n){var a=r,o=n.changes;return r.localStore.indexManager.updateIndexEntries(e,o).next((function(){return a.ot(i,n)})).next((function(n){return ST("IndexBackiller","Updating offset: ".concat(n)),a.localStore.indexManager.updateCollectionGroup(e,t,n)})).next((function(){return o.size}))}))}))}},{key:"ot",value:function(e,t){var n=e;return t.changes.forEach((function(e,t){var r=cE(t);hE(r,n)>0&&(n=r)})),new lE(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}]),t}(),CE=function(){"use strict";function t(n,r){var i=this;e(l)(this,t),this.previousValue=n,r&&(r.sequenceNumberHandler=function(e){return i.ut(e)},this.ct=function(e){return r.writeSequenceNumber(e)})}return e(h)(t,[{key:"ut",value:function(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}},{key:"next",value:function(){var e=++this.previousValue;return this.ct&&this.ct(e),e}}]),t}();CE.at=-1;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var AE=function t(n,r,i,a,o,s,u,c){"use strict";e(l)(this,t),this.databaseId=n,this.appId=r,this.persistenceKey=i,this.host=a,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=u,this.useFetchStreams=c},NE=function(){"use strict";function t(n,r){e(l)(this,t),this.projectId=n,this.database=r||"(default)"}return e(h)(t,[{key:"isDefaultDatabase",get:function(){return"(default)"===this.database}},{key:"isEqual",value:function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database}}],[{key:"empty",value:function(){return new t("","")}}]),t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function RE(e){var t=0;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function DE(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function PE(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OE(e){return null==e}function ME(e){return 0===e&&1/e==-1/0}function LE(e){return"number"==typeof e&&Number.isInteger(e)&&!ME(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var FE=Symbol.iterator,UE=function(){"use strict";function t(n){e(l)(this,t),this.binaryString=n}return e(h)(t,[{key:FE,value:function(){var e=this,t=0;return{next:function(){return t<e.binaryString.length?{value:e.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}}},{key:"toBase64",value:function(){var e;return e=this.binaryString,btoa(e)}},{key:"toUint8Array",value:function(){return function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}},{key:"approximateByteSize",value:function(){return 2*this.binaryString.length}},{key:"compareTo",value:function(e){return HT(this.binaryString,e.binaryString)}},{key:"isEqual",value:function(e){return this.binaryString===e.binaryString}}],[{key:"fromBase64String",value:function(e){return new t(atob(e))}},{key:"fromUint8Array",value:function(e){return new t(function(e){for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e))}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */UE.EMPTY_BYTE_STRING=new UE("");var qE=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function VE(e){if(DT(!!e),"string"==typeof e){var t=0,n=qE.exec(e);if(DT(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),t=Number(r)}var i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:jE(e.seconds),nanos:jE(e.nanos)}}function jE(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function BE(e){return"string"==typeof e?UE.fromBase64String(e):UE.fromUint8Array(e)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KE(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function zE(e){var t=e.mapValue.fields.__previous_value__;return KE(t)?zE(t):t}function WE(e){var t=VE(e.mapValue.fields.__local_write_time__.timestampValue);return new JT(t.seconds,t.nanos)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var GE={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},HE={nullValue:"NULL_VALUE"};function QE(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?KE(e)?4:uS(e)?9007199254740991:10:RT()}function YE(e,t){if(e===t)return!0;var n,r=QE(e);if(r!==QE(t))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return WE(e).isEqual(WE(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;var n=VE(e.timestampValue),r=VE(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return n=t,BE(e.bytesValue).isEqual(BE(n.bytesValue));case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return jE(e.geoPointValue.latitude)===jE(t.geoPointValue.latitude)&&jE(e.geoPointValue.longitude)===jE(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return jE(e.integerValue)===jE(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){var n=jE(e.doubleValue),r=jE(t.doubleValue);return n===r?ME(n)===ME(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return QT(e.arrayValue.values||[],t.arrayValue.values||[],YE);case 10:return function(e,t){var n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(RE(n)!==RE(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!YE(n[i],r[i])))return!1;return!0}(e,t);default:return RT()}}function JE(e,t){return void 0!==(e.values||[]).find((function(e){return YE(e,t)}))}function XE(e,t){if(e===t)return 0;var n,r,i,a,o=QE(e),s=QE(t);if(o!==s)return HT(o,s);switch(o){case 0:case 9007199254740991:return 0;case 1:return HT(e.booleanValue,t.booleanValue);case 2:return r=t,i=jE((n=e).integerValue||n.doubleValue),a=jE(r.integerValue||r.doubleValue),i<a?-1:i>a?1:i===a?0:isNaN(i)?isNaN(a)?0:-1:1;case 3:return $E(e.timestampValue,t.timestampValue);case 4:return $E(WE(e),WE(t));case 5:return HT(e.stringValue,t.stringValue);case 6:return function(e,t){var n=BE(e),r=BE(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){for(var n=e.split("/"),r=t.split("/"),i=0;i<n.length&&i<r.length;i++){var a=HT(n[i],r[i]);if(0!==a)return a}return HT(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){var n=HT(jE(e.latitude),jE(t.latitude));return 0!==n?n:HT(jE(e.longitude),jE(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){for(var n=e.values||[],r=t.values||[],i=0;i<n.length&&i<r.length;++i){var a=XE(n[i],r[i]);if(a)return a}return HT(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===GE.mapValue&&t===GE.mapValue)return 0;if(e===GE.mapValue)return 1;if(t===GE.mapValue)return-1;var n=e.fields||{},r=Object.keys(n),i=t.fields||{},a=Object.keys(i);r.sort(),a.sort();for(var o=0;o<r.length&&o<a.length;++o){var s=HT(r[o],a[o]);if(0!==s)return s;var u=XE(n[r[o]],i[a[o]]);if(0!==u)return u}return HT(r.length,a.length)}(e.mapValue,t.mapValue);default:throw RT()}}function $E(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return HT(e,t);var n=VE(e),r=VE(t),i=HT(n.seconds,r.seconds);return 0!==i?i:HT(n.nanos,r.nanos)}function ZE(e){return eS(e)}function eS(e){var t,n,r,i;return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?(r=e.timestampValue,i=VE(r),"time(".concat(i.seconds,",").concat(i.nanos,")")):"stringValue"in e?e.stringValue:"bytesValue"in e?BE(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,nE.fromName(n).toString()):"geoPointValue"in e?"geo(".concat((t=e.geoPointValue).latitude,",").concat(t.longitude,")"):"arrayValue"in e?function(e){var t="[",n=!0,r=!0,i=!1,a=void 0;try{for(var o,s=(e.values||[])[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;n?n=!1:t+=",",t+=eS(u)}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return t+"]"}(e.arrayValue):"mapValue"in e?function(e){var t=Object.keys(e.fields||{}).sort(),n="{",r=!0,i=!0,a=!1,o=void 0;try{for(var s,u=t[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value;r?r=!1:n+=",",n+="".concat(c,":").concat(eS(e.fields[c]))}}catch(e){a=!0,o=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw o}}return n+"}"}(e.mapValue):RT()}function tS(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function nS(e){return!!e&&"integerValue"in e}function rS(e){return!!e&&"arrayValue"in e}function iS(e){return!!e&&"nullValue"in e}function aS(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function oS(e){return!!e&&"mapValue"in e}function sS(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){var t={mapValue:{fields:{}}};return DE(e.mapValue.fields,(function(e,n){return t.mapValue.fields[e]=sS(n)})),t}if(e.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(e.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=sS(e.arrayValue.values[r]);return n}return Object.assign({},e)}function uS(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}function cS(e){return"nullValue"in e?HE:"booleanValue"in e?{booleanValue:!1}:"integerValue"in e||"doubleValue"in e?{doubleValue:NaN}:"timestampValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in e?{stringValue:""}:"bytesValue"in e?{bytesValue:""}:"referenceValue"in e?tS(NE.empty(),nE.empty()):"geoPointValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in e?{arrayValue:{}}:"mapValue"in e?{mapValue:{}}:RT()}function lS(e){return"nullValue"in e?{booleanValue:!1}:"booleanValue"in e?{doubleValue:NaN}:"integerValue"in e||"doubleValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in e?{stringValue:""}:"stringValue"in e?{bytesValue:""}:"bytesValue"in e?tS(NE.empty(),nE.empty()):"referenceValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in e?{arrayValue:{}}:"arrayValue"in e?{mapValue:{}}:"mapValue"in e?GE:RT()}function hS(e,t){var n=XE(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function fS(e,t){var n=XE(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var dS=function t(n,r){"use strict";e(l)(this,t),this.position=n,this.inclusive=r};function pS(e,t,n){for(var r=0,i=0;i<e.position.length;i++){var a=t[i],o=e.position[i];if(r=a.field.isKeyField()?nE.comparator(nE.fromName(o.referenceValue),n.key):XE(o,n.data.field(a.field)),"desc"===a.dir&&(r*=-1),0!==r)break}return r}function vS(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(var n=0;n<e.position.length;n++)if(!YE(e.position[n],t.position[n]))return!1;return!0}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var yS=function t(){"use strict";e(l)(this,t)},mS=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i,a){var o;return e(l)(this,r),(o=n.call(this)).field=t,o.op=i,o.value=a,e(gw)(o)}return e(h)(r,[{key:"matches",value:function(e){var t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(XE(t,this.value)):null!==t&&QE(this.value)===QE(t)&&this.matchesComparison(XE(t,this.value))}},{key:"matchesComparison",value:function(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return RT()}}},{key:"isInequality",value:function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}},{key:"getFlattenedFilters",value:function(){return[this]}},{key:"getFilters",value:function(){return[this]}},{key:"getFirstInequalityField",value:function(){return this.isInequality()?this.field:null}}],[{key:"create",value:function(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new SS(e,t,n):"array-contains"===t?new RS(e,n):"in"===t?new DS(e,n):"not-in"===t?new PS(e,n):"array-contains-any"===t?new OS(e,n):new r(e,t,n)}},{key:"createKeyFieldInFilter",value:function(e,t,n){return"in"===t?new CS(e,n):new AS(e,n)}}]),r}(yS),gS=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i){var a;return e(l)(this,r),(a=n.call(this)).filters=t,a.op=i,a.ht=null,e(gw)(a)}return e(h)(r,[{key:"matches",value:function(e){return kS(this)?void 0===this.filters.find((function(t){return!t.matches(e)})):void 0!==this.filters.find((function(t){return t.matches(e)}))}},{key:"getFlattenedFilters",value:function(){return null!==this.ht||(this.ht=this.filters.reduce((function(e,t){return e.concat(t.getFlattenedFilters())}),[])),this.ht}},{key:"getFilters",value:function(){return Object.assign([],this.filters)}},{key:"getFirstInequalityField",value:function(){var e=this.lt((function(e){return e.isInequality()}));return null!==e?e.field:null}},{key:"lt",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=this.getFlattenedFilters()[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;if(e(o))return o}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return null}}],[{key:"create",value:function(e,t){return new r(e,t)}}]),r}(yS);function kS(e){return"and"===e.op}function _S(e){return"or"===e.op}function wS(e){return bS(e)&&kS(e)}function bS(e){var t=!0,n=!1,r=void 0;try{for(var i,a=e.filters[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){if(i.value instanceof gS)return!1}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return!0}function xS(e){if(e instanceof mS)return e.field.canonicalString()+e.op.toString()+ZE(e.value);var t=e.filters.map((function(e){return xS(e)})).join(",");return"".concat(e.op,"(").concat(t,")")}function IS(e,t){return e instanceof mS?(n=e,(r=t)instanceof mS&&n.op===r.op&&n.field.isEqual(r.field)&&YE(n.value,r.value)):e instanceof gS?function(e,t){return t instanceof gS&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((function(e,n,r){return e&&IS(n,t.filters[r])}),!0)}(e,t):void RT();var n,r}function TS(e,t){var n=e.filters.concat(t);return gS.create(n,e.op)}function ES(e){return e instanceof mS?"".concat((t=e).field.canonicalString()," ").concat(t.op," ").concat(ZE(t.value)):e instanceof gS?function(e){return e.op.toString()+" {"+e.getFilters().map(ES).join(" ,")+"}"}(e):"Filter";var t}var SS=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i,a){var o;return e(l)(this,r),(o=n.call(this,t,i,a)).key=nE.fromName(a.referenceValue),e(gw)(o)}return e(h)(r,[{key:"matches",value:function(e){var t=nE.comparator(e.key,this.key);return this.matchesComparison(t)}}]),r}(mS),CS=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i){var a;return e(l)(this,r),(a=n.call(this,t,"in",i)).keys=NS("in",i),e(gw)(a)}return e(h)(r,[{key:"matches",value:function(e){return this.keys.some((function(t){return t.isEqual(e.key)}))}}]),r}(mS),AS=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i){var a;return e(l)(this,r),(a=n.call(this,t,"not-in",i)).keys=NS("not-in",i),e(gw)(a)}return e(h)(r,[{key:"matches",value:function(e){return!this.keys.some((function(t){return t.isEqual(e.key)}))}}]),r}(mS);function NS(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(e){return nE.fromName(e.referenceValue)}))}var RS=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i){return e(l)(this,r),n.call(this,t,"array-contains",i)}return e(h)(r,[{key:"matches",value:function(e){var t=e.data.field(this.field);return rS(t)&&JE(t.arrayValue,this.value)}}]),r}(mS),DS=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i){return e(l)(this,r),n.call(this,t,"in",i)}return e(h)(r,[{key:"matches",value:function(e){var t=e.data.field(this.field);return null!==t&&JE(this.value.arrayValue,t)}}]),r}(mS),PS=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i){return e(l)(this,r),n.call(this,t,"not-in",i)}return e(h)(r,[{key:"matches",value:function(e){if(JE(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var t=e.data.field(this.field);return null!==t&&!JE(this.value.arrayValue,t)}}]),r}(mS),OS=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i){return e(l)(this,r),n.call(this,t,"array-contains-any",i)}return e(h)(r,[{key:"matches",value:function(e){var t=this,n=e.data.field(this.field);return!(!rS(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(e){return JE(t.value.arrayValue,e)}))}}]),r}(mS),MS=function t(n){"use strict";var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";e(l)(this,t),this.field=n,this.dir=r};function LS(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var FS=function(){"use strict";function t(n,r){e(l)(this,t),this.comparator=n,this.root=r||qS.EMPTY}return e(h)(t,[{key:"insert",value:function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,qS.BLACK,null,null))}},{key:"remove",value:function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,qS.BLACK,null,null))}},{key:"get",value:function(e){for(var t=this.root;!t.isEmpty();){var n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}},{key:"indexOf",value:function(e){for(var t=0,n=this.root;!n.isEmpty();){var r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}},{key:"isEmpty",value:function(){return this.root.isEmpty()}},{key:"size",get:function(){return this.root.size}},{key:"minKey",value:function(){return this.root.minKey()}},{key:"maxKey",value:function(){return this.root.maxKey()}},{key:"inorderTraversal",value:function(e){return this.root.inorderTraversal(e)}},{key:"forEach",value:function(e){this.inorderTraversal((function(t,n){return e(t,n),!1}))}},{key:"toString",value:function(){var e=[];return this.inorderTraversal((function(t,n){return e.push("".concat(t,":").concat(n)),!1})),"{".concat(e.join(", "),"}")}},{key:"reverseTraversal",value:function(e){return this.root.reverseTraversal(e)}},{key:"getIterator",value:function(){return new US(this.root,null,this.comparator,!1)}},{key:"getIteratorFrom",value:function(e){return new US(this.root,e,this.comparator,!1)}},{key:"getReverseIterator",value:function(){return new US(this.root,null,this.comparator,!0)}},{key:"getReverseIteratorFrom",value:function(e){return new US(this.root,e,this.comparator,!0)}}]),t}(),US=function(){"use strict";function t(n,r,i,a){e(l)(this,t),this.isReverse=a,this.nodeStack=[];for(var o=1;!n.isEmpty();)if(o=r?i(n.key,r):1,r&&a&&(o*=-1),o<0)n=this.isReverse?n.left:n.right;else{if(0===o){this.nodeStack.push(n);break}this.nodeStack.push(n),n=this.isReverse?n.right:n.left}}return e(h)(t,[{key:"getNext",value:function(){var e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}},{key:"hasNext",value:function(){return this.nodeStack.length>0}},{key:"peek",value:function(){if(0===this.nodeStack.length)return null;var e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}]),t}(),qS=function(){"use strict";function t(n,r,i,a,o){e(l)(this,t),this.key=n,this.value=r,this.color=null!=i?i:t.RED,this.left=null!=a?a:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return e(h)(t,[{key:"copy",value:function(e,n,r,i,a){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=a?a:this.right)}},{key:"isEmpty",value:function(){return!1}},{key:"inorderTraversal",value:function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}},{key:"min",value:function(){return this.left.isEmpty()?this:this.left.min()}},{key:"minKey",value:function(){return this.min().key}},{key:"maxKey",value:function(){return this.right.isEmpty()?this.key:this.right.maxKey()}},{key:"insert",value:function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp()}},{key:"removeMin",value:function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()}},{key:"remove",value:function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}},{key:"isRed",value:function(){return this.color}},{key:"fixUp",value:function(){var e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}},{key:"moveRedLeft",value:function(){var e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e}},{key:"moveRedRight",value:function(){var e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e}},{key:"rotateLeft",value:function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}},{key:"rotateRight",value:function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}},{key:"colorFlip",value:function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}},{key:"checkMaxDepth",value:function(){var e=this.check();return Math.pow(2,e)<=this.size+1}},{key:"check",value:function(){if(this.isRed()&&this.left.isRed())throw RT();if(this.right.isRed())throw RT();var e=this.left.check();if(e!==this.right.check())throw RT();return e+(this.isRed()?0:1)}}]),t}();qS.EMPTY=null,qS.RED=!0,qS.BLACK=!1,qS.EMPTY=new(function(){"use strict";function t(){e(l)(this,t),this.size=0}return e(h)(t,[{key:"key",get:function(){throw RT()}},{key:"value",get:function(){throw RT()}},{key:"color",get:function(){throw RT()}},{key:"left",get:function(){throw RT()}},{key:"right",get:function(){throw RT()}},{key:"copy",value:function(e,t,n,r,i){return this}},{key:"insert",value:function(e,t,n){return new qS(e,t)}},{key:"remove",value:function(e,t){return this}},{key:"isEmpty",value:function(){return!0}},{key:"inorderTraversal",value:function(e){return!1}},{key:"reverseTraversal",value:function(e){return!1}},{key:"minKey",value:function(){return null}},{key:"maxKey",value:function(){return null}},{key:"isRed",value:function(){return!1}},{key:"checkMaxDepth",value:function(){return!0}},{key:"check",value:function(){return 0}}]),t}());
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var VS=function(){"use strict";function t(n){e(l)(this,t),this.comparator=n,this.data=new FS(this.comparator)}return e(h)(t,[{key:"has",value:function(e){return null!==this.data.get(e)}},{key:"first",value:function(){return this.data.minKey()}},{key:"last",value:function(){return this.data.maxKey()}},{key:"size",get:function(){return this.data.size}},{key:"indexOf",value:function(e){return this.data.indexOf(e)}},{key:"forEach",value:function(e){this.data.inorderTraversal((function(t,n){return e(t),!1}))}},{key:"forEachInRange",value:function(e,t){for(var n=this.data.getIteratorFrom(e[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}},{key:"forEachWhile",value:function(e,t){var n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}},{key:"firstAfterOrEqual",value:function(e){var t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}},{key:"getIterator",value:function(){return new jS(this.data.getIterator())}},{key:"getIteratorFrom",value:function(e){return new jS(this.data.getIteratorFrom(e))}},{key:"add",value:function(e){return this.copy(this.data.remove(e).insert(e,!0))}},{key:"delete",value:function(e){return this.has(e)?this.copy(this.data.remove(e)):this}},{key:"isEmpty",value:function(){return this.data.isEmpty()}},{key:"unionWith",value:function(e){var t=this;return t.size<e.size&&(t=e,e=this),e.forEach((function(e){t=t.add(e)})),t}},{key:"isEqual",value:function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(0!==this.comparator(i,a))return!1}return!0}},{key:"toArray",value:function(){var e=[];return this.forEach((function(t){e.push(t)})),e}},{key:"toString",value:function(){var e=[];return this.forEach((function(t){return e.push(t)})),"SortedSet("+e.toString()+")"}},{key:"copy",value:function(e){var n=new t(this.comparator);return n.data=e,n}}]),t}(),jS=function(){"use strict";function t(n){e(l)(this,t),this.iter=n}return e(h)(t,[{key:"getNext",value:function(){return this.iter.getNext().key}},{key:"hasNext",value:function(){return this.iter.hasNext()}}]),t}();function BS(e){return e.hasNext()?e.getNext():void 0}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var KS=function(){"use strict";function t(n){e(l)(this,t),this.fields=n,n.sort(tE.comparator)}return e(h)(t,[{key:"unionWith",value:function(e){var n=new VS(tE.comparator),r=!0,i=!1,a=void 0;try{for(var o,s=this.fields[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;n=n.add(u)}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}var c=!0,l=!1,h=void 0;try{for(var f,d=e[Symbol.iterator]();!(c=(f=d.next()).done);c=!0){var p=f.value;n=n.add(p)}}catch(e){l=!0,h=e}finally{try{c||null==d.return||d.return()}finally{if(l)throw h}}return new t(n.toArray())}},{key:"covers",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=this.fields[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){if(i.value.isPrefixOf(e))return!0}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return!1}},{key:"isEqual",value:function(e){return QT(this.fields,e.fields,(function(e,t){return e.isEqual(t)}))}}],[{key:"empty",value:function(){return new t([])}}]),t}(),zS=function(){"use strict";function t(n){e(l)(this,t),this.value=n}return e(h)(t,[{key:"field",value:function(e){if(e.isEmpty())return this.value;for(var t=this.value,n=0;n<e.length-1;++n)if(!oS(t=(t.mapValue.fields||{})[e.get(n)]))return null;return(t=(t.mapValue.fields||{})[e.lastSegment()])||null}},{key:"set",value:function(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=sS(t)}},{key:"setAll",value:function(e){var t=this,n=tE.emptyPath(),r={},i=[];e.forEach((function(e,a){if(!n.isImmediateParentOf(a)){var o=t.getFieldsMap(n);t.applyChanges(o,r,i),r={},i=[],n=a.popLast()}e?r[a.lastSegment()]=sS(e):i.push(a.lastSegment())}));var a=this.getFieldsMap(n);this.applyChanges(a,r,i)}},{key:"delete",value:function(e){var t=this.field(e.popLast());oS(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}},{key:"isEqual",value:function(e){return YE(this.value,e.value)}},{key:"getFieldsMap",value:function(e){var t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(var n=0;n<e.length;++n){var r=t.mapValue.fields[e.get(n)];oS(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}},{key:"applyChanges",value:function(e,t,n){DE(t,(function(t,n){return e[t]=n}));var r=!0,i=!1,a=void 0;try{for(var o,s=n[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;delete e[u]}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}}},{key:"clone",value:function(){return new t(sS(this.value))}}],[{key:"empty",value:function(){return new t({mapValue:{}})}}]),t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WS(e){var t=[];return DE(e.fields,(function(e,n){var r=new tE([e]);if(oS(n)){var i=WS(n.mapValue).fields,a=!0,o=!1,s=void 0;if(0===i.length)t.push(r);else try{for(var u,c=i[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var l=u.value;t.push(r.child(l))}}catch(e){o=!0,s=e}finally{try{a||null==c.return||c.return()}finally{if(o)throw s}}}else t.push(r)})),new KS(t)
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}var GS=function(){"use strict";function t(n,r,i,a,o,s,u){e(l)(this,t),this.key=n,this.documentType=r,this.version=i,this.readTime=a,this.createTime=o,this.data=s,this.documentState=u}return e(h)(t,[{key:"convertToFoundDocument",value:function(e,t){return!this.createTime.isEqual(XT.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}},{key:"convertToNoDocument",value:function(e){return this.version=e,this.documentType=2,this.data=zS.empty(),this.documentState=0,this}},{key:"convertToUnknownDocument",value:function(e){return this.version=e,this.documentType=3,this.data=zS.empty(),this.documentState=2,this}},{key:"setHasCommittedMutations",value:function(){return this.documentState=2,this}},{key:"setHasLocalMutations",value:function(){return this.documentState=1,this.version=XT.min(),this}},{key:"setReadTime",value:function(e){return this.readTime=e,this}},{key:"hasLocalMutations",get:function(){return 1===this.documentState}},{key:"hasCommittedMutations",get:function(){return 2===this.documentState}},{key:"hasPendingWrites",get:function(){return this.hasLocalMutations||this.hasCommittedMutations}},{key:"isValidDocument",value:function(){return 0!==this.documentType}},{key:"isFoundDocument",value:function(){return 1===this.documentType}},{key:"isNoDocument",value:function(){return 2===this.documentType}},{key:"isUnknownDocument",value:function(){return 3===this.documentType}},{key:"isEqual",value:function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}},{key:"mutableCopy",value:function(){return new t(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}},{key:"toString",value:function(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}],[{key:"newInvalidDocument",value:function(e){return new t(e,0,XT.min(),XT.min(),XT.min(),zS.empty(),0)}},{key:"newFoundDocument",value:function(e,n,r,i){return new t(e,1,n,XT.min(),r,i,0)}},{key:"newNoDocument",value:function(e,n){return new t(e,2,n,XT.min(),XT.min(),zS.empty(),0)}},{key:"newUnknownDocument",value:function(e,n){return new t(e,3,n,XT.min(),XT.min(),zS.empty(),2)}}]),t}(),HS=function t(n){"use strict";var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;e(l)(this,t),this.path=n,this.collectionGroup=r,this.orderBy=i,this.filters=a,this.limit=o,this.startAt=s,this.endAt=u,this.ft=null};
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QS(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;return new HS(e,t,n,r,i,a,o)}function YS(e){var t=PT(e);if(null===t.ft){var n=t.path.canonicalString();null!==t.collectionGroup&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map((function(e){return xS(e)})).join(","),n+="|ob:",n+=t.orderBy.map((function(e){return(t=e).field.canonicalString()+t.dir;var t})).join(","),OE(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map((function(e){return ZE(e)})).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map((function(e){return ZE(e)})).join(",")),t.ft=n}return t.ft}function JS(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(var n=0;n<e.orderBy.length;n++)if(!LS(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(var r=0;r<e.filters.length;r++)if(!IS(e.filters[r],t.filters[r]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!vS(e.startAt,t.startAt)&&vS(e.endAt,t.endAt)}function XS(e){return nE.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function $S(e,t){return e.filters.filter((function(e){return e instanceof mS&&e.field.isEqual(t)}))}function ZS(e,t,n){var r=HE,i=!0,a=!0,o=!1,s=void 0;try{for(var u,c=$S(e,t)[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var l=u.value,h=HE,f=!0;switch(l.op){case"<":case"<=":h=cS(l.value);break;case"==":case"in":case">=":h=l.value;break;case">":h=l.value,f=!1;break;case"!=":case"not-in":h=HE}hS({value:r,inclusive:i},{value:h,inclusive:f})<0&&(r=h,i=f)}}catch(e){o=!0,s=e}finally{try{a||null==c.return||c.return()}finally{if(o)throw s}}if(null!==n)for(var d=0;d<e.orderBy.length;++d)if(e.orderBy[d].field.isEqual(t)){var p=n.position[d];hS({value:r,inclusive:i},{value:p,inclusive:n.inclusive})<0&&(r=p,i=n.inclusive);break}return{value:r,inclusive:i}}function eC(e,t,n){var r=GE,i=!0,a=!0,o=!1,s=void 0;try{for(var u,c=$S(e,t)[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var l=u.value,h=GE,f=!0;switch(l.op){case">=":case">":h=lS(l.value),f=!1;break;case"==":case"in":case"<=":h=l.value;break;case"<":h=l.value,f=!1;break;case"!=":case"not-in":h=GE}fS({value:r,inclusive:i},{value:h,inclusive:f})>0&&(r=h,i=f)}}catch(e){o=!0,s=e}finally{try{a||null==c.return||c.return()}finally{if(o)throw s}}if(null!==n)for(var d=0;d<e.orderBy.length;++d)if(e.orderBy[d].field.isEqual(t)){var p=n.position[d];fS({value:r,inclusive:i},{value:p,inclusive:n.inclusive})>0&&(r=p,i=n.inclusive);break}return{value:r,inclusive:i}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var tC=function t(n){"use strict";var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;e(l)(this,t),this.path=n,this.collectionGroup=r,this.explicitOrderBy=i,this.filters=a,this.limit=o,this.limitType=s,this.startAt=u,this.endAt=c,this.dt=null,this._t=null,this.startAt,this.endAt};function nC(e,t,n,r,i,a,o,s){return new tC(e,t,n,r,i,a,o,s)}function rC(e){return new tC(e)}function iC(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function aC(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function oC(e){var t=!0,n=!1,r=void 0;try{for(var i,a=e.filters[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value.getFirstInequalityField();if(null!==o)return o}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return null}function sC(e){return null!==e.collectionGroup}function uC(e){var t=PT(e);if(null===t.dt){t.dt=[];var n=oC(t),r=aC(t);if(null!==n&&null===r)n.isKeyField()||t.dt.push(new MS(n)),t.dt.push(new MS(tE.keyField(),"asc"));else{var i=!1,a=!0,o=!1,s=void 0;try{for(var u,c=t.explicitOrderBy[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var l=u.value;t.dt.push(l),l.field.isKeyField()&&(i=!0)}}catch(e){o=!0,s=e}finally{try{a||null==c.return||c.return()}finally{if(o)throw s}}if(!i){var h=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.dt.push(new MS(tE.keyField(),h))}}}return t.dt}function cC(e){var t=PT(e);if(!t._t)if("F"===t.limitType)t._t=QS(t.path,t.collectionGroup,uC(t),t.filters,t.limit,t.startAt,t.endAt);else{var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=uC(t)[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value,c="desc"===u.dir?"asc":"desc";n.push(new MS(u.field,c))}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}var l=t.endAt?new dS(t.endAt.position,t.endAt.inclusive):null,h=t.startAt?new dS(t.startAt.position,t.startAt.inclusive):null;t._t=QS(t.path,t.collectionGroup,n,t.filters,t.limit,l,h)}return t._t}function lC(e,t){t.getFirstInequalityField(),oC(e);var n=e.filters.concat([t]);return new tC(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function hC(e,t,n){return new tC(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function fC(e,t){return JS(cC(e),cC(t))&&e.limitType===t.limitType}function dC(e){return"".concat(YS(cC(e)),"|lt:").concat(e.limitType)}function pC(e){return"Query(target=".concat((t=cC(e),n=t.path.canonicalString(),null!==t.collectionGroup&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=", filters: [".concat(t.filters.map((function(e){return ES(e)})).join(", "),"]")),OE(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=", orderBy: [".concat(t.orderBy.map((function(e){return"".concat((t=e).field.canonicalString()," (").concat(t.dir,")");var t})).join(", "),"]")),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map((function(e){return ZE(e)})).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map((function(e){return ZE(e)})).join(",")),"Target(".concat(n,")")),"; limitType=").concat(e.limitType,")");var t,n}function vC(e,t){return t.isFoundDocument()&&(i=e,o=(a=t).key.path,null!==i.collectionGroup?a.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(o):nE.isDocumentKey(i.path)?i.path.isEqual(o):i.path.isImmediateParentOf(o))&&function(e,t){var n=!0,r=!1,i=void 0;try{for(var a,o=uC(e)[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;if(!s.field.isKeyField()&&null===t.data.field(s.field))return!1}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return!0}(e,t)&&function(e,t){var n=!0,r=!1,i=void 0;try{for(var a,o=e.filters[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){if(!a.value.matches(t))return!1}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return!0}(e,t)&&(r=t,!((n=e).startAt&&!function(e,t,n){var r=pS(e,t,n);return e.inclusive?r<=0:r<0}(n.startAt,uC(n),r)||n.endAt&&!function(e,t,n){var r=pS(e,t,n);return e.inclusive?r>=0:r>0}(n.endAt,uC(n),r)));var n,r,i,a,o}function yC(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function mC(e){return function(t,n){var r=!1,i=!0,a=!1,o=void 0;try{for(var s,u=uC(e)[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value,l=gC(c,t,n);if(0!==l)return l;r=r||c.field.isKeyField()}}catch(e){a=!0,o=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw o}}return 0}}function gC(e,t,n){var r=e.field.isKeyField()?nE.comparator(t.key,n.key):function(e,t,n){var r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?XE(r,i):RT()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return RT()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kC(e,t){if(e.wt){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ME(t)?"-0":t}}function _C(e){return{integerValue:""+e}}function wC(e,t){return LE(t)?_C(t):kC(e,t)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var bC=function t(){"use strict";e(l)(this,t),this._=void 0};function xC(e,t,n){return e instanceof EC?(i=t,a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:(r=n).seconds,nanos:r.nanoseconds}}}},i&&(a.fields.__previous_value__=i),{mapValue:a}):e instanceof SC?CC(e,t):e instanceof AC?NC(e,t):function(e,t){var n=TC(e,t),r=DC(n)+DC(e.gt);return nS(n)&&nS(e.gt)?_C(r):kC(e.yt,r)}(e,t);var r,i,a}function IC(e,t,n){return e instanceof SC?CC(e,t):e instanceof AC?NC(e,t):n}function TC(e,t){var n,r;return e instanceof RC?nS(n=t)||(r=n)&&"doubleValue"in r?t:{integerValue:0}:null}var EC=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(){return e(l)(this,r),n.apply(this,arguments)}return r}(bC),SC=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t){var i;return e(l)(this,r),(i=n.call(this)).elements=t,e(gw)(i)}return r}(bC);function CC(e,t){var n=PC(t),r=!0,i=!1,a=void 0;try{for(var o,s=function(e,t){var r=t.value;n.some((function(e){return YE(e,r)}))||n.push(r)},u=e.elements[Symbol.iterator]();!(r=(o=u.next()).done);r=!0)s(0,o)}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return{arrayValue:{values:n}}}var AC=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t){var i;return e(l)(this,r),(i=n.call(this)).elements=t,e(gw)(i)}return r}(bC);function NC(e,t){var n=PC(t),r=!0,i=!1,a=void 0;try{for(var o,s=function(e,t){var r=t.value;n=n.filter((function(e){return!YE(e,r)}))},u=e.elements[Symbol.iterator]();!(r=(o=u.next()).done);r=!0)s(0,o)}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return{arrayValue:{values:n}}}var RC=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i){var a;return e(l)(this,r),(a=n.call(this)).yt=t,a.gt=i,e(gw)(a)}return r}(bC);function DC(e){return jE(e.integerValue||e.doubleValue)}function PC(e){return rS(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var OC=function t(n,r){"use strict";e(l)(this,t),this.field=n,this.transform=r};var MC=function t(n,r){"use strict";e(l)(this,t),this.version=n,this.transformResults=r},LC=function(){"use strict";function t(n,r){e(l)(this,t),this.updateTime=n,this.exists=r}return e(h)(t,[{key:"isNone",get:function(){return void 0===this.updateTime&&void 0===this.exists}},{key:"isEqual",value:function(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}],[{key:"none",value:function(){return new t}},{key:"exists",value:function(e){return new t(void 0,e)}},{key:"updateTime",value:function(e){return new t(e)}}]),t}();function FC(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}var UC=function t(){"use strict";e(l)(this,t)};function qC(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new XC(e.key,LC.none()):new zC(e.key,e.data,LC.none());var n=e.data,r=zS.empty(),i=new VS(tE.comparator),a=!0,o=!1,s=void 0;try{for(var u,c=t.fields[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var l=u.value;if(!i.has(l)){var h=n.field(l);null===h&&l.length>1&&(l=l.popLast(),h=n.field(l)),null===h?r.delete(l):r.set(l,h),i=i.add(l)}}}catch(e){o=!0,s=e}finally{try{a||null==c.return||c.return()}finally{if(o)throw s}}return new WC(e.key,r,new KS(i.toArray()),LC.none())}function VC(e,t,n){var r;e instanceof zC?function(e,t,n){var r=e.value.clone(),i=HC(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof WC?function(e,t,n){if(FC(e.precondition,t)){var r=HC(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(GC(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else t.convertToUnknownDocument(n.version)}(e,t,n):(r=n,t.convertToNoDocument(r.version).setHasCommittedMutations())}function jC(e,t,n,r){return e instanceof zC?function(e,t,n,r){if(!FC(e.precondition,t))return n;var i=e.value.clone(),a=QC(e.fieldTransforms,r,t);return i.setAll(a),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof WC?function(e,t,n,r){if(!FC(e.precondition,t))return n;var i=QC(e.fieldTransforms,r,t),a=t.data;return a.setAll(GC(e)),a.setAll(i),t.convertToFoundDocument(t.version,a).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((function(e){return e.field})))}(e,t,n,r):(i=t,a=n,FC(e.precondition,i)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):a);var i,a}function BC(e,t){var n=null,r=!0,i=!1,a=void 0;try{for(var o,s=e.fieldTransforms[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value,c=t.data.field(u.field),l=TC(u.transform,c||null);null!=l&&(null===n&&(n=zS.empty()),n.set(u.field,l))}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n||null}function KC(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&(n=e.fieldTransforms,r=t.fieldTransforms,!!(void 0===n&&void 0===r||n&&r&&QT(n,r,(function(e,t){return function(e,t){return e.field.isEqual(t.field)&&(n=e.transform,r=t.transform,n instanceof SC&&r instanceof SC||n instanceof AC&&r instanceof AC?QT(n.elements,r.elements,YE):n instanceof RC&&r instanceof RC?YE(n.gt,r.gt):n instanceof EC&&r instanceof EC);var n,r}(e,t)}))))&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask));var n,r}var zC=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i,a){var o,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return e(l)(this,r),(o=n.call(this)).key=t,o.value=i,o.precondition=a,o.fieldTransforms=s,o.type=0,e(gw)(o)}return e(h)(r,[{key:"getFieldMask",value:function(){return null}}]),r}(UC),WC=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i,a,o){var s,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return e(l)(this,r),(s=n.call(this)).key=t,s.data=i,s.fieldMask=a,s.precondition=o,s.fieldTransforms=u,s.type=1,e(gw)(s)}return e(h)(r,[{key:"getFieldMask",value:function(){return this.fieldMask}}]),r}(UC);function GC(e){var t=new Map;return e.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=e.data.field(n);t.set(n,r)}})),t}function HC(e,t,n){var r=new Map;DT(e.length===n.length);for(var i=0;i<n.length;i++){var a=e[i],o=a.transform,s=t.data.field(a.field);r.set(a.field,IC(o,s,n[i]))}return r}function QC(e,t,n){var r=new Map,i=!0,a=!1,o=void 0;try{for(var s,u=e[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value,l=c.transform,h=n.data.field(c.field);r.set(c.field,xC(l,h,t))}}catch(e){a=!0,o=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw o}}return r}var YC,JC,XC=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i){var a;return e(l)(this,r),(a=n.call(this)).key=t,a.precondition=i,a.type=2,a.fieldTransforms=[],e(gw)(a)}return e(h)(r,[{key:"getFieldMask",value:function(){return null}}]),r}(UC),$C=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i){var a;return e(l)(this,r),(a=n.call(this)).key=t,a.precondition=i,a.type=3,a.fieldTransforms=[],e(gw)(a)}return e(h)(r,[{key:"getFieldMask",value:function(){return null}}]),r}(UC),ZC=function t(n){"use strict";e(l)(this,t),this.count=n};function eA(e){switch(e){default:return RT();case OT.CANCELLED:case OT.UNKNOWN:case OT.DEADLINE_EXCEEDED:case OT.RESOURCE_EXHAUSTED:case OT.INTERNAL:case OT.UNAVAILABLE:case OT.UNAUTHENTICATED:return!1;case OT.INVALID_ARGUMENT:case OT.NOT_FOUND:case OT.ALREADY_EXISTS:case OT.PERMISSION_DENIED:case OT.FAILED_PRECONDITION:case OT.ABORTED:case OT.OUT_OF_RANGE:case OT.UNIMPLEMENTED:case OT.DATA_LOSS:return!0}}function tA(e){if(void 0===e)return CT("GRPC error has no .code"),OT.UNKNOWN;switch(e){case YC.OK:return OT.OK;case YC.CANCELLED:return OT.CANCELLED;case YC.UNKNOWN:return OT.UNKNOWN;case YC.DEADLINE_EXCEEDED:return OT.DEADLINE_EXCEEDED;case YC.RESOURCE_EXHAUSTED:return OT.RESOURCE_EXHAUSTED;case YC.INTERNAL:return OT.INTERNAL;case YC.UNAVAILABLE:return OT.UNAVAILABLE;case YC.UNAUTHENTICATED:return OT.UNAUTHENTICATED;case YC.INVALID_ARGUMENT:return OT.INVALID_ARGUMENT;case YC.NOT_FOUND:return OT.NOT_FOUND;case YC.ALREADY_EXISTS:return OT.ALREADY_EXISTS;case YC.PERMISSION_DENIED:return OT.PERMISSION_DENIED;case YC.FAILED_PRECONDITION:return OT.FAILED_PRECONDITION;case YC.ABORTED:return OT.ABORTED;case YC.OUT_OF_RANGE:return OT.OUT_OF_RANGE;case YC.UNIMPLEMENTED:return OT.UNIMPLEMENTED;case YC.DATA_LOSS:return OT.DATA_LOSS;default:return RT()}}(JC=YC||(YC={}))[JC.OK=0]="OK",JC[JC.CANCELLED=1]="CANCELLED",JC[JC.UNKNOWN=2]="UNKNOWN",JC[JC.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",JC[JC.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",JC[JC.NOT_FOUND=5]="NOT_FOUND",JC[JC.ALREADY_EXISTS=6]="ALREADY_EXISTS",JC[JC.PERMISSION_DENIED=7]="PERMISSION_DENIED",JC[JC.UNAUTHENTICATED=16]="UNAUTHENTICATED",JC[JC.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",JC[JC.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",JC[JC.ABORTED=10]="ABORTED",JC[JC.OUT_OF_RANGE=11]="OUT_OF_RANGE",JC[JC.UNIMPLEMENTED=12]="UNIMPLEMENTED",JC[JC.INTERNAL=13]="INTERNAL",JC[JC.UNAVAILABLE=14]="UNAVAILABLE",JC[JC.DATA_LOSS=15]="DATA_LOSS";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var nA=function(){"use strict";function t(n,r){e(l)(this,t),this.mapKeyFn=n,this.equalsFn=r,this.inner={},this.innerSize=0}return e(h)(t,[{key:"get",value:function(t){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){var i=!0,a=!1,o=void 0;try{for(var s,u=r[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=e(b)(s.value,2),l=c[0],h=c[1];if(this.equalsFn(l,t))return h}}catch(e){a=!0,o=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw o}}}}},{key:"has",value:function(e){return void 0!==this.get(e)}},{key:"set",value:function(e,t){var n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}},{key:"delete",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}},{key:"forEach",value:function(t){DE(this.inner,(function(n,r){var i=!0,a=!1,o=void 0;try{for(var s,u=r[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=e(b)(s.value,2),l=c[0],h=c[1];t(l,h)}}catch(e){a=!0,o=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw o}}}))}},{key:"isEmpty",value:function(){return PE(this.inner)}},{key:"size",value:function(){return this.innerSize}}]),t}(),rA=new FS(nE.comparator);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iA(){return rA}var aA=new FS(nE.comparator);function oA(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=aA,i=!0,a=!1,o=void 0;try{for(var s,u=t[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value;r=r.insert(c.key,c)}}catch(e){a=!0,o=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw o}}return r}function sA(e){var t=aA;return e.forEach((function(e,n){return t=t.insert(e,n.overlayedDocument)})),t}function uA(){return lA()}function cA(){return lA()}function lA(){return new nA((function(e){return e.toString()}),(function(e,t){return e.isEqual(t)}))}var hA=new FS(nE.comparator),fA=new VS(nE.comparator);function dA(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=fA,i=!0,a=!1,o=void 0;try{for(var s,u=t[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value;r=r.add(c)}}catch(e){a=!0,o=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw o}}return r}var pA=new VS(HT);function vA(){return pA}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var yA=function(){"use strict";function t(n,r,i,a,o){e(l)(this,t),this.snapshotVersion=n,this.targetChanges=r,this.targetMismatches=i,this.documentUpdates=a,this.resolvedLimboDocuments=o}return e(h)(t,null,[{key:"createSynthesizedRemoteEventForCurrentChange",value:function(e,n,r){var i=new Map;return i.set(e,mA.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new t(XT.min(),i,vA(),iA(),dA())}}]),t}(),mA=function(){"use strict";function t(n,r,i,a,o){e(l)(this,t),this.resumeToken=n,this.current=r,this.addedDocuments=i,this.modifiedDocuments=a,this.removedDocuments=o}return e(h)(t,null,[{key:"createSynthesizedTargetChangeForCurrentChange",value:function(e,n,r){return new t(r,n,dA(),dA(),dA())}}]),t}(),gA=function t(n,r,i,a){"use strict";e(l)(this,t),this.It=n,this.removedTargetIds=r,this.key=i,this.Tt=a},kA=function t(n,r){"use strict";e(l)(this,t),this.targetId=n,this.Et=r},_A=function t(n,r){"use strict";var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:UE.EMPTY_BYTE_STRING,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e(l)(this,t),this.state=n,this.targetIds=r,this.resumeToken=i,this.cause=a},wA=function(){"use strict";function t(){e(l)(this,t),this.At=0,this.Rt=IA(),this.bt=UE.EMPTY_BYTE_STRING,this.Pt=!1,this.vt=!0}return e(h)(t,[{key:"current",get:function(){return this.Pt}},{key:"resumeToken",get:function(){return this.bt}},{key:"Vt",get:function(){return 0!==this.At}},{key:"St",get:function(){return this.vt}},{key:"Dt",value:function(e){e.approximateByteSize()>0&&(this.vt=!0,this.bt=e)}},{key:"Ct",value:function(){var e=dA(),t=dA(),n=dA();return this.Rt.forEach((function(r,i){switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:RT()}})),new mA(this.bt,this.Pt,e,t,n)}},{key:"xt",value:function(){this.vt=!1,this.Rt=IA()}},{key:"Nt",value:function(e,t){this.vt=!0,this.Rt=this.Rt.insert(e,t)}},{key:"kt",value:function(e){this.vt=!0,this.Rt=this.Rt.remove(e)}},{key:"Ot",value:function(){this.At+=1}},{key:"Mt",value:function(){this.At-=1}},{key:"Ft",value:function(){this.vt=!0,this.Pt=!0}}]),t}(),bA=function(){"use strict";function t(n){e(l)(this,t),this.$t=n,this.Bt=new Map,this.Lt=iA(),this.qt=xA(),this.Ut=new VS(HT)}return e(h)(t,[{key:"Kt",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=e.It[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;e.Tt&&e.Tt.isFoundDocument()?this.Gt(o,e.Tt):this.Qt(o,e.key,e.Tt)}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}var s=!0,u=!1,c=void 0;try{for(var l,h=e.removedTargetIds[Symbol.iterator]();!(s=(l=h.next()).done);s=!0){var f=l.value;this.Qt(f,e.key,e.Tt)}}catch(e){u=!0,c=e}finally{try{s||null==h.return||h.return()}finally{if(u)throw c}}}},{key:"jt",value:function(e){var t=this;this.forEachTarget(e,(function(n){var r=t.Wt(n);switch(e.state){case 0:t.zt(n)&&r.Dt(e.resumeToken);break;case 1:r.Mt(),r.Vt||r.xt(),r.Dt(e.resumeToken);break;case 2:r.Mt(),r.Vt||t.removeTarget(n);break;case 3:t.zt(n)&&(r.Ft(),r.Dt(e.resumeToken));break;case 4:t.zt(n)&&(t.Ht(n),r.Dt(e.resumeToken));break;default:RT()}}))}},{key:"forEachTarget",value:function(e,t){var n=this;e.targetIds.length>0?e.targetIds.forEach(t):this.Bt.forEach((function(e,r){n.zt(r)&&t(r)}))}},{key:"Jt",value:function(e){var t=e.targetId,n=e.Et.count,r=this.Yt(t);if(r){var i=r.target;if(XS(i))if(0===n){var a=new nE(i.path);this.Qt(t,a,GS.newNoDocument(a,XT.min()))}else DT(1===n);else this.Xt(t)!==n&&(this.Ht(t),this.Ut=this.Ut.add(t))}}},{key:"Zt",value:function(e){var t=this,n=new Map;this.Bt.forEach((function(r,i){var a=t.Yt(i);if(a){if(r.current&&XS(a.target)){var o=new nE(a.target.path);null!==t.Lt.get(o)||t.te(i,o)||t.Qt(i,o,GS.newNoDocument(o,e))}r.St&&(n.set(i,r.Ct()),r.xt())}}));var r=dA();this.qt.forEach((function(e,n){var i=t,a=!0;n.forEachWhile((function(e){var t=i.Yt(e);return!t||2===t.purpose||(a=!1,!1)})),a&&(r=r.add(e))})),this.Lt.forEach((function(t,n){return n.setReadTime(e)}));var i=new yA(e,n,this.Ut,this.Lt,r);return this.Lt=iA(),this.qt=xA(),this.Ut=new VS(HT),i}},{key:"Gt",value:function(e,t){if(this.zt(e)){var n=this.te(e,t.key)?2:0;this.Wt(e).Nt(t.key,n),this.Lt=this.Lt.insert(t.key,t),this.qt=this.qt.insert(t.key,this.ee(t.key).add(e))}}},{key:"Qt",value:function(e,t,n){if(this.zt(e)){var r=this.Wt(e);this.te(e,t)?r.Nt(t,1):r.kt(t),this.qt=this.qt.insert(t,this.ee(t).delete(e)),n&&(this.Lt=this.Lt.insert(t,n))}}},{key:"removeTarget",value:function(e){this.Bt.delete(e)}},{key:"Xt",value:function(e){var t=this.Wt(e).Ct();return this.$t.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}},{key:"Ot",value:function(e){this.Wt(e).Ot()}},{key:"Wt",value:function(e){var t=this.Bt.get(e);return t||(t=new wA,this.Bt.set(e,t)),t}},{key:"ee",value:function(e){var t=this.qt.get(e);return t||(t=new VS(HT),this.qt=this.qt.insert(e,t)),t}},{key:"zt",value:function(e){var t=null!==this.Yt(e);return t||ST("WatchChangeAggregator","Detected inactive target",e),t}},{key:"Yt",value:function(e){var t=this.Bt.get(e);return t&&t.Vt?null:this.$t.ne(e)}},{key:"Ht",value:function(e){var t=this;this.Bt.set(e,new wA),this.$t.getRemoteKeysForTarget(e).forEach((function(n){t.Qt(e,n,null)}))}},{key:"te",value:function(e,t){return this.$t.getRemoteKeysForTarget(e).has(t)}}]),t}();function xA(){return new FS(nE.comparator)}function IA(){return new FS(nE.comparator)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var TA={asc:"ASCENDING",desc:"DESCENDING"},EA={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},SA={and:"AND",or:"OR"},CA=function t(n,r){"use strict";e(l)(this,t),this.databaseId=n,this.wt=r};function AA(e,t){return e.wt?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function NA(e,t){return e.wt?t.toBase64():t.toUint8Array()}function RA(e,t){return AA(e,t.toTimestamp())}function DA(e){return DT(!!e),XT.fromTimestamp((t=VE(e),new JT(t.seconds,t.nanos)));var t}function PA(e,t){return(n=e,new ZT(["projects",n.projectId,"databases",n.database])).child("documents").child(t).canonicalString();var n}function OA(e){var t=ZT.fromString(e);return DT(eN(t)),t}function MA(e,t){return PA(e.databaseId,t.path)}function LA(e,t){var n=OA(t);if(n.get(1)!==e.databaseId.projectId)throw new MT(OT.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new MT(OT.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new nE(VA(n))}function FA(e,t){return PA(e.databaseId,t)}function UA(e){var t=OA(e);return 4===t.length?ZT.emptyPath():VA(t)}function qA(e){return new ZT(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function VA(e){return DT(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function jA(e,t,n){return{name:MA(e,t),fields:n.value.mapValue.fields}}function BA(e,t,n){var r=LA(e,t.name),i=DA(t.updateTime),a=t.createTime?DA(t.createTime):XT.min(),o=new zS({mapValue:{fields:t.fields}}),s=GS.newFoundDocument(r,i,a,o);return n&&s.setHasCommittedMutations(),n?s.setHasCommittedMutations():s}function KA(e,t){var n,r,i;if(t instanceof zC)n={update:jA(e,t.key,t.value)};else if(t instanceof XC)n={delete:MA(e,t.key)};else if(t instanceof WC)n={update:jA(e,t.key,t.data),updateMask:(r=t.fieldMask,i=[],r.fields.forEach((function(e){return i.push(e.canonicalString())})),{fieldPaths:i})};else{if(!(t instanceof $C))return RT();n={verify:MA(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((function(e){return function(e,t){var n=t.transform;if(n instanceof EC)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof SC)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof AC)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof RC)return{fieldPath:t.field.canonicalString(),increment:n.gt};throw RT()}(0,e)}))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:RA(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:RT()}(e,t.precondition)),n}function zA(e,t){var n,r,i,a=t.currentDocument?void 0!==(n=t.currentDocument).updateTime?LC.updateTime(DA(n.updateTime)):void 0!==n.exists?LC.exists(n.exists):LC.none():LC.none(),o=t.updateTransforms?t.updateTransforms.map((function(t){return function(e,t){var n=null;if("setToServerValue"in t)DT("REQUEST_TIME"===t.setToServerValue),n=new EC;else if("appendMissingElements"in t){var r=t.appendMissingElements.values||[];n=new SC(r)}else if("removeAllFromArray"in t){var i=t.removeAllFromArray.values||[];n=new AC(i)}else"increment"in t?n=new RC(e,t.increment):RT();var a=tE.fromServerFormat(t.fieldPath);return new OC(a,n)}(e,t)})):[];if(t.update){t.update.name;var s=LA(e,t.update.name),u=new zS({mapValue:{fields:t.update.fields}});if(t.updateMask){var c=(r=t.updateMask,i=r.fieldPaths||[],new KS(i.map((function(e){return tE.fromServerFormat(e)}))));return new WC(s,u,c,a,o)}return new zC(s,u,a,o)}if(t.delete){var l=LA(e,t.delete);return new XC(l,a)}if(t.verify){var h=LA(e,t.verify);return new $C(h,a)}return RT()}function WA(e,t){return{documents:[FA(e,t.path)]}}function GA(e,t){var n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=FA(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=FA(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(e){if(0!==e.length)return ZA(gS.create(e,"and"))}(t.filters);i&&(n.structuredQuery.where=i);var a=function(e){if(0!==e.length)return e.map((function(e){return{field:XA((t=e).field),direction:YA(t.dir)};var t}))}(t.orderBy);a&&(n.structuredQuery.orderBy=a);var o,s,u,c=(o=e,s=t.limit,o.wt||OE(s)?s:{value:s});return null!==c&&(n.structuredQuery.limit=c),t.startAt&&(n.structuredQuery.startAt={before:(u=t.startAt).inclusive,values:u.position}),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),n}function HA(e){var t=UA(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){DT(1===r);var a=n.from[0];a.allDescendants?i=a.collectionId:t=t.child(a.collectionId)}var o,s,u=[];n.where&&(o=n.where,u=(s=QA(o))instanceof gS&&wS(s)?s.getFilters():[s]);var c=[];n.orderBy&&(c=n.orderBy.map((function(e){return new MS($A((t=e).field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction));var t})));var l=null;n.limit&&(l=function(e){var t;return OE(t="object"==typeof e?e.value:e)?null:t}(n.limit));var h=null;n.startAt&&(h=function(e){var t=!!e.before,n=e.values||[];return new dS(n,t)}(n.startAt));var f=null;return n.endAt&&(f=function(e){var t=!e.before,n=e.values||[];return new dS(n,t)}(n.endAt)),nC(t,i,c,u,l,"F",h,f)}function QA(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":var t=$A(e.unaryFilter.field);return mS.create(t,"==",{doubleValue:NaN});case"IS_NULL":var n=$A(e.unaryFilter.field);return mS.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=$A(e.unaryFilter.field);return mS.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=$A(e.unaryFilter.field);return mS.create(i,"!=",{nullValue:"NULL_VALUE"});default:return RT()}}(e):void 0!==e.fieldFilter?(n=e,mS.create($A(n.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return RT()}}(n.fieldFilter.op),n.fieldFilter.value)):void 0!==e.compositeFilter?(t=e,gS.create(t.compositeFilter.filters.map((function(e){return QA(e)})),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return RT()}}(t.compositeFilter.op))):RT();var t,n}function YA(e){return TA[e]}function JA(e){return EA[e]}function XA(e){return{fieldPath:e.canonicalString()}}function $A(e){return tE.fromServerFormat(e.fieldPath)}function ZA(e){return e instanceof mS?function(e){if("=="===e.op){if(aS(e.value))return{unaryFilter:{field:XA(e.field),op:"IS_NAN"}};if(iS(e.value))return{unaryFilter:{field:XA(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(aS(e.value))return{unaryFilter:{field:XA(e.field),op:"IS_NOT_NAN"}};if(iS(e.value))return{unaryFilter:{field:XA(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:XA(e.field),op:JA(e.op),value:e.value}}}(e):e instanceof gS?(r=(t=e).getFilters().map((function(e){return ZA(e)})),1===r.length?r[0]:{compositeFilter:{op:(n=t.op,SA[n]),filters:r}}):RT();var t,n,r}function eN(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tN(e){for(var t="",n=0;n<e.length;n++)t.length>0&&(t=rN(t)),t=nN(e.get(n),t);return rN(t)}function nN(e,t){for(var n=t,r=e.length,i=0;i<r;i++){var a=e.charAt(i);switch(a){case"\0":n+="";break;case"":n+="";break;default:n+=a}}return n}function rN(e){return e+""}function iN(e){var t=e.length;if(DT(t>=2),2===t)return DT(""===e.charAt(0)&&""===e.charAt(1)),ZT.emptyPath();for(var n=t-2,r=[],i="",a=0;a<t;){var o=e.indexOf("",a);switch((o<0||o>n)&&RT(),e.charAt(o+1)){case"":var s=e.substring(a,o),u=void 0;0===i.length?u=s:(u=i+=s,i=""),r.push(u);break;case"":i+=e.substring(a,o),i+="\0";break;case"":i+=e.substring(a,o+1);break;default:RT()}a=o+2}return new ZT(r)}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var aN=["userId","batchId"];
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oN(e,t){return[e,tN(t)]}function sN(e,t,n){return[e,tN(t),n]}var uN={},cN=["prefixPath","collectionGroup","readTime","documentId"],lN=["prefixPath","collectionGroup","documentId"],hN=["collectionGroup","readTime","prefixPath","documentId"],fN=["canonicalId","targetId"],dN=["targetId","path"],pN=["path","targetId"],vN=["collectionId","parent"],yN=["indexId","uid"],mN=["uid","sequenceNumber"],gN=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],kN=["indexId","uid","orderedDocumentKey"],_N=["userId","collectionPath","documentId"],wN=["userId","collectionPath","largestBatchId"],bN=["userId","collectionGroup","largestBatchId"],xN=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],IN=e(p)(xN).concat(["documentOverlays"]),TN=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],EN=TN,SN=e(p)(EN).concat(["indexConfiguration","indexState","indexEntries"]),CN=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i){var a;return e(l)(this,r),(a=n.call(this)).se=t,a.currentSequenceNumber=i,e(gw)(a)}return r}(dE);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AN(e,t){var n=PT(e);return gE.M(n.se,t)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var NN=function(){"use strict";function t(n,r,i,a){e(l)(this,t),this.batchId=n,this.localWriteTime=r,this.baseMutations=i,this.mutations=a}return e(h)(t,[{key:"applyToRemoteDocument",value:function(e,t){for(var n=t.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(e.key)&&VC(i,e,n[r])}}},{key:"applyToLocalView",value:function(e,t){var n=!0,r=!1,i=void 0;try{for(var a,o=this.baseMutations[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;s.key.isEqual(e.key)&&(t=jC(s,e,t,this.localWriteTime))}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}var u=!0,c=!1,l=void 0;try{for(var h,f=this.mutations[Symbol.iterator]();!(u=(h=f.next()).done);u=!0){var d=h.value;d.key.isEqual(e.key)&&(t=jC(d,e,t,this.localWriteTime))}}catch(e){c=!0,l=e}finally{try{u||null==f.return||f.return()}finally{if(c)throw l}}return t}},{key:"applyToLocalDocumentSet",value:function(e,t){var n=this,r=cA();return this.mutations.forEach((function(i){var a=e.get(i.key),o=a.overlayedDocument,s=n.applyToLocalView(o,a.mutatedFields),u=qC(o,s=t.has(i.key)?null:s);null!==u&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(XT.min())})),r}},{key:"keys",value:function(){return this.mutations.reduce((function(e,t){return e.add(t.key)}),dA())}},{key:"isEqual",value:function(e){return this.batchId===e.batchId&&QT(this.mutations,e.mutations,(function(e,t){return KC(e,t)}))&&QT(this.baseMutations,e.baseMutations,(function(e,t){return KC(e,t)}))}}]),t}(),RN=function(){"use strict";function t(n,r,i,a){e(l)(this,t),this.batch=n,this.commitVersion=r,this.mutationResults=i,this.docVersions=a}return e(h)(t,null,[{key:"from",value:function(e,n,r){DT(e.mutations.length===r.length);for(var i=hA,a=e.mutations,o=0;o<a.length;o++)i=i.insert(a[o].key,r[o].version);return new t(e,n,r,i)}}]),t}(),DN=function(){"use strict";function t(n,r){e(l)(this,t),this.largestBatchId=n,this.mutation=r}return e(h)(t,[{key:"getKey",value:function(){return this.mutation.key}},{key:"isEqual",value:function(e){return null!==e&&this.mutation===e.mutation}},{key:"toString",value:function(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}]),t}(),PN=function(){"use strict";function t(n,r,i,a){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:XT.min(),s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:XT.min(),u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:UE.EMPTY_BYTE_STRING;e(l)(this,t),this.target=n,this.targetId=r,this.purpose=i,this.sequenceNumber=a,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=u}return e(h)(t,[{key:"withSequenceNumber",value:function(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}},{key:"withResumeToken",value:function(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)}},{key:"withLastLimboFreeSnapshotVersion",value:function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}]),t}(),ON=function t(n){"use strict";e(l)(this,t),this.ie=n};function MN(e,t){var n,r,i=t.key,a={prefixPath:i.getCollectionPath().popLast().toArray(),collectionGroup:i.collectionGroup,documentId:i.path.lastSegment(),readTime:LN(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())a.document={name:MA(n=e.ie,(r=t).key),fields:r.data.value.mapValue.fields,updateTime:AA(n,r.version.toTimestamp()),createTime:AA(n,r.createTime.toTimestamp())};else if(t.isNoDocument())a.noDocument={path:i.path.toArray(),readTime:FN(t.version)};else{if(!t.isUnknownDocument())return RT();a.unknownDocument={path:i.path.toArray(),version:FN(t.version)}}return a}function LN(e){var t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function FN(e){var t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function UN(e){var t=new JT(e.seconds,e.nanoseconds);return XT.fromTimestamp(t)}function qN(e,t){for(var n=(t.baseMutations||[]).map((function(t){return zA(e.ie,t)})),r=0;r<t.mutations.length-1;++r){var i=t.mutations[r];if(r+1<t.mutations.length&&void 0!==t.mutations[r+1].transform){var a=t.mutations[r+1];i.updateTransforms=a.transform.fieldTransforms,t.mutations.splice(r+1,1),++r}}var o=t.mutations.map((function(t){return zA(e.ie,t)})),s=JT.fromMillis(t.localWriteTimeMs);return new NN(t.batchId,s,n,o)}function VN(e){var t,n,r=UN(e.readTime),i=void 0!==e.lastLimboFreeSnapshotVersion?UN(e.lastLimboFreeSnapshotVersion):XT.min();return void 0!==e.query.documents?(DT(1===(n=e.query).documents.length),t=cC(rC(UA(n.documents[0])))):t=cC(HA(e.query)),new PN(t,e.targetId,0,e.lastListenSequenceNumber,r,i,UE.fromBase64String(e.resumeToken))}function jN(e,t){var n,r=FN(t.snapshotVersion),i=FN(t.lastLimboFreeSnapshotVersion);n=XS(t.target)?WA(e.ie,t.target):GA(e.ie,t.target);var a=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:YS(t.target),readTime:r,resumeToken:a,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:n}}function BN(e){var t=HA({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?hC(t,t.limit,"L"):t}function KN(e,t){return new DN(t.largestBatchId,zA(e.ie,t.overlayMutation))}function zN(e,t){var n=t.path.lastSegment();return[e,tN(t.path.popLast()),n]}function WN(e,t,n,r){return{indexId:e,uid:t.uid||"",sequenceNumber:n,readTime:FN(r.readTime),documentKey:tN(r.documentKey.path),largestBatchId:r.largestBatchId}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var GN=function(){"use strict";function t(){e(l)(this,t)}return e(h)(t,[{key:"getBundleMetadata",value:function(e,t){return HN(e).get(t).next((function(e){if(e)return{id:(t=e).bundleId,createTime:UN(t.createTime),version:t.version};var t}))}},{key:"saveBundleMetadata",value:function(e,t){var n;return HN(e).put({bundleId:(n=t).id,createTime:FN(DA(n.createTime)),version:n.version})}},{key:"getNamedQuery",value:function(e,t){return QN(e).get(t).next((function(e){if(e)return{name:(t=e).name,query:BN(t.bundledQuery),readTime:UN(t.readTime)};var t}))}},{key:"saveNamedQuery",value:function(e,t){return QN(e).put({name:(n=t).name,readTime:FN(DA(n.readTime)),bundledQuery:n.bundledQuery});var n}}]),t}();function HN(e){return AN(e,"bundles")}function QN(e){return AN(e,"namedQueries")}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var YN=function(){"use strict";function t(n,r){e(l)(this,t),this.yt=n,this.userId=r}return e(h)(t,[{key:"getOverlay",value:function(e,t){var n=this;return JN(e).get(zN(this.userId,t)).next((function(e){return e?KN(n.yt,e):null}))}},{key:"getOverlays",value:function(e,t){var n=this,r=uA();return yE.forEach(t,(function(t){return n.getOverlay(e,t).next((function(e){null!==e&&r.set(t,e)}))})).next((function(){return r}))}},{key:"saveOverlays",value:function(e,t,n){var r=this,i=[];return n.forEach((function(n,a){var o=new DN(t,a);i.push(r.oe(e,o))})),yE.waitFor(i)}},{key:"removeOverlaysForBatchId",value:function(e,t,n){var r=this,i=new Set;t.forEach((function(e){return i.add(tN(e.getCollectionPath()))}));var a=[];return i.forEach((function(t){var i=IDBKeyRange.bound([r.userId,t,n],[r.userId,t,n+1],!1,!0);a.push(JN(e).Y("collectionPathOverlayIndex",i))})),yE.waitFor(a)}},{key:"getOverlaysForCollection",value:function(e,t,n){var r=this,i=uA(),a=tN(t),o=IDBKeyRange.bound([this.userId,a,n],[this.userId,a,Number.POSITIVE_INFINITY],!0);return JN(e).W("collectionPathOverlayIndex",o).next((function(e){var t=!0,n=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(t=(o=s.next()).done);t=!0){var u=o.value,c=KN(r.yt,u);i.set(c.getKey(),c)}}catch(e){n=!0,a=e}finally{try{t||null==s.return||s.return()}finally{if(n)throw a}}return i}))}},{key:"getOverlaysForCollectionGroup",value:function(e,t,n,r){var i,a=this,o=uA(),s=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return JN(e).Z({index:"collectionGroupOverlayIndex",range:s},(function(e,t,n){var s=KN(a.yt,t);o.size()<r||s.largestBatchId===i?(o.set(s.getKey(),s),i=s.largestBatchId):n.done()})).next((function(){return o}))}},{key:"oe",value:function(t,n){return JN(t).put(function(t,n,r){var i=e(b)(zN(n,r.mutation.key),3);i[0];return{userId:n,collectionPath:i[1],documentId:i[2],collectionGroup:r.mutation.key.getCollectionGroup(),largestBatchId:r.largestBatchId,overlayMutation:KA(t.ie,r.mutation)}}(this.yt,this.userId,n))}}],[{key:"re",value:function(e,n){return new t(e,n.uid||"")}}]),t}();function JN(e){return AN(e,"documentOverlays")}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var XN=function(){"use strict";function t(){e(l)(this,t)}return e(h)(t,[{key:"ue",value:function(e,t){this.ce(e,t),t.ae()}},{key:"ce",value:function(e,t){if("nullValue"in e)this.he(t,5);else if("booleanValue"in e)this.he(t,10),t.le(e.booleanValue?1:0);else if("integerValue"in e)this.he(t,15),t.le(jE(e.integerValue));else if("doubleValue"in e){var n=jE(e.doubleValue);isNaN(n)?this.he(t,13):(this.he(t,15),ME(n)?t.le(0):t.le(n))}else if("timestampValue"in e){var r=e.timestampValue;this.he(t,20),"string"==typeof r?t.fe(r):(t.fe("".concat(r.seconds||"")),t.le(r.nanos||0))}else if("stringValue"in e)this.de(e.stringValue,t),this._e(t);else if("bytesValue"in e)this.he(t,30),t.we(BE(e.bytesValue)),this._e(t);else if("referenceValue"in e)this.me(e.referenceValue,t);else if("geoPointValue"in e){var i=e.geoPointValue;this.he(t,45),t.le(i.latitude||0),t.le(i.longitude||0)}else"mapValue"in e?uS(e)?this.he(t,Number.MAX_SAFE_INTEGER):(this.ge(e.mapValue,t),this._e(t)):"arrayValue"in e?(this.ye(e.arrayValue,t),this._e(t)):RT()}},{key:"de",value:function(e,t){this.he(t,25),this.pe(e,t)}},{key:"pe",value:function(e,t){t.fe(e)}},{key:"ge",value:function(e,t){var n=e.fields||{};this.he(t,55);var r=!0,i=!1,a=void 0;try{for(var o,s=Object.keys(n)[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;this.de(u,t),this.ce(n[u],t)}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}}},{key:"ye",value:function(e,t){var n=e.values||[];this.he(t,50);var r=!0,i=!1,a=void 0;try{for(var o,s=n[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;this.ce(u,t)}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}}},{key:"me",value:function(e,t){var n=this;this.he(t,37),nE.fromName(e).path.forEach((function(e){n.he(t,60),n.pe(e,t)}))}},{key:"he",value:function(e,t){e.le(t)}},{key:"_e",value:function(e){e.le(2)}}]),t}();function $N(e){if(0===e)return 8;var t=0;return e>>4==0&&(t+=4,e<<=4),e>>6==0&&(t+=2,e<<=2),e>>7==0&&(t+=1),t}function ZN(e){var t=64-function(e){for(var t=0,n=0;n<8;++n){var r=$N(255&e[n]);if(t+=r,8!==r)break}return t}(e);return Math.ceil(t/8)}XN.Ie=new XN;var eR=function(){"use strict";function t(){e(l)(this,t),this.buffer=new Uint8Array(1024),this.position=0}return e(h)(t,[{key:"Te",value:function(e){for(var t=e[Symbol.iterator](),n=t.next();!n.done;)this.Ee(n.value),n=t.next();this.Ae()}},{key:"Re",value:function(e){for(var t=e[Symbol.iterator](),n=t.next();!n.done;)this.be(n.value),n=t.next();this.Pe()}},{key:"ve",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value,s=o.charCodeAt(0);if(s<128)this.Ee(s);else if(s<2048)this.Ee(960|s>>>6),this.Ee(128|63&s);else if(o<"\ud800"||"\udbff"<o)this.Ee(480|s>>>12),this.Ee(128|63&s>>>6),this.Ee(128|63&s);else{var u=o.codePointAt(0);this.Ee(240|u>>>18),this.Ee(128|63&u>>>12),this.Ee(128|63&u>>>6),this.Ee(128|63&u)}}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}this.Ae()}},{key:"Ve",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value,s=o.charCodeAt(0);if(s<128)this.be(s);else if(s<2048)this.be(960|s>>>6),this.be(128|63&s);else if(o<"\ud800"||"\udbff"<o)this.be(480|s>>>12),this.be(128|63&s>>>6),this.be(128|63&s);else{var u=o.codePointAt(0);this.be(240|u>>>18),this.be(128|63&u>>>12),this.be(128|63&u>>>6),this.be(128|63&u)}}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}this.Pe()}},{key:"Se",value:function(e){var t=this.De(e),n=ZN(t);this.Ce(1+n),this.buffer[this.position++]=255&n;for(var r=t.length-n;r<t.length;++r)this.buffer[this.position++]=255&t[r]}},{key:"xe",value:function(e){var t=this.De(e),n=ZN(t);this.Ce(1+n),this.buffer[this.position++]=~(255&n);for(var r=t.length-n;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}},{key:"Ne",value:function(){this.ke(255),this.ke(255)}},{key:"Oe",value:function(){this.Me(255),this.Me(255)}},{key:"reset",value:function(){this.position=0}},{key:"seed",value:function(e){this.Ce(e.length),this.buffer.set(e,this.position),this.position+=e.length}},{key:"Fe",value:function(){return this.buffer.slice(0,this.position)}},{key:"De",value:function(e){var t,n,r=(t=e,(n=new DataView(new ArrayBuffer(8))).setFloat64(0,t,!1),new Uint8Array(n.buffer)),i=0!=(128&r[0]);r[0]^=i?255:128;for(var a=1;a<r.length;++a)r[a]^=i?255:0;return r}},{key:"Ee",value:function(e){var t=255&e;0===t?(this.ke(0),this.ke(255)):255===t?(this.ke(255),this.ke(0)):this.ke(t)}},{key:"be",value:function(e){var t=255&e;0===t?(this.Me(0),this.Me(255)):255===t?(this.Me(255),this.Me(0)):this.Me(e)}},{key:"Ae",value:function(){this.ke(0),this.ke(1)}},{key:"Pe",value:function(){this.Me(0),this.Me(1)}},{key:"ke",value:function(e){this.Ce(1),this.buffer[this.position++]=e}},{key:"Me",value:function(e){this.Ce(1),this.buffer[this.position++]=~e}},{key:"Ce",value:function(e){var t=e+this.position;if(!(t<=this.buffer.length)){var n=2*this.buffer.length;n<t&&(n=t);var r=new Uint8Array(n);r.set(this.buffer),this.buffer=r}}}]),t}(),tR=function(){"use strict";function t(n){e(l)(this,t),this.$e=n}return e(h)(t,[{key:"we",value:function(e){this.$e.Te(e)}},{key:"fe",value:function(e){this.$e.ve(e)}},{key:"le",value:function(e){this.$e.Se(e)}},{key:"ae",value:function(){this.$e.Ne()}}]),t}(),nR=function(){"use strict";function t(n){e(l)(this,t),this.$e=n}return e(h)(t,[{key:"we",value:function(e){this.$e.Re(e)}},{key:"fe",value:function(e){this.$e.Ve(e)}},{key:"le",value:function(e){this.$e.xe(e)}},{key:"ae",value:function(){this.$e.Oe()}}]),t}(),rR=function(){"use strict";function t(){e(l)(this,t),this.$e=new eR,this.Be=new tR(this.$e),this.Le=new nR(this.$e)}return e(h)(t,[{key:"seed",value:function(e){this.$e.seed(e)}},{key:"qe",value:function(e){return 0===e?this.Be:this.Le}},{key:"Fe",value:function(){return this.$e.Fe()}},{key:"reset",value:function(){this.$e.reset()}}]),t}(),iR=function(){"use strict";function t(n,r,i,a){e(l)(this,t),this.indexId=n,this.documentKey=r,this.arrayValue=i,this.directionalValue=a}return e(h)(t,[{key:"Ue",value:function(){var e=this.directionalValue.length,n=0===e||255===this.directionalValue[e-1]?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new t(this.indexId,this.documentKey,this.arrayValue,r)}}]),t}();function aR(e,t){var n=e.indexId-t.indexId;return 0!==n?n:0!==(n=oR(e.arrayValue,t.arrayValue))?n:0!==(n=oR(e.directionalValue,t.directionalValue))?n:nE.comparator(e.documentKey,t.documentKey)}function oR(e,t){for(var n=0;n<e.length&&n<t.length;++n){var r=e[n]-t[n];if(0!==r)return r}return e.length-t.length}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var sR=function(){"use strict";function t(n){e(l)(this,t),this.collectionId=null!=n.collectionGroup?n.collectionGroup:n.path.lastSegment(),this.Ke=n.orderBy,this.Ge=[];var r=!0,i=!1,a=void 0;try{for(var o,s=n.filters[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;u.isInequality()?this.Qe=u:this.Ge.push(u)}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}}return e(h)(t,[{key:"je",value:function(e){DT(e.collectionGroup===this.collectionId);var t=iE(e);if(void 0!==t&&!this.We(t))return!1;for(var n=aE(e),r=0,i=0;r<n.length&&this.We(n[r]);++r);if(r===n.length)return!0;if(void 0!==this.Qe){var a=n[r];if(!this.ze(this.Qe,a)||!this.He(this.Ke[i++],a))return!1;++r}for(;r<n.length;++r){var o=n[r];if(i>=this.Ke.length||!this.He(this.Ke[i++],o))return!1}return!0}},{key:"We",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=this.Ge[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;if(this.ze(o,e))return!0}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return!1}},{key:"ze",value:function(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;var n="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind===n}},{key:"He",value:function(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}]),t}();
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uR(e){var t,n;if(DT(e instanceof mS||e instanceof gS),e instanceof mS){if(e instanceof DS){var r=(null===(n=null===(t=e.value.arrayValue)||void 0===t?void 0:t.values)||void 0===n?void 0:n.map((function(t){return mS.create(e.field,"==",t)})))||[];return gS.create(r,"or")}return e}var i=e.filters.map((function(e){return uR(e)}));return gS.create(i,e.op)}function cR(e){if(0===e.getFilters().length)return[];var t=dR(uR(e));return DT(fR(t)),lR(t)||hR(t)?[t]:t.getFilters()}function lR(e){return e instanceof mS}function hR(e){return e instanceof gS&&wS(e)}function fR(e){return lR(e)||hR(e)||function(e){if(e instanceof gS&&_S(e)){var t=!0,n=!1,r=void 0;try{for(var i,a=e.getFilters()[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;if(!lR(o)&&!hR(o))return!1}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return!0}return!1}(e)}function dR(e){if(DT(e instanceof mS||e instanceof gS),e instanceof mS)return e;if(1===e.filters.length)return dR(e.filters[0]);var t=e.filters.map((function(e){return dR(e)})),n=gS.create(t,e.op);return fR(n=yR(n))?n:(DT(n instanceof gS),DT(kS(n)),DT(n.filters.length>1),n.filters.reduce((function(e,t){return pR(e,t)})))}function pR(e,t){var n,r;return DT(e instanceof mS||e instanceof gS),DT(t instanceof mS||t instanceof gS),yR(e instanceof mS?t instanceof mS?(n=e,r=t,gS.create([n,r],"and")):vR(e,t):t instanceof mS?vR(t,e):function(e,t){if(DT(e.filters.length>0&&t.filters.length>0),kS(e)&&kS(t))return TS(e,t.getFilters());var n=_S(e)?e:t,r=_S(e)?t:e,i=n.filters.map((function(e){return pR(e,r)}));return gS.create(i,"or")}(e,t))}function vR(e,t){if(kS(t))return TS(t,e.getFilters());var n=t.filters.map((function(t){return pR(e,t)}));return gS.create(n,"or")}function yR(t){if(DT(t instanceof mS||t instanceof gS),t instanceof mS)return t;var n=t.getFilters();if(1===n.length)return yR(n[0]);if(bS(t))return t;var r=n.map((function(e){return yR(e)})),i=[];return r.forEach((function(n){var r;n instanceof mS?i.push(n):n instanceof gS&&(n.op===t.op?(r=i).push.apply(r,e(p)(n.filters)):i.push(n))})),1===i.length?i[0]:gS.create(i,t.op)
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}var mR=function(){"use strict";function t(){e(l)(this,t),this.Je=new gR}return e(h)(t,[{key:"addToCollectionParentIndex",value:function(e,t){return this.Je.add(t),yE.resolve()}},{key:"getCollectionParents",value:function(e,t){return yE.resolve(this.Je.getEntries(t))}},{key:"addFieldIndex",value:function(e,t){return yE.resolve()}},{key:"deleteFieldIndex",value:function(e,t){return yE.resolve()}},{key:"getDocumentsMatchingTarget",value:function(e,t){return yE.resolve(null)}},{key:"getIndexType",value:function(e,t){return yE.resolve(0)}},{key:"getFieldIndexes",value:function(e,t){return yE.resolve([])}},{key:"getNextCollectionGroupToUpdate",value:function(e){return yE.resolve(null)}},{key:"getMinOffset",value:function(e,t){return yE.resolve(lE.min())}},{key:"getMinOffsetFromCollectionGroup",value:function(e,t){return yE.resolve(lE.min())}},{key:"updateCollectionGroup",value:function(e,t,n){return yE.resolve()}},{key:"updateIndexEntries",value:function(e,t){return yE.resolve()}}]),t}(),gR=function(){"use strict";function t(){e(l)(this,t),this.index={}}return e(h)(t,[{key:"add",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new VS(ZT.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}},{key:"has",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}},{key:"getEntries",value:function(e){return(this.index[e]||new VS(ZT.comparator)).toArray()}}]),t}(),kR=new Uint8Array(0),_R=function(){"use strict";function t(n,r){e(l)(this,t),this.user=n,this.databaseId=r,this.Ye=new gR,this.Xe=new nA((function(e){return YS(e)}),(function(e,t){return JS(e,t)})),this.uid=n.uid||""}return e(h)(t,[{key:"addToCollectionParentIndex",value:function(e,t){if(!this.Ye.has(t)){var n=this,r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((function(){n.Ye.add(t)}));var a={collectionId:r,parent:tN(i)};return wR(e).put(a)}return yE.resolve()}},{key:"getCollectionParents",value:function(e,t){var n=[],r=IDBKeyRange.bound([t,""],[YT(t),""],!1,!0);return wR(e).W(r).next((function(e){var r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;if(u.collectionId!==t)break;n.push(iN(u.parent))}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}))}},{key:"addFieldIndex",value:function(e,t){var n,r=xR(e),i={indexId:(n=t).indexId,collectionGroup:n.collectionGroup,fields:n.fields.map((function(e){return[e.fieldPath.canonicalString(),e.kind]}))};delete i.indexId;var a=r.add(i);if(t.indexState){var o=this,s=IR(e);return a.next((function(e){s.put(WN(e,o.user,t.indexState.sequenceNumber,t.indexState.offset))}))}return a.next()}},{key:"deleteFieldIndex",value:function(e,t){var n=xR(e),r=IR(e),i=bR(e);return n.delete(t.indexId).next((function(){return r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))})).next((function(){return i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))}))}},{key:"getDocumentsMatchingTarget",value:function(e,t){var n=this,r=bR(e),i=!0,a=new Map;return yE.forEach(this.Ze(t),(function(t){return n.tn(e,t).next((function(e){i&&(i=!!e),a.set(t,e)}))})).next((function(){if(i){var e=n,o=dA(),s=[];return yE.forEach(a,(function(n,i){var a;ST("IndexedDbIndexManager","Using index ".concat((a=n,"id=".concat(a.indexId,"|cg=").concat(a.collectionGroup,"|f=").concat(a.fields.map((function(e){return"".concat(e.fieldPath,":").concat(e.kind)})).join(",")))," to execute ").concat(YS(t)));var u=function(e,t){var n=iE(t);if(void 0===n)return null;var r=!0,i=!1,a=void 0;try{for(var o,s=$S(e,n.fieldPath)[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;switch(u.op){case"array-contains-any":return u.value.arrayValue.values||[];case"array-contains":return[u.value]}}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return null}(i,n),c=function(e,t){var n=new Map,r=!0,i=!1,a=void 0,o=!0,s=!1,u=void 0;try{for(var c,l=aE(t)[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var h=c.value;try{for(var f,d=$S(e,h.fieldPath)[Symbol.iterator]();!(r=(f=d.next()).done);r=!0){var p=f.value;switch(p.op){case"==":case"in":n.set(h.fieldPath.canonicalString(),p.value);break;case"not-in":case"!=":return n.set(h.fieldPath.canonicalString(),p.value),Array.from(n.values())}}}catch(e){i=!0,a=e}finally{try{r||null==d.return||d.return()}finally{if(i)throw a}}}}catch(e){s=!0,u=e}finally{try{o||null==l.return||l.return()}finally{if(s)throw u}}return null}(i,n),l=function(e,t){var n=[],r=!0,i=!0,a=!1,o=void 0;try{for(var s,u=aE(t)[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value,l=0===c.kind?ZS(e,c.fieldPath,e.startAt):eC(e,c.fieldPath,e.startAt);n.push(l.value),r&&(r=l.inclusive)}}catch(e){a=!0,o=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw o}}return new dS(n,r)}(i,n),h=function(e,t){var n=[],r=!0,i=!0,a=!1,o=void 0;try{for(var s,u=aE(t)[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value,l=0===c.kind?eC(e,c.fieldPath,e.endAt):ZS(e,c.fieldPath,e.endAt);n.push(l.value),r&&(r=l.inclusive)}}catch(e){a=!0,o=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw o}}return new dS(n,r)}(i,n),f=e.en(n,i,l),d=e.en(n,i,h),p=e.nn(n,i,c),v=e.sn(n.indexId,u,f,l.inclusive,d,h.inclusive,p);return yE.forEach(v,(function(e){return r.J(e,t.limit).next((function(e){e.forEach((function(e){var t=nE.fromSegments(e.documentKey);o.has(t)||(o=o.add(t),s.push(t))}))}))}))})).next((function(){return s}))}return yE.resolve(null)}))}},{key:"Ze",value:function(e){var t=this.Xe.get(e);return t||(t=0===e.filters.length?[e]:cR(gS.create(e.filters,"and")).map((function(t){return QS(e.path,e.collectionGroup,e.orderBy,t.getFilters(),e.limit,e.startAt,e.endAt)})),this.Xe.set(e,t),t)}},{key:"sn",value:function(t,n,r,i,a,o,s){for(var u=this,c=function(c){var l,d=u,v=n?u.rn(n[c/h]):kR,y=u.on(t,v,r[c%h],i),m=u.un(t,v,a[c%h],o),g=s.map((function(e){return d.on(t,v,e,!0)}));(l=f).push.apply(l,e(p)(u.createRange(y,m,g)))},l=(null!=n?n.length:1)*Math.max(r.length,a.length),h=l/(null!=n?n.length:1),f=[],d=0;d<l;++d)c(d);return f}},{key:"on",value:function(e,t,n,r){var i=new iR(e,nE.empty(),t,n);return r?i:i.Ue()}},{key:"un",value:function(e,t,n,r){var i=new iR(e,nE.empty(),t,n);return r?i.Ue():i}},{key:"tn",value:function(e,t){var n=new sR(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((function(e){var t=null,r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;n.je(u)&&(!t||u.fields.length>t.fields.length)&&(t=u)}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return t}))}},{key:"getIndexType",value:function(e,t){var n=this,r=2,i=this.Ze(t);return yE.forEach(i,(function(t){return n.tn(e,t).next((function(e){e?0!==r&&e.fields.length<function(e){var t=new VS(tE.comparator),n=!1,r=!0,i=!1,a=void 0,o=!0,s=!1,u=void 0;try{for(var c,l=e.filters[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var h=c.value;try{for(var f,d=h.getFlattenedFilters()[Symbol.iterator]();!(r=(f=d.next()).done);r=!0){var p=f.value;p.field.isKeyField()||("array-contains"===p.op||"array-contains-any"===p.op?n=!0:t=t.add(p.field))}}catch(e){i=!0,a=e}finally{try{r||null==d.return||d.return()}finally{if(i)throw a}}}}catch(e){s=!0,u=e}finally{try{o||null==l.return||l.return()}finally{if(s)throw u}}var v=!0,y=!1,m=void 0;try{for(var g,k=e.orderBy[Symbol.iterator]();!(v=(g=k.next()).done);v=!0){var _=g.value;_.field.isKeyField()||(t=t.add(_.field))}}catch(e){y=!0,m=e}finally{try{v||null==k.return||k.return()}finally{if(y)throw m}}return t.size+(n?1:0)}(t)&&(r=1):r=0}))})).next((function(){return null!==t.limit&&i.length>1&&2===r?1:r}))}},{key:"cn",value:function(e,t){var n=new rR,r=!0,i=!1,a=void 0;try{for(var o,s=aE(e)[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value,c=t.data.field(u.fieldPath);if(null==c)return null;var l=n.qe(u.kind);XN.Ie.ue(c,l)}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n.Fe()}},{key:"rn",value:function(e){var t=new rR;return XN.Ie.ue(e,t.qe(0)),t.Fe()}},{key:"an",value:function(e,t){var n,r=new rR;return XN.Ie.ue(tS(this.databaseId,t),r.qe(0===(n=aE(e)).length?0:n[n.length-1].kind)),r.Fe()}},{key:"nn",value:function(e,t,n){if(null===n)return[];var r=[];r.push(new rR);var i=0,a=!0,o=!1,s=void 0;try{for(var u,c=aE(e)[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var l=u.value,h=n[i++],f=!0,d=!1,p=void 0;try{for(var v,y=r[Symbol.iterator]();!(f=(v=y.next()).done);f=!0){var m=v.value;if(this.hn(t,l.fieldPath)&&rS(h))r=this.ln(r,l,h);else{var g=m.qe(l.kind);XN.Ie.ue(h,g)}}}catch(e){d=!0,p=e}finally{try{f||null==y.return||y.return()}finally{if(d)throw p}}}}catch(e){o=!0,s=e}finally{try{a||null==c.return||c.return()}finally{if(o)throw s}}return this.fn(r)}},{key:"en",value:function(e,t,n){return this.nn(e,t,n.position)}},{key:"fn",value:function(e){for(var t=[],n=0;n<e.length;++n)t[n]=e[n].Fe();return t}},{key:"ln",value:function(t,n,r){var i=e(p)(t),a=[],o=!0,s=!1,u=void 0,c=!0,l=!1,h=void 0;try{for(var f,d=(r.arrayValue.values||[])[Symbol.iterator]();!(c=(f=d.next()).done);c=!0){var v=f.value;try{for(var y,m=i[Symbol.iterator]();!(o=(y=m.next()).done);o=!0){var g=y.value,k=new rR;k.seed(g.Fe()),XN.Ie.ue(v,k.qe(n.kind)),a.push(k)}}catch(e){s=!0,u=e}finally{try{o||null==m.return||m.return()}finally{if(s)throw u}}}}catch(e){l=!0,h=e}finally{try{c||null==d.return||d.return()}finally{if(l)throw h}}return a}},{key:"hn",value:function(e,t){return!!e.filters.find((function(e){return e instanceof mS&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op)}))}},{key:"getFieldIndexes",value:function(t,n){var r=this,i=xR(t),a=IR(t);return(n?i.W("collectionGroupIndex",IDBKeyRange.bound(n,n)):i.W()).next((function(t){var n=r,i=[];return yE.forEach(t,(function(t){return a.get([t.indexId,n.uid]).next((function(n){var r,a,o,s;i.push((r=t,o=(a=n)?new sE(a.sequenceNumber,new lE(UN(a.readTime),new nE(iN(a.documentKey)),a.largestBatchId)):sE.empty(),s=r.fields.map((function(t){var n=e(b)(t,2),r=n[0],i=n[1];return new oE(tE.fromServerFormat(r),i)})),new rE(r.indexId,r.collectionGroup,s,o)))}))})).next((function(){return i}))}))}},{key:"getNextCollectionGroupToUpdate",value:function(e){return this.getFieldIndexes(e).next((function(e){return 0===e.length?null:(e.sort((function(e,t){var n=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==n?n:HT(e.collectionGroup,t.collectionGroup)})),e[0].collectionGroup)}))}},{key:"updateCollectionGroup",value:function(e,t,n){var r=this,i=xR(e),a=IR(e);return this.dn(e).next((function(e){return i.W("collectionGroupIndex",IDBKeyRange.bound(t,t)).next((function(t){return yE.forEach(t,(function(t){return a.put(WN(t.indexId,r.user,e,n))}))}))}))}},{key:"updateIndexEntries",value:function(e,t){var n=this,r=new Map;return yE.forEach(t,(function(t,i){var a=n,o=r.get(t.collectionGroup);return(o?yE.resolve(o):n.getFieldIndexes(e,t.collectionGroup)).next((function(n){return r.set(t.collectionGroup,n),yE.forEach(n,(function(n){return a._n(e,t,n).next((function(t){var r=a.wn(i,n);return t.isEqual(r)?yE.resolve():a.mn(e,i,n,t,r)}))}))}))}))}},{key:"gn",value:function(e,t,n,r){return bR(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.an(n,t.key),documentKey:t.key.path.toArray()})}},{key:"yn",value:function(e,t,n,r){return bR(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.an(n,t.key),t.key.path.toArray()])}},{key:"_n",value:function(e,t,n){var r=bR(e),i=new VS(aR);return r.Z({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.an(n,t)])},(function(e,r){i=i.add(new iR(n.indexId,t,r.arrayValue,r.directionalValue))})).next((function(){return i}))}},{key:"wn",value:function(e,t){var n=new VS(aR),r=this.cn(t,e);if(null==r)return n;var i=iE(t);if(null!=i){var a=e.data.field(i.fieldPath),o=!0,s=!1,u=void 0;if(rS(a))try{for(var c,l=(a.arrayValue.values||[])[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var h=c.value;n=n.add(new iR(t.indexId,e.key,this.rn(h),r))}}catch(e){s=!0,u=e}finally{try{o||null==l.return||l.return()}finally{if(s)throw u}}}else n=n.add(new iR(t.indexId,e.key,kR,r));return n}},{key:"mn",value:function(e,t,n,r,i){var a=this;ST("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);var o=[];return function(e,t,n,r,i){for(var a=e.getIterator(),o=t.getIterator(),s=BS(a),u=BS(o);s||u;){var c=!1,l=!1;if(s&&u){var h=n(s,u);h<0?l=!0:h>0&&(c=!0)}else null!=s?l=!0:c=!0;c?(r(u),u=BS(o)):l?(i(s),s=BS(a)):(s=BS(a),u=BS(o))}}(r,i,aR,(function(r){o.push(a.gn(e,t,n,r))}),(function(r){o.push(a.yn(e,t,n,r))})),yE.waitFor(o)}},{key:"dn",value:function(e){var t=1;return IR(e).Z({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(function(e,n,r){r.done(),t=n.sequenceNumber+1})).next((function(){return t}))}},{key:"createRange",value:function(e,t,n){n=n.sort((function(e,t){return aR(e,t)})).filter((function(e,t,n){return!t||0!==aR(e,n[t-1])}));var r=[];r.push(e);var i=!0,a=!1,o=void 0;try{for(var s,u=n[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value,l=aR(c,e),h=aR(c,t);if(0===l)r[0]=e.Ue();else if(l>0&&h<0)r.push(c),r.push(c.Ue());else if(h>0)break}}catch(e){a=!0,o=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw o}}r.push(t);for(var f=[],d=0;d<r.length;d+=2){if(this.pn(r[d],r[d+1]))return[];var p=[r[d].indexId,this.uid,r[d].arrayValue,r[d].directionalValue,kR,[]],v=[r[d+1].indexId,this.uid,r[d+1].arrayValue,r[d+1].directionalValue,kR,[]];f.push(IDBKeyRange.bound(p,v))}return f}},{key:"pn",value:function(e,t){return aR(e,t)>0}},{key:"getMinOffsetFromCollectionGroup",value:function(e,t){return this.getFieldIndexes(e,t).next(TR)}},{key:"getMinOffset",value:function(e,t){var n=this;return yE.mapArray(this.Ze(t),(function(t){return n.tn(e,t).next((function(e){return e||RT()}))})).next(TR)}}]),t}();function wR(e){return AN(e,"collectionParents")}function bR(e){return AN(e,"indexEntries")}function xR(e){return AN(e,"indexConfiguration")}function IR(e){return AN(e,"indexState")}function TR(e){DT(0!==e.length);for(var t=e[0].indexState.offset,n=t.largestBatchId,r=1;r<e.length;r++){var i=e[r].indexState.offset;hE(i,t)<0&&(t=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new lE(t.readTime,t.documentKey,n)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ER={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},SR=function(){"use strict";function t(n,r,i){e(l)(this,t),this.cacheSizeCollectionThreshold=n,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=i}return e(h)(t,null,[{key:"withCacheSize",value:function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function CR(e,t,n){var r=e.store("mutations"),i=e.store("documentMutations"),a=[],o=IDBKeyRange.only(n.batchId),s=0,u=r.Z({range:o},(function(e,t,n){return s++,n.delete()}));a.push(u.next((function(){DT(1===s)})));var c=[],l=!0,h=!1,f=void 0;try{for(var d,p=n.mutations[Symbol.iterator]();!(l=(d=p.next()).done);l=!0){var v=d.value,y=sN(t,v.key.path,n.batchId);a.push(i.delete(y)),c.push(v.key)}}catch(e){h=!0,f=e}finally{try{l||null==p.return||p.return()}finally{if(h)throw f}}return yE.waitFor(a).next((function(){return c}))}function AR(e){if(!e)return 0;var t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw RT();t=e.noDocument}return JSON.stringify(t).length}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */SR.DEFAULT_COLLECTION_PERCENTILE=10,SR.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,SR.DEFAULT=new SR(41943040,SR.DEFAULT_COLLECTION_PERCENTILE,SR.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),SR.DISABLED=new SR(-1,0,0);var NR=function(){"use strict";function t(n,r,i,a){e(l)(this,t),this.userId=n,this.yt=r,this.indexManager=i,this.referenceDelegate=a,this.In={}}return e(h)(t,[{key:"checkEmpty",value:function(e){var t=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return DR(e).Z({index:"userMutationsIndex",range:n},(function(e,n,r){t=!1,r.done()})).next((function(){return t}))}},{key:"addMutationBatch",value:function(e,t,n,r){var i=this,a=PR(e),o=DR(e);return o.add({}).next((function(s){var u=i;DT("number"==typeof s);var c=new NN(s,t,n,r),l=function(e,t,n){var r=n.baseMutations.map((function(t){return KA(e.ie,t)})),i=n.mutations.map((function(t){return KA(e.ie,t)}));return{userId:t,batchId:n.batchId,localWriteTimeMs:n.localWriteTime.toMillis(),baseMutations:r,mutations:i}}(i.yt,i.userId,c),h=[],f=new VS((function(e,t){return HT(e.canonicalString(),t.canonicalString())})),d=!0,p=!1,v=void 0;try{for(var y,m=r[Symbol.iterator]();!(d=(y=m.next()).done);d=!0){var g=y.value,k=sN(i.userId,g.key.path,s);f=f.add(g.key.path.popLast()),h.push(o.put(l)),h.push(a.put(k,uN))}}catch(e){p=!0,v=e}finally{try{d||null==m.return||m.return()}finally{if(p)throw v}}return f.forEach((function(t){h.push(u.indexManager.addToCollectionParentIndex(e,t))})),e.addOnCommittedListener((function(){u.In[s]=c.keys()})),yE.waitFor(h).next((function(){return c}))}))}},{key:"lookupMutationBatch",value:function(e,t){var n=this;return DR(e).get(t).next((function(e){return e?(DT(e.userId===n.userId),qN(n.yt,e)):null}))}},{key:"Tn",value:function(e,t){var n=this;return this.In[t]?yE.resolve(this.In[t]):this.lookupMutationBatch(e,t).next((function(e){if(e){var r=e.keys();return n.In[t]=r,r}return null}))}},{key:"getNextMutationBatchAfterBatchId",value:function(e,t){var n=this,r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),a=null;return DR(e).Z({index:"userMutationsIndex",range:i},(function(e,t,i){t.userId===n.userId&&(DT(t.batchId>=r),a=qN(n.yt,t)),i.done()})).next((function(){return a}))}},{key:"getHighestUnacknowledgedBatchId",value:function(e){var t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return DR(e).Z({index:"userMutationsIndex",range:t,reverse:!0},(function(e,t,r){n=t.batchId,r.done()})).next((function(){return n}))}},{key:"getAllMutationBatches",value:function(e){var t=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return DR(e).W("userMutationsIndex",n).next((function(e){return e.map((function(e){return qN(t.yt,e)}))}))}},{key:"getAllMutationBatchesAffectingDocumentKey",value:function(t,n){var r=this,i=oN(this.userId,n.path),a=IDBKeyRange.lowerBound(i),o=[];return PR(t).Z({range:a},(function(i,a,s){var u=r,c=e(b)(i,3),l=c[0],h=c[1],f=c[2],d=iN(h);if(l===r.userId&&n.path.isEqual(d))return DR(t).get(f).next((function(e){if(!e)throw RT();DT(e.userId===u.userId),o.push(qN(u.yt,e))}));s.done()})).next((function(){return o}))}},{key:"getAllMutationBatchesAffectingDocumentKeys",value:function(t,n){var r=this,i=new VS(HT),a=[];return n.forEach((function(n){var o=r,s=oN(r.userId,n.path),u=IDBKeyRange.lowerBound(s),c=PR(t).Z({range:u},(function(t,r,a){var s=e(b)(t,3),u=s[0],c=s[1],l=s[2],h=iN(c);u===o.userId&&n.path.isEqual(h)?i=i.add(l):a.done()}));a.push(c)})),yE.waitFor(a).next((function(){return r.En(t,i)}))}},{key:"getAllMutationBatchesAffectingQuery",value:function(t,n){var r=this,i=n.path,a=i.length+1,o=oN(this.userId,i),s=IDBKeyRange.lowerBound(o),u=new VS(HT);return PR(t).Z({range:s},(function(t,n,o){var s=e(b)(t,3),c=s[0],l=s[1],h=s[2],f=iN(l);c===r.userId&&i.isPrefixOf(f)?f.length===a&&(u=u.add(h)):o.done()})).next((function(){return r.En(t,u)}))}},{key:"En",value:function(e,t){var n=this,r=[],i=[];return t.forEach((function(t){var a=n;i.push(DR(e).get(t).next((function(e){if(null===e)throw RT();DT(e.userId===a.userId),r.push(qN(a.yt,e))})))})),yE.waitFor(i).next((function(){return r}))}},{key:"removeMutationBatch",value:function(e,t){var n=this;return CR(e.se,this.userId,t).next((function(r){return e.addOnCommittedListener((function(){n.An(t.batchId)})),yE.forEach(r,(function(t){return n.referenceDelegate.markPotentiallyOrphaned(e,t)}))}))}},{key:"An",value:function(e){delete this.In[e]}},{key:"performConsistencyCheck",value:function(e){var t=this;return this.checkEmpty(e).next((function(n){var r=t;if(!n)return yE.resolve();var i=IDBKeyRange.lowerBound([t.userId]),a=[];return PR(e).Z({range:i},(function(e,t,n){if(e[0]===r.userId){var i=iN(e[1]);a.push(i)}else n.done()})).next((function(){DT(0===a.length)}))}))}},{key:"containsKey",value:function(e,t){return RR(e,this.userId,t)}},{key:"Rn",value:function(e){var t=this;return OR(e).get(this.userId).next((function(e){return e||{userId:t.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""}}))}}],[{key:"re",value:function(e,n,r,i){return DT(""!==e.uid),new t(e.isAuthenticated()?e.uid:"",n,r,i)}}]),t}();function RR(t,n,r){var i=oN(n,r.path),a=i[1],o=IDBKeyRange.lowerBound(i),s=!1;return PR(t).Z({range:o,X:!0},(function(t,r,i){var o=e(b)(t,3),u=o[0],c=o[1];o[2];u===n&&c===a&&(s=!0),i.done()})).next((function(){return s}))}function DR(e){return AN(e,"mutations")}function PR(e){return AN(e,"documentMutations")}function OR(e){return AN(e,"mutationQueues")}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var MR=function(){"use strict";function t(n){e(l)(this,t),this.bn=n}return e(h)(t,[{key:"next",value:function(){return this.bn+=2,this.bn}}],[{key:"Pn",value:function(){return new t(0)}},{key:"vn",value:function(){return new t(-1)}}]),t}(),LR=function(){"use strict";function t(n,r){e(l)(this,t),this.referenceDelegate=n,this.yt=r}return e(h)(t,[{key:"allocateTargetId",value:function(e){var t=this;return this.Vn(e).next((function(n){var r=new MR(n.highestTargetId);return n.highestTargetId=r.next(),t.Sn(e,n).next((function(){return n.highestTargetId}))}))}},{key:"getLastRemoteSnapshotVersion",value:function(e){return this.Vn(e).next((function(e){return XT.fromTimestamp(new JT(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))}))}},{key:"getHighestSequenceNumber",value:function(e){return this.Vn(e).next((function(e){return e.highestListenSequenceNumber}))}},{key:"setTargetsMetadata",value:function(e,t,n){var r=this;return this.Vn(e).next((function(i){return i.highestListenSequenceNumber=t,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),r.Sn(e,i)}))}},{key:"addTargetData",value:function(e,t){var n=this;return this.Dn(e,t).next((function(){return n.Vn(e).next((function(r){return r.targetCount+=1,n.Cn(t,r),n.Sn(e,r)}))}))}},{key:"updateTargetData",value:function(e,t){return this.Dn(e,t)}},{key:"removeTargetData",value:function(e,t){var n=this;return this.removeMatchingKeysForTargetId(e,t.targetId).next((function(){return FR(e).delete(t.targetId)})).next((function(){return n.Vn(e)})).next((function(t){return DT(t.targetCount>0),t.targetCount-=1,n.Sn(e,t)}))}},{key:"removeTargets",value:function(e,t,n){var r=this,i=0,a=[];return FR(e).Z((function(o,s){var u=VN(s);u.sequenceNumber<=t&&null===n.get(u.targetId)&&(i++,a.push(r.removeTargetData(e,u)))})).next((function(){return yE.waitFor(a)})).next((function(){return i}))}},{key:"forEachTarget",value:function(e,t){return FR(e).Z((function(e,n){var r=VN(n);t(r)}))}},{key:"Vn",value:function(e){return UR(e).get("targetGlobalKey").next((function(e){return DT(null!==e),e}))}},{key:"Sn",value:function(e,t){return UR(e).put("targetGlobalKey",t)}},{key:"Dn",value:function(e,t){return FR(e).put(jN(this.yt,t))}},{key:"Cn",value:function(e,t){var n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}},{key:"getTargetCount",value:function(e){return this.Vn(e).next((function(e){return e.targetCount}))}},{key:"getTargetData",value:function(e,t){var n=YS(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return FR(e).Z({range:r,index:"queryTargetsIndex"},(function(e,n,r){var a=VN(n);JS(t,a.target)&&(i=a,r.done())})).next((function(){return i}))}},{key:"addMatchingKeys",value:function(e,t,n){var r=this,i=[],a=qR(e);return t.forEach((function(t){var o=tN(t.path);i.push(a.put({targetId:n,path:o})),i.push(r.referenceDelegate.addReference(e,n,t))})),yE.waitFor(i)}},{key:"removeMatchingKeys",value:function(e,t,n){var r=this,i=qR(e);return yE.forEach(t,(function(t){var a=tN(t.path);return yE.waitFor([i.delete([n,a]),r.referenceDelegate.removeReference(e,n,t)])}))}},{key:"removeMatchingKeysForTargetId",value:function(e,t){var n=qR(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}},{key:"getMatchingKeysForTargetId",value:function(e,t){var n=IDBKeyRange.bound([t],[t+1],!1,!0),r=qR(e),i=dA();return r.Z({range:n,X:!0},(function(e,t,n){var r=iN(e[1]),a=new nE(r);i=i.add(a)})).next((function(){return i}))}},{key:"containsKey",value:function(t,n){var r=tN(n.path),i=IDBKeyRange.bound([r],[YT(r)],!1,!0),a=0;return qR(t).Z({index:"documentTargetsIndex",X:!0,range:i},(function(t,n,r){var i=e(b)(t,2),o=i[0];i[1];0!==o&&(a++,r.done())})).next((function(){return a>0}))}},{key:"ne",value:function(e,t){return FR(e).get(t).next((function(e){return e?VN(e):null}))}}]),t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FR(e){return AN(e,"targets")}function UR(e){return AN(e,"targetGlobal")}function qR(e){return AN(e,"targetDocuments")}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VR(t,n){var r=e(b)(t,2),i=r[0],a=r[1],o=e(b)(n,2),s=o[0],u=o[1],c=HT(i,s);return 0===c?HT(a,u):c}var jR=function(){"use strict";function t(n){e(l)(this,t),this.xn=n,this.buffer=new VS(VR),this.Nn=0}return e(h)(t,[{key:"kn",value:function(){return++this.Nn}},{key:"On",value:function(e){var t=[e,this.kn()];if(this.buffer.size<this.xn)this.buffer=this.buffer.add(t);else{var n=this.buffer.last();VR(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}},{key:"maxValue",get:function(){return this.buffer.last()[0]}}]),t}(),BR=function(){"use strict";function t(n,r,i){e(l)(this,t),this.garbageCollector=n,this.asyncQueue=r,this.localStore=i,this.Mn=null}return e(h)(t,[{key:"start",value:function(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Fn(6e4)}},{key:"stop",value:function(){this.Mn&&(this.Mn.cancel(),this.Mn=null)}},{key:"started",get:function(){return null!==this.Mn}},{key:"Fn",value:function(t){var n=this;ST("LruGarbageCollector","Garbage collection scheduled in ".concat(t,"ms")),this.Mn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,e(u)(e(_).mark((function t(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.Mn=null,e.prev=1,e.next=4,n.localStore.collectGarbage(n.garbageCollector);case 4:e.next=14;break;case 6:if(e.prev=6,e.t0=e.catch(1),!wE(e.t0)){e.next=12;break}ST("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e.t0),e.next=14;break;case 12:return e.next=14,pE(e.t0);case 14:return e.next=16,n.Fn(3e5);case 16:case"end":return e.stop()}}),t,null,[[1,6]])}))))}}]),t}(),KR=function(){"use strict";function t(n,r){e(l)(this,t),this.$n=n,this.params=r}return e(h)(t,[{key:"calculateTargetCount",value:function(e,t){return this.$n.Bn(e).next((function(e){return Math.floor(t/100*e)}))}},{key:"nthSequenceNumber",value:function(e,t){var n=this;if(0===t)return yE.resolve(CE.at);var r=new jR(t);return this.$n.forEachTarget(e,(function(e){return r.On(e.sequenceNumber)})).next((function(){return n.$n.Ln(e,(function(e){return r.On(e)}))})).next((function(){return r.maxValue}))}},{key:"removeTargets",value:function(e,t,n){return this.$n.removeTargets(e,t,n)}},{key:"removeOrphanedDocuments",value:function(e,t){return this.$n.removeOrphanedDocuments(e,t)}},{key:"collect",value:function(e,t){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(ST("LruGarbageCollector","Garbage collection skipped; disabled"),yE.resolve(ER)):this.getCacheSize(e).next((function(r){return r<n.params.cacheSizeCollectionThreshold?(ST("LruGarbageCollector","Garbage collection skipped; Cache size ".concat(r," is lower than threshold ").concat(n.params.cacheSizeCollectionThreshold)),ER):n.qn(e,t)}))}},{key:"getCacheSize",value:function(e){return this.$n.getCacheSize(e)}},{key:"qn",value:function(e,t){var n,r,i,a,o,s,u,c=this,l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((function(t){return t>c.params.maximumSequenceNumbersToCollect?(ST("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of ".concat(c.params.maximumSequenceNumbersToCollect," from ").concat(t)),r=c.params.maximumSequenceNumbersToCollect):r=t,a=Date.now(),c.nthSequenceNumber(e,r)})).next((function(r){return n=r,o=Date.now(),c.removeTargets(e,n,t)})).next((function(t){return i=t,s=Date.now(),c.removeOrphanedDocuments(e,n)})).next((function(e){return u=Date.now(),ET()<=pt.DEBUG&&ST("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in ".concat(a-l,"ms\n\tDetermined least recently used ").concat(r," in ")+(o-a)+"ms\n"+"\tRemoved ".concat(i," targets in ")+(s-o)+"ms\n"+"\tRemoved ".concat(e," documents in ")+(u-s)+"ms\n"+"Total Duration: ".concat(u-l,"ms")),yE.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e})}))}}]),t}(),zR=function(){"use strict";function t(n,r){e(l)(this,t),this.db=n,this.garbageCollector=new KR(this,r)}return e(h)(t,[{key:"Bn",value:function(e){var t=this.Un(e);return this.db.getTargetCache().getTargetCount(e).next((function(e){return t.next((function(t){return e+t}))}))}},{key:"Un",value:function(e){var t=0;return this.Ln(e,(function(e){t++})).next((function(){return t}))}},{key:"forEachTarget",value:function(e,t){return this.db.getTargetCache().forEachTarget(e,t)}},{key:"Ln",value:function(e,t){return this.Kn(e,(function(e,n){return t(n)}))}},{key:"addReference",value:function(e,t,n){return WR(e,n)}},{key:"removeReference",value:function(e,t,n){return WR(e,n)}},{key:"removeTargets",value:function(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}},{key:"markPotentiallyOrphaned",value:function(e,t){return WR(e,t)}},{key:"Gn",value:function(e,t){return r=t,i=!1,OR(n=e).tt((function(e){return RR(n,e,r).next((function(e){return e&&(i=!0),yE.resolve(!e)}))})).next((function(){return i}));var n,r,i}},{key:"removeOrphanedDocuments",value:function(e,t){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],a=0;return this.Kn(e,(function(o,s){if(s<=t){var u=n.Gn(e,o).next((function(t){if(!t)return a++,r.getEntry(e,o).next((function(){return r.removeEntry(o,XT.min()),qR(e).delete([0,tN(o.path)])}))}));i.push(u)}})).next((function(){return yE.waitFor(i)})).next((function(){return r.apply(e)})).next((function(){return a}))}},{key:"removeTarget",value:function(e,t){var n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}},{key:"updateLimboDocument",value:function(e,t){return WR(e,t)}},{key:"Kn",value:function(t,n){var r,i=qR(t),a=CE.at;return i.Z({index:"documentTargetsIndex"},(function(t,i){var o=e(b)(t,2),s=o[0],u=(o[1],i.path),c=i.sequenceNumber;0===s?(a!==CE.at&&n(new nE(iN(r)),a),a=c,r=u):a=CE.at})).next((function(){a!==CE.at&&n(new nE(iN(r)),a)}))}},{key:"getCacheSize",value:function(e){return this.db.getRemoteDocumentCache().getSize(e)}}]),t}();function WR(e,t){return qR(e).put((n=t,r=e.currentSequenceNumber,{targetId:0,path:tN(n.path),sequenceNumber:r}));var n,r}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var GR=function(){"use strict";function t(){e(l)(this,t),this.changes=new nA((function(e){return e.toString()}),(function(e,t){return e.isEqual(t)})),this.changesApplied=!1}return e(h)(t,[{key:"addEntry",value:function(e){this.assertNotApplied(),this.changes.set(e.key,e)}},{key:"removeEntry",value:function(e,t){this.assertNotApplied(),this.changes.set(e,GS.newInvalidDocument(e).setReadTime(t))}},{key:"getEntry",value:function(e,t){this.assertNotApplied();var n=this.changes.get(t);return void 0!==n?yE.resolve(n):this.getFromCache(e,t)}},{key:"getEntries",value:function(e,t){return this.getAllFromCache(e,t)}},{key:"apply",value:function(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}},{key:"assertNotApplied",value:function(){}}]),t}(),HR=function(){"use strict";function t(n){e(l)(this,t),this.yt=n}return e(h)(t,[{key:"setIndexManager",value:function(e){this.indexManager=e}},{key:"addEntry",value:function(e,t,n){return XR(e).put(n)}},{key:"removeEntry",value:function(e,t,n){return XR(e).delete((r=n,[(i=t.path.toArray()).slice(0,i.length-2),i[i.length-2],LN(r),i[i.length-1]]));var r,i}},{key:"updateMetadata",value:function(e,t){var n=this;return this.getMetadata(e).next((function(r){return r.byteSize+=t,n.Qn(e,r)}))}},{key:"getEntry",value:function(e,t){var n=this,r=GS.newInvalidDocument(t);return XR(e).Z({index:"documentKeyIndex",range:IDBKeyRange.only($R(t))},(function(e,i){r=n.jn(t,i)})).next((function(){return r}))}},{key:"Wn",value:function(e,t){var n=this,r={size:0,document:GS.newInvalidDocument(t)};return XR(e).Z({index:"documentKeyIndex",range:IDBKeyRange.only($R(t))},(function(e,i){r={document:n.jn(t,i),size:AR(i)}})).next((function(){return r}))}},{key:"getEntries",value:function(e,t){var n=this,r=iA();return this.zn(e,t,(function(e,t){var i=n.jn(e,t);r=r.insert(e,i)})).next((function(){return r}))}},{key:"Hn",value:function(e,t){var n=this,r=iA(),i=new FS(nE.comparator);return this.zn(e,t,(function(e,t){var a=n.jn(e,t);r=r.insert(e,a),i=i.insert(e,AR(t))})).next((function(){return{documents:r,Jn:i}}))}},{key:"zn",value:function(t,n,r){if(n.isEmpty())return yE.resolve();var i=new VS(eD);n.forEach((function(e){return i=i.add(e)}));var a=IDBKeyRange.bound($R(i.first()),$R(i.last())),o=i.getIterator(),s=o.getNext();return XR(t).Z({index:"documentKeyIndex",range:a},(function(t,n,i){for(var a=nE.fromSegments(e(p)(n.prefixPath).concat([n.collectionGroup,n.documentId]));s&&eD(s,a)<0;)r(s,null),s=o.getNext();s&&s.isEqual(a)&&(r(s,n),s=o.hasNext()?o.getNext():null),s?i.j($R(s)):i.done()})).next((function(){for(;s;)r(s,null),s=o.hasNext()?o.getNext():null}))}},{key:"getAllFromCollection",value:function(e,t,n){var r=this,i=[t.popLast().toArray(),t.lastSegment(),LN(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],a=[t.popLast().toArray(),t.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return XR(e).W(IDBKeyRange.bound(i,a,!0)).next((function(e){var t=iA(),n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var u=o.value,c=r.jn(nE.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);t=t.insert(c.key,c)}}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return t}))}},{key:"getAllFromCollectionGroup",value:function(e,t,n,r){var i=this,a=iA(),o=ZR(t,n),s=ZR(t,lE.max());return XR(e).Z({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,s,!0)},(function(e,t,n){var o=i.jn(nE.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);(a=a.insert(o.key,o)).size===r&&n.done()})).next((function(){return a}))}},{key:"newChangeBuffer",value:function(e){return new YR(this,!!e&&e.trackRemovals)}},{key:"getSize",value:function(e){return this.getMetadata(e).next((function(e){return e.byteSize}))}},{key:"getMetadata",value:function(e){return JR(e).get("remoteDocumentGlobalKey").next((function(e){return DT(!!e),e}))}},{key:"Qn",value:function(e,t){return JR(e).put("remoteDocumentGlobalKey",t)}},{key:"jn",value:function(e,t){if(t){var n=function(e,t){var n,r,i;if(t.document)n=BA(e.ie,t.document,!!t.hasCommittedMutations);else if(t.noDocument){var a=nE.fromSegments(t.noDocument.path),o=UN(t.noDocument.readTime);n=GS.newNoDocument(a,o),t.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!t.unknownDocument)return RT();var s=nE.fromSegments(t.unknownDocument.path),u=UN(t.unknownDocument.version);n=GS.newUnknownDocument(s,u)}return t.readTime&&n.setReadTime((r=t.readTime,i=new JT(r[0],r[1]),XT.fromTimestamp(i))),n}(this.yt,t);if(!n.isNoDocument()||!n.version.isEqual(XT.min()))return n}return GS.newInvalidDocument(e)}}]),t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QR(e){return new HR(e)}var YR=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i){var a;return e(l)(this,r),(a=n.call(this)).Yn=t,a.trackRemovals=i,a.Xn=new nA((function(e){return e.toString()}),(function(e,t){return e.isEqual(t)})),e(gw)(a)}return e(h)(r,[{key:"applyChanges",value:function(e){var t=this,n=[],r=0,i=new VS((function(e,t){return HT(e.canonicalString(),t.canonicalString())}));return this.changes.forEach((function(a,o){var s=t.Xn.get(a);if(n.push(t.Yn.removeEntry(e,a,s.readTime)),o.isValidDocument()){var u=MN(t.Yn.yt,o);i=i.add(a.path.popLast());var c=AR(u);r+=c-s.size,n.push(t.Yn.addEntry(e,a,u))}else if(r-=s.size,t.trackRemovals){var l=MN(t.Yn.yt,o.convertToNoDocument(XT.min()));n.push(t.Yn.addEntry(e,a,l))}})),i.forEach((function(r){n.push(t.Yn.indexManager.addToCollectionParentIndex(e,r))})),n.push(this.Yn.updateMetadata(e,r)),yE.waitFor(n)}},{key:"getFromCache",value:function(e,t){var n=this;return this.Yn.Wn(e,t).next((function(e){return n.Xn.set(t,{size:e.size,readTime:e.document.readTime}),e.document}))}},{key:"getAllFromCache",value:function(e,t){var n=this;return this.Yn.Hn(e,t).next((function(e){var t=e.documents;return e.Jn.forEach((function(e,r){n.Xn.set(e,{size:r,readTime:t.get(e).readTime})})),t}))}}]),r}(GR);function JR(e){return AN(e,"remoteDocumentGlobal")}function XR(e){return AN(e,"remoteDocumentsV14")}function $R(e){var t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function ZR(e,t){var n=t.documentKey.path.toArray();return[e,LN(t.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function eD(e,t){for(var n=e.path.toArray(),r=t.path.toArray(),i=0,a=0;a<n.length-2&&a<r.length-2;++a)if(i=HT(n[a],r[a]))return i;return(i=HT(n.length,r.length))||((i=HT(n[n.length-2],r[r.length-2]))||HT(n[n.length-1],r[r.length-1]))}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var tD=function t(n,r){"use strict";e(l)(this,t),this.overlayedDocument=n,this.mutatedFields=r},nD=function(){"use strict";function t(n,r,i,a){e(l)(this,t),this.remoteDocumentCache=n,this.mutationQueue=r,this.documentOverlayCache=i,this.indexManager=a}return e(h)(t,[{key:"getDocument",value:function(e,t){var n=this,r=null;return this.documentOverlayCache.getOverlay(e,t).next((function(i){return r=i,n.remoteDocumentCache.getEntry(e,t)})).next((function(e){return null!==r&&jC(r.mutation,e,KS.empty(),JT.now()),e}))}},{key:"getDocuments",value:function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next((function(t){return n.getLocalViewOfDocuments(e,t,dA()).next((function(){return t}))}))}},{key:"getLocalViewOfDocuments",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:dA(),r=this,i=uA();return this.populateOverlays(e,i,t).next((function(){return r.computeViews(e,t,i,n).next((function(e){var t=oA();return e.forEach((function(e,n){t=t.insert(e,n.overlayedDocument)})),t}))}))}},{key:"getOverlayedDocuments",value:function(e,t){var n=this,r=uA();return this.populateOverlays(e,r,t).next((function(){return n.computeViews(e,t,r,dA())}))}},{key:"populateOverlays",value:function(e,t,n){var r=[];return n.forEach((function(e){t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((function(e){e.forEach((function(e,n){t.set(e,n)}))}))}},{key:"computeViews",value:function(e,t,n,r){var i=iA(),a=lA(),o=lA();return t.forEach((function(e,t){var o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof WC)?i=i.insert(t.key,t):void 0!==o&&(a.set(t.key,o.mutation.getFieldMask()),jC(o.mutation,t,o.mutation.getFieldMask(),JT.now()))})),this.recalculateAndSaveOverlays(e,i).next((function(e){return e.forEach((function(e,t){return a.set(e,t)})),t.forEach((function(e,t){var n;return o.set(e,new tD(t,null!==(n=a.get(e))&&void 0!==n?n:null))})),o}))}},{key:"recalculateAndSaveOverlays",value:function(e,t){var n=this,r=lA(),i=new FS((function(e,t){return e-t})),a=dA();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((function(e){var n=!0,a=!1,o=void 0;try{for(var s,u=function(e,n){var a=n.value;a.keys().forEach((function(e){var n=t.get(e);if(null!==n){var o=r.get(e)||KS.empty();o=a.applyToLocalView(n,o),r.set(e,o);var s=(i.get(a.batchId)||dA()).add(e);i=i.insert(a.batchId,s)}}))},c=e[Symbol.iterator]();!(n=(s=c.next()).done);n=!0)u(0,s)}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}})).next((function(){for(var o=[],s=i.getReverseIterator();s.hasNext();){var u=s.getNext(),c=u.key,l=u.value,h=cA();l.forEach((function(e){if(!a.has(e)){var n=qC(t.get(e),r.get(e));null!==n&&h.set(e,n),a=a.add(e)}})),o.push(n.documentOverlayCache.saveOverlays(e,c,h))}return yE.waitFor(o)})).next((function(){return r}))}},{key:"recalculateAndSaveOverlaysForDocumentKeys",value:function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next((function(t){return n.recalculateAndSaveOverlays(e,t)}))}},{key:"getDocumentsMatchingQuery",value:function(e,t,n){return r=t,nE.isDocumentKey(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):sC(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n);var r}},{key:"getNextDocuments",value:function(e,t,n,r){var i=this;return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((function(a){var o=i,s=r-a.size>0?i.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-a.size):yE.resolve(uA()),u=-1,c=a;return s.next((function(t){return yE.forEach(t,(function(t,n){return u<n.largestBatchId&&(u=n.largestBatchId),a.get(t)?yE.resolve():o.remoteDocumentCache.getEntry(e,t).next((function(e){c=c.insert(t,e)}))})).next((function(){return o.populateOverlays(e,t,a)})).next((function(){return o.computeViews(e,c,t,dA())})).next((function(e){return{batchId:u,changes:sA(e)}}))}))}))}},{key:"getDocumentsMatchingDocumentQuery",value:function(e,t){return this.getDocument(e,new nE(t)).next((function(e){var t=oA();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}},{key:"getDocumentsMatchingCollectionGroupQuery",value:function(e,t,n){var r=this,i=t.collectionGroup,a=oA();return this.indexManager.getCollectionParents(e,i).next((function(o){return yE.forEach(o,(function(o){var s,u,c=(s=t,u=o.child(i),new tC(u,null,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt));return r.getDocumentsMatchingCollectionQuery(e,c,n).next((function(e){e.forEach((function(e,t){a=a.insert(e,t)}))}))})).next((function(){return a}))}))}},{key:"getDocumentsMatchingCollectionQuery",value:function(e,t,n){var r,i=this;return this.remoteDocumentCache.getAllFromCollection(e,t.path,n).next((function(a){return r=a,i.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId)})).next((function(e){e.forEach((function(e,t){var n=t.getKey();null===r.get(n)&&(r=r.insert(n,GS.newInvalidDocument(n)))}));var n=oA();return r.forEach((function(r,i){var a=e.get(r);void 0!==a&&jC(a.mutation,i,KS.empty(),JT.now()),vC(t,i)&&(n=n.insert(r,i))})),n}))}}]),t}(),rD=function(){"use strict";function t(n){e(l)(this,t),this.yt=n,this.Zn=new Map,this.ts=new Map}return e(h)(t,[{key:"getBundleMetadata",value:function(e,t){return yE.resolve(this.Zn.get(t))}},{key:"saveBundleMetadata",value:function(e,t){var n;return this.Zn.set(t.id,{id:(n=t).id,version:n.version,createTime:DA(n.createTime)}),yE.resolve()}},{key:"getNamedQuery",value:function(e,t){return yE.resolve(this.ts.get(t))}},{key:"saveNamedQuery",value:function(e,t){return this.ts.set(t.name,{name:(n=t).name,query:BN(n.bundledQuery),readTime:DA(n.readTime)}),yE.resolve();var n}}]),t}(),iD=function(){"use strict";function t(){e(l)(this,t),this.overlays=new FS(nE.comparator),this.es=new Map}return e(h)(t,[{key:"getOverlay",value:function(e,t){return yE.resolve(this.overlays.get(t))}},{key:"getOverlays",value:function(e,t){var n=this,r=uA();return yE.forEach(t,(function(t){return n.getOverlay(e,t).next((function(e){null!==e&&r.set(t,e)}))})).next((function(){return r}))}},{key:"saveOverlays",value:function(e,t,n){var r=this;return n.forEach((function(n,i){r.oe(e,t,i)})),yE.resolve()}},{key:"removeOverlaysForBatchId",value:function(e,t,n){var r=this,i=this.es.get(n);return void 0!==i&&(i.forEach((function(e){return r.overlays=r.overlays.remove(e)})),this.es.delete(n)),yE.resolve()}},{key:"getOverlaysForCollection",value:function(e,t,n){for(var r=uA(),i=t.length+1,a=new nE(t.child("")),o=this.overlays.getIteratorFrom(a);o.hasNext();){var s=o.getNext().value,u=s.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===i&&s.largestBatchId>n&&r.set(s.getKey(),s)}return yE.resolve(r)}},{key:"getOverlaysForCollectionGroup",value:function(e,t,n,r){for(var i=new FS((function(e,t){return e-t})),a=this.overlays.getIterator();a.hasNext();){var o=a.getNext().value;if(o.getKey().getCollectionGroup()===t&&o.largestBatchId>n){var s=i.get(o.largestBatchId);null===s&&(s=uA(),i=i.insert(o.largestBatchId,s)),s.set(o.getKey(),o)}}for(var u=uA(),c=i.getIterator();c.hasNext()&&(c.getNext().value.forEach((function(e,t){return u.set(e,t)})),!(u.size()>=r)););return yE.resolve(u)}},{key:"oe",value:function(e,t,n){var r=this.overlays.get(n.key);if(null!==r){var i=this.es.get(r.largestBatchId).delete(n.key);this.es.set(r.largestBatchId,i)}this.overlays=this.overlays.insert(n.key,new DN(t,n));var a=this.es.get(t);void 0===a&&(a=dA(),this.es.set(t,a)),this.es.set(t,a.add(n.key))}}]),t}(),aD=function(){"use strict";function t(){e(l)(this,t),this.ns=new VS(oD.ss),this.rs=new VS(oD.os)}return e(h)(t,[{key:"isEmpty",value:function(){return this.ns.isEmpty()}},{key:"addReference",value:function(e,t){var n=new oD(e,t);this.ns=this.ns.add(n),this.rs=this.rs.add(n)}},{key:"us",value:function(e,t){var n=this;e.forEach((function(e){return n.addReference(e,t)}))}},{key:"removeReference",value:function(e,t){this.cs(new oD(e,t))}},{key:"hs",value:function(e,t){var n=this;e.forEach((function(e){return n.removeReference(e,t)}))}},{key:"ls",value:function(e){var t=this,n=new nE(new ZT([])),r=new oD(n,e),i=new oD(n,e+1),a=[];return this.rs.forEachInRange([r,i],(function(e){t.cs(e),a.push(e.key)})),a}},{key:"fs",value:function(){var e=this;this.ns.forEach((function(t){return e.cs(t)}))}},{key:"cs",value:function(e){this.ns=this.ns.delete(e),this.rs=this.rs.delete(e)}},{key:"ds",value:function(e){var t=new nE(new ZT([])),n=new oD(t,e),r=new oD(t,e+1),i=dA();return this.rs.forEachInRange([n,r],(function(e){i=i.add(e.key)})),i}},{key:"containsKey",value:function(e){var t=new oD(e,0),n=this.ns.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}]),t}(),oD=function(){"use strict";function t(n,r){e(l)(this,t),this.key=n,this._s=r}return e(h)(t,null,[{key:"ss",value:function(e,t){return nE.comparator(e.key,t.key)||HT(e._s,t._s)}},{key:"os",value:function(e,t){return HT(e._s,t._s)||nE.comparator(e.key,t.key)}}]),t}(),sD=function(){"use strict";function t(n,r){e(l)(this,t),this.indexManager=n,this.referenceDelegate=r,this.mutationQueue=[],this.ws=1,this.gs=new VS(oD.ss)}return e(h)(t,[{key:"checkEmpty",value:function(e){return yE.resolve(0===this.mutationQueue.length)}},{key:"addMutationBatch",value:function(e,t,n,r){var i=this.ws;this.ws++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];var a=new NN(i,t,n,r);this.mutationQueue.push(a);var o=!0,s=!1,u=void 0;try{for(var c,l=r[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var h=c.value;this.gs=this.gs.add(new oD(h.key,i)),this.indexManager.addToCollectionParentIndex(e,h.key.path.popLast())}}catch(e){s=!0,u=e}finally{try{o||null==l.return||l.return()}finally{if(s)throw u}}return yE.resolve(a)}},{key:"lookupMutationBatch",value:function(e,t){return yE.resolve(this.ys(t))}},{key:"getNextMutationBatchAfterBatchId",value:function(e,t){var n=t+1,r=this.ps(n),i=r<0?0:r;return yE.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}},{key:"getHighestUnacknowledgedBatchId",value:function(){return yE.resolve(0===this.mutationQueue.length?-1:this.ws-1)}},{key:"getAllMutationBatches",value:function(e){return yE.resolve(this.mutationQueue.slice())}},{key:"getAllMutationBatchesAffectingDocumentKey",value:function(e,t){var n=this,r=new oD(t,0),i=new oD(t,Number.POSITIVE_INFINITY),a=[];return this.gs.forEachInRange([r,i],(function(e){var t=n.ys(e._s);a.push(t)})),yE.resolve(a)}},{key:"getAllMutationBatchesAffectingDocumentKeys",value:function(e,t){var n=this,r=new VS(HT);return t.forEach((function(e){var t=new oD(e,0),i=new oD(e,Number.POSITIVE_INFINITY);n.gs.forEachInRange([t,i],(function(e){r=r.add(e._s)}))})),yE.resolve(this.Is(r))}},{key:"getAllMutationBatchesAffectingQuery",value:function(e,t){var n=t.path,r=n.length+1,i=n;nE.isDocumentKey(i)||(i=i.child(""));var a=new oD(new nE(i),0),o=new VS(HT);return this.gs.forEachWhile((function(e){var t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e._s)),!0)}),a),yE.resolve(this.Is(o))}},{key:"Is",value:function(e){var t=this,n=[];return e.forEach((function(e){var r=t.ys(e);null!==r&&n.push(r)})),n}},{key:"removeMutationBatch",value:function(e,t){var n=this;DT(0===this.Ts(t.batchId,"removed")),this.mutationQueue.shift();var r=this.gs;return yE.forEach(t.mutations,(function(i){var a=new oD(i.key,t.batchId);return r=r.delete(a),n.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((function(){n.gs=r}))}},{key:"An",value:function(e){}},{key:"containsKey",value:function(e,t){var n=new oD(t,0),r=this.gs.firstAfterOrEqual(n);return yE.resolve(t.isEqual(r&&r.key))}},{key:"performConsistencyCheck",value:function(e){return this.mutationQueue.length,yE.resolve()}},{key:"Ts",value:function(e,t){return this.ps(e)}},{key:"ps",value:function(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}},{key:"ys",value:function(e){var t=this.ps(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}]),t}(),uD=function(){"use strict";function t(n){e(l)(this,t),this.Es=n,this.docs=new FS(nE.comparator),this.size=0}return e(h)(t,[{key:"setIndexManager",value:function(e){this.indexManager=e}},{key:"addEntry",value:function(e,t){var n=t.key,r=this.docs.get(n),i=r?r.size:0,a=this.Es(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}},{key:"removeEntry",value:function(e){var t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}},{key:"getEntry",value:function(e,t){var n=this.docs.get(t);return yE.resolve(n?n.document.mutableCopy():GS.newInvalidDocument(t))}},{key:"getEntries",value:function(e,t){var n=this,r=iA();return t.forEach((function(e){var t=n.docs.get(e);r=r.insert(e,t?t.document.mutableCopy():GS.newInvalidDocument(e))})),yE.resolve(r)}},{key:"getAllFromCollection",value:function(e,t,n){for(var r=iA(),i=new nE(t.child("")),a=this.docs.getIteratorFrom(i);a.hasNext();){var o=a.getNext(),s=o.key,u=o.value.document;if(!t.isPrefixOf(s.path))break;s.path.length>t.length+1||hE(cE(u),n)<=0||(r=r.insert(u.key,u.mutableCopy()))}return yE.resolve(r)}},{key:"getAllFromCollectionGroup",value:function(e,t,n,r){RT()}},{key:"As",value:function(e,t){return yE.forEach(this.docs,(function(e){return t(e)}))}},{key:"newChangeBuffer",value:function(e){return new cD(this)}},{key:"getSize",value:function(e){return yE.resolve(this.size)}}]),t}(),cD=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t){var i;return e(l)(this,r),(i=n.call(this)).Yn=t,e(gw)(i)}return e(h)(r,[{key:"applyChanges",value:function(e){var t=this,n=[];return this.changes.forEach((function(r,i){i.isValidDocument()?n.push(t.Yn.addEntry(e,i)):t.Yn.removeEntry(r)})),yE.waitFor(n)}},{key:"getFromCache",value:function(e,t){return this.Yn.getEntry(e,t)}},{key:"getAllFromCache",value:function(e,t){return this.Yn.getEntries(e,t)}}]),r}(GR),lD=function(){"use strict";function t(n){e(l)(this,t),this.persistence=n,this.Rs=new nA((function(e){return YS(e)}),JS),this.lastRemoteSnapshotVersion=XT.min(),this.highestTargetId=0,this.bs=0,this.Ps=new aD,this.targetCount=0,this.vs=MR.Pn()}return e(h)(t,[{key:"forEachTarget",value:function(e,t){return this.Rs.forEach((function(e,n){return t(n)})),yE.resolve()}},{key:"getLastRemoteSnapshotVersion",value:function(e){return yE.resolve(this.lastRemoteSnapshotVersion)}},{key:"getHighestSequenceNumber",value:function(e){return yE.resolve(this.bs)}},{key:"allocateTargetId",value:function(e){return this.highestTargetId=this.vs.next(),yE.resolve(this.highestTargetId)}},{key:"setTargetsMetadata",value:function(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.bs&&(this.bs=t),yE.resolve()}},{key:"Dn",value:function(e){this.Rs.set(e.target,e);var t=e.targetId;t>this.highestTargetId&&(this.vs=new MR(t),this.highestTargetId=t),e.sequenceNumber>this.bs&&(this.bs=e.sequenceNumber)}},{key:"addTargetData",value:function(e,t){return this.Dn(t),this.targetCount+=1,yE.resolve()}},{key:"updateTargetData",value:function(e,t){return this.Dn(t),yE.resolve()}},{key:"removeTargetData",value:function(e,t){return this.Rs.delete(t.target),this.Ps.ls(t.targetId),this.targetCount-=1,yE.resolve()}},{key:"removeTargets",value:function(e,t,n){var r=this,i=0,a=[];return this.Rs.forEach((function(o,s){s.sequenceNumber<=t&&null===n.get(s.targetId)&&(r.Rs.delete(o),a.push(r.removeMatchingKeysForTargetId(e,s.targetId)),i++)})),yE.waitFor(a).next((function(){return i}))}},{key:"getTargetCount",value:function(e){return yE.resolve(this.targetCount)}},{key:"getTargetData",value:function(e,t){var n=this.Rs.get(t)||null;return yE.resolve(n)}},{key:"addMatchingKeys",value:function(e,t,n){return this.Ps.us(t,n),yE.resolve()}},{key:"removeMatchingKeys",value:function(e,t,n){this.Ps.hs(t,n);var r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((function(t){i.push(r.markPotentiallyOrphaned(e,t))})),yE.waitFor(i)}},{key:"removeMatchingKeysForTargetId",value:function(e,t){return this.Ps.ls(t),yE.resolve()}},{key:"getMatchingKeysForTargetId",value:function(e,t){var n=this.Ps.ds(t);return yE.resolve(n)}},{key:"containsKey",value:function(e,t){return yE.resolve(this.Ps.containsKey(t))}}]),t}(),hD=function(){"use strict";function t(n,r){var i=this;e(l)(this,t),this.Vs={},this.overlays={},this.Ss=new CE(0),this.Ds=!1,this.Ds=!0,this.referenceDelegate=n(this),this.Cs=new lD(this),this.indexManager=new mR,this.remoteDocumentCache=new uD((function(e){return i.referenceDelegate.xs(e)})),this.yt=new ON(r),this.Ns=new rD(this.yt)}return e(h)(t,[{key:"start",value:function(){return Promise.resolve()}},{key:"shutdown",value:function(){return this.Ds=!1,Promise.resolve()}},{key:"started",get:function(){return this.Ds}},{key:"setDatabaseDeletedListener",value:function(){}},{key:"setNetworkEnabled",value:function(){}},{key:"getIndexManager",value:function(e){return this.indexManager}},{key:"getDocumentOverlayCache",value:function(e){var t=this.overlays[e.toKey()];return t||(t=new iD,this.overlays[e.toKey()]=t),t}},{key:"getMutationQueue",value:function(e,t){var n=this.Vs[e.toKey()];return n||(n=new sD(t,this.referenceDelegate),this.Vs[e.toKey()]=n),n}},{key:"getTargetCache",value:function(){return this.Cs}},{key:"getRemoteDocumentCache",value:function(){return this.remoteDocumentCache}},{key:"getBundleCache",value:function(){return this.Ns}},{key:"runTransaction",value:function(e,t,n){var r=this;ST("MemoryPersistence","Starting transaction:",e);var i=new fD(this.Ss.next());return this.referenceDelegate.ks(),n(i).next((function(e){return r.referenceDelegate.Os(i).next((function(){return e}))})).toPromise().then((function(e){return i.raiseOnCommittedEvent(),e}))}},{key:"Ms",value:function(e,t){return yE.or(Object.values(this.Vs).map((function(n){return function(){return n.containsKey(e,t)}})))}}]),t}(),fD=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t){var i;return e(l)(this,r),(i=n.call(this)).currentSequenceNumber=t,e(gw)(i)}return r}(dE),dD=function(){"use strict";function t(n){e(l)(this,t),this.persistence=n,this.Fs=new aD,this.$s=null}return e(h)(t,[{key:"Ls",get:function(){if(this.$s)return this.$s;throw RT()}},{key:"addReference",value:function(e,t,n){return this.Fs.addReference(n,t),this.Ls.delete(n.toString()),yE.resolve()}},{key:"removeReference",value:function(e,t,n){return this.Fs.removeReference(n,t),this.Ls.add(n.toString()),yE.resolve()}},{key:"markPotentiallyOrphaned",value:function(e,t){return this.Ls.add(t.toString()),yE.resolve()}},{key:"removeTarget",value:function(e,t){var n=this;this.Fs.ls(t.targetId).forEach((function(e){return n.Ls.add(e.toString())}));var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((function(e){var t=n;e.forEach((function(e){return t.Ls.add(e.toString())}))})).next((function(){return r.removeTargetData(e,t)}))}},{key:"ks",value:function(){this.$s=new Set}},{key:"Os",value:function(e){var t=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return yE.forEach(this.Ls,(function(r){var i=nE.fromPath(r);return t.qs(e,i).next((function(e){e||n.removeEntry(i,XT.min())}))})).next((function(){return t.$s=null,n.apply(e)}))}},{key:"updateLimboDocument",value:function(e,t){var n=this;return this.qs(e,t).next((function(e){e?n.Ls.delete(t.toString()):n.Ls.add(t.toString())}))}},{key:"xs",value:function(e){return 0}},{key:"qs",value:function(e,t){var n=this;return yE.or([function(){return yE.resolve(n.Fs.containsKey(t))},function(){return n.persistence.getTargetCache().containsKey(e,t)},function(){return n.persistence.Ms(e,t)}])}}],[{key:"Bs",value:function(e){return new t(e)}}]),t}(),pD=function(){"use strict";function t(n){e(l)(this,t),this.yt=n}return e(h)(t,[{key:"$",value:function(e,t,n,r){var i=this,a=new mE("createOrUpgrade",t);n<1&&r>=1&&(e.createObjectStore("owner"),function(e){e.createObjectStore("mutationQueues",{keyPath:"userId"}),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",aN,{unique:!0}),e.createObjectStore("documentMutations")}(e),vD(e),function(e){e.createObjectStore("remoteDocuments")}(e));var o=yE.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore("targetDocuments"),e.deleteObjectStore("targets"),e.deleteObjectStore("targetGlobal")}(e),vD(e)),o=o.next((function(){return function(e){var t=e.store("targetGlobal"),n={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:XT.min().toTimestamp(),targetCount:0};return t.put("targetGlobalKey",n)}(a)}))),n<4&&r>=4&&(0!==n&&(o=o.next((function(){return t=e,(n=a).store("mutations").W().next((function(e){t.deleteObjectStore("mutations"),t.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",aN,{unique:!0});var r=n.store("mutations"),i=e.map((function(e){return r.put(e)}));return yE.waitFor(i)}));var t,n}))),o=o.next((function(){!function(e){e.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)}))),n<5&&r>=5&&(o=o.next((function(){return i.Us(a)}))),n<6&&r>=6&&(o=o.next((function(){return function(e){e.createObjectStore("remoteDocumentGlobal")}(e),i.Ks(a)}))),n<7&&r>=7&&(o=o.next((function(){return i.Gs(a)}))),n<8&&r>=8&&(o=o.next((function(){return i.Qs(e,a)}))),n<9&&r>=9&&(o=o.next((function(){!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e)}))),n<10&&r>=10&&(o=o.next((function(){return i.js(a)}))),n<11&&r>=11&&(o=o.next((function(){!function(e){e.createObjectStore("bundles",{keyPath:"bundleId"})}(e),function(e){e.createObjectStore("namedQueries",{keyPath:"name"})}(e)}))),n<12&&r>=12&&(o=o.next((function(){!function(e){var t=e.createObjectStore("documentOverlays",{keyPath:_N});t.createIndex("collectionPathOverlayIndex",wN,{unique:!1}),t.createIndex("collectionGroupOverlayIndex",bN,{unique:!1})}(e)}))),n<13&&r>=13&&(o=o.next((function(){return function(e){var t=e.createObjectStore("remoteDocumentsV14",{keyPath:cN});t.createIndex("documentKeyIndex",lN),t.createIndex("collectionGroupIndex",hN)}(e)})).next((function(){return i.Ws(e,a)})).next((function(){return e.deleteObjectStore("remoteDocuments")}))),n<14&&r>=14&&(o=o.next((function(){return i.zs(e,a)}))),n<15&&r>=15&&(o=o.next((function(){return function(e){e.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),e.createObjectStore("indexState",{keyPath:yN}).createIndex("sequenceNumberIndex",mN,{unique:!1}),e.createObjectStore("indexEntries",{keyPath:gN}).createIndex("documentKeyIndex",kN,{unique:!1})}(e)}))),o}},{key:"Ks",value:function(e){var t=0;return e.store("remoteDocuments").Z((function(e,n){t+=AR(n)})).next((function(){var n={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)}))}},{key:"Us",value:function(e){var t=this,n=e.store("mutationQueues"),r=e.store("mutations");return n.W().next((function(n){return yE.forEach(n,(function(n){var i=t,a=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",a).next((function(t){return yE.forEach(t,(function(t){DT(t.userId===n.userId);var r=qN(i.yt,t);return CR(e,n.userId,r).next((function(){}))}))}))}))}))}},{key:"Gs",value:function(e){var t=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next((function(e){var r=[];return n.Z((function(n,i){var a=new ZT(n),o=[0,tN(a)];r.push(t.get(o).next((function(n){return n?yE.resolve():(r=a,t.put({targetId:0,path:tN(r),sequenceNumber:e.highestListenSequenceNumber}));var r})))})).next((function(){return yE.waitFor(r)}))}))}},{key:"Qs",value:function(t,n){t.createObjectStore("collectionParents",{keyPath:vN});var r=n.store("collectionParents"),i=new gR,a=function(e){if(i.add(e)){var t=e.lastSegment(),n=e.popLast();return r.put({collectionId:t,parent:tN(n)})}};return n.store("remoteDocuments").Z({X:!0},(function(e,t){var n=new ZT(e);return a(n.popLast())})).next((function(){return n.store("documentMutations").Z({X:!0},(function(t,n){var r=e(b)(t,3),i=(r[0],r[1]),o=(r[2],iN(i));return a(o.popLast())}))}))}},{key:"js",value:function(e){var t=this,n=e.store("targets");return n.Z((function(e,r){var i=VN(r),a=jN(t.yt,i);return n.put(a)}))}},{key:"Ws",value:function(e,t){var n=t.store("remoteDocuments"),r=[];return n.Z((function(e,n){var i,a=t.store("remoteDocumentsV14"),o=(i=n,i.document?new nE(ZT.fromString(i.document.name).popFirst(5)):i.noDocument?nE.fromSegments(i.noDocument.path):i.unknownDocument?nE.fromSegments(i.unknownDocument.path):RT()).path.toArray(),s={prefixPath:o.slice(0,o.length-2),collectionGroup:o[o.length-2],documentId:o[o.length-1],readTime:n.readTime||[0,0],unknownDocument:n.unknownDocument,noDocument:n.noDocument,document:n.document,hasCommittedMutations:!!n.hasCommittedMutations};r.push(a.put(s))})).next((function(){return yE.waitFor(r)}))}},{key:"zs",value:function(e,t){var n=this,r=t.store("mutations"),i=QR(this.yt),a=new hD(dD.Bs,this.yt.ie);return r.W().next((function(e){var r=n,o=new Map;return e.forEach((function(e){var t,n=null!==(t=o.get(e.userId))&&void 0!==t?t:dA();qN(r.yt,e).keys().forEach((function(e){return n=n.add(e)})),o.set(e.userId,n)})),yE.forEach(o,(function(e,n){var o=new xT(n),s=YN.re(r.yt,o),u=a.getIndexManager(o),c=NR.re(o,r.yt,u,a.referenceDelegate);return new nD(i,c,s,u).recalculateAndSaveOverlaysForDocumentKeys(new CN(t,CE.at),e).next()}))}))}}]),t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vD(e){e.createObjectStore("targetDocuments",{keyPath:dN}).createIndex("documentTargetsIndex",pN,{unique:!0}),e.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",fN,{unique:!0}),e.createObjectStore("targetGlobal")}var yD="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",mD=function(){"use strict";function t(n,r,i,a,o,s,u,c,h,f){var d=arguments.length>10&&void 0!==arguments[10]?arguments[10]:15;if(e(l)(this,t),this.allowTabSynchronization=n,this.persistenceKey=r,this.clientId=i,this.Hs=o,this.window=s,this.document=u,this.Js=h,this.Ys=f,this.Xs=d,this.Ss=null,this.Ds=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Zs=null,this.inForeground=!1,this.ti=null,this.ei=null,this.ni=Number.NEGATIVE_INFINITY,this.si=function(e){return Promise.resolve()},!t.C())throw new MT(OT.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new zR(this,a),this.ii=r+"main",this.yt=new ON(c),this.ri=new gE(this.ii,this.Xs,new pD(this.yt)),this.Cs=new LR(this.referenceDelegate,this.yt),this.remoteDocumentCache=QR(this.yt),this.Ns=new GN,this.window&&this.window.localStorage?this.oi=this.window.localStorage:(this.oi=null,!1===f&&CT("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return e(h)(t,[{key:"start",value:function(){var e=this;return this.ui().then((function(){var t=e;if(!e.isPrimary&&!e.allowTabSynchronization)throw new MT(OT.FAILED_PRECONDITION,yD);return e.ci(),e.ai(),e.hi(),e.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t.Cs.getHighestSequenceNumber(e)}))})).then((function(t){e.Ss=new CE(t,e.Js)})).then((function(){e.Ds=!0})).catch((function(t){return e.ri&&e.ri.close(),Promise.reject(t)}))}},{key:"li",value:function(t){var n,r=this;return this.si=(n=e(u)(e(_).mark((function n(i){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.started){e.next=2;break}return e.abrupt("return",t(i));case 2:case"end":return e.stop()}}),n)}))),function(e){return n.apply(this,arguments)}),t(this.isPrimary)}},{key:"setDatabaseDeletedListener",value:function(t){var n;this.ri.L((n=e(u)(e(_).mark((function n(r){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=null===r.newVersion,!e.t0){e.next=4;break}return e.next=4,t();case 4:case"end":return e.stop()}}),n)}))),function(e){return n.apply(this,arguments)}))}},{key:"setNetworkEnabled",value:function(t){var n=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Hs.enqueueAndForget(e(u)(e(_).mark((function t(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n.started,!e.t0){e.next=4;break}return e.next=4,n.ui();case 4:case"end":return e.stop()}}),t)})))))}},{key:"ui",value:function(){var e=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(t){return kD(t).put({clientId:e.clientId,updateTimeMs:Date.now(),networkEnabled:e.networkEnabled,inForeground:e.inForeground}).next((function(){var n=e;if(e.isPrimary)return e.fi(t).next((function(e){var t=n;e||(n.isPrimary=!1,n.Hs.enqueueRetryable((function(){return t.si(!1)})))}))})).next((function(){return e.di(t)})).next((function(n){return e.isPrimary&&!n?e._i(t).next((function(){return!1})):!!n&&e.wi(t).next((function(){return!0}))}))})).catch((function(t){if(wE(t))return ST("IndexedDbPersistence","Failed to extend owner lease: ",t),e.isPrimary;if(!e.allowTabSynchronization)throw t;return ST("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1})).then((function(t){var n=e;e.isPrimary!==t&&e.Hs.enqueueRetryable((function(){return n.si(t)})),e.isPrimary=t}))}},{key:"fi",value:function(e){var t=this;return gD(e).get("owner").next((function(e){return yE.resolve(t.mi(e))}))}},{key:"gi",value:function(e){return kD(e).delete(this.clientId)}},{key:"yi",value:function(){var t=this;return e(u)(e(_).mark((function n(){var r,i,a,o,s,u,c;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isPrimary||t.pi(t.ni,18e5)){e.next=23;break}return t.ni=Date.now(),e.next=4,t.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(e){var n=AN(e,"clientMetadata");return n.W().next((function(e){var r=t.Ii(e,18e5),i=e.filter((function(e){return-1===r.indexOf(e)}));return yE.forEach(i,(function(e){return n.delete(e.clientId)})).next((function(){return i}))}))})).catch((function(){return[]}));case 4:if(r=e.sent,i=!0,a=!1,o=void 0,!t.oi){e.next=23;break}for(e.prev=7,s=r[Symbol.iterator]();!(i=(u=s.next()).done);i=!0)c=u.value,t.oi.removeItem(t.Ti(c.clientId));e.next=15;break;case 11:e.prev=11,e.t0=e.catch(7),a=!0,o=e.t0;case 15:e.prev=15,e.prev=16,i||null==s.return||s.return();case 18:if(e.prev=18,!a){e.next=21;break}throw o;case 21:return e.finish(18);case 22:return e.finish(15);case 23:case"end":return e.stop()}}),n,null,[[7,11,15,23],[16,,18,22]])})))()}},{key:"hi",value:function(){var e=this;this.ei=this.Hs.enqueueAfterDelay("client_metadata_refresh",4e3,(function(){return e.ui().then((function(){return e.yi()})).then((function(){return e.hi()}))}))}},{key:"mi",value:function(e){return!!e&&e.ownerId===this.clientId}},{key:"di",value:function(e){var t=this;return this.Ys?yE.resolve(!0):gD(e).get("owner").next((function(n){var r=t;if(null!==n&&t.pi(n.leaseTimestampMs,5e3)&&!t.Ei(n.ownerId)){if(t.mi(n)&&t.networkEnabled)return!0;if(!t.mi(n)){if(!n.allowTabSynchronization)throw new MT(OT.FAILED_PRECONDITION,yD);return!1}}return!(!t.networkEnabled||!t.inForeground)||kD(e).W().next((function(e){return void 0===r.Ii(e,5e3).find((function(e){if(r.clientId!==e.clientId){var t=!r.networkEnabled&&e.networkEnabled,n=!r.inForeground&&e.inForeground,i=r.networkEnabled===e.networkEnabled;if(t||n&&i)return!0}return!1}))}))})).next((function(e){return t.isPrimary!==e&&ST("IndexedDbPersistence","Client ".concat(e?"is":"is not"," eligible for a primary lease.")),e}))}},{key:"shutdown",value:function(){var t=this;return e(u)(e(_).mark((function n(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.Ds=!1,t.Ai(),t.ei&&(t.ei.cancel(),t.ei=null),t.Ri(),t.bi(),e.next=7,t.ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],(function(e){var n=new CN(e,CE.at);return t._i(n).next((function(){return t.gi(n)}))}));case 7:t.ri.close(),t.Pi();case 9:case"end":return e.stop()}}),n)})))()}},{key:"Ii",value:function(e,t){var n=this;return e.filter((function(e){return n.pi(e.updateTimeMs,t)&&!n.Ei(e.clientId)}))}},{key:"vi",value:function(){var e=this;return this.runTransaction("getActiveClients","readonly",(function(t){return kD(t).W().next((function(t){return e.Ii(t,18e5).map((function(e){return e.clientId}))}))}))}},{key:"started",get:function(){return this.Ds}},{key:"getMutationQueue",value:function(e,t){return NR.re(e,this.yt,t,this.referenceDelegate)}},{key:"getTargetCache",value:function(){return this.Cs}},{key:"getRemoteDocumentCache",value:function(){return this.remoteDocumentCache}},{key:"getIndexManager",value:function(e){return new _R(e,this.yt.ie.databaseId)}},{key:"getDocumentOverlayCache",value:function(e){return YN.re(this.yt,e)}},{key:"getBundleCache",value:function(){return this.Ns}},{key:"runTransaction",value:function(e,t,n){var r=this;ST("IndexedDbPersistence","Starting transaction:",e);var i,a,o="readonly"===t?"readonly":"readwrite",s=15===(i=this.Xs)?SN:14===i?EN:13===i?TN:12===i?IN:11===i?xN:void RT();return this.ri.runTransaction(e,o,s,(function(i){return a=new CN(i,r.Ss?r.Ss.next():CE.at),"readwrite-primary"===t?r.fi(a).next((function(e){return!!e||r.di(a)})).next((function(t){var i=r;if(!t)throw CT("Failed to obtain primary lease for action '".concat(e,"'.")),r.isPrimary=!1,r.Hs.enqueueRetryable((function(){return i.si(!1)})),new MT(OT.FAILED_PRECONDITION,fE);return n(a)})).next((function(e){return r.wi(a).next((function(){return e}))})):r.Vi(a).next((function(){return n(a)}))})).then((function(e){return a.raiseOnCommittedEvent(),e}))}},{key:"Vi",value:function(e){var t=this;return gD(e).get("owner").next((function(e){if(null!==e&&t.pi(e.leaseTimestampMs,5e3)&&!t.Ei(e.ownerId)&&!t.mi(e)&&!(t.Ys||t.allowTabSynchronization&&e.allowTabSynchronization))throw new MT(OT.FAILED_PRECONDITION,yD)}))}},{key:"wi",value:function(e){var t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return gD(e).put("owner",t)}},{key:"_i",value:function(e){var t=this,n=gD(e);return n.get("owner").next((function(e){return t.mi(e)?(ST("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):yE.resolve()}))}},{key:"pi",value:function(e,t){var n=Date.now();return!(e<n-t||e>n&&(CT("Detected an update time that is in the future: ".concat(e," > ").concat(n)),1))}},{key:"ci",value:function(){var e=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ti=function(){var t=e;e.Hs.enqueueAndForget((function(){return t.inForeground="visible"===t.document.visibilityState,t.ui()}))},this.document.addEventListener("visibilitychange",this.ti),this.inForeground="visible"===this.document.visibilityState)}},{key:"Ri",value:function(){this.ti&&(this.document.removeEventListener("visibilitychange",this.ti),this.ti=null)}},{key:"ai",value:function(){var e,t=this;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Zs=function(){var e=t;t.Ai(),!ge()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")&&navigator.appVersion.match(/Version\/1[45]/)&&t.Hs.enterRestrictedMode(!0),t.Hs.enqueueAndForget((function(){return e.shutdown()}))},this.window.addEventListener("pagehide",this.Zs))}},{key:"bi",value:function(){this.Zs&&(this.window.removeEventListener("pagehide",this.Zs),this.Zs=null)}},{key:"Ei",value:function(e){var t;try{var n=null!==(null===(t=this.oi)||void 0===t?void 0:t.getItem(this.Ti(e)));return ST("IndexedDbPersistence","Client '".concat(e,"' ").concat(n?"is":"is not"," zombied in LocalStorage")),n}catch(e){return CT("IndexedDbPersistence","Failed to get zombied client id.",e),!1}}},{key:"Ai",value:function(){if(this.oi)try{this.oi.setItem(this.Ti(this.clientId),String(Date.now()))}catch(e){CT("Failed to set zombie client id.",e)}}},{key:"Pi",value:function(){if(this.oi)try{this.oi.removeItem(this.Ti(this.clientId))}catch(e){}}},{key:"Ti",value:function(e){return"firestore_zombie_".concat(this.persistenceKey,"_").concat(e)}}],[{key:"C",value:function(){return gE.C()}}]),t}();function gD(e){return AN(e,"owner")}function kD(e){return AN(e,"clientMetadata")}function _D(e,t){var n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}var wD=function(){"use strict";function t(n,r,i,a){e(l)(this,t),this.targetId=n,this.fromCache=r,this.Si=i,this.Di=a}return e(h)(t,null,[{key:"Ci",value:function(e,n){var r=dA(),i=dA(),a=!0,o=!1,s=void 0;try{for(var u,c=n.docChanges[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var l=u.value;switch(l.type){case 0:r=r.add(l.doc.key);break;case 1:i=i.add(l.doc.key)}}}catch(e){o=!0,s=e}finally{try{a||null==c.return||c.return()}finally{if(o)throw s}}return new t(e,n.fromCache,r,i)}}]),t}(),bD=function(){"use strict";function t(){e(l)(this,t),this.xi=!1}return e(h)(t,[{key:"initialize",value:function(e,t){this.Ni=e,this.indexManager=t,this.xi=!0}},{key:"getDocumentsMatchingQuery",value:function(e,t,n,r){var i=this;return this.ki(e,t).next((function(a){return a||i.Oi(e,t,r,n)})).next((function(n){return n||i.Mi(e,t)}))}},{key:"ki",value:function(t,n){var r=this;if(iC(n))return yE.resolve(null);var i=cC(n);return this.indexManager.getIndexType(t,i).next((function(a){return 0===a?null:(null!==n.limit&&1===a&&(n=hC(n,null,"F"),i=cC(n)),r.indexManager.getDocumentsMatchingTarget(t,i).next((function(a){var o=r,s=dA.apply(void 0,e(p)(a));return r.Ni.getDocuments(t,s).next((function(e){return o.indexManager.getMinOffset(t,i).next((function(r){var i=o.Fi(n,e);return o.$i(n,i,s,r.readTime)?o.ki(t,hC(n,null,"F")):o.Bi(t,i,n,r)}))}))})))}))}},{key:"Oi",value:function(e,t,n,r){var i=this;return iC(t)||r.isEqual(XT.min())?this.Mi(e,t):this.Ni.getDocuments(e,n).next((function(a){var o=i.Fi(t,a);return i.$i(t,o,n,r)?i.Mi(e,t):(ET()<=pt.DEBUG&&ST("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),pC(t)),i.Bi(e,o,t,uE(r,-1)))}))}},{key:"Fi",value:function(e,t){var n=new VS(mC(e));return t.forEach((function(t,r){vC(e,r)&&(n=n.add(r))})),n}},{key:"$i",value:function(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;var i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}},{key:"Mi",value:function(e,t){return ET()<=pt.DEBUG&&ST("QueryEngine","Using full collection scan to execute query:",pC(t)),this.Ni.getDocumentsMatchingQuery(e,t,lE.min())}},{key:"Bi",value:function(e,t,n,r){return this.Ni.getDocumentsMatchingQuery(e,n,r).next((function(e){return t.forEach((function(t){e=e.insert(t.key,t)})),e}))}}]),t}(),xD=function(){"use strict";function t(n,r,i,a){e(l)(this,t),this.persistence=n,this.Li=r,this.yt=a,this.qi=new FS(HT),this.Ui=new nA((function(e){return YS(e)}),JS),this.Ki=new Map,this.Gi=n.getRemoteDocumentCache(),this.Cs=n.getTargetCache(),this.Ns=n.getBundleCache(),this.Qi(i)}return e(h)(t,[{key:"Qi",value:function(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new nD(this.Gi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Gi.setIndexManager(this.indexManager),this.Li.initialize(this.localDocuments,this.indexManager)}},{key:"collectGarbage",value:function(e){var t=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return e.collect(n,t.qi)}))}}]),t}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ID(e,t,n,r){return new xD(e,t,n,r)}function TD(e,t){return ED.apply(this,arguments)}function ED(){return(ED=e(u)(e(_).mark((function t(n,r){var i;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=PT(n),e.next=3,i.persistence.runTransaction("Handle user change","readonly",(function(e){var t;return i.mutationQueue.getAllMutationBatches(e).next((function(n){return t=n,i.Qi(r),i.mutationQueue.getAllMutationBatches(e)})).next((function(n){var r=[],a=[],o=dA(),s=!0,u=!1,c=void 0;try{for(var l,h=t[Symbol.iterator]();!(s=(l=h.next()).done);s=!0){var f=l.value;r.push(f.batchId);var d=!0,p=!1,v=void 0;try{for(var y,m=f.mutations[Symbol.iterator]();!(d=(y=m.next()).done);d=!0){var g=y.value;o=o.add(g.key)}}catch(e){p=!0,v=e}finally{try{d||null==m.return||m.return()}finally{if(p)throw v}}}}catch(e){u=!0,c=e}finally{try{s||null==h.return||h.return()}finally{if(u)throw c}}var k=!0,_=!1,w=void 0;try{for(var b,x=n[Symbol.iterator]();!(k=(b=x.next()).done);k=!0){var I=b.value;a.push(I.batchId);var T=!0,E=!1,S=void 0;try{for(var C,A=I.mutations[Symbol.iterator]();!(T=(C=A.next()).done);T=!0){var N=C.value;o=o.add(N.key)}}catch(e){E=!0,S=e}finally{try{T||null==A.return||A.return()}finally{if(E)throw S}}}}catch(e){_=!0,w=e}finally{try{k||null==x.return||x.return()}finally{if(_)throw w}}return i.localDocuments.getDocuments(e,o).next((function(e){return{ji:e,removedBatchIds:r,addedBatchIds:a}}))}))}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function SD(e,t){var n=PT(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(e){var r=t.batch.keys(),i=n.Gi.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){var i=n.batch,a=i.keys(),o=yE.resolve();return a.forEach((function(e){o=o.next((function(){return r.getEntry(t,e)})).next((function(t){var a=n.docVersions.get(e);DT(null!==a),t.version.compareTo(a)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))}))})),o.next((function(){return e.mutationQueue.removeMutationBatch(t,i)}))}(n,e,t,i).next((function(){return i.apply(e)})).next((function(){return n.mutationQueue.performConsistencyCheck(e)})).next((function(){return n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)})).next((function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){for(var t=dA(),n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))})).next((function(){return n.localDocuments.getDocuments(e,r)}))}))}function CD(e){var t=PT(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(function(e){return t.Cs.getLastRemoteSnapshotVersion(e)}))}function AD(e,t){var n=PT(e),r=t.snapshotVersion,i=n.qi;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(e){var a=n.Gi.newChangeBuffer({trackRemovals:!0});i=n.qi;var o=[];t.targetChanges.forEach((function(a,s){var u=i.get(s);if(u){o.push(n.Cs.removeMatchingKeys(e,a.removedDocuments,s).next((function(){return n.Cs.addMatchingKeys(e,a.addedDocuments,s)})));var c,l,h,f=u.withSequenceNumber(e.currentSequenceNumber);t.targetMismatches.has(s)?f=f.withResumeToken(UE.EMPTY_BYTE_STRING,XT.min()).withLastLimboFreeSnapshotVersion(XT.min()):a.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(a.resumeToken,r)),i=i.insert(s,f),l=f,h=a,(0===(c=u).resumeToken.approximateByteSize()||l.snapshotVersion.toMicroseconds()-c.snapshotVersion.toMicroseconds()>=3e8||h.addedDocuments.size+h.modifiedDocuments.size+h.removedDocuments.size>0)&&o.push(n.Cs.updateTargetData(e,f))}}));var s=iA(),u=dA();if(t.documentUpdates.forEach((function(r){t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),o.push(ND(e,a,t.documentUpdates).next((function(e){s=e.Wi,u=e.zi}))),!r.isEqual(XT.min())){var c=n.Cs.getLastRemoteSnapshotVersion(e).next((function(t){return n.Cs.setTargetsMetadata(e,e.currentSequenceNumber,r)}));o.push(c)}return yE.waitFor(o).next((function(){return a.apply(e)})).next((function(){return n.localDocuments.getLocalViewOfDocuments(e,s,u)})).next((function(){return s}))})).then((function(e){return n.qi=i,e}))}function ND(e,t,n){var r=dA(),i=dA();return n.forEach((function(e){return r=r.add(e)})),t.getEntries(e,r).next((function(e){var r=iA();return n.forEach((function(n,a){var o=e.get(n);a.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),a.isNoDocument()&&a.version.isEqual(XT.min())?(t.removeEntry(n,a.readTime),r=r.insert(n,a)):!o.isValidDocument()||a.version.compareTo(o.version)>0||0===a.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(a),r=r.insert(n,a)):ST("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",a.version)})),{Wi:r,zi:i}}))}function RD(e,t){var n=PT(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(e){return void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)}))}function DD(e,t){var n=PT(e);return n.persistence.runTransaction("Allocate target","readwrite",(function(e){var r;return n.Cs.getTargetData(e,t).next((function(i){return i?(r=i,yE.resolve(r)):n.Cs.allocateTargetId(e).next((function(i){return r=new PN(t,i,0,e.currentSequenceNumber),n.Cs.addTargetData(e,r).next((function(){return r}))}))}))})).then((function(e){var r=n.qi.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.qi=n.qi.insert(e.targetId,e),n.Ui.set(t,e.targetId)),e}))}function PD(e,t,n){return OD.apply(this,arguments)}function OD(){return(OD=e(u)(e(_).mark((function t(n,r,i){var a,o,s;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=PT(n),o=a.qi.get(r),s=i?"readwrite":"readwrite-primary",e.prev=1,e.t0=i,e.t0){e.next=6;break}return e.next=6,a.persistence.runTransaction("Release target",s,(function(e){return a.persistence.referenceDelegate.removeTarget(e,o)}));case 6:e.next=13;break;case 8:if(e.prev=8,e.t1=e.catch(1),wE(e.t1)){e.next=12;break}throw e.t1;case 12:ST("LocalStore","Failed to update sequence numbers for target ".concat(r,": ").concat(e.t1));case 13:a.qi=a.qi.remove(r),a.Ui.delete(o.target);case 14:case"end":return e.stop()}}),t,null,[[1,8]])})))).apply(this,arguments)}function MD(e,t,n){var r=PT(e),i=XT.min(),a=dA();return r.persistence.runTransaction("Execute query","readonly",(function(e){return function(e,t,n){var r=PT(e),i=r.Ui.get(n);return void 0!==i?yE.resolve(r.qi.get(i)):r.Cs.getTargetData(t,n)}(r,e,cC(t)).next((function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.Cs.getMatchingKeysForTargetId(e,t.targetId).next((function(e){a=e}))})).next((function(){return r.Li.getDocumentsMatchingQuery(e,t,n?i:XT.min(),n?a:dA())})).next((function(e){return UD(r,yC(t),e),{documents:e,Hi:a}}))}))}function LD(e,t){var n=PT(e),r=PT(n.Cs),i=n.qi.get(t);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(e){return r.ne(e,t).next((function(e){return e?e.target:null}))}))}function FD(e,t){var n=PT(e),r=n.Ki.get(t)||XT.min();return n.persistence.runTransaction("Get new document changes","readonly",(function(e){return n.Gi.getAllFromCollectionGroup(e,t,uE(r,-1),Number.MAX_SAFE_INTEGER)})).then((function(e){return UD(n,t,e),e}))}function UD(e,t,n){var r=e.Ki.get(t)||XT.min();n.forEach((function(e,t){t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.Ki.set(t,r)}function qD(e,t,n,r){return VD.apply(this,arguments)}function VD(){return(VD=e(u)(e(_).mark((function t(n,r,i,a){var o,s,u,c,l,h,f,d,p,v,y,m,g;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(o=PT(n),s=dA(),u=iA(),c=!0,l=!1,h=void 0,e.prev=3,f=i[Symbol.iterator]();!(c=(d=f.next()).done);c=!0)p=d.value,v=r.Ji(p.metadata.name),p.document&&(s=s.add(v)),(y=r.Yi(p)).setReadTime(r.Xi(p.metadata.readTime)),u=u.insert(v,y);e.next=11;break;case 7:e.prev=7,e.t0=e.catch(3),l=!0,h=e.t0;case 11:e.prev=11,e.prev=12,c||null==f.return||f.return();case 14:if(e.prev=14,!l){e.next=17;break}throw h;case 17:return e.finish(14);case 18:return e.finish(11);case 19:return m=o.Gi.newChangeBuffer({trackRemovals:!0}),e.next=22,DD(o,(t=a,cC(rC(ZT.fromString("__bundle__/docs/".concat(t))))));case 22:return g=e.sent,e.abrupt("return",o.persistence.runTransaction("Apply bundle documents","readwrite",(function(e){return ND(e,m,u).next((function(t){return m.apply(e),t})).next((function(t){return o.Cs.removeMatchingKeysForTargetId(e,g.targetId).next((function(){return o.Cs.addMatchingKeys(e,s,g.targetId)})).next((function(){return o.localDocuments.getLocalViewOfDocuments(e,t.Wi,t.zi)})).next((function(){return t.Wi}))}))})));case 24:case"end":return e.stop()}var t}),t,null,[[3,7,11,19],[12,,14,18]])})))).apply(this,arguments)}function jD(e,t){return BD.apply(this,arguments)}function BD(){return BD=e(u)(e(_).mark((function t(n,r){var i,a,o,s=arguments;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=s.length>2&&void 0!==s[2]?s[2]:dA(),e.next=3,DD(n,cC(BN(r.bundledQuery)));case 3:return a=e.sent,o=PT(n),e.abrupt("return",o.persistence.runTransaction("Save named query","readwrite",(function(e){var t=DA(r.readTime);if(a.snapshotVersion.compareTo(t)>=0)return o.Ns.saveNamedQuery(e,r);var n=a.withResumeToken(UE.EMPTY_BYTE_STRING,t);return o.qi=o.qi.insert(n.targetId,n),o.Cs.updateTargetData(e,n).next((function(){return o.Cs.removeMatchingKeysForTargetId(e,a.targetId)})).next((function(){return o.Cs.addMatchingKeys(e,i,a.targetId)})).next((function(){return o.Ns.saveNamedQuery(e,r)}))})));case 6:case"end":return e.stop()}}),t)}))),BD.apply(this,arguments)}function KD(e,t){return"firestore_clients_".concat(e,"_").concat(t)}function zD(e,t,n){var r="firestore_mutations_".concat(e,"_").concat(n);return t.isAuthenticated()&&(r+="_".concat(t.uid)),r}function WD(e,t){return"firestore_targets_".concat(e,"_").concat(t)}var GD=function(){"use strict";function t(n,r,i,a){e(l)(this,t),this.user=n,this.batchId=r,this.state=i,this.error=a}return e(h)(t,[{key:"tr",value:function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}],[{key:"Zi",value:function(e,n,r){var i,a=JSON.parse(r),o="object"==typeof a&&-1!==["pending","acknowledged","rejected"].indexOf(a.state)&&(void 0===a.error||"object"==typeof a.error);return o&&a.error&&((o="string"==typeof a.error.message&&"string"==typeof a.error.code)&&(i=new MT(a.error.code,a.error.message))),o?new t(e,n,a.state,i):(CT("SharedClientState","Failed to parse mutation state for ID '".concat(n,"': ").concat(r)),null)}}]),t}(),HD=function(){"use strict";function t(n,r,i){e(l)(this,t),this.targetId=n,this.state=r,this.error=i}return e(h)(t,[{key:"tr",value:function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}],[{key:"Zi",value:function(e,n){var r,i=JSON.parse(n),a="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return a&&i.error&&((a="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new MT(i.error.code,i.error.message))),a?new t(e,i.state,r):(CT("SharedClientState","Failed to parse target state for ID '".concat(e,"': ").concat(n)),null)}}]),t}(),QD=function(){"use strict";function t(n,r){e(l)(this,t),this.clientId=n,this.activeTargetIds=r}return e(h)(t,null,[{key:"Zi",value:function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,a=vA(),o=0;i&&o<r.activeTargetIds.length;++o)i=LE(r.activeTargetIds[o]),a=a.add(r.activeTargetIds[o]);return i?new t(e,a):(CT("SharedClientState","Failed to parse client data for instance '".concat(e,"': ").concat(n)),null)}}]),t}(),YD=function(){"use strict";function t(n,r){e(l)(this,t),this.clientId=n,this.onlineState=r}return e(h)(t,null,[{key:"Zi",value:function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(CT("SharedClientState","Failed to parse online state: ".concat(e)),null)}}]),t}(),JD=function(){"use strict";function t(){e(l)(this,t),this.activeTargetIds=vA()}return e(h)(t,[{key:"er",value:function(e){this.activeTargetIds=this.activeTargetIds.add(e)}},{key:"nr",value:function(e){this.activeTargetIds=this.activeTargetIds.delete(e)}},{key:"tr",value:function(){var e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}]),t}(),XD=function(){"use strict";function t(n,r,i,a,o){e(l)(this,t),this.window=n,this.Hs=r,this.persistenceKey=i,this.sr=a,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ir=this.rr.bind(this),this.ur=new FS(HT),this.started=!1,this.cr=[];var s,u=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=o,this.ar=KD(this.persistenceKey,this.sr),this.hr=(s=this.persistenceKey,"firestore_sequence_number_".concat(s)),this.ur=this.ur.insert(this.sr,new JD),this.lr=new RegExp("^firestore_clients_".concat(u,"_([^_]*)$")),this.dr=new RegExp("^firestore_mutations_".concat(u,"_(\\d+)(?:_(.*))?$")),this._r=new RegExp("^firestore_targets_".concat(u,"_(\\d+)$")),this.wr=function(e){return"firestore_online_state_".concat(e)}(this.persistenceKey),this.mr=function(e){return"firestore_bundle_loaded_v2_".concat(e)}(this.persistenceKey),this.window.addEventListener("storage",this.ir)}return e(h)(t,[{key:"start",value:function(){var t=this;return e(u)(e(_).mark((function n(){var r,i,a,o,s,u,c,l,h,f,d,p,v,y,m,g,k;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.syncEngine.vi();case 2:r=e.sent,i=!0,a=!1,o=void 0,e.prev=4,s=r[Symbol.iterator]();case 6:if(i=(u=s.next()).done){e.next=15;break}if((c=u.value)!==t.sr){e.next=10;break}return e.abrupt("continue",12);case 10:(l=t.getItem(KD(t.persistenceKey,c)))&&(h=QD.Zi(c,l))&&(t.ur=t.ur.insert(h.clientId,h));case 12:i=!0,e.next=6;break;case 15:e.next=21;break;case 17:e.prev=17,e.t0=e.catch(4),a=!0,o=e.t0;case 21:e.prev=21,e.prev=22,i||null==s.return||s.return();case 24:if(e.prev=24,!a){e.next=27;break}throw o;case 27:return e.finish(24);case 28:return e.finish(21);case 29:for(t.gr(),(f=t.storage.getItem(t.wr))&&(d=t.yr(f))&&t.pr(d),p=!0,v=!1,y=void 0,e.prev=33,m=t.cr[Symbol.iterator]();!(p=(g=m.next()).done);p=!0)k=g.value,t.rr(k);e.next=41;break;case 37:e.prev=37,e.t1=e.catch(33),v=!0,y=e.t1;case 41:e.prev=41,e.prev=42,p||null==m.return||m.return();case 44:if(e.prev=44,!v){e.next=47;break}throw y;case 47:return e.finish(44);case 48:return e.finish(41);case 49:t.cr=[],t.window.addEventListener("pagehide",(function(){return t.shutdown()})),t.started=!0;case 50:case"end":return e.stop()}}),n,null,[[4,17,21,29],[22,,24,28],[33,37,41,49],[42,,44,48]])})))()}},{key:"writeSequenceNumber",value:function(e){this.setItem(this.hr,JSON.stringify(e))}},{key:"getAllActiveQueryTargets",value:function(){return this.Ir(this.ur)}},{key:"isActiveQueryTarget",value:function(e){var t=!1;return this.ur.forEach((function(n,r){r.activeTargetIds.has(e)&&(t=!0)})),t}},{key:"addPendingMutation",value:function(e){this.Tr(e,"pending")}},{key:"updateMutationState",value:function(e,t,n){this.Tr(e,t,n),this.Er(e)}},{key:"addLocalQueryTarget",value:function(e){var t="not-current";if(this.isActiveQueryTarget(e)){var n=this.storage.getItem(WD(this.persistenceKey,e));if(n){var r=HD.Zi(e,n);r&&(t=r.state)}}return this.Ar.er(e),this.gr(),t}},{key:"removeLocalQueryTarget",value:function(e){this.Ar.nr(e),this.gr()}},{key:"isLocalQueryTarget",value:function(e){return this.Ar.activeTargetIds.has(e)}},{key:"clearQueryState",value:function(e){this.removeItem(WD(this.persistenceKey,e))}},{key:"updateQueryState",value:function(e,t,n){this.Rr(e,t,n)}},{key:"handleUserChange",value:function(e,t,n){var r=this;t.forEach((function(e){r.Er(e)})),this.currentUser=e,n.forEach((function(e){r.addPendingMutation(e)}))}},{key:"setOnlineState",value:function(e){this.br(e)}},{key:"notifyBundleLoaded",value:function(e){this.Pr(e)}},{key:"shutdown",value:function(){this.started&&(this.window.removeEventListener("storage",this.ir),this.removeItem(this.ar),this.started=!1)}},{key:"getItem",value:function(e){var t=this.storage.getItem(e);return ST("SharedClientState","READ",e,t),t}},{key:"setItem",value:function(e,t){ST("SharedClientState","SET",e,t),this.storage.setItem(e,t)}},{key:"removeItem",value:function(e){ST("SharedClientState","REMOVE",e),this.storage.removeItem(e)}},{key:"rr",value:function(t){var n=t;if(n.storageArea===this.storage){if(ST("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ar)return void CT("Received WebStorage notification for local change. Another client might have garbage-collected our state");var r=this;this.Hs.enqueueRetryable(e(u)(e(_).mark((function t(){var i,a,o,s,u,c,l;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.started){e.next=42;break}if(null===n.key){e.next=40;break}if(!r.lr.test(n.key)){e.next=11;break}if(null!=n.newValue){e.next=6;break}return i=r.vr(n.key),e.abrupt("return",r.Vr(i,null));case 6:if(!(a=r.Sr(n.key,n.newValue))){e.next=9;break}return e.abrupt("return",r.Vr(a.clientId,a));case 9:e.next=40;break;case 11:if(!r.dr.test(n.key)){e.next=18;break}if(null===n.newValue){e.next=16;break}if(!(o=r.Dr(n.key,n.newValue))){e.next=16;break}return e.abrupt("return",r.Cr(o));case 16:e.next=40;break;case 18:if(!r._r.test(n.key)){e.next=25;break}if(null===n.newValue){e.next=23;break}if(!(s=r.Nr(n.key,n.newValue))){e.next=23;break}return e.abrupt("return",r.kr(s));case 23:e.next=40;break;case 25:if(n.key!==r.wr){e.next=32;break}if(null===n.newValue){e.next=30;break}if(!(u=r.yr(n.newValue))){e.next=30;break}return e.abrupt("return",r.pr(u));case 30:e.next=40;break;case 32:if(n.key!==r.hr){e.next=36;break}(c=function(e){var t=CE.at;if(null!=e)try{var n=JSON.parse(e);DT("number"==typeof n),t=n}catch(e){CT("SharedClientState","Failed to read sequence number from WebStorage",e)}return t}(n.newValue))!==CE.at&&r.sequenceNumberHandler(c),e.next=40;break;case 36:if(n.key!==r.mr){e.next=40;break}return l=r.Or(n.newValue),e.next=40,Promise.all(l.map((function(e){return r.syncEngine.Mr(e)})));case 40:e.next=43;break;case 42:r.cr.push(n);case 43:case"end":return e.stop()}}),t)}))))}}},{key:"Ar",get:function(){return this.ur.get(this.sr)}},{key:"gr",value:function(){this.setItem(this.ar,this.Ar.tr())}},{key:"Tr",value:function(e,t,n){var r=new GD(this.currentUser,e,t,n),i=zD(this.persistenceKey,this.currentUser,e);this.setItem(i,r.tr())}},{key:"Er",value:function(e){var t=zD(this.persistenceKey,this.currentUser,e);this.removeItem(t)}},{key:"br",value:function(e){var t={clientId:this.sr,onlineState:e};this.storage.setItem(this.wr,JSON.stringify(t))}},{key:"Rr",value:function(e,t,n){var r=WD(this.persistenceKey,e),i=new HD(e,t,n);this.setItem(r,i.tr())}},{key:"Pr",value:function(e){var t=JSON.stringify(Array.from(e));this.setItem(this.mr,t)}},{key:"vr",value:function(e){var t=this.lr.exec(e);return t?t[1]:null}},{key:"Sr",value:function(e,t){var n=this.vr(e);return QD.Zi(n,t)}},{key:"Dr",value:function(e,t){var n=this.dr.exec(e),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return GD.Zi(new xT(i),r,t)}},{key:"Nr",value:function(e,t){var n=this._r.exec(e),r=Number(n[1]);return HD.Zi(r,t)}},{key:"yr",value:function(e){return YD.Zi(e)}},{key:"Or",value:function(e){return JSON.parse(e)}},{key:"Cr",value:function(t){var n=this;return e(u)(e(_).mark((function r(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.user.uid!==n.currentUser.uid){e.next=2;break}return e.abrupt("return",n.syncEngine.Fr(t.batchId,t.state,t.error));case 2:ST("SharedClientState","Ignoring mutation for non-active user ".concat(t.user.uid));case 3:case"end":return e.stop()}}),r)})))()}},{key:"kr",value:function(e){return this.syncEngine.$r(e.targetId,e.state,e.error)}},{key:"Vr",value:function(e,t){var n=this,r=t?this.ur.insert(e,t):this.ur.remove(e),i=this.Ir(this.ur),a=this.Ir(r),o=[],s=[];return a.forEach((function(e){i.has(e)||o.push(e)})),i.forEach((function(e){a.has(e)||s.push(e)})),this.syncEngine.Br(o,s).then((function(){n.ur=r}))}},{key:"pr",value:function(e){this.ur.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}},{key:"Ir",value:function(e){var t=vA();return e.forEach((function(e,n){t=t.unionWith(n.activeTargetIds)})),t}}],[{key:"C",value:function(e){return!(!e||!e.localStorage)}}]),t}(),$D=function(){"use strict";function t(){e(l)(this,t),this.Lr=new JD,this.qr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return e(h)(t,[{key:"addPendingMutation",value:function(e){}},{key:"updateMutationState",value:function(e,t,n){}},{key:"addLocalQueryTarget",value:function(e){return this.Lr.er(e),this.qr[e]||"not-current"}},{key:"updateQueryState",value:function(e,t,n){this.qr[e]=t}},{key:"removeLocalQueryTarget",value:function(e){this.Lr.nr(e)}},{key:"isLocalQueryTarget",value:function(e){return this.Lr.activeTargetIds.has(e)}},{key:"clearQueryState",value:function(e){delete this.qr[e]}},{key:"getAllActiveQueryTargets",value:function(){return this.Lr.activeTargetIds}},{key:"isActiveQueryTarget",value:function(e){return this.Lr.activeTargetIds.has(e)}},{key:"start",value:function(){return this.Lr=new JD,Promise.resolve()}},{key:"handleUserChange",value:function(e,t,n){}},{key:"setOnlineState",value:function(e){}},{key:"shutdown",value:function(){}},{key:"writeSequenceNumber",value:function(e){}},{key:"notifyBundleLoaded",value:function(e){}}]),t}(),ZD=function(){"use strict";function t(){e(l)(this,t)}return e(h)(t,[{key:"Ur",value:function(e){}},{key:"shutdown",value:function(){}}]),t}(),eP=function(){"use strict";function t(){var n=this;e(l)(this,t),this.Kr=function(){return n.Gr()},this.Qr=function(){return n.jr()},this.Wr=[],this.zr()}return e(h)(t,[{key:"Ur",value:function(e){this.Wr.push(e)}},{key:"shutdown",value:function(){window.removeEventListener("online",this.Kr),window.removeEventListener("offline",this.Qr)}},{key:"zr",value:function(){window.addEventListener("online",this.Kr),window.addEventListener("offline",this.Qr)}},{key:"Gr",value:function(){ST("ConnectivityMonitor","Network connectivity changed: AVAILABLE");var e=!0,t=!1,n=void 0;try{for(var r,i=this.Wr[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){(0,r.value)(0)}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}},{key:"jr",value:function(){ST("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");var e=!0,t=!1,n=void 0;try{for(var r,i=this.Wr[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){(0,r.value)(1)}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}}],[{key:"C",value:function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}]),t}(),tP={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"},nP=function(){"use strict";function t(n){e(l)(this,t),this.Hr=n.Hr,this.Jr=n.Jr}return e(h)(t,[{key:"Yr",value:function(e){this.Xr=e}},{key:"Zr",value:function(e){this.eo=e}},{key:"onMessage",value:function(e){this.no=e}},{key:"close",value:function(){this.Jr()}},{key:"send",value:function(e){this.Hr(e)}},{key:"so",value:function(){this.Xr()}},{key:"io",value:function(e){this.eo(e)}},{key:"ro",value:function(e){this.no(e)}}]),t}(),rP=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t){var i;return e(l)(this,r),(i=n.call(this,t)).forceLongPolling=t.forceLongPolling,i.autoDetectLongPolling=t.autoDetectLongPolling,i.useFetchStreams=t.useFetchStreams,e(gw)(i)}return e(h)(r,[{key:"fo",value:function(e,t,n,r){return new Promise((function(i,a){var o=new wT;o.setWithCredentials(!0),o.listenOnce(yT.COMPLETE,(function(){try{switch(o.getLastErrorCode()){case vT.NO_ERROR:var t=o.getResponseJson();ST("Connection","XHR received:",JSON.stringify(t)),i(t);break;case vT.TIMEOUT:ST("Connection",'RPC "'+e+'" timed out'),a(new MT(OT.DEADLINE_EXCEEDED,"Request time out"));break;case vT.HTTP_ERROR:var n=o.getStatus();if(ST("Connection",'RPC "'+e+'" failed with status:',n,"response text:",o.getResponseText()),n>0){var r=o.getResponseJson();Array.isArray(r)&&(r=r[0]);var s=null==r?void 0:r.error;if(s&&s.status&&s.message){var u=(c=s.status,l=c.toLowerCase().replace(/_/g,"-"),Object.values(OT).indexOf(l)>=0?l:OT.UNKNOWN);a(new MT(u,s.message))}else a(new MT(OT.UNKNOWN,"Server responded with status "+o.getStatus()))}else a(new MT(OT.UNAVAILABLE,"Connection failed."));break;default:RT()}}finally{ST("Connection",'RPC "'+e+'" completed.')}var c,l}));var s=JSON.stringify(r);o.send(t,"POST",s,n,15)}))}},{key:"wo",value:function(e,t,n){var r=[this.oo,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=dT(),a=pT(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new kT({})),this.lo(o.initMessageHeaders,t,n),o.encodeInitMessageHeaders=!0;var s=r.join("");ST("Connection","Creating WebChannel: "+s,o);var u=i.createWebChannel(s,o),c=!1,l=!1,h=new nP({Hr:function(e){l?ST("Connection","Not sending because WebChannel is closed:",e):(c||(ST("Connection","Opening WebChannel transport."),u.open(),c=!0),ST("Connection","WebChannel sending:",e),u.send(e))},Jr:function(){return u.close()}}),f=function(e,t,n){e.listen(t,(function(e){try{n(e)}catch(e){setTimeout((function(){throw e}),0)}}))};return f(u,_T.EventType.OPEN,(function(){l||ST("Connection","WebChannel transport opened.")})),f(u,_T.EventType.CLOSE,(function(){l||(l=!0,ST("Connection","WebChannel transport closed"),h.io())})),f(u,_T.EventType.ERROR,(function(e){l||(l=!0,AT("Connection","WebChannel transport errored:",e),h.io(new MT(OT.UNAVAILABLE,"The operation could not be completed")))})),f(u,_T.EventType.MESSAGE,(function(e){var t;if(!l){var n=e.data[0];DT(!!n);var r=n,i=r.error||(null===(t=r[0])||void 0===t?void 0:t.error);if(i){ST("Connection","WebChannel received error:",i);var a=i.status,o=function(e){var t=YC[e];if(void 0!==t)return tA(t)}(a),s=i.message;void 0===o&&(o=OT.INTERNAL,s="Unknown error status: "+a+" with message "+i.message),l=!0,h.io(new MT(o,s)),u.close()}else ST("Connection","WebChannel received:",n),h.ro(n)}})),f(a,mT.STAT_EVENT,(function(e){e.stat===gT.PROXY?ST("Connection","Detected buffering proxy"):e.stat===gT.NOPROXY&&ST("Connection","Detected no buffering proxy")})),setTimeout((function(){h.so()}),0),h}}]),r}(function(){"use strict";function t(n){e(l)(this,t),this.databaseInfo=n,this.databaseId=n.databaseId;var r=n.ssl?"https":"http";this.oo=r+"://"+n.host,this.uo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return e(h)(t,[{key:"co",get:function(){return!1}},{key:"ao",value:function(e,t,n,r,i){var a=this.ho(e,t);ST("RestConnection","Sending: ",a,n);var o={};return this.lo(o,r,i),this.fo(e,a,o,n).then((function(e){return ST("RestConnection","Received: ",e),e}),(function(t){throw AT("RestConnection","".concat(e," failed with error: "),t,"url: ",a,"request:",n),t}))}},{key:"_o",value:function(e,t,n,r,i,a){return this.ao(e,t,n,r,i)}},{key:"lo",value:function(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+IT,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((function(t,n){return e[n]=t})),n&&n.headers.forEach((function(t,n){return e[n]=t}))}},{key:"ho",value:function(e,t){var n=tP[e];return"".concat(this.oo,"/v1/").concat(t,":").concat(n)}}]),t}());
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iP(){return"undefined"!=typeof window?window:null}function aP(){return"undefined"!=typeof document?document:null}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oP(e){return new CA(e,!0)}var sP=function(){"use strict";function t(n,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;e(l)(this,t),this.Hs=n,this.timerId=r,this.mo=i,this.yo=a,this.po=o,this.Io=0,this.To=null,this.Eo=Date.now(),this.reset()}return e(h)(t,[{key:"reset",value:function(){this.Io=0}},{key:"Ao",value:function(){this.Io=this.po}},{key:"Ro",value:function(e){var t=this;this.cancel();var n=Math.floor(this.Io+this.bo()),r=Math.max(0,Date.now()-this.Eo),i=Math.max(0,n-r);i>0&&ST("ExponentialBackoff","Backing off for ".concat(i," ms (base delay: ").concat(this.Io," ms, delay with jitter: ").concat(n," ms, last attempt: ").concat(r," ms ago)")),this.To=this.Hs.enqueueAfterDelay(this.timerId,i,(function(){return t.Eo=Date.now(),e()})),this.Io*=this.yo,this.Io<this.mo&&(this.Io=this.mo),this.Io>this.po&&(this.Io=this.po)}},{key:"Po",value:function(){null!==this.To&&(this.To.skipDelay(),this.To=null)}},{key:"cancel",value:function(){null!==this.To&&(this.To.cancel(),this.To=null)}},{key:"bo",value:function(){return(Math.random()-.5)*this.Io}}]),t}(),uP=function(){"use strict";function t(n,r,i,a,o,s,u,c){e(l)(this,t),this.Hs=n,this.vo=i,this.Vo=a,this.connection=o,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=u,this.listener=c,this.state=0,this.So=0,this.Do=null,this.Co=null,this.stream=null,this.xo=new sP(n,r)}return e(h)(t,[{key:"No",value:function(){return 1===this.state||5===this.state||this.ko()}},{key:"ko",value:function(){return 2===this.state||3===this.state}},{key:"start",value:function(){4!==this.state?this.auth():this.Oo()}},{key:"stop",value:function(){var t=this;return e(u)(e(_).mark((function n(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.No(),!e.t0){e.next=4;break}return e.next=4,t.close(0);case 4:case"end":return e.stop()}}),n)})))()}},{key:"Mo",value:function(){this.state=0,this.xo.reset()}},{key:"Fo",value:function(){var e=this;this.ko()&&null===this.Do&&(this.Do=this.Hs.enqueueAfterDelay(this.vo,6e4,(function(){return e.$o()})))}},{key:"Bo",value:function(e){this.Lo(),this.stream.send(e)}},{key:"$o",value:function(){var t=this;return e(u)(e(_).mark((function n(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.ko()){e.next=2;break}return e.abrupt("return",t.close(0));case 2:case"end":return e.stop()}}),n)})))()}},{key:"Lo",value:function(){this.Do&&(this.Do.cancel(),this.Do=null)}},{key:"qo",value:function(){this.Co&&(this.Co.cancel(),this.Co=null)}},{key:"close",value:function(t,n){var r=this;return e(u)(e(_).mark((function i(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.Lo(),r.qo(),r.xo.cancel(),r.So++,4!==t?r.xo.reset():n&&n.code===OT.RESOURCE_EXHAUSTED?(CT(n.toString()),CT("Using maximum backoff delay to prevent overloading the backend."),r.xo.Ao()):n&&n.code===OT.UNAUTHENTICATED&&3!==r.state&&(r.authCredentialsProvider.invalidateToken(),r.appCheckCredentialsProvider.invalidateToken()),null!==r.stream&&(r.Uo(),r.stream.close(),r.stream=null),r.state=t,e.next=9,r.listener.Zr(n);case 9:case"end":return e.stop()}}),i)})))()}},{key:"Uo",value:function(){}},{key:"auth",value:function(){var t=this;this.state=1;var n=this.Ko(this.So),r=this.So;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((function(n){var i=e(b)(n,2),a=i[0],o=i[1];t.So===r&&t.Go(a,o)}),(function(e){var r=t;n((function(){var t=new MT(OT.UNKNOWN,"Fetching auth token failed: "+e.message);return r.Qo(t)}))}))}},{key:"Go",value:function(e,t){var n=this,r=this.Ko(this.So);this.stream=this.jo(e,t),this.stream.Yr((function(){var e=n;r((function(){return e.state=2,e.Co=e.Hs.enqueueAfterDelay(e.Vo,1e4,(function(){return e.ko()&&(e.state=3),Promise.resolve()})),e.listener.Yr()}))})),this.stream.Zr((function(e){var t=n;r((function(){return t.Qo(e)}))})),this.stream.onMessage((function(e){var t=n;r((function(){return t.onMessage(e)}))}))}},{key:"Oo",value:function(){var t=this;this.state=5,this.xo.Ro(e(u)(e(_).mark((function n(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.state=0,t.start();case 1:case"end":return e.stop()}}),n)}))))}},{key:"Qo",value:function(e){return ST("PersistentStream","close with error: ".concat(e)),this.stream=null,this.close(4,e)}},{key:"Ko",value:function(e){var t=this;return function(n){var r=t;t.Hs.enqueueAndForget((function(){return r.So===e?n():(ST("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}}}]),t}(),cP=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i,a,o,s,u){var c;return e(l)(this,r),(c=n.call(this,t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",i,a,o,u)).yt=s,e(gw)(c)}return e(h)(r,[{key:"jo",value:function(e,t){return this.connection.wo("Listen",e,t)}},{key:"onMessage",value:function(e){this.xo.reset();var t=function(e,t){var n,r;if("targetChange"in t){t.targetChange;var i="NO_CHANGE"===(r=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===r?1:"REMOVE"===r?2:"CURRENT"===r?3:"RESET"===r?4:RT(),a=t.targetChange.targetIds||[],o=function(e,t){return e.wt?(DT(void 0===t||"string"==typeof t),UE.fromBase64String(t||"")):(DT(void 0===t||t instanceof Uint8Array),UE.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),s=t.targetChange.cause,u=s&&function(e){var t=void 0===e.code?OT.UNKNOWN:tA(e.code);return new MT(t,e.message||"")}(s);n=new _A(i,a,o,u||null)}else if("documentChange"in t){t.documentChange;var c=t.documentChange;c.document,c.document.name,c.document.updateTime;var l=LA(e,c.document.name),h=DA(c.document.updateTime),f=c.document.createTime?DA(c.document.createTime):XT.min(),d=new zS({mapValue:{fields:c.document.fields}}),p=GS.newFoundDocument(l,h,f,d),v=c.targetIds||[],y=c.removedTargetIds||[];n=new gA(v,y,p.key,p)}else if("documentDelete"in t){t.documentDelete;var m=t.documentDelete;m.document;var g=LA(e,m.document),k=m.readTime?DA(m.readTime):XT.min(),_=GS.newNoDocument(g,k),w=m.removedTargetIds||[];n=new gA([],w,_.key,_)}else if("documentRemove"in t){t.documentRemove;var b=t.documentRemove;b.document;var x=LA(e,b.document),I=b.removedTargetIds||[];n=new gA([],I,x,null)}else{if(!("filter"in t))return RT();t.filter;var T=t.filter;T.targetId;var E=T.count||0,S=new ZC(E),C=T.targetId;n=new kA(C,S)}return n}(this.yt,e),n=function(e){if(!("targetChange"in e))return XT.min();var t=e.targetChange;return t.targetIds&&t.targetIds.length?XT.min():t.readTime?DA(t.readTime):XT.min()}(e);return this.listener.Wo(t,n)}},{key:"zo",value:function(e){var t,n,r,i,a={};a.database=qA(this.yt),a.addTarget=(t=this.yt,i=(n=e).target,(r=XS(i)?{documents:WA(t,i)}:{query:GA(t,i)}).targetId=n.targetId,n.resumeToken.approximateByteSize()>0?r.resumeToken=NA(t,n.resumeToken):n.snapshotVersion.compareTo(XT.min())>0&&(r.readTime=AA(t,n.snapshotVersion.toTimestamp())),r);var o=function(e,t){var n=function(e,t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return RT()}}(0,t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.yt,e);o&&(a.labels=o),this.Bo(a)}},{key:"Ho",value:function(e){var t={};t.database=qA(this.yt),t.removeTarget=e,this.Bo(t)}}]),r}(uP),lP=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i,a,o,s,u){var c;return e(l)(this,r),(c=n.call(this,t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",i,a,o,u)).yt=s,c.Jo=!1,e(gw)(c)}return e(h)(r,[{key:"Yo",get:function(){return this.Jo}},{key:"start",value:function(){this.Jo=!1,this.lastStreamToken=void 0,e(Nd)(e(Pd)(r.prototype),"start",this).call(this)}},{key:"Uo",value:function(){this.Jo&&this.Xo([])}},{key:"jo",value:function(e,t){return this.connection.wo("Write",e,t)}},{key:"onMessage",value:function(e){if(DT(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Jo){this.xo.reset();var t=(r=e.writeResults,i=e.commitTime,r&&r.length>0?(DT(void 0!==i),r.map((function(e){return n=i,(r=(t=e).updateTime?DA(t.updateTime):DA(n)).isEqual(XT.min())&&(r=DA(n)),new MC(r,t.transformResults||[]);var t,n,r}))):[]),n=DA(e.commitTime);return this.listener.Zo(n,t)}var r,i;return DT(!e.writeResults||0===e.writeResults.length),this.Jo=!0,this.listener.tu()}},{key:"eu",value:function(){var e={};e.database=qA(this.yt),this.Bo(e)}},{key:"Xo",value:function(e){var t=this,n={streamToken:this.lastStreamToken,writes:e.map((function(e){return KA(t.yt,e)}))};this.Bo(n)}}]),r}(uP),hP=function(t){"use strict";e(A)(r,(function t(){e(l)(this,t)}));var n=e(q)(r);function r(t,i,a,o){var s;return e(l)(this,r),(s=n.call(this)).authCredentials=t,s.appCheckCredentials=i,s.connection=a,s.yt=o,s.nu=!1,e(gw)(s)}return e(h)(r,[{key:"su",value:function(){if(this.nu)throw new MT(OT.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"ao",value:function(t,n,r){var i=this;return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((function(a){var o=e(b)(a,2),s=o[0],u=o[1];return i.connection.ao(t,n,r,s,u)})).catch((function(e){throw"FirebaseError"===e.name?(e.code===OT.UNAUTHENTICATED&&(i.authCredentials.invalidateToken(),i.appCheckCredentials.invalidateToken()),e):new MT(OT.UNKNOWN,e.toString())}))}},{key:"_o",value:function(t,n,r,i){var a=this;return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((function(o){var s=e(b)(o,2),u=s[0],c=s[1];return a.connection._o(t,n,r,u,c,i)})).catch((function(e){throw"FirebaseError"===e.name?(e.code===OT.UNAUTHENTICATED&&(a.authCredentials.invalidateToken(),a.appCheckCredentials.invalidateToken()),e):new MT(OT.UNKNOWN,e.toString())}))}},{key:"terminate",value:function(){this.nu=!0}}]),r}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var fP=function(){"use strict";function t(n,r){e(l)(this,t),this.asyncQueue=n,this.onlineStateHandler=r,this.state="Unknown",this.iu=0,this.ru=null,this.ou=!0}return e(h)(t,[{key:"uu",value:function(){var e=this;0===this.iu&&(this.cu("Unknown"),this.ru=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(function(){return e.ru=null,e.au("Backend didn't respond within 10 seconds."),e.cu("Offline"),Promise.resolve()})))}},{key:"hu",value:function(e){"Online"===this.state?this.cu("Unknown"):(this.iu++,this.iu>=1&&(this.lu(),this.au("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.cu("Offline")))}},{key:"set",value:function(e){this.lu(),this.iu=0,"Online"===e&&(this.ou=!1),this.cu(e)}},{key:"cu",value:function(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}},{key:"au",value:function(e){var t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.ou?(CT(t),this.ou=!1):ST("OnlineStateTracker",t)}},{key:"lu",value:function(){null!==this.ru&&(this.ru.cancel(),this.ru=null)}}]),t}(),dP=function t(n,r,i,a,o){"use strict";var s=this;e(l)(this,t),this.localStore=n,this.datastore=r,this.asyncQueue=i,this.remoteSyncer={},this.fu=[],this.du=new Map,this._u=new Set,this.wu=[],this.mu=o,this.mu.Ur((function(t){var n=s;i.enqueueAndForget(e(u)(e(_).mark((function t(){return e(_).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=IP(n),!t.t0){t.next=5;break}return ST("RemoteStore","Restarting streams for network reachability change."),t.next=5,function(){var t=e(u)(e(_).mark((function t(n){var r;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=PT(n))._u.add(4),e.next=4,yP(r);case 4:return r.gu.set("Unknown"),r._u.delete(4),e.next=8,pP(r);case 8:case"end":return e.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()(n);case 5:case"end":return t.stop()}}),t)}))))})),this.gu=new fP(i,a)};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pP(e){return vP.apply(this,arguments)}function vP(){return(vP=e(u)(e(_).mark((function t(n){var r,i,a,o,s,u;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=!0,i=!1,a=void 0,!IP(n)){e.next=25;break}e.prev=2,o=n.wu[Symbol.iterator]();case 4:if(r=(s=o.next()).done){e.next=11;break}return u=s.value,e.next=8,u(!0);case 8:r=!0,e.next=4;break;case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(2),i=!0,a=e.t0;case 17:e.prev=17,e.prev=18,r||null==o.return||o.return();case 20:if(e.prev=20,!i){e.next=23;break}throw a;case 23:return e.finish(20);case 24:return e.finish(17);case 25:case"end":return e.stop()}}),t,null,[[2,13,17,25],[18,,20,24]])})))).apply(this,arguments)}function yP(e){return mP.apply(this,arguments)}function mP(){return(mP=e(u)(e(_).mark((function t(n){var r,i,a,o,s,u;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=!0,i=!1,a=void 0,e.prev=1,o=n.wu[Symbol.iterator]();case 3:if(r=(s=o.next()).done){e.next=10;break}return u=s.value,e.next=7,u(!1);case 7:r=!0,e.next=3;break;case 10:e.next=16;break;case 12:e.prev=12,e.t0=e.catch(1),i=!0,a=e.t0;case 16:e.prev=16,e.prev=17,r||null==o.return||o.return();case 19:if(e.prev=19,!i){e.next=22;break}throw a;case 22:return e.finish(19);case 23:return e.finish(16);case 24:case"end":return e.stop()}}),t,null,[[1,12,16,24],[17,,19,23]])})))).apply(this,arguments)}function gP(e,t){var n=PT(e);n.du.has(t.targetId)||(n.du.set(t.targetId,t),xP(n)?bP(n):ZP(n).ko()&&_P(n,t))}function kP(e,t){var n=PT(e),r=ZP(n);n.du.delete(t),r.ko()&&wP(n,t),0===n.du.size&&(r.ko()?r.Fo():IP(n)&&n.gu.set("Unknown"))}function _P(e,t){e.yu.Ot(t.targetId),ZP(e).zo(t)}function wP(e,t){e.yu.Ot(t),ZP(e).Ho(t)}function bP(e){e.yu=new bA({getRemoteKeysForTarget:function(t){return e.remoteSyncer.getRemoteKeysForTarget(t)},ne:function(t){return e.du.get(t)||null}}),ZP(e).start(),e.gu.uu()}function xP(e){return IP(e)&&!ZP(e).No()&&e.du.size>0}function IP(e){return 0===PT(e)._u.size}function TP(e){e.yu=void 0}function EP(e){return SP.apply(this,arguments)}function SP(){return(SP=e(u)(e(_).mark((function t(n){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.du.forEach((function(e,t){_P(n,e)}));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function CP(e,t){return AP.apply(this,arguments)}function AP(){return(AP=e(u)(e(_).mark((function t(n,r){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:TP(n),xP(n)?(n.gu.hu(r),bP(n)):n.gu.set("Unknown");case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function NP(e,t,n){return RP.apply(this,arguments)}function RP(){return RP=e(u)(e(_).mark((function t(n,r,i){var a;return e(_).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.gu.set("Online"),!(r instanceof _A&&2===r.state&&r.cause)){t.next=13;break}return t.prev=1,t.next=4,function(){var t=e(u)(e(_).mark((function t(n,r){var i,a,o,s,u,c,l;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=r.cause,a=!0,o=!1,s=void 0,e.prev=2,u=r.targetIds[Symbol.iterator]();case 4:if(a=(c=u.next()).done){e.next=15;break}if(l=c.value,e.t0=n.du.has(l),!e.t0){e.next=12;break}return e.next=10,n.remoteSyncer.rejectListen(l,i);case 10:n.du.delete(l),n.yu.removeTarget(l);case 12:a=!0,e.next=4;break;case 15:e.next=21;break;case 17:e.prev=17,e.t1=e.catch(2),o=!0,s=e.t1;case 21:e.prev=21,e.prev=22,a||null==u.return||u.return();case 24:if(e.prev=24,!o){e.next=27;break}throw s;case 27:return e.finish(24);case 28:return e.finish(21);case 29:case"end":return e.stop()}}),t,null,[[2,17,21,29],[22,,24,28]])})));return function(e,n){return t.apply(this,arguments)}}()(n,r);case 4:t.next=11;break;case 6:return t.prev=6,t.t0=t.catch(1),ST("RemoteStore","Failed to remove targets %s: %s ",r.targetIds.join(","),t.t0),t.next=11,DP(n,t.t0);case 11:case 22:t.next=29;break;case 13:if(r instanceof gA?n.yu.Kt(r):r instanceof kA?n.yu.Jt(r):n.yu.jt(r),i.isEqual(XT.min())){t.next=29;break}return t.prev=14,t.next=17,CD(n.localStore);case 17:if(a=t.sent,t.t1=i.compareTo(a)>=0,!t.t1){t.next=22;break}return t.next=22,function(e,t){var n=e.yu.Zt(t);return n.targetChanges.forEach((function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=e.du.get(r);i&&e.du.set(r,i.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach((function(t){var n=e.du.get(t);if(n){e.du.set(t,n.withResumeToken(UE.EMPTY_BYTE_STRING,n.snapshotVersion)),wP(e,t);var r=new PN(n.target,t,1,n.sequenceNumber);_P(e,r)}})),e.remoteSyncer.applyRemoteEvent(n)}(n,i);case 24:return t.prev=24,t.t2=t.catch(14),ST("RemoteStore","Failed to raise snapshot:",t.t2),t.next=29,DP(n,t.t2);case 29:case"end":return t.stop()}}),t,null,[[1,6],[14,24]])}))),RP.apply(this,arguments)}function DP(e,t,n){return PP.apply(this,arguments)}function PP(){return(PP=e(u)(e(_).mark((function t(n,r,i){return e(_).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(wE(r)){t.next=2;break}throw r;case 2:return n._u.add(1),t.next=5,yP(n);case 5:n.gu.set("Offline"),i||(i=function(){return CD(n.localStore)}),n.asyncQueue.enqueueRetryable(e(u)(e(_).mark((function t(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ST("RemoteStore","Retrying IndexedDB access"),e.next=3,i();case 3:return n._u.delete(1),e.next=6,pP(n);case 6:case"end":return e.stop()}}),t)}))));case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function OP(e,t){return t().catch((function(n){return DP(e,n,t)}))}function MP(e){return LP.apply(this,arguments)}function LP(){return(LP=e(u)(e(_).mark((function t(n){var r,i,a,o;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=PT(n),i=eO(r),a=r.fu.length>0?r.fu[r.fu.length-1].batchId:-1;case 2:if(!FP(r)){e.next=19;break}return e.prev=3,e.next=6,RD(r.localStore,a);case 6:if(null!==(o=e.sent)){e.next=10;break}return 0===r.fu.length&&i.Fo(),e.abrupt("break",19);case 10:a=o.batchId,UP(r,o),e.next=17;break;case 13:return e.prev=13,e.t0=e.catch(3),e.next=17,DP(r,e.t0);case 17:e.next=2;break;case 19:qP(r)&&VP(r);case 20:case"end":return e.stop()}}),t,null,[[3,13]])})))).apply(this,arguments)}function FP(e){return IP(e)&&e.fu.length<10}function UP(e,t){e.fu.push(t);var n=eO(e);n.ko()&&n.Yo&&n.Xo(t.mutations)}function qP(e){return IP(e)&&!eO(e).No()&&e.fu.length>0}function VP(e){eO(e).start()}function jP(e){return BP.apply(this,arguments)}function BP(){return(BP=e(u)(e(_).mark((function t(n){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:eO(n).eu();case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function KP(e){return zP.apply(this,arguments)}function zP(){return(zP=e(u)(e(_).mark((function t(n){var r,i,a,o,s,u,c;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=eO(n),i=!0,a=!1,o=void 0,e.prev=2,s=n.fu[Symbol.iterator]();!(i=(u=s.next()).done);i=!0)c=u.value,r.Xo(c.mutations);e.next=10;break;case 6:e.prev=6,e.t0=e.catch(2),a=!0,o=e.t0;case 10:e.prev=10,e.prev=11,i||null==s.return||s.return();case 13:if(e.prev=13,!a){e.next=16;break}throw o;case 16:return e.finish(13);case 17:return e.finish(10);case 18:case"end":return e.stop()}}),t,null,[[2,6,10,18],[11,,13,17]])})))).apply(this,arguments)}function WP(e,t,n){return GP.apply(this,arguments)}function GP(){return(GP=e(u)(e(_).mark((function t(n,r,i){var a,o;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.fu.shift(),o=RN.from(a,r,i),e.next=3,OP(n,(function(){return n.remoteSyncer.applySuccessfulWrite(o)}));case 3:return e.next=5,MP(n);case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function HP(e,t){return QP.apply(this,arguments)}function QP(){return QP=e(u)(e(_).mark((function t(n,r){return e(_).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=r&&eO(n).Yo,!t.t0){t.next=4;break}return t.next=4,function(){var t=e(u)(e(_).mark((function t(n,r){var i,a;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!eA(a=r.code)||a===OT.ABORTED){e.next=7;break}return i=n.fu.shift(),eO(n).Mo(),e.next=5,OP(n,(function(){return n.remoteSyncer.rejectFailedWrite(i.batchId,r)}));case 5:return e.next=7,MP(n);case 7:case 8:case"end":return e.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()(n,r);case 4:qP(n)&&VP(n);case 5:case"end":return t.stop()}}),t)}))),QP.apply(this,arguments)}function YP(e,t){return JP.apply(this,arguments)}function JP(){return(JP=e(u)(e(_).mark((function t(n,r){var i,a;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(i=PT(n)).asyncQueue.verifyOperationInProgress(),ST("RemoteStore","RemoteStore received new credentials"),a=IP(i),i._u.add(3),e.next=6,yP(i);case 6:return a&&i.gu.set("Unknown"),e.next=9,i.remoteSyncer.handleCredentialChange(r);case 9:return i._u.delete(3),e.next=12,pP(i);case 12:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function XP(e,t){return $P.apply(this,arguments)}function $P(){return($P=e(u)(e(_).mark((function t(n,r){var i;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=PT(n),!r){e.next=7;break}return i._u.delete(2),e.next=5,pP(i);case 5:e.next=13;break;case 7:if(e.t0=r,e.t0){e.next=13;break}return i._u.add(2),e.next=12,yP(i);case 12:i.gu.set("Unknown");case 13:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function ZP(t){return t.pu||(t.pu=(r=t.datastore,i=t.asyncQueue,a={Yr:EP.bind(null,t),Zr:CP.bind(null,t),Wo:NP.bind(null,t)},(o=PT(r)).su(),new cP(i,o.connection,o.authCredentials,o.appCheckCredentials,o.yt,a)),t.wu.push((n=e(u)(e(_).mark((function n(r){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=4;break}t.pu.Mo(),xP(t)?bP(t):t.gu.set("Unknown"),e.next=7;break;case 4:return e.next=6,t.pu.stop();case 6:TP(t);case 7:case"end":return e.stop()}}),n)}))),function(e){return n.apply(this,arguments)}))),t.pu;var n,r,i,a,o}function eO(t){return t.Iu||(t.Iu=(r=t.datastore,i=t.asyncQueue,a={Yr:jP.bind(null,t),Zr:HP.bind(null,t),tu:KP.bind(null,t),Zo:WP.bind(null,t)},(o=PT(r)).su(),new lP(i,o.connection,o.authCredentials,o.appCheckCredentials,o.yt,a)),t.wu.push((n=e(u)(e(_).mark((function n(r){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=6;break}return t.Iu.Mo(),e.next=4,MP(t);case 4:e.next=9;break;case 6:return e.next=8,t.Iu.stop();case 8:t.fu.length>0&&(ST("RemoteStore","Stopping write stream with ".concat(t.fu.length," pending writes")),t.fu=[]);case 9:case"end":return e.stop()}}),n)}))),function(e){return n.apply(this,arguments)}))),t.Iu
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */;var n,r,i,a,o}var tO=function(){"use strict";function t(n,r,i,a,o){e(l)(this,t),this.asyncQueue=n,this.timerId=r,this.targetTimeMs=i,this.op=a,this.removalCallback=o,this.deferred=new LT,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(e){}))}return e(h)(t,[{key:"start",value:function(e){var t=this;this.timerHandle=setTimeout((function(){return t.handleDelayElapsed()}),e)}},{key:"skipDelay",value:function(){return this.handleDelayElapsed()}},{key:"cancel",value:function(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new MT(OT.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}},{key:"handleDelayElapsed",value:function(){var e=this;this.asyncQueue.enqueueAndForget((function(){return null!==e.timerHandle?(e.clearTimeout(),e.op().then((function(t){return e.deferred.resolve(t)}))):Promise.resolve()}))}},{key:"clearTimeout",value:function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}],[{key:"createAndSchedule",value:function(e,n,r,i,a){var o=new t(e,n,Date.now()+r,i,a);return o.start(r),o}}]),t}();function nO(e,t){if(CT("AsyncQueue","".concat(t,": ").concat(e)),wE(e))return new MT(OT.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var rO=function(){"use strict";function t(n){e(l)(this,t),this.comparator=n?function(e,t){return n(e,t)||nE.comparator(e.key,t.key)}:function(e,t){return nE.comparator(e.key,t.key)},this.keyedMap=oA(),this.sortedSet=new FS(this.comparator)}return e(h)(t,[{key:"has",value:function(e){return null!=this.keyedMap.get(e)}},{key:"get",value:function(e){return this.keyedMap.get(e)}},{key:"first",value:function(){return this.sortedSet.minKey()}},{key:"last",value:function(){return this.sortedSet.maxKey()}},{key:"isEmpty",value:function(){return this.sortedSet.isEmpty()}},{key:"indexOf",value:function(e){var t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}},{key:"size",get:function(){return this.sortedSet.size}},{key:"forEach",value:function(e){this.sortedSet.inorderTraversal((function(t,n){return e(t),!1}))}},{key:"add",value:function(e){var t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}},{key:"delete",value:function(e){var t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}},{key:"isEqual",value:function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}},{key:"toString",value:function(){var e=[];return this.forEach((function(t){e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}},{key:"copy",value:function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}],[{key:"emptySet",value:function(e){return new t(e.comparator)}}]),t}(),iO=function(){"use strict";function t(){e(l)(this,t),this.Tu=new FS(nE.comparator)}return e(h)(t,[{key:"track",value:function(e){var t=e.doc.key,n=this.Tu.get(t);n?0!==e.type&&3===n.type?this.Tu=this.Tu.insert(t,e):3===e.type&&1!==n.type?this.Tu=this.Tu.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Tu=this.Tu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Tu=this.Tu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Tu=this.Tu.remove(t):1===e.type&&2===n.type?this.Tu=this.Tu.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Tu=this.Tu.insert(t,{type:2,doc:e.doc}):RT():this.Tu=this.Tu.insert(t,e)}},{key:"Eu",value:function(){var e=[];return this.Tu.inorderTraversal((function(t,n){e.push(n)})),e}}]),t}(),aO=function(){"use strict";function t(n,r,i,a,o,s,u,c,h){e(l)(this,t),this.query=n,this.docs=r,this.oldDocs=i,this.docChanges=a,this.mutatedKeys=o,this.fromCache=s,this.syncStateChanged=u,this.excludesMetadataChanges=c,this.hasCachedResults=h}return e(h)(t,[{key:"hasPendingWrites",get:function(){return!this.mutatedKeys.isEmpty()}},{key:"isEqual",value:function(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&fC(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;var t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}],[{key:"fromInitialDocuments",value:function(e,n,r,i,a){var o=[];return n.forEach((function(e){o.push({type:0,doc:e})})),new t(e,n,rO.emptySet(n),o,r,i,!0,!1,a)}}]),t}(),oO=function t(){"use strict";e(l)(this,t),this.Au=void 0,this.listeners=[]},sO=function t(){"use strict";e(l)(this,t),this.queries=new nA((function(e){return dC(e)}),fC),this.onlineState="Unknown",this.Ru=new Set};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uO(e,t){return cO.apply(this,arguments)}function cO(){return(cO=e(u)(e(_).mark((function t(n,r){var i,a,o,s,u;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=PT(n),a=r.query,o=!1,(s=i.queries.get(a))||(o=!0,s=new oO),!o){e.next=13;break}return e.prev=3,e.next=6,i.onListen(a);case 6:s.Au=e.sent,e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(3),u=nO(e.t0,"Initialization of query '".concat(pC(r.query),"' failed")),e.abrupt("return",void r.onError(u));case 13:i.queries.set(a,s),s.listeners.push(r),r.bu(i.onlineState),s.Au&&r.Pu(s.Au)&&pO(i);case 14:case"end":return e.stop()}}),t,null,[[3,9]])})))).apply(this,arguments)}function lO(e,t){return hO.apply(this,arguments)}function hO(){return(hO=e(u)(e(_).mark((function t(n,r){var i,a,o,s,u;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=PT(n),a=r.query,o=!1,(s=i.queries.get(a))&&(u=s.listeners.indexOf(r))>=0&&(s.listeners.splice(u,1),o=0===s.listeners.length),!o){e.next=6;break}return e.abrupt("return",(i.queries.delete(a),i.onUnlisten(a)));case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function fO(e,t){var n=PT(e),r=!1,i=!0,a=!1,o=void 0;try{for(var s,u=t[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value,l=c.query,h=n.queries.get(l);if(h){var f=!0,d=!1,p=void 0;try{for(var v,y=h.listeners[Symbol.iterator]();!(f=(v=y.next()).done);f=!0){v.value.Pu(c)&&(r=!0)}}catch(e){d=!0,p=e}finally{try{f||null==y.return||y.return()}finally{if(d)throw p}}h.Au=c}}}catch(e){a=!0,o=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw o}}r&&pO(n)}function dO(e,t,n){var r=PT(e),i=r.queries.get(t),a=!0,o=!1,s=void 0;if(i)try{for(var u,c=i.listeners[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){u.value.onError(n)}}catch(e){o=!0,s=e}finally{try{a||null==c.return||c.return()}finally{if(o)throw s}}r.queries.delete(t)}function pO(e){e.Ru.forEach((function(e){e.next()}))}var vO=function(){"use strict";function t(n,r,i){e(l)(this,t),this.query=n,this.vu=r,this.Vu=!1,this.Su=null,this.onlineState="Unknown",this.options=i||{}}return e(h)(t,[{key:"Pu",value:function(e){if(!this.options.includeMetadataChanges){var t=[],n=!0,r=!1,i=void 0;try{for(var a,o=e.docChanges[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;3!==s.type&&t.push(s)}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}e=new aO(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}var u=!1;return this.Vu?this.Du(e)&&(this.vu.next(e),u=!0):this.Cu(e,this.onlineState)&&(this.xu(e),u=!0),this.Su=e,u}},{key:"onError",value:function(e){this.vu.error(e)}},{key:"bu",value:function(e){this.onlineState=e;var t=!1;return this.Su&&!this.Vu&&this.Cu(this.Su,e)&&(this.xu(this.Su),t=!0),t}},{key:"Cu",value:function(e,t){if(!e.fromCache)return!0;var n="Offline"!==t;return(!this.options.Nu||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}},{key:"Du",value:function(e){if(e.docChanges.length>0)return!0;var t=this.Su&&this.Su.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}},{key:"xu",value:function(e){e=aO.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Vu=!0,this.vu.next(e)}}]),t}(),yO=function(){"use strict";function t(n,r){e(l)(this,t),this.ku=n,this.byteLength=r}return e(h)(t,[{key:"Ou",value:function(){return"metadata"in this.ku}}]),t}(),mO=function(){"use strict";function t(n){e(l)(this,t),this.yt=n}return e(h)(t,[{key:"Ji",value:function(e){return LA(this.yt,e)}},{key:"Yi",value:function(e){return e.metadata.exists?BA(this.yt,e.document,!1):GS.newNoDocument(this.Ji(e.metadata.name),this.Xi(e.metadata.readTime))}},{key:"Xi",value:function(e){return DA(e)}}]),t}(),gO=function(){"use strict";function t(n,r,i){e(l)(this,t),this.Mu=n,this.localStore=r,this.yt=i,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=kO(n)}return e(h)(t,[{key:"Fu",value:function(e){this.progress.bytesLoaded+=e.byteLength;var t=this.progress.documentsLoaded;if(e.ku.namedQuery)this.queries.push(e.ku.namedQuery);else if(e.ku.documentMetadata){this.documents.push({metadata:e.ku.documentMetadata}),e.ku.documentMetadata.exists||++t;var n=ZT.fromString(e.ku.documentMetadata.name);this.collectionGroups.add(n.get(n.length-2))}else e.ku.document&&(this.documents[this.documents.length-1].document=e.ku.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}},{key:"$u",value:function(e){var t=new Map,n=new mO(this.yt),r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;if(u.metadata.queries){var c=n.Ji(u.metadata.name),l=!0,h=!1,f=void 0;try{for(var d,p=u.metadata.queries[Symbol.iterator]();!(l=(d=p.next()).done);l=!0){var v=d.value,y=(t.get(v)||dA()).add(c);t.set(v,y)}}catch(e){h=!0,f=e}finally{try{l||null==p.return||p.return()}finally{if(h)throw f}}}}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return t}},{key:"complete",value:function(){var t=this;return e(u)(e(_).mark((function n(){var r,i,a,o,s,u,c,l;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,qD(t.localStore,new mO(t.yt),t.documents,t.Mu.id);case 2:r=e.sent,i=t.$u(t.documents),a=!0,o=!1,s=void 0,e.prev=5,u=t.queries[Symbol.iterator]();case 7:if(a=(c=u.next()).done){e.next=14;break}return l=c.value,e.next=11,jD(t.localStore,l,i.get(l.name));case 11:a=!0,e.next=7;break;case 14:e.next=20;break;case 16:e.prev=16,e.t0=e.catch(5),o=!0,s=e.t0;case 20:e.prev=20,e.prev=21,a||null==u.return||u.return();case 23:if(e.prev=23,!o){e.next=26;break}throw s;case 26:return e.finish(23);case 27:return e.finish(20);case 28:return e.abrupt("return",(t.progress.taskState="Success",{progress:t.progress,Bu:t.collectionGroups,Lu:r}));case 29:case"end":return e.stop()}}),n,null,[[5,16,20,28],[21,,23,27]])})))()}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kO(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _O=function t(n){"use strict";e(l)(this,t),this.key=n},wO=function t(n){"use strict";e(l)(this,t),this.key=n},bO=function(){"use strict";function t(n,r){e(l)(this,t),this.query=n,this.qu=r,this.Uu=null,this.hasCachedResults=!1,this.current=!1,this.Ku=dA(),this.mutatedKeys=dA(),this.Gu=mC(n),this.Qu=new rO(this.Gu)}return e(h)(t,[{key:"ju",get:function(){return this.qu}},{key:"Wu",value:function(e,t){var n=this,r=t?t.zu:new iO,i=t?t.Qu:this.Qu,a=t?t.mutatedKeys:this.mutatedKeys,o=i,s=!1,u="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,c="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((function(e,t){var l=i.get(e),h=vC(n.query,t)?t:null,f=!!l&&n.mutatedKeys.has(l.key),d=!!h&&(h.hasLocalMutations||n.mutatedKeys.has(h.key)&&h.hasCommittedMutations),p=!1;l&&h?l.data.isEqual(h.data)?f!==d&&(r.track({type:3,doc:h}),p=!0):n.Hu(l,h)||(r.track({type:2,doc:h}),p=!0,(u&&n.Gu(h,u)>0||c&&n.Gu(h,c)<0)&&(s=!0)):!l&&h?(r.track({type:0,doc:h}),p=!0):l&&!h&&(r.track({type:1,doc:l}),p=!0,(u||c)&&(s=!0)),p&&(h?(o=o.add(h),a=d?a.add(e):a.delete(e)):(o=o.delete(e),a=a.delete(e)))})),null!==this.query.limit)for(;o.size>this.query.limit;){var l="F"===this.query.limitType?o.last():o.first();o=o.delete(l.key),a=a.delete(l.key),r.track({type:1,doc:l})}return{Qu:o,zu:r,$i:s,mutatedKeys:a}}},{key:"Hu",value:function(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}},{key:"applyChanges",value:function(e,t,n){var r=this,i=this.Qu;this.Qu=e.Qu,this.mutatedKeys=e.mutatedKeys;var a=e.zu.Eu();a.sort((function(e,t){return n=e.type,i=t.type,(a=function(e){switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return RT()}})(n)-a(i)||r.Gu(e.doc,t.doc);var n,i,a})),this.Ju(n);var o=t?this.Yu():[],s=0===this.Ku.size&&this.current?1:0,u=s!==this.Uu;return this.Uu=s,0!==a.length||u?{snapshot:new aO(this.query,e.Qu,i,a,e.mutatedKeys,0===s,u,!1,!!n&&n.resumeToken.approximateByteSize()>0),Xu:o}:{Xu:o}}},{key:"bu",value:function(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Qu:this.Qu,zu:new iO,mutatedKeys:this.mutatedKeys,$i:!1},!1)):{Xu:[]}}},{key:"Zu",value:function(e){return!this.qu.has(e)&&!!this.Qu.has(e)&&!this.Qu.get(e).hasLocalMutations}},{key:"Ju",value:function(e){var t=this;e&&(e.addedDocuments.forEach((function(e){return t.qu=t.qu.add(e)})),e.modifiedDocuments.forEach((function(e){})),e.removedDocuments.forEach((function(e){return t.qu=t.qu.delete(e)})),this.current=e.current)}},{key:"Yu",value:function(){var e=this;if(!this.current)return[];var t=this.Ku;this.Ku=dA(),this.Qu.forEach((function(t){e.Zu(t.key)&&(e.Ku=e.Ku.add(t.key))}));var n=[];return t.forEach((function(t){e.Ku.has(t)||n.push(new wO(t))})),this.Ku.forEach((function(e){t.has(e)||n.push(new _O(e))})),n}},{key:"tc",value:function(e){this.qu=e.Hi,this.Ku=dA();var t=this.Wu(e.documents);return this.applyChanges(t,!0)}},{key:"ec",value:function(){return aO.fromInitialDocuments(this.query,this.Qu,this.mutatedKeys,0===this.Uu,this.hasCachedResults)}}]),t}(),xO=function t(n,r,i){"use strict";e(l)(this,t),this.query=n,this.targetId=r,this.view=i},IO=function t(n){"use strict";e(l)(this,t),this.key=n,this.nc=!1},TO=function(){"use strict";function t(n,r,i,a,o,s){e(l)(this,t),this.localStore=n,this.remoteStore=r,this.eventManager=i,this.sharedClientState=a,this.currentUser=o,this.maxConcurrentLimboResolutions=s,this.sc={},this.ic=new nA((function(e){return dC(e)}),fC),this.rc=new Map,this.oc=new Set,this.uc=new FS(nE.comparator),this.cc=new Map,this.ac=new aD,this.hc={},this.lc=new Map,this.fc=MR.vn(),this.onlineState="Unknown",this.dc=void 0}return e(h)(t,[{key:"isPrimaryClient",get:function(){return!0===this.dc}}]),t}();function EO(e,t){return SO.apply(this,arguments)}function SO(){return(SO=e(u)(e(_).mark((function t(n,r){var i,a,o,s,u,c;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=kM(n),!(s=i.ic.get(r))){e.next=7;break}a=s.targetId,i.sharedClientState.addLocalQueryTarget(a),o=s.view.ec(),e.next=16;break;case 7:return e.next=9,DD(i.localStore,cC(r));case 9:return u=e.sent,i.isPrimaryClient&&gP(i.remoteStore,u),c=i.sharedClientState.addLocalQueryTarget(u.targetId),a=u.targetId,e.next=15,CO(i,r,a,"current"===c,u.resumeToken);case 15:o=e.sent;case 16:return e.abrupt("return",o);case 17:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function CO(e,t,n,r,i){return AO.apply(this,arguments)}function AO(){return AO=e(u)(e(_).mark((function t(n,r,i,a,o){var s,c,l,h,f,d;return e(_).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n._c=function(t,r,i){return(a=e(u)(e(_).mark((function t(n,r,i,a){var o,s,u;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=r.view.Wu(i),e.t0=o.$i,!e.t0){e.next=6;break}return e.next=5,MD(n.localStore,r.query,!1).then((function(e){var t=e.documents;return r.view.Wu(t,o)}));case 5:o=e.sent;case 6:return s=a&&a.targetChanges.get(r.targetId),u=r.view.applyChanges(o,n.isPrimaryClient,s),e.abrupt("return",(YO(n,r.targetId,u.Xu),u.snapshot));case 8:case"end":return e.stop()}}),t)}))),function(e,t,n,r){return a.apply(this,arguments)})(n,t,r,i);var a},t.next=3,MD(n.localStore,r,!0);case 3:return s=t.sent,c=new bO(r,s.Hi),l=c.Wu(s.documents),h=mA.createSynthesizedTargetChangeForCurrentChange(i,a&&"Offline"!==n.onlineState,o),f=c.applyChanges(l,n.isPrimaryClient,h),YO(n,i,f.Xu),d=new xO(r,i,c),t.abrupt("return",(n.ic.set(r,d),n.rc.has(i)?n.rc.get(i).push(r):n.rc.set(i,[r]),f.snapshot));case 11:case"end":return t.stop()}}),t)}))),AO.apply(this,arguments)}function NO(e,t){return RO.apply(this,arguments)}function RO(){return(RO=e(u)(e(_).mark((function t(n,r){var i,a,o;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=PT(n),a=i.ic.get(r),!((o=i.rc.get(a.targetId)).length>1)){e.next=3;break}return e.abrupt("return",(i.rc.set(a.targetId,o.filter((function(e){return!fC(e,r)}))),void i.ic.delete(r)));case 3:if(!i.isPrimaryClient){e.next=11;break}if(i.sharedClientState.removeLocalQueryTarget(a.targetId),e.t0=i.sharedClientState.isActiveQueryTarget(a.targetId),e.t0){e.next=9;break}return e.next=9,PD(i.localStore,a.targetId,!1).then((function(){i.sharedClientState.clearQueryState(a.targetId),kP(i.remoteStore,a.targetId),HO(i,a.targetId)})).catch(pE);case 9:e.next=14;break;case 11:return HO(i,a.targetId),e.next=14,PD(i.localStore,a.targetId,!0);case 14:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function DO(e,t,n){return PO.apply(this,arguments)}function PO(){return(PO=e(u)(e(_).mark((function t(n,r,i){var a,o,s;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=_M(n),e.prev=1,e.next=4,function(e,t){var n,r,i=PT(e),a=JT.now(),o=t.reduce((function(e,t){return e.add(t.key)}),dA());return i.persistence.runTransaction("Locally write mutations","readwrite",(function(e){var s=iA(),u=dA();return i.Gi.getEntries(e,o).next((function(e){(s=e).forEach((function(e,t){t.isValidDocument()||(u=u.add(e))}))})).next((function(){return i.localDocuments.getOverlayedDocuments(e,s)})).next((function(r){n=r;var o=[],s=!0,u=!1,c=void 0;try{for(var l,h=t[Symbol.iterator]();!(s=(l=h.next()).done);s=!0){var f=l.value,d=BC(f,n.get(f.key).overlayedDocument);null!=d&&o.push(new WC(f.key,d,WS(d.value.mapValue),LC.exists(!0)))}}catch(e){u=!0,c=e}finally{try{s||null==h.return||h.return()}finally{if(u)throw c}}return i.mutationQueue.addMutationBatch(e,a,o,t)})).next((function(t){r=t;var a=t.applyToLocalDocumentSet(n,u);return i.documentOverlayCache.saveOverlays(e,t.batchId,a)}))})).then((function(){return{batchId:r.batchId,changes:sA(n)}}))}(a.localStore,r);case 4:return o=e.sent,a.sharedClientState.addPendingMutation(o.batchId),t=a,u=o.batchId,c=i,l=void 0,(l=t.hc[t.currentUser.toKey()])||(l=new FS(HT)),l=l.insert(u,c),t.hc[t.currentUser.toKey()]=l,e.next=9,$O(a,o.changes);case 9:return e.next=11,MP(a.remoteStore);case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),s=nO(e.t0,"Failed to persist write"),i.reject(s);case 17:case"end":return e.stop()}var t,u,c,l}),t,null,[[1,13]])})))).apply(this,arguments)}function OO(e,t){return MO.apply(this,arguments)}function MO(){return(MO=e(u)(e(_).mark((function t(n,r){var i,a;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=PT(n),e.prev=1,e.next=4,AD(i.localStore,r);case 4:return a=e.sent,r.targetChanges.forEach((function(e,t){var n=i.cc.get(t);n&&(DT(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?n.nc=!0:e.modifiedDocuments.size>0?DT(n.nc):e.removedDocuments.size>0&&(DT(n.nc),n.nc=!1))})),e.next=8,$O(i,a,r);case 8:e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(1),e.next=14,pE(e.t0);case 14:case"end":return e.stop()}}),t,null,[[1,10]])})))).apply(this,arguments)}function LO(e,t,n){var r=PT(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.ic.forEach((function(e,n){var r=n.view.bu(t);r.snapshot&&i.push(r.snapshot)})),function(e,t){var n=PT(e);n.onlineState=t;var r=!1;n.queries.forEach((function(e,n){var i=!0,a=!1,o=void 0;try{for(var s,u=n.listeners[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){s.value.bu(t)&&(r=!0)}}catch(e){a=!0,o=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw o}}})),r&&pO(n)}(r.eventManager,t),i.length&&r.sc.Wo(i),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}function FO(e,t,n){return UO.apply(this,arguments)}function UO(){return(UO=e(u)(e(_).mark((function t(n,r,i){var a,o,s,u,c,l;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((a=PT(n)).sharedClientState.updateQueryState(r,"rejected",i),o=a.cc.get(r),!(s=o&&o.key)){e.next=14;break}return u=(u=new FS(nE.comparator)).insert(s,GS.newNoDocument(s,XT.min())),c=dA().add(s),l=new yA(XT.min(),new Map,new VS(HT),u,c),e.next=9,OO(a,l);case 9:a.uc=a.uc.remove(s),a.cc.delete(r),XO(a),e.next=16;break;case 14:return e.next=16,PD(a.localStore,r,!1).then((function(){return HO(a,r,i)})).catch(pE);case 16:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function qO(e,t){return VO.apply(this,arguments)}function VO(){return(VO=e(u)(e(_).mark((function t(n,r){var i,a,o;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=PT(n),a=r.batch.batchId,e.prev=1,e.next=4,SD(i.localStore,r);case 4:return o=e.sent,GO(i,a,null),WO(i,a),i.sharedClientState.updateMutationState(a,"acknowledged"),e.next=10,$O(i,o);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,pE(e.t0);case 16:case"end":return e.stop()}}),t,null,[[1,12]])})))).apply(this,arguments)}function jO(e,t,n){return BO.apply(this,arguments)}function BO(){return(BO=e(u)(e(_).mark((function t(n,r,i){var a,o;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=PT(n),e.prev=1,e.next=4,function(e,t){var n=PT(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(e){var r;return n.mutationQueue.lookupMutationBatch(e,t).next((function(t){return DT(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)})).next((function(){return n.mutationQueue.performConsistencyCheck(e)})).next((function(){return n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)})).next((function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)})).next((function(){return n.localDocuments.getDocuments(e,r)}))}))}(a.localStore,r);case 4:return o=e.sent,GO(a,r,i),WO(a,r),a.sharedClientState.updateMutationState(r,"rejected",i),e.next=10,$O(a,o);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,pE(e.t0);case 16:case"end":return e.stop()}}),t,null,[[1,12]])})))).apply(this,arguments)}function KO(e,t){return zO.apply(this,arguments)}function zO(){return(zO=e(u)(e(_).mark((function t(n,r){var i,a,o,s;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return IP((i=PT(n)).remoteStore)||ST("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),e.prev=2,e.next=5,function(e){var t=PT(e);return t.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(e){return t.mutationQueue.getHighestUnacknowledgedBatchId(e)}))}(i.localStore);case 5:if(-1!==(a=e.sent)){e.next=8;break}return e.abrupt("return",void r.resolve());case 8:(o=i.lc.get(a)||[]).push(r),i.lc.set(a,o),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(2),s=nO(e.t0,"Initialization of waitForPendingWrites() operation failed"),r.reject(s);case 16:case"end":return e.stop()}}),t,null,[[2,12]])})))).apply(this,arguments)}function WO(e,t){(e.lc.get(t)||[]).forEach((function(e){e.resolve()})),e.lc.delete(t)}function GO(e,t,n){var r=PT(e),i=r.hc[r.currentUser.toKey()];if(i){var a=i.get(t);a&&(n?a.reject(n):a.resolve(),i=i.remove(t)),r.hc[r.currentUser.toKey()]=i}}function HO(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);var r=!0,i=!1,a=void 0;try{for(var o,s=e.rc.get(t)[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;e.ic.delete(u),n&&e.sc.wc(u,n)}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}e.rc.delete(t),e.isPrimaryClient&&e.ac.ls(t).forEach((function(t){e.ac.containsKey(t)||QO(e,t)}))}function QO(e,t){e.oc.delete(t.path.canonicalString());var n=e.uc.get(t);null!==n&&(kP(e.remoteStore,n),e.uc=e.uc.remove(t),e.cc.delete(n),XO(e))}function YO(e,t,n){var r=!0,i=!1,a=void 0;try{for(var o,s=n[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;u instanceof _O?(e.ac.addReference(u.key,t),JO(e,u)):u instanceof wO?(ST("SyncEngine","Document no longer in limbo: "+u.key),e.ac.removeReference(u.key,t),e.ac.containsKey(u.key)||QO(e,u.key)):RT()}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}}function JO(e,t){var n=t.key,r=n.path.canonicalString();e.uc.get(n)||e.oc.has(r)||(ST("SyncEngine","New document in limbo: "+n),e.oc.add(r),XO(e))}function XO(e){for(;e.oc.size>0&&e.uc.size<e.maxConcurrentLimboResolutions;){var t=e.oc.values().next().value;e.oc.delete(t);var n=new nE(ZT.fromString(t)),r=e.fc.next();e.cc.set(r,new IO(n)),e.uc=e.uc.insert(n,r),gP(e.remoteStore,new PN(cC(rC(n.path)),r,2,CE.at))}}function $O(e,t,n){return ZO.apply(this,arguments)}function ZO(){return ZO=e(u)(e(_).mark((function t(n,r,i){var a,o,s,c;return e(_).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=PT(n),o=[],s=[],c=[],t.t0=a.ic.isEmpty(),t.t0){t.next=9;break}return a.ic.forEach((function(e,t){c.push(a._c(t,r,i).then((function(e){if((e||i)&&a.isPrimaryClient&&a.sharedClientState.updateQueryState(t.targetId,(null==e?void 0:e.fromCache)?"not-current":"current"),e){o.push(e);var n=wD.Ci(t.targetId,e);s.push(n)}})))})),t.next=6,Promise.all(c);case 6:return a.sc.Wo(o),t.next=9,function(){var t=e(u)(e(_).mark((function t(n,r){var i,a,o,s,u,c,l,h,f,d,p;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=PT(n),e.prev=1,e.next=4,i.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(e){return yE.forEach(r,(function(t){return yE.forEach(t.Si,(function(n){return i.persistence.referenceDelegate.addReference(e,t.targetId,n)})).next((function(){return yE.forEach(t.Di,(function(n){return i.persistence.referenceDelegate.removeReference(e,t.targetId,n)}))}))}))}));case 4:e.next=11;break;case 6:if(e.prev=6,e.t0=e.catch(1),wE(e.t0)){e.next=10;break}throw e.t0;case 10:ST("LocalStore","Failed to update sequence numbers: "+e.t0);case 11:for(a=!0,o=!1,s=void 0,e.prev=12,u=r[Symbol.iterator]();!(a=(c=u.next()).done);a=!0)l=c.value,h=l.targetId,l.fromCache||(f=i.qi.get(h),d=f.snapshotVersion,p=f.withLastLimboFreeSnapshotVersion(d),i.qi=i.qi.insert(h,p));e.next=20;break;case 16:e.prev=16,e.t1=e.catch(12),o=!0,s=e.t1;case 20:e.prev=20,e.prev=21,a||null==u.return||u.return();case 23:if(e.prev=23,!o){e.next=26;break}throw s;case 26:return e.finish(23);case 27:return e.finish(20);case 28:case"end":return e.stop()}}),t,null,[[1,6],[12,16,20,28],[21,,23,27]])})));return function(e,n){return t.apply(this,arguments)}}()(a.localStore,s);case 9:case"end":return t.stop()}}),t)}))),ZO.apply(this,arguments)}function eM(e,t){return tM.apply(this,arguments)}function tM(){return(tM=e(u)(e(_).mark((function t(n,r){var i,a;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((i=PT(n)).currentUser.isEqual(r)){e.next=11;break}return ST("SyncEngine","User change. New user:",r.toKey()),e.next=5,TD(i.localStore,r);case 5:return a=e.sent,i.currentUser=r,(t=i).lc.forEach((function(e){e.forEach((function(e){e.reject(new MT(OT.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.lc.clear(),i.sharedClientState.handleUserChange(r,a.removedBatchIds,a.addedBatchIds),e.next=11,$O(i,a.ji);case 11:case"end":return e.stop()}var t}),t)})))).apply(this,arguments)}function nM(e,t){var n=PT(e),r=n.cc.get(t);if(r&&r.nc)return dA().add(r.key);var i=dA(),a=n.rc.get(t);if(!a)return i;var o=!0,s=!1,u=void 0;try{for(var c,l=a[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var h=c.value,f=n.ic.get(h);i=i.unionWith(f.view.ju)}}catch(e){s=!0,u=e}finally{try{o||null==l.return||l.return()}finally{if(s)throw u}}return i}function rM(e,t){return iM.apply(this,arguments)}function iM(){return(iM=e(u)(e(_).mark((function t(n,r){var i,a,o;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=PT(n),e.next=3,MD(i.localStore,r.query,!0);case 3:return a=e.sent,o=r.view.tc(a),e.abrupt("return",(i.isPrimaryClient&&YO(i,r.targetId,o.Xu),o));case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function aM(e,t){return oM.apply(this,arguments)}function oM(){return(oM=e(u)(e(_).mark((function t(n,r){var i;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=PT(n),e.abrupt("return",FD(i.localStore,r).then((function(e){return $O(i,e)})));case 2:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function sM(e,t,n,r){return uM.apply(this,arguments)}function uM(){return(uM=e(u)(e(_).mark((function t(n,r,i,a){var o,s;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=PT(n),e.next=3,function(e,t){var n=PT(e),r=PT(n.mutationQueue);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(e){return r.Tn(e,t).next((function(t){return t?n.localDocuments.getDocuments(e,t):yE.resolve(null)}))}))}(o.localStore,r);case 3:if(null===(s=e.sent)){e.next=15;break}if("pending"!==i){e.next=10;break}return e.next=8,MP(o.remoteStore);case 8:e.next=11;break;case 10:"acknowledged"===i||"rejected"===i?(GO(o,r,a||null),WO(o,r),t=o.localStore,u=r,PT(PT(t).mutationQueue).An(u)):RT();case 11:return e.next=13,$O(o,s);case 13:e.next=16;break;case 15:ST("SyncEngine","Cannot apply mutation batch with id: "+r);case 16:case"end":return e.stop()}var t,u}),t)})))).apply(this,arguments)}function cM(e,t){return lM.apply(this,arguments)}function lM(){return(lM=e(u)(e(_).mark((function t(n,r){var i,a,o,s,u,c,l,h,f,d,p;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(kM(i=PT(n)),_M(i),!0!==r||!0===i.dc){e.next=28;break}return a=i.sharedClientState.getAllActiveQueryTargets(),e.next=5,hM(i,a.toArray());case 5:return o=e.sent,i.dc=!0,e.next=9,XP(i.remoteStore,!0);case 9:for(s=!0,u=!1,c=void 0,e.prev=10,l=o[Symbol.iterator]();!(s=(h=l.next()).done);s=!0)f=h.value,gP(i.remoteStore,f);e.next=18;break;case 14:e.prev=14,e.t0=e.catch(10),u=!0,c=e.t0;case 18:e.prev=18,e.prev=19,s||null==l.return||l.return();case 21:if(e.prev=21,!u){e.next=24;break}throw c;case 24:return e.finish(21);case 25:return e.finish(18);case 26:e.next=40;break;case 28:if(!1!==r||!1===i.dc){e.next=40;break}return d=[],p=Promise.resolve(),i.rc.forEach((function(e,t){i.sharedClientState.isLocalQueryTarget(t)?d.push(t):p=p.then((function(){return HO(i,t),PD(i.localStore,t,!0)})),kP(i.remoteStore,t)})),e.next=34,p;case 34:return e.next=36,hM(i,d);case 36:return function(e){var t=PT(e);t.cc.forEach((function(e,n){kP(t.remoteStore,n)})),t.ac.fs(),t.cc=new Map,t.uc=new FS(nE.comparator)}(i),i.dc=!1,e.next=40,XP(i.remoteStore,!1);case 40:case"end":return e.stop()}}),t,null,[[10,14,18,26],[19,,21,25]])})))).apply(this,arguments)}function hM(e,t,n){return fM.apply(this,arguments)}function fM(){return(fM=e(u)(e(_).mark((function t(n,r,i){var a,o,s,u,c,l,h,f,d,p,v,y,m,g,k,w,b,x,I,T;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=PT(n),o=[],s=[],u=!0,c=!1,l=void 0,e.prev=2,h=r[Symbol.iterator]();case 4:if(u=(f=h.next()).done){e.next=53;break}if(d=f.value,!(v=a.rc.get(d))||0===v.length){e.next=41;break}return e.next=11,DD(a.localStore,cC(v[0]));case 11:p=e.sent,y=!0,m=!1,g=void 0,e.prev=13,k=v[Symbol.iterator]();case 15:if(y=(w=k.next()).done){e.next=25;break}return b=w.value,x=a.ic.get(b),e.next=20,rM(a,x);case 20:(I=e.sent).snapshot&&s.push(I.snapshot);case 22:y=!0,e.next=15;break;case 25:e.next=31;break;case 27:e.prev=27,e.t0=e.catch(13),m=!0,g=e.t0;case 31:e.prev=31,e.prev=32,y||null==k.return||k.return();case 34:if(e.prev=34,!m){e.next=37;break}throw g;case 37:return e.finish(34);case 38:return e.finish(31);case 39:e.next=49;break;case 41:return e.next=43,LD(a.localStore,d);case 43:return T=e.sent,e.next=46,DD(a.localStore,T);case 46:return p=e.sent,e.next=49,CO(a,dM(T),d,!1,p.resumeToken);case 49:o.push(p);case 50:u=!0,e.next=4;break;case 53:e.next=59;break;case 55:e.prev=55,e.t1=e.catch(2),c=!0,l=e.t1;case 59:e.prev=59,e.prev=60,u||null==h.return||h.return();case 62:if(e.prev=62,!c){e.next=65;break}throw l;case 65:return e.finish(62);case 66:return e.finish(59);case 67:return e.abrupt("return",(a.sc.Wo(s),o));case 68:case"end":return e.stop()}}),t,null,[[2,55,59,67],[13,27,31,39],[32,,34,38],[60,,62,66]])})))).apply(this,arguments)}function dM(e){return nC(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function pM(e){var t=PT(e);return PT(PT(t.localStore).persistence).vi()}function vM(e,t,n,r){return yM.apply(this,arguments)}function yM(){return(yM=e(u)(e(_).mark((function t(n,r,i,a){var o,s,u,c;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(o=PT(n)).dc){e.next=3;break}return e.abrupt("return",void ST("SyncEngine","Ignoring unexpected query state notification."));case 3:if(!((s=o.rc.get(r))&&s.length>0)){e.next=20;break}e.t0=i,e.next="current"===e.t0||"not-current"===e.t0?8:"rejected"===e.t0?15:19;break;case 8:return e.next=10,FD(o.localStore,yC(s[0]));case 10:return u=e.sent,c=yA.createSynthesizedRemoteEventForCurrentChange(r,"current"===i,UE.EMPTY_BYTE_STRING),e.next=14,$O(o,u,c);case 14:return e.abrupt("break",20);case 15:return e.next=17,PD(o.localStore,r,!0);case 17:return HO(o,r,a),e.abrupt("break",20);case 19:RT();case 20:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function mM(e,t,n){return gM.apply(this,arguments)}function gM(){return(gM=e(u)(e(_).mark((function t(n,r,i){var a,o,s,u,c,l,h,f,d,p,v,y,m,g,k;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a=kM(n)).dc){e.next=62;break}o=!0,s=!1,u=void 0,e.prev=3,c=r[Symbol.iterator]();case 5:if(o=(l=c.next()).done){e.next=22;break}if(h=l.value,!a.rc.has(h)){e.next=10;break}return ST("SyncEngine","Adding an already active target "+h),e.abrupt("continue",19);case 10:return e.next=12,LD(a.localStore,h);case 12:return f=e.sent,e.next=15,DD(a.localStore,f);case 15:return d=e.sent,e.next=18,CO(a,dM(f),d.targetId,!1,d.resumeToken);case 18:gP(a.remoteStore,d);case 19:o=!0,e.next=5;break;case 22:e.next=28;break;case 24:e.prev=24,e.t0=e.catch(3),s=!0,u=e.t0;case 28:e.prev=28,e.prev=29,o||null==c.return||c.return();case 31:if(e.prev=31,!s){e.next=34;break}throw u;case 34:return e.finish(31);case 35:return e.finish(28);case 36:p=!0,v=!1,y=void 0,e.prev=37,m=i[Symbol.iterator]();case 39:if(p=(g=m.next()).done){e.next=48;break}if(k=g.value,e.t1=a.rc.has(k),!e.t1){e.next=45;break}return e.next=45,PD(a.localStore,k,!1).then((function(){kP(a.remoteStore,k),HO(a,k)})).catch(pE);case 45:p=!0,e.next=39;break;case 48:e.next=54;break;case 50:e.prev=50,e.t2=e.catch(37),v=!0,y=e.t2;case 54:e.prev=54,e.prev=55,p||null==m.return||m.return();case 57:if(e.prev=57,!v){e.next=60;break}throw y;case 60:return e.finish(57);case 61:return e.finish(54);case 62:case"end":return e.stop()}}),t,null,[[3,24,28,36],[29,,31,35],[37,50,54,62],[55,,57,61]])})))).apply(this,arguments)}function kM(e){var t=PT(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=OO.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=nM.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=FO.bind(null,t),t.sc.Wo=fO.bind(null,t.eventManager),t.sc.wc=dO.bind(null,t.eventManager),t}function _M(e){var t=PT(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=qO.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=jO.bind(null,t),t}function wM(t,n,r){var i,a=PT(t);(i=e(u)(e(_).mark((function t(n,r,i){var a,o,s,u,c;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.getMetadata();case 3:return a=e.sent,e.next=6,function(e,t){var n=PT(e),r=DA(t.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",(function(e){return n.Ns.getBundleMetadata(e,t.id)})).then((function(e){return!!e&&e.createTime.compareTo(r)>=0}))}(n.localStore,a);case 6:if(!e.sent){e.next=11;break}return e.next=9,r.close();case 9:return i._completeWith({taskState:"Success",documentsLoaded:(t=a).totalDocuments,bytesLoaded:t.totalBytes,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}),e.abrupt("return",(e.sent,Promise.resolve(new Set)));case 11:return i._updateProgress(kO(a)),o=new gO(a,n.localStore,r.yt),e.next=15,r.mc();case 15:s=e.sent;case 16:if(!s){e.next=26;break}return e.next=19,o.Fu(s);case 19:return(u=e.sent)&&i._updateProgress(u),e.next=23,r.mc();case 23:s=e.sent;case 24:e.next=16;break;case 26:return e.next=28,o.complete();case 28:return c=e.sent,e.next=31,$O(n,c.Lu,void 0);case 31:return e.next=33,function(e,t){var n=PT(e);return n.persistence.runTransaction("Save bundle","readwrite",(function(e){return n.Ns.saveBundleMetadata(e,t)}))}(n.localStore,a);case 33:return i._completeWith(c.progress),e.abrupt("return",(e.sent,e.sent,Promise.resolve(c.Bu)));case 37:return e.prev=37,e.t0=e.catch(0),e.abrupt("return",(AT("SyncEngine","Loading bundle failed with ".concat(e.t0)),i._failWith(e.t0),Promise.resolve(new Set)));case 40:case"end":return e.stop()}var t}),t,null,[[0,37]])}))),function(e,t,n){return i.apply(this,arguments)})(a,n,r).then((function(e){a.sharedClientState.notifyBundleLoaded(e)}))}var bM=function(){"use strict";function t(){e(l)(this,t),this.synchronizeTabs=!1}return e(h)(t,[{key:"initialize",value:function(t){var n=this;return e(u)(e(_).mark((function r(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.yt=oP(t.databaseInfo.databaseId),n.sharedClientState=n.gc(t),n.persistence=n.yc(t),e.next=5,n.persistence.start();case 5:n.localStore=n.Ic(t),n.gcScheduler=n.Tc(t,n.localStore),n.indexBackfillerScheduler=n.Ec(t,n.localStore);case 8:case"end":return e.stop()}}),r)})))()}},{key:"Tc",value:function(e,t){return null}},{key:"Ec",value:function(e,t){return null}},{key:"Ic",value:function(e){return ID(this.persistence,new bD,e.initialUser,this.yt)}},{key:"yc",value:function(e){return new hD(dD.Bs,this.yt)}},{key:"gc",value:function(e){return new $D}},{key:"terminate",value:function(){var t=this;return e(u)(e(_).mark((function n(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.gcScheduler&&t.gcScheduler.stop(),e.next=3,t.sharedClientState.shutdown();case 3:return e.next=5,t.persistence.shutdown();case 5:case"end":return e.stop()}}),n)})))()}}]),t}(),xM=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i,a){var o;return e(l)(this,r),(o=n.call(this)).Ac=t,o.cacheSizeBytes=i,o.forceOwnership=a,o.synchronizeTabs=!1,e(gw)(o)}return e(h)(r,[{key:"initialize",value:function(t){var n=this,i=this;return e(u)(e(_).mark((function a(){return e(_).wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e(Nd)(e(Pd)(r.prototype),"initialize",n).call(i,t);case 2:return a.next=4,i.Ac.initialize(i,t);case 4:return a.next=6,_M(i.Ac.syncEngine);case 6:return a.next=8,MP(i.Ac.remoteStore);case 8:return a.next=10,i.persistence.li((function(){return i.gcScheduler&&!i.gcScheduler.started&&i.gcScheduler.start(),i.indexBackfillerScheduler&&!i.indexBackfillerScheduler.started&&i.indexBackfillerScheduler.start(),Promise.resolve()}));case 10:case"end":return a.stop()}}),a)})))()}},{key:"Ic",value:function(e){return ID(this.persistence,new bD,e.initialUser,this.yt)}},{key:"Tc",value:function(e,t){var n=this.persistence.referenceDelegate.garbageCollector;return new BR(n,e.asyncQueue,t)}},{key:"Ec",value:function(e,t){var n=new SE(t,this.persistence);return new EE(e.asyncQueue,n)}},{key:"yc",value:function(e){var t=_D(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?SR.withCacheSize(this.cacheSizeBytes):SR.DEFAULT;return new mD(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,iP(),aP(),this.yt,this.sharedClientState,!!this.forceOwnership)}},{key:"gc",value:function(e){return new $D}}]),r}(bM),IM=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i){var a;return e(l)(this,r),(a=n.call(this,t,i,!1)).Ac=t,a.cacheSizeBytes=i,a.synchronizeTabs=!0,e(gw)(a)}return e(h)(r,[{key:"initialize",value:function(t){var n=this,i=this;return e(u)(e(_).mark((function a(){var o;return e(_).wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e(Nd)(e(Pd)(r.prototype),"initialize",n).call(i,t);case 2:if(o=i.Ac.syncEngine,a.t0=i.sharedClientState instanceof XD,!a.t0){a.next=8;break}return i.sharedClientState.syncEngine={Fr:sM.bind(null,o),$r:vM.bind(null,o),Br:mM.bind(null,o),vi:pM.bind(null,o),Mr:aM.bind(null,o)},a.next=8,i.sharedClientState.start();case 8:return a.next=10,i.persistence.li(function(){var t=e(u)(e(_).mark((function t(n){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,cM(i.Ac.syncEngine,n);case 2:i.gcScheduler&&(n&&!i.gcScheduler.started?i.gcScheduler.start():n||i.gcScheduler.stop()),i.indexBackfillerScheduler&&(n&&!i.indexBackfillerScheduler.started?i.indexBackfillerScheduler.start():n||i.indexBackfillerScheduler.stop());case 4:case"end":return e.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 10:case"end":return a.stop()}}),a)})))()}},{key:"gc",value:function(e){var t=iP();if(!XD.C(t))throw new MT(OT.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=_D(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new XD(t,e.asyncQueue,n,e.clientId,e.initialUser)}}]),r}(xM),TM=function(){"use strict";function t(){e(l)(this,t)}return e(h)(t,[{key:"initialize",value:function(t,n){var r=this;return e(u)(e(_).mark((function i(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=r.localStore,e.t0){e.next=12;break}return r.localStore=t.localStore,r.sharedClientState=t.sharedClientState,r.datastore=r.createDatastore(n),r.remoteStore=r.createRemoteStore(n),r.eventManager=r.createEventManager(n),r.syncEngine=r.createSyncEngine(n,!t.synchronizeTabs),r.sharedClientState.onlineStateHandler=function(e){return LO(r.syncEngine,e,1)},r.remoteStore.remoteSyncer.handleCredentialChange=eM.bind(null,r.syncEngine),e.next=12,XP(r.remoteStore,r.syncEngine.isPrimaryClient);case 12:case"end":return e.stop()}}),i)})))()}},{key:"createEventManager",value:function(e){return new sO}},{key:"createDatastore",value:function(e){var t,n,r,i=oP(e.databaseInfo.databaseId),a=(t=e.databaseInfo,new rP(t));return n=e.authCredentials,r=e.appCheckCredentials,new hP(n,r,a,i)}},{key:"createRemoteStore",value:function(e){var t,n,r,i,a,o=this;return t=this.localStore,n=this.datastore,r=e.asyncQueue,i=function(e){return LO(o.syncEngine,e,0)},a=eP.C()?new eP:new ZD,new dP(t,n,r,i,a)}},{key:"createSyncEngine",value:function(e,t){return function(e,t,n,r,i,a,o){var s=new TO(e,t,n,r,i,a);return o&&(s.dc=!0),s}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}},{key:"terminate",value:function(){return(t=e(u)(e(_).mark((function t(n){var r;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=PT(n),ST("RemoteStore","RemoteStore shutting down."),r._u.add(5),e.next=5,yP(r);case 5:r.mu.shutdown(),r.gu.set("Unknown");case 7:case"end":return e.stop()}}),t)}))),function(e){return t.apply(this,arguments)})(this.remoteStore);var t}}]),t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function EM(e,t,n){if(!n)throw new MT(OT.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function SM(e,t,n,r){if(!0===t&&!0===r)throw new MT(OT.INVALID_ARGUMENT,"".concat(e," and ").concat(n," cannot be used together."))}function CM(e){if(!nE.isDocumentKey(e))throw new MT(OT.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function AM(e){if(nE.isDocumentKey(e))throw new MT(OT.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function NM(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";var t=(n=e).constructor?n.constructor.name:null;return t?"a custom ".concat(t," object"):"an object"}var n;return"function"==typeof e?"a function":RT()}function RM(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new MT(OT.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=NM(e);throw new MT(OT.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}return e}function DM(e,t){if(t<=0)throw new MT(OT.INVALID_ARGUMENT,"Function ".concat(e,"() requires a positive number, but it was: ").concat(t,"."))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var PM=new Map,OM=function(){"use strict";function t(n){var r;if(e(l)(this,t),void 0===n.host){if(void 0!==n.ssl)throw new MT(OT.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=n.host,this.ssl=null===(r=n.ssl)||void 0===r||r;if(this.credentials=n.credentials,this.ignoreUndefinedProperties=!!n.ignoreUndefinedProperties,void 0===n.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==n.cacheSizeBytes&&n.cacheSizeBytes<1048576)throw new MT(OT.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=n.cacheSizeBytes}this.experimentalForceLongPolling=!!n.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!n.experimentalAutoDetectLongPolling,this.useFetchStreams=!!n.useFetchStreams,SM("experimentalForceLongPolling",n.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",n.experimentalAutoDetectLongPolling)}return e(h)(t,[{key:"isEqual",value:function(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}]),t}(),MM=function(){"use strict";function t(n,r,i,a){e(l)(this,t),this._authCredentials=n,this._appCheckCredentials=r,this._databaseId=i,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new OM({}),this._settingsFrozen=!1}return e(h)(t,[{key:"app",get:function(){if(!this._app)throw new MT(OT.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}},{key:"_initialized",get:function(){return this._settingsFrozen}},{key:"_terminated",get:function(){return void 0!==this._terminateTask}},{key:"_setSettings",value:function(e){if(this._settingsFrozen)throw new MT(OT.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new OM(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new UT;switch(e.type){case"gapi":var t=e.client;return new BT(t,e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new MT(OT.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}},{key:"_getSettings",value:function(){return this._settings}},{key:"_freezeSettings",value:function(){return this._settingsFrozen=!0,this._settings}},{key:"_delete",value:function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}},{key:"toJSON",value:function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}},{key:"_terminate",value:function(){return e=this,(t=PM.get(e))&&(ST("ComponentProvider","Removing Datastore"),PM.delete(e),t.terminate()),Promise.resolve();var e,t}}]),t}();function LM(e,t,n){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=(e=RM(e,MM))._getSettings();if("firestore.googleapis.com"!==a.host&&a.host!==t&&AT("Host has been set in both settings() and useEmulator(), emulator host will be used"),e._setSettings(Object.assign(Object.assign({},a),{host:"".concat(t,":").concat(n),ssl:!1})),i.mockUserToken){var o,s;if("string"==typeof i.mockUserToken)o=i.mockUserToken,s=xT.MOCK_USER;else{o=Pe(i.mockUserToken,null===(r=e._app)||void 0===r?void 0:r.options.projectId);var u=i.mockUserToken.sub||i.mockUserToken.user_id;if(!u)throw new MT(OT.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");s=new xT(u)}e._authCredentials=new qT(new FT(o,s))}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var FM=function(){"use strict";function t(n,r,i){e(l)(this,t),this.converter=r,this._key=i,this.type="document",this.firestore=n}return e(h)(t,[{key:"_path",get:function(){return this._key.path}},{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"path",get:function(){return this._key.path.canonicalString()}},{key:"parent",get:function(){return new qM(this.firestore,this.converter,this._key.path.popLast())}},{key:"withConverter",value:function(e){return new t(this.firestore,e,this._key)}}]),t}(),UM=function(){"use strict";function t(n,r,i){e(l)(this,t),this.converter=r,this._query=i,this.type="query",this.firestore=n}return e(h)(t,[{key:"withConverter",value:function(e){return new t(this.firestore,e,this._query)}}]),t}(),qM=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i,a){var o;return e(l)(this,r),(o=n.call(this,t,i,rC(a)))._path=a,o.type="collection",e(gw)(o)}return e(h)(r,[{key:"id",get:function(){return this._query.path.lastSegment()}},{key:"path",get:function(){return this._query.path.canonicalString()}},{key:"parent",get:function(){var e=this._path.popLast();return e.isEmpty()?null:new FM(this.firestore,null,new nE(e))}},{key:"withConverter",value:function(e){return new r(this.firestore,e,this._path)}}]),r}(UM);function VM(t,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];if(t=lt(t),EM("collection","path",n),t instanceof MM){var o,s=(o=ZT).fromString.apply(o,[n].concat(e(p)(i)));return AM(s),new qM(t,null,s)}var u;if(!(t instanceof FM||t instanceof qM))throw new MT(OT.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var c=t._path.child((u=ZT).fromString.apply(u,[n].concat(e(p)(i))));return AM(c),new qM(t.firestore,null,c)}function jM(e,t){if(e=RM(e,MM),EM("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new MT(OT.INVALID_ARGUMENT,"Invalid collection ID '".concat(t,"' passed to function collectionGroup(). Collection IDs must not contain '/'."));return new UM(e,null,(n=t,new tC(ZT.emptyPath(),n)));var n}function BM(t,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];if(t=lt(t),1===arguments.length&&(n=GT.R()),EM("doc","path",n),t instanceof MM){var o,s=(o=ZT).fromString.apply(o,[n].concat(e(p)(i)));return CM(s),new FM(t,null,new nE(s))}var u;if(!(t instanceof FM||t instanceof qM))throw new MT(OT.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var c=t._path.child((u=ZT).fromString.apply(u,[n].concat(e(p)(i))));return CM(c),new FM(t.firestore,t instanceof qM?t.converter:null,new nE(c))}function KM(e,t){return e=lt(e),t=lt(t),(e instanceof FM||e instanceof qM)&&(t instanceof FM||t instanceof qM)&&e.firestore===t.firestore&&e.path===t.path&&e.converter===t.converter}function zM(e,t){return e=lt(e),t=lt(t),e instanceof UM&&t instanceof UM&&e.firestore===t.firestore&&fC(e._query,t._query)&&e.converter===t.converter
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}function WM(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10240,r=0;return{read:function(){return e(u)(e(_).mark((function i(){var a;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r<t.byteLength)){e.next=3;break}return a={value:t.slice(r,r+n),done:!1},e.abrupt("return",(r+=n,a));case 3:return e.abrupt("return",{done:!0});case 4:case"end":return e.stop()}}),i)})))()},cancel:function(){return e(u)(e(_).mark((function t(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),t)})))()},releaseLock:function(){},closed:Promise.reject("unimplemented")}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var GM=function(){"use strict";function t(n){e(l)(this,t),this.observer=n,this.muted=!1}return e(h)(t,[{key:"next",value:function(e){this.observer.next&&this.Rc(this.observer.next,e)}},{key:"error",value:function(e){this.observer.error?this.Rc(this.observer.error,e):CT("Uncaught Error in snapshot listener:",e.toString())}},{key:"bc",value:function(){this.muted=!0}},{key:"Rc",value:function(e,t){var n=this;this.muted||setTimeout((function(){n.muted||e(t)}),0)}}]),t}(),HM=function(){"use strict";function t(n,r){var i=this;e(l)(this,t),this.Pc=n,this.yt=r,this.metadata=new LT,this.buffer=new Uint8Array,this.vc=new TextDecoder("utf-8"),this.Vc().then((function(e){e&&e.Ou()?i.metadata.resolve(e.ku.metadata):i.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             ".concat(JSON.stringify(null==e?void 0:e.ku))))}),(function(e){return i.metadata.reject(e)}))}return e(h)(t,[{key:"close",value:function(){return this.Pc.cancel()}},{key:"getMetadata",value:function(){var t=this;return e(u)(e(_).mark((function n(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.metadata.promise);case 1:case"end":return e.stop()}}),n)})))()}},{key:"mc",value:function(){var t=this;return e(u)(e(_).mark((function n(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getMetadata();case 2:return e.abrupt("return",(e.sent,t.Vc()));case 3:case"end":return e.stop()}}),n)})))()}},{key:"Vc",value:function(){var t=this;return e(u)(e(_).mark((function n(){var r,i,a,o;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.Sc();case 2:if(null!==(r=e.sent)){e.next=5;break}return e.abrupt("return",null);case 5:return i=t.vc.decode(r),a=Number(i),isNaN(a)&&t.Dc("length string (".concat(i,") is not valid number")),e.next=9,t.Cc(a);case 9:return o=e.sent,e.abrupt("return",new yO(JSON.parse(o),r.length+a));case 11:case"end":return e.stop()}}),n)})))()}},{key:"xc",value:function(){return this.buffer.findIndex((function(e){return e==="{".charCodeAt(0)}))}},{key:"Sc",value:function(){var t=this;return e(u)(e(_).mark((function n(){var r,i;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.xc()<0)){e.next=7;break}return e.next=3,t.Nc();case 3:if(!e.sent){e.next=5;break}return e.abrupt("break",7);case 5:e.next=0;break;case 7:if(0!==t.buffer.length){e.next=9;break}return e.abrupt("return",null);case 9:return(r=t.xc())<0&&t.Dc("Reached the end of bundle when a length string is expected."),i=t.buffer.slice(0,r),e.abrupt("return",(t.buffer=t.buffer.slice(r),i));case 13:case"end":return e.stop()}}),n)})))()}},{key:"Cc",value:function(t){var n=this;return e(u)(e(_).mark((function r(){var i;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n.buffer.length<t)){e.next=8;break}return e.next=3,n.Nc();case 3:if(e.t0=e.sent,!e.t0){e.next=6;break}n.Dc("Reached the end of bundle when more is expected.");case 6:e.next=0;break;case 8:return i=n.vc.decode(n.buffer.slice(0,t)),e.abrupt("return",(n.buffer=n.buffer.slice(t),i));case 10:case"end":return e.stop()}}),r)})))()}},{key:"Dc",value:function(e){throw this.Pc.cancel(),new Error("Invalid bundle format: ".concat(e))}},{key:"Nc",value:function(){var t=this;return e(u)(e(_).mark((function n(){var r,i;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.Pc.read();case 2:return(r=e.sent).done||((i=new Uint8Array(t.buffer.length+r.value.length)).set(t.buffer),i.set(r.value,t.buffer.length),t.buffer=i),e.abrupt("return",r.done);case 5:case"end":return e.stop()}}),n)})))()}}]),t}(),QM=function(){"use strict";function t(n){e(l)(this,t),this.datastore=n,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return e(h)(t,[{key:"lookup",value:function(t){var n=this;return e(u)(e(_).mark((function r(){var i;return e(_).wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n.ensureCommitNotCalled(),!(n.mutations.length>0)){r.next=2;break}throw new MT(OT.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");case 2:return r.next=4,function(){var t=e(u)(e(_).mark((function t(n,r){var i,a,o,s,u,c;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=PT(n),a=qA(i.yt)+"/documents",o={documents:r.map((function(e){return MA(i.yt,e)}))},e.next=5,i._o("BatchGetDocuments",a,o,r.length);case 5:return s=e.sent,u=new Map,s.forEach((function(e){var t,n,r=(t=i.yt,"found"in(n=e)?function(e,t){DT(!!t.found),t.found.name,t.found.updateTime;var n=LA(e,t.found.name),r=DA(t.found.updateTime),i=t.found.createTime?DA(t.found.createTime):XT.min(),a=new zS({mapValue:{fields:t.found.fields}});return GS.newFoundDocument(n,r,i,a)}(t,n):"missing"in n?function(e,t){DT(!!t.missing),DT(!!t.readTime);var n=LA(e,t.missing),r=DA(t.readTime);return GS.newNoDocument(n,r)}(t,n):RT());u.set(r.key.toString(),r)})),c=[],e.abrupt("return",(r.forEach((function(e){var t=u.get(e.toString());DT(!!t),c.push(t)})),c));case 10:case"end":return e.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()(n.datastore,t);case 4:return i=r.sent,r.abrupt("return",(i.forEach((function(e){return n.recordVersion(e)})),i));case 6:case"end":return r.stop()}}),r)})))()}},{key:"set",value:function(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}},{key:"update",value:function(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastWriteError=e}this.writtenDocs.add(e.toString())}},{key:"delete",value:function(e){this.write(new XC(e,this.precondition(e))),this.writtenDocs.add(e.toString())}},{key:"commit",value:function(){var t=this;return e(u)(e(_).mark((function n(){var r;return e(_).wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.ensureCommitNotCalled(),!t.lastWriteError){n.next=2;break}throw t.lastWriteError;case 2:return r=t.readVersions,t.mutations.forEach((function(e){r.delete(e.key.toString())})),r.forEach((function(e,n){var r=nE.fromPath(n);t.mutations.push(new $C(r,t.precondition(r)))})),n.next=7,function(){var t=e(u)(e(_).mark((function t(n,r){var i,a,o;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=PT(n),a=qA(i.yt)+"/documents",o={writes:r.map((function(e){return KA(i.yt,e)}))},e.next=3,i.ao("Commit",a,o);case 3:case"end":return e.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()(t.datastore,t.mutations);case 7:t.committed=!0;case 8:case"end":return n.stop()}}),n)})))()}},{key:"recordVersion",value:function(e){var t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw RT();t=XT.min()}var n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new MT(OT.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}},{key:"precondition",value:function(e){var t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(XT.min())?LC.exists(!1):LC.updateTime(t):LC.none()}},{key:"preconditionForUpdate",value:function(e){var t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(XT.min()))throw new MT(OT.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return LC.updateTime(t)}return LC.exists(!0)}},{key:"write",value:function(e){this.ensureCommitNotCalled(),this.mutations.push(e)}},{key:"ensureCommitNotCalled",value:function(){}}]),t}(),YM=function(){"use strict";function t(n,r,i,a,o){e(l)(this,t),this.asyncQueue=n,this.datastore=r,this.options=i,this.updateFunction=a,this.deferred=o,this.kc=i.maxAttempts,this.xo=new sP(this.asyncQueue,"transaction_retry")}return e(h)(t,[{key:"run",value:function(){this.kc-=1,this.Oc()}},{key:"Oc",value:function(){var t=this;this.xo.Ro(e(u)(e(_).mark((function n(){var r,i;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=new QM(t.datastore),(i=t.Mc(r))&&i.then((function(e){t.asyncQueue.enqueueAndForget((function(){return r.commit().then((function(){t.deferred.resolve(e)})).catch((function(e){t.Fc(e)}))}))})).catch((function(e){t.Fc(e)}));case 2:case"end":return e.stop()}}),n)}))))}},{key:"Mc",value:function(e){try{var t=this.updateFunction(e);return!OE(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}},{key:"Fc",value:function(e){var t=this;this.kc>0&&this.$c(e)?(this.kc-=1,this.asyncQueue.enqueueAndForget((function(){return t.Oc(),Promise.resolve()}))):this.deferred.reject(e)}},{key:"$c",value:function(e){if("FirebaseError"===e.name){var t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!eA(t)}return!1}}]),t}(),JM=function(){"use strict";function t(n,r,i,a){var o=this;e(l)(this,t);var s,c=this;this.authCredentials=n,this.appCheckCredentials=r,this.asyncQueue=i,this.databaseInfo=a,this.user=xT.UNAUTHENTICATED,this.clientId=GT.R(),this.authCredentialListener=function(){return Promise.resolve()},this.appCheckCredentialListener=function(){return Promise.resolve()},this.authCredentials.start(i,(s=e(u)(e(_).mark((function t(n){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ST("FirestoreClient","Received user=",n.uid),e.next=3,c.authCredentialListener(n);case 3:c.user=n;case 4:case"end":return e.stop()}}),t)}))),function(e){return s.apply(this,arguments)})),this.appCheckCredentials.start(i,(function(e){return ST("FirestoreClient","Received new app check token=",e),o.appCheckCredentialListener(e,o.user)}))}return e(h)(t,[{key:"getConfiguration",value:function(){var t=this;return e(u)(e(_).mark((function n(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{asyncQueue:t.asyncQueue,databaseInfo:t.databaseInfo,clientId:t.clientId,authCredentials:t.authCredentials,appCheckCredentials:t.appCheckCredentials,initialUser:t.user,maxConcurrentLimboResolutions:100});case 1:case"end":return e.stop()}}),n)})))()}},{key:"setCredentialChangeListener",value:function(e){this.authCredentialListener=e}},{key:"setAppCheckTokenChangeListener",value:function(e){this.appCheckCredentialListener=e}},{key:"verifyNotTerminated",value:function(){if(this.asyncQueue.isShuttingDown)throw new MT(OT.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"terminate",value:function(){this.asyncQueue.enterRestrictedMode();var t=new LT,n=this;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(e(u)(e(_).mark((function r(){var i;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,e.t0=n.onlineComponents,!e.t0){e.next=5;break}return e.next=5,n.onlineComponents.terminate();case 5:if(e.t1=n.offlineComponents,!e.t1){e.next=9;break}return e.next=9,n.offlineComponents.terminate();case 9:n.authCredentials.shutdown(),n.appCheckCredentials.shutdown(),t.resolve(),e.next=18;break;case 14:e.prev=14,e.t2=e.catch(0),i=nO(e.t2,"Failed to shutdown persistence"),t.reject(i);case 18:case"end":return e.stop()}}),r,null,[[0,14]])})))),t.promise}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XM(e,t){return $M.apply(this,arguments)}function $M(){return $M=e(u)(e(_).mark((function t(n,r){var i,a;return e(_).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.asyncQueue.verifyOperationInProgress(),ST("FirestoreClient","Initializing OfflineComponentProvider"),t.next=3,n.getConfiguration();case 3:return i=t.sent,t.next=6,r.initialize(i);case 6:a=i.initialUser,n.setCredentialChangeListener(function(){var t=e(u)(e(_).mark((function t(n){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=a.isEqual(n),e.t0){e.next=5;break}return e.next=4,TD(r.localStore,n);case 4:a=n;case 5:case"end":return e.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),r.persistence.setDatabaseDeletedListener((function(){return n.terminate()})),n.offlineComponents=r;case 8:case"end":return t.stop()}}),t)}))),$M.apply(this,arguments)}function ZM(e,t){return eL.apply(this,arguments)}function eL(){return(eL=e(u)(e(_).mark((function t(n,r){var i,a;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.asyncQueue.verifyOperationInProgress(),e.next=3,tL(n);case 3:return i=e.sent,ST("FirestoreClient","Initializing OnlineComponentProvider"),e.next=7,n.getConfiguration();case 7:return a=e.sent,e.next=10,r.initialize(i,a);case 10:n.setCredentialChangeListener((function(e){return YP(r.remoteStore,e)})),n.setAppCheckTokenChangeListener((function(e,t){return YP(r.remoteStore,t)})),n.onlineComponents=r;case 13:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function tL(e){return nL.apply(this,arguments)}function nL(){return(nL=e(u)(e(_).mark((function t(n){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n.offlineComponents,e.t0){e.next=5;break}return ST("FirestoreClient","Using default OfflineComponentProvider"),e.next=5,XM(n,new bM);case 5:return e.abrupt("return",(e.t0||e.sent,n.offlineComponents));case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function rL(e){return iL.apply(this,arguments)}function iL(){return(iL=e(u)(e(_).mark((function t(n){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n.onlineComponents,e.t0){e.next=5;break}return ST("FirestoreClient","Using default OnlineComponentProvider"),e.next=5,ZM(n,new TM);case 5:return e.abrupt("return",(e.t0||e.sent,n.onlineComponents));case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function aL(e){return tL(e).then((function(e){return e.persistence}))}function oL(e){return tL(e).then((function(e){return e.localStore}))}function sL(e){return rL(e).then((function(e){return e.remoteStore}))}function uL(e){return rL(e).then((function(e){return e.syncEngine}))}function cL(e){return rL(e).then((function(e){return e.datastore}))}function lL(e){return hL.apply(this,arguments)}function hL(){return(hL=e(u)(e(_).mark((function t(n){var r,i;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,rL(n);case 2:return r=e.sent,i=r.eventManager,e.abrupt("return",(i.onListen=EO.bind(null,r.syncEngine),i.onUnlisten=NO.bind(null,r.syncEngine),i));case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function fL(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=new LT;return t.asyncQueue.enqueueAndForget(e(u)(e(_).mark((function a(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=function(e,t,n,r,i){var a=new GM({next:function(a){t.enqueueAndForget((function(){return lO(e,o)}));var s=a.docs.has(n);!s&&a.fromCache?i.reject(new MT(OT.UNAVAILABLE,"Failed to get document because the client is offline.")):s&&a.fromCache&&r&&"server"===r.source?i.reject(new MT(OT.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(a)},error:function(e){return i.reject(e)}}),o=new vO(rC(n.path),a,{includeMetadataChanges:!0,Nu:!0});return uO(e,o)},e.next=3,lL(t);case 3:return e.t1=e.sent,e.t2=t.asyncQueue,e.t3=n,e.t4=r,e.t5=i,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3,e.t4,e.t5));case 9:case"end":return e.stop()}}),a)})))),i.promise}function dL(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=new LT;return t.asyncQueue.enqueueAndForget(e(u)(e(_).mark((function a(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=function(e,t,n,r,i){var a=new GM({next:function(n){t.enqueueAndForget((function(){return lO(e,o)})),n.fromCache&&"server"===r.source?i.reject(new MT(OT.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(e){return i.reject(e)}}),o=new vO(n,a,{includeMetadataChanges:!0,Nu:!0});return uO(e,o)},e.next=3,lL(t);case 3:return e.t1=e.sent,e.t2=t.asyncQueue,e.t3=n,e.t4=r,e.t5=i,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3,e.t4,e.t5));case 9:case"end":return e.stop()}}),a)})))),i.promise}var pL=function(){"use strict";function t(){var n=this;e(l)(this,t),this.Bc=Promise.resolve(),this.Lc=[],this.qc=!1,this.Uc=[],this.Kc=null,this.Gc=!1,this.Qc=!1,this.jc=[],this.xo=new sP(this,"async_queue_retry"),this.Wc=function(){var e=aP();e&&ST("AsyncQueue","Visibility state changed to "+e.visibilityState),n.xo.Po()};var r=aP();r&&"function"==typeof r.addEventListener&&r.addEventListener("visibilitychange",this.Wc)}return e(h)(t,[{key:"isShuttingDown",get:function(){return this.qc}},{key:"enqueueAndForget",value:function(e){this.enqueue(e)}},{key:"enqueueAndForgetEvenWhileRestricted",value:function(e){this.zc(),this.Hc(e)}},{key:"enterRestrictedMode",value:function(e){if(!this.qc){this.qc=!0,this.Qc=e||!1;var t=aP();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Wc)}}},{key:"enqueue",value:function(e){var t=this;if(this.zc(),this.qc)return new Promise((function(){}));var n=new LT;return this.Hc((function(){return t.qc&&t.Qc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)})).then((function(){return n.promise}))}},{key:"enqueueRetryable",value:function(e){var t=this;this.enqueueAndForget((function(){return t.Lc.push(e),t.Jc()}))}},{key:"Jc",value:function(){var t=this;return e(u)(e(_).mark((function n(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0===t.Lc.length){e.next=14;break}return e.prev=1,e.next=4,t.Lc[0]();case 4:t.Lc.shift(),t.xo.reset(),e.next=13;break;case 8:if(e.prev=8,e.t0=e.catch(1),wE(e.t0)){e.next=12;break}throw e.t0;case 12:ST("AsyncQueue","Operation failed with retryable error: "+e.t0);case 13:t.Lc.length>0&&t.xo.Ro((function(){return t.Jc()}));case 14:case"end":return e.stop()}}),n,null,[[1,8]])})))()}},{key:"Hc",value:function(e){var t=this,n=this.Bc.then((function(){return t.Gc=!0,e().catch((function(e){var n,r;throw t.Kc=e,t.Gc=!1,CT("INTERNAL UNHANDLED ERROR: ",(r=(n=e).message||"",n.stack&&(r=n.stack.includes(n.message)?n.stack:n.message+"\n"+n.stack),r)),e})).then((function(e){return t.Gc=!1,e}))}));return this.Bc=n,n}},{key:"enqueueAfterDelay",value:function(e,t,n){var r=this;this.zc(),this.jc.indexOf(e)>-1&&(t=0);var i=tO.createAndSchedule(this,e,t,n,(function(e){return r.Yc(e)}));return this.Uc.push(i),i}},{key:"zc",value:function(){this.Kc&&RT()}},{key:"verifyOperationInProgress",value:function(){}},{key:"Xc",value:function(){var t=this;return e(u)(e(_).mark((function n(){var r;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case 1:return r=t.Bc,e.next=4,r;case 4:if(r!==t.Bc){e.next=1;break}case 5:case"end":return e.stop()}}),n)})))()}},{key:"Zc",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=this.Uc[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){if(i.value.timerId===e)return!0}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return!1}},{key:"ta",value:function(e){var t=this;return this.Xc().then((function(){t.Uc.sort((function(e,t){return e.targetTimeMs-t.targetTimeMs}));var n=!0,r=!1,i=void 0;try{for(var a,o=t.Uc[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;if(s.skipDelay(),"all"!==e&&s.timerId===e)break}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return t.Xc()}))}},{key:"ea",value:function(e){this.jc.push(e)}},{key:"Yc",value:function(e){var t=this.Uc.indexOf(e);this.Uc.splice(t,1)}}]),t}();function vL(e){return function(e,t){if("object"!=typeof e||null===e)return!1;var n=e,r=!0,i=!1,a=void 0;try{for(var o,s=["next","error","complete"][Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;if(u in n&&"function"==typeof n[u])return!0}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return!1}(e)}var yL=function(){"use strict";function t(){e(l)(this,t),this._progressObserver={},this._taskCompletionResolver=new LT,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}return e(h)(t,[{key:"onProgress",value:function(e,t,n){this._progressObserver={next:e,error:t,complete:n}}},{key:"catch",value:function(e){return this._taskCompletionResolver.promise.catch(e)}},{key:"then",value:function(e,t){return this._taskCompletionResolver.promise.then(e,t)}},{key:"_completeWith",value:function(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}},{key:"_failWith",value:function(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}},{key:"_updateProgress",value:function(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}]),t}(),mL=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i,a,o){var s;return e(l)(this,r),(s=n.call(this,t,i,a,o)).type="firestore",s._queue=new pL,s._persistenceKey=(null==o?void 0:o.name)||"[DEFAULT]",e(gw)(s)}return e(h)(r,[{key:"_terminate",value:function(){return this._firestoreClient||kL(this),this._firestoreClient.terminate()}}]),r}(MM);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gL(e){return e._firestoreClient||kL(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function kL(e){var t,n,r,i,a,o=e._freezeSettings(),s=(n=e._databaseId,r=(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",i=e._persistenceKey,new AE(n,r,i,(a=o).host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,a.useFetchStreams));e._firestoreClient=new JM(e._authCredentials,e._appCheckCredentials,e._queue,s)}function _L(e,t){CL(e=RM(e,mL));var n=gL(e),r=e._freezeSettings(),i=new TM;return bL(n,i,new xM(i,r.cacheSizeBytes,null==t?void 0:t.forceOwnership))}function wL(e){CL(e=RM(e,mL));var t=gL(e),n=e._freezeSettings(),r=new TM;return bL(t,r,new IM(r,n.cacheSizeBytes))}function bL(t,n,r){var i=new LT;return t.asyncQueue.enqueue(e(u)(e(_).mark((function a(){var o;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,XM(t,r);case 3:return e.next=5,ZM(t,n);case 5:i.resolve(),e.next=14;break;case 8:if(e.prev=8,e.t0=e.catch(0),o=e.t0,"FirebaseError"===(a=o).name?a.code===OT.FAILED_PRECONDITION||a.code===OT.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&a instanceof DOMException)||22===a.code||20===a.code||11===a.code){e.next=13;break}throw o;case 13:AT("Error enabling offline persistence. Falling back to persistence disabled: "+o),i.reject(o);case 14:case"end":return e.stop()}var a}),a,null,[[0,8]])})))).then((function(){return i.promise}))}function xL(t){if(t._initialized&&!t._terminated)throw new MT(OT.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new LT;return t._queue.enqueueAndForgetEvenWhileRestricted(e(u)(e(_).mark((function r(){return e(_).wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,function(){var t=e(u)(e(_).mark((function t(n){var r;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(gE.C()){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return r=n+"main",e.next=5,gE.delete(r);case 5:case"end":return e.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()(_D(t._databaseId,t._persistenceKey));case 3:n.resolve(),r.next=9;break;case 6:r.prev=6,r.t0=r.catch(0),n.reject(r.t0);case 9:case"end":return r.stop()}}),r,null,[[0,6]])})))),n.promise}function IL(t){return(n=gL(t=RM(t,mL))).asyncQueue.enqueue(e(u)(e(_).mark((function t(){var r,i;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,aL(n);case 2:return r=e.sent,e.next=5,sL(n);case 5:return i=e.sent,e.abrupt("return",(r.setNetworkEnabled(!0),t=void 0,(t=PT(i))._u.delete(0),pP(t)));case 7:case"end":return e.stop()}var t}),t)}))));var n}function TL(t){return(n=gL(t=RM(t,mL))).asyncQueue.enqueue(e(u)(e(_).mark((function t(){var r,i;return e(_).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,aL(n);case 2:return r=t.sent,t.next=5,sL(n);case 5:return i=t.sent,t.abrupt("return",(r.setNetworkEnabled(!1),function(){var t=e(u)(e(_).mark((function t(n){var r;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=PT(n))._u.add(0),e.next=4,yP(r);case 4:r.gu.set("Offline");case 5:case"end":return e.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()(i)));case 7:case"end":return t.stop()}}),t)}))));var n}function EL(t,n){var r=gL(t=RM(t,mL)),i=new yL;return function(t,n,r,i){var a,o,s,c,l=(a=r,o=oP(n),s="string"==typeof a?(new TextEncoder).encode(a):a,c=function(e,t){if(e instanceof Uint8Array)return WM(e,t);if(e instanceof ArrayBuffer)return WM(new Uint8Array(e),t);if(e instanceof ReadableStream)return e.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(s),new HM(c,o));t.asyncQueue.enqueueAndForget(e(u)(e(_).mark((function n(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=wM,e.next=3,uL(t);case 3:e.t1=e.sent,e.t2=l,e.t3=i,(0,e.t0)(e.t1,e.t2,e.t3);case 7:case"end":return e.stop()}}),n)}))))}(r,t._databaseId,n,i),i}function SL(t,n){return(r=gL(t=RM(t,mL)),i=n,r.asyncQueue.enqueue(e(u)(e(_).mark((function t(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=function(e,t){var n=PT(e);return n.persistence.runTransaction("Get named query","readonly",(function(e){return n.Ns.getNamedQuery(e,t)}))},e.next=3,oL(r);case 3:return e.t1=e.sent,e.t2=i,e.abrupt("return",(0,e.t0)(e.t1,e.t2));case 6:case"end":return e.stop()}}),t)}))))).then((function(e){return e?new UM(t,null,e.query):null}));var r,i}function CL(e){if(e._initialized||e._terminated)throw new MT(OT.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var AL=function(){"use strict";function t(n){e(l)(this,t),this._byteString=n}return e(h)(t,[{key:"toBase64",value:function(){return this._byteString.toBase64()}},{key:"toUint8Array",value:function(){return this._byteString.toUint8Array()}},{key:"toString",value:function(){return"Bytes(base64: "+this.toBase64()+")"}},{key:"isEqual",value:function(e){return this._byteString.isEqual(e._byteString)}}],[{key:"fromBase64String",value:function(e){try{return new t(UE.fromBase64String(e))}catch(e){throw new MT(OT.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}},{key:"fromUint8Array",value:function(e){return new t(UE.fromUint8Array(e))}}]),t}(),NL=function(){"use strict";function t(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];e(l)(this,t);for(var a=0;a<r.length;++a)if(0===r[a].length)throw new MT(OT.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new tE(r)}return e(h)(t,[{key:"isEqual",value:function(e){return this._internalPath.isEqual(e._internalPath)}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var RL=function t(n){"use strict";e(l)(this,t),this._methodName=n},DL=function(){"use strict";function t(n,r){if(e(l)(this,t),!isFinite(n)||n<-90||n>90)throw new MT(OT.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+n);if(!isFinite(r)||r<-180||r>180)throw new MT(OT.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=n,this._long=r}return e(h)(t,[{key:"latitude",get:function(){return this._lat}},{key:"longitude",get:function(){return this._long}},{key:"isEqual",value:function(e){return this._lat===e._lat&&this._long===e._long}},{key:"toJSON",value:function(){return{latitude:this._lat,longitude:this._long}}},{key:"_compareTo",value:function(e){return HT(this._lat,e._lat)||HT(this._long,e._long)}}]),t}(),PL=/^__.*__$/,OL=function(){"use strict";function t(n,r,i){e(l)(this,t),this.data=n,this.fieldMask=r,this.fieldTransforms=i}return e(h)(t,[{key:"toMutation",value:function(e,t){return null!==this.fieldMask?new WC(e,this.data,this.fieldMask,t,this.fieldTransforms):new zC(e,this.data,t,this.fieldTransforms)}}]),t}(),ML=function(){"use strict";function t(n,r,i){e(l)(this,t),this.data=n,this.fieldMask=r,this.fieldTransforms=i}return e(h)(t,[{key:"toMutation",value:function(e,t){return new WC(e,this.data,this.fieldMask,t,this.fieldTransforms)}}]),t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LL(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw RT()}}var FL=function(){"use strict";function t(n,r,i,a,o,s){e(l)(this,t),this.settings=n,this.databaseId=r,this.yt=i,this.ignoreUndefinedProperties=a,void 0===o&&this.na(),this.fieldTransforms=o||[],this.fieldMask=s||[]}return e(h)(t,[{key:"path",get:function(){return this.settings.path}},{key:"sa",get:function(){return this.settings.sa}},{key:"ia",value:function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.yt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}},{key:"ra",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ia({path:n,oa:!1});return r.ua(e),r}},{key:"ca",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ia({path:n,oa:!1});return r.na(),r}},{key:"aa",value:function(e){return this.ia({path:void 0,oa:!0})}},{key:"ha",value:function(e){return rF(e,this.settings.methodName,this.settings.la||!1,this.path,this.settings.fa)}},{key:"contains",value:function(e){return void 0!==this.fieldMask.find((function(t){return e.isPrefixOf(t)}))||void 0!==this.fieldTransforms.find((function(t){return e.isPrefixOf(t.field)}))}},{key:"na",value:function(){if(this.path)for(var e=0;e<this.path.length;e++)this.ua(this.path.get(e))}},{key:"ua",value:function(e){if(0===e.length)throw this.ha("Document fields must not be empty");if(LL(this.sa)&&PL.test(e))throw this.ha('Document fields cannot begin and end with "__"')}}]),t}(),UL=function(){"use strict";function t(n,r,i){e(l)(this,t),this.databaseId=n,this.ignoreUndefinedProperties=r,this.yt=i||oP(n)}return e(h)(t,[{key:"da",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new FL({sa:e,methodName:t,fa:n,path:tE.emptyPath(),oa:!1,la:r},this.databaseId,this.yt,this.ignoreUndefinedProperties)}}]),t}();function qL(e){var t=e._freezeSettings(),n=oP(e._databaseId);return new UL(e._databaseId,!!t.ignoreUndefinedProperties,n)}function VL(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=e.da(a.merge||a.mergeFields?2:0,t,n,i);ZL("Data must be an object, but it was:",o,r);var s,u,c=XL(r,o);if(a.merge)s=new KS(o.fieldMask),u=o.fieldTransforms;else if(a.mergeFields){var l=[],h=!0,f=!1,d=void 0;try{for(var p,v=a.mergeFields[Symbol.iterator]();!(h=(p=v.next()).done);h=!0){var y=p.value,m=eF(t,y,n);if(!o.contains(m))throw new MT(OT.INVALID_ARGUMENT,"Field '".concat(m,"' is specified in your field mask but missing from your input data."));iF(l,m)||l.push(m)}}catch(e){f=!0,d=e}finally{try{h||null==v.return||v.return()}finally{if(f)throw d}}s=new KS(l),u=o.fieldTransforms.filter((function(e){return s.covers(e.field)}))}else s=null,u=o.fieldTransforms;return new OL(new zS(c),s,u)}var jL=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(){return e(l)(this,r),n.apply(this,arguments)}return e(h)(r,[{key:"_toFieldTransform",value:function(e){if(2!==e.sa)throw 1===e.sa?e.ha("".concat(this._methodName,"() can only appear at the top level of your update data")):e.ha("".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}},{key:"isEqual",value:function(e){return e instanceof r}}]),r}(RL);function BL(e,t,n){return new FL({sa:3,fa:t.settings.fa,methodName:e._methodName,oa:n},t.databaseId,t.yt,t.ignoreUndefinedProperties)}var KL=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(){return e(l)(this,r),n.apply(this,arguments)}return e(h)(r,[{key:"_toFieldTransform",value:function(e){return new OC(e.path,new EC)}},{key:"isEqual",value:function(e){return e instanceof r}}]),r}(RL),zL=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i){var a;return e(l)(this,r),(a=n.call(this,t))._a=i,e(gw)(a)}return e(h)(r,[{key:"_toFieldTransform",value:function(e){var t=BL(this,e,!0),n=this._a.map((function(e){return JL(e,t)})),r=new SC(n);return new OC(e.path,r)}},{key:"isEqual",value:function(e){return this===e}}]),r}(RL),WL=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i){var a;return e(l)(this,r),(a=n.call(this,t))._a=i,e(gw)(a)}return e(h)(r,[{key:"_toFieldTransform",value:function(e){var t=BL(this,e,!0),n=this._a.map((function(e){return JL(e,t)})),r=new AC(n);return new OC(e.path,r)}},{key:"isEqual",value:function(e){return this===e}}]),r}(RL),GL=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i){var a;return e(l)(this,r),(a=n.call(this,t)).wa=i,e(gw)(a)}return e(h)(r,[{key:"_toFieldTransform",value:function(e){var t=new RC(e.yt,wC(e.yt,this.wa));return new OC(e.path,t)}},{key:"isEqual",value:function(e){return this===e}}]),r}(RL);function HL(e,t,n,r){var i=e.da(1,t,n);ZL("Data must be an object, but it was:",i,r);var a=[],o=zS.empty();DE(r,(function(e,r){var s=nF(t,e,n);r=lt(r);var u=i.ca(s);if(r instanceof jL)a.push(s);else{var c=JL(r,u);null!=c&&(a.push(s),o.set(s,c))}}));var s=new KS(a);return new ML(o,s,i.fieldTransforms)}function QL(e,t,n,r,i,a){var o=e.da(1,t,n),s=[eF(t,r,n)],u=[i];if(a.length%2!=0)throw new MT(OT.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(var c=0;c<a.length;c+=2)s.push(eF(t,a[c])),u.push(a[c+1]);for(var l=[],h=zS.empty(),f=s.length-1;f>=0;--f)if(!iF(l,s[f])){var d=s[f],p=u[f];p=lt(p);var v=o.ca(d);if(p instanceof jL)l.push(d);else{var y=JL(p,v);null!=y&&(l.push(d),h.set(d,y))}}var m=new KS(l);return new ML(h,m,o.fieldTransforms)}function YL(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return JL(n,e.da(r?4:3,t))}function JL(e,t){if($L(e=lt(e)))return ZL("Unsupported field value:",t,e),XL(e,t);if(e instanceof RL)return function(e,t){if(!LL(t.sa))throw t.ha("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.ha("".concat(e._methodName,"() is not currently supported inside arrays"));var n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.oa&&4!==t.sa)throw t.ha("Nested arrays are not supported");return function(e,t){var n=[],r=0,i=!0,a=!1,o=void 0;try{for(var s,u=e[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=JL(s.value,t.aa(r));null==c&&(c={nullValue:"NULL_VALUE"}),n.push(c),r++}}catch(e){a=!0,o=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw o}}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=lt(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return wC(t.yt,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){var n=JT.fromDate(e);return{timestampValue:AA(t.yt,n)}}if(e instanceof JT){var r=new JT(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:AA(t.yt,r)}}if(e instanceof DL)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof AL)return{bytesValue:NA(t.yt,e._byteString)};if(e instanceof FM){var i=t.databaseId,a=e.firestore._databaseId;if(!a.isEqual(i))throw t.ha("Document reference is for database ".concat(a.projectId,"/").concat(a.database," but should be for database ").concat(i.projectId,"/").concat(i.database));return{referenceValue:PA(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.ha("Unsupported field value: ".concat(NM(e)))}(e,t)}function XL(e,t){var n={};return PE(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):DE(e,(function(e,r){var i=JL(r,t.ra(e));null!=i&&(n[e]=i)})),{mapValue:{fields:n}}}function $L(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof JT||e instanceof DL||e instanceof AL||e instanceof FM||e instanceof RL)}function ZL(e,t,n){if(!$L(n)||("object"!=typeof(i=n)||null===i||Object.getPrototypeOf(i)!==Object.prototype&&null!==Object.getPrototypeOf(i))){var r=NM(n);throw"an object"===r?t.ha(e+" a custom object"):t.ha(e+" "+r)}var i}function eF(e,t,n){if((t=lt(t))instanceof NL)return t._internalPath;if("string"==typeof t)return nF(e,t);throw rF("Field path arguments must be of type string or ",e,!1,void 0,n)}var tF=new RegExp("[~\\*/\\[\\]]");function nF(t,n,r){if(n.search(tF)>=0)throw rF("Invalid field path (".concat(n,"). Paths must not contain '~', '*', '/', '[', or ']'"),t,!1,void 0,r);try{return e(mw)(NL,e(p)(n.split(".")))._internalPath}catch(e){throw rF("Invalid field path (".concat(n,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),t,!1,void 0,r)}}function rF(e,t,n,r,i){var a=r&&!r.isEmpty(),o=void 0!==i,s="Function ".concat(t,"() called with invalid data");n&&(s+=" (via `toFirestore()`)"),s+=". ";var u="";return(a||o)&&(u+=" (found",a&&(u+=" in field ".concat(r)),o&&(u+=" in document ".concat(i)),u+=")"),new MT(OT.INVALID_ARGUMENT,s+e+u)}function iF(e,t){return e.some((function(e){return e.isEqual(t)}))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var aF=function(){"use strict";function t(n,r,i,a,o){e(l)(this,t),this._firestore=n,this._userDataWriter=r,this._key=i,this._document=a,this._converter=o}return e(h)(t,[{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"ref",get:function(){return new FM(this._firestore,this._converter,this._key)}},{key:"exists",value:function(){return null!==this._document}},{key:"data",value:function(){if(this._document){if(this._converter){var e=new oF(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}},{key:"get",value:function(e){if(this._document){var t=this._document.data.field(sF("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}]),t}(),oF=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(){return e(l)(this,r),n.apply(this,arguments)}return e(h)(r,[{key:"data",value:function(){return e(Nd)(e(Pd)(r.prototype),"data",this).call(this)}}]),r}(aF);function sF(e,t){return"string"==typeof t?nF(e,t):t instanceof NL?t._internalPath:t._delegate._internalPath}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uF(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new MT(OT.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var cF=function t(){"use strict";e(l)(this,t)},lF=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(){return e(l)(this,r),n.apply(this,arguments)}return r}(cF);function hF(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];var a=[];t instanceof cF&&a.push(t),function(e){var t=e.filter((function(e){return e instanceof pF})).length,n=e.filter((function(e){return e instanceof fF})).length;if(t>1||t>0&&n>0)throw new MT(OT.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(a=a.concat(r));var o=!0,s=!1,u=void 0;try{for(var c,l=a[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var h=c.value;e=h._apply(e)}}catch(e){s=!0,u=e}finally{try{o||null==l.return||l.return()}finally{if(s)throw u}}return e}var fF=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i,a){var o;return e(l)(this,r),(o=n.call(this))._field=t,o._op=i,o._value=a,o.type="where",e(gw)(o)}return e(h)(r,[{key:"_apply",value:function(e){var t=this._parse(e);return SF(e._query,t),new UM(e.firestore,e.converter,lC(e._query,t))}},{key:"_parse",value:function(e){var t=qL(e.firestore);return function(e,t,n,r,i,a,o){var s;if(i.isKeyField()){if("array-contains"===a||"array-contains-any"===a)throw new MT(OT.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(a,"' queries on documentId()."));if("in"===a||"not-in"===a){EF(o,a);var u=[],c=!0,l=!1,h=void 0;try{for(var f,d=o[Symbol.iterator]();!(c=(f=d.next()).done);c=!0){var p=f.value;u.push(TF(r,e,p))}}catch(e){l=!0,h=e}finally{try{c||null==d.return||d.return()}finally{if(l)throw h}}s={arrayValue:{values:u}}}else s=TF(r,e,o)}else"in"!==a&&"not-in"!==a&&"array-contains-any"!==a||EF(o,a),s=YL(n,"where",o,"in"===a||"not-in"===a);return mS.create(i,a,s)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value)}}],[{key:"_create",value:function(e,t,n){return new r(e,t,n)}}]),r}(lF);function dF(e,t,n){var r=t,i=sF("where",e);return fF._create(i,r,n)}var pF=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i){var a;return e(l)(this,r),(a=n.call(this)).type=t,a._queryConstraints=i,e(gw)(a)}return e(h)(r,[{key:"_parse",value:function(e){var t=this._queryConstraints.map((function(t){return t._parse(e)})).filter((function(e){return e.getFilters().length>0}));return 1===t.length?t[0]:gS.create(t,this._getOperator())}},{key:"_apply",value:function(e){var t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){var n=e,r=t.getFlattenedFilters(),i=!0,a=!1,o=void 0;try{for(var s,u=r[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value;SF(n,c),n=lC(n,c)}}catch(e){a=!0,o=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw o}}}(e._query,t),new UM(e.firestore,e.converter,lC(e._query,t)))}},{key:"_getQueryConstraints",value:function(){return this._queryConstraints}},{key:"_getOperator",value:function(){return"and"===this.type?"and":"or"}}],[{key:"_create",value:function(e,t){return new r(e,t)}}]),r}(cF);var vF=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i){var a;return e(l)(this,r),(a=n.call(this))._field=t,a._direction=i,a.type="orderBy",e(gw)(a)}return e(h)(r,[{key:"_apply",value:function(e){var t,n,r,i=function(e,t,n){if(null!==e.startAt)throw new MT(OT.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new MT(OT.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new MS(t,n);return function(e,t){if(null===aC(e)){var n=oC(e);null!==n&&CF(e,n,t.field)}}(e,r),r}(e._query,this._field,this._direction);return new UM(e.firestore,e.converter,(t=e._query,n=i,r=t.explicitOrderBy.concat([n]),new tC(t.path,t.collectionGroup,r,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))}}],[{key:"_create",value:function(e,t){return new r(e,t)}}]),r}(lF);function yF(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=t,r=sF("orderBy",e);return vF._create(r,n)}var mF=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i,a){var o;return e(l)(this,r),(o=n.call(this)).type=t,o._limit=i,o._limitType=a,e(gw)(o)}return e(h)(r,[{key:"_apply",value:function(e){return new UM(e.firestore,e.converter,hC(e._query,this._limit,this._limitType))}}],[{key:"_create",value:function(e,t,n){return new r(e,t,n)}}]),r}(lF);var gF=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i,a){var o;return e(l)(this,r),(o=n.call(this)).type=t,o._docOrFields=i,o._inclusive=a,e(gw)(o)}return e(h)(r,[{key:"_apply",value:function(e){var t,n,r=IF(e,this.type,this._docOrFields,this._inclusive);return new UM(e.firestore,e.converter,(t=e._query,n=r,new tC(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,n,t.endAt)))}}],[{key:"_create",value:function(e,t,n){return new r(e,t,n)}}]),r}(lF);function kF(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return gF._create("startAt",t,!0)}function _F(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return gF._create("startAfter",t,!1)}var wF=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i,a){var o;return e(l)(this,r),(o=n.call(this)).type=t,o._docOrFields=i,o._inclusive=a,e(gw)(o)}return e(h)(r,[{key:"_apply",value:function(e){var t,n,r=IF(e,this.type,this._docOrFields,this._inclusive);return new UM(e.firestore,e.converter,(t=e._query,n=r,new tC(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,n)))}}],[{key:"_create",value:function(e,t,n){return new r(e,t,n)}}]),r}(lF);function bF(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return wF._create("endBefore",t,!1)}function xF(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return wF._create("endAt",t,!0)}function IF(t,n,r,i){if(r[0]=lt(r[0]),r[0]instanceof aF)return function(e,t,n,r,i){if(!r)throw new MT(OT.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for ".concat(n,"()."));var a=[],o=!0,s=!1,u=void 0;try{for(var c,l=uC(e)[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var h=c.value;if(h.field.isKeyField())a.push(tS(t,r.key));else{var f=r.data.field(h.field);if(KE(f))throw new MT(OT.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+h.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===f){var d=h.field.canonicalString();throw new MT(OT.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '".concat(d,"' (used as the orderBy) does not exist."))}a.push(f)}}}catch(e){s=!0,u=e}finally{try{o||null==l.return||l.return()}finally{if(s)throw u}}return new dS(a,i)}(t._query,t.firestore._databaseId,n,r[0]._document,i);var a=qL(t.firestore);return function(t,n,r,i,a,o){var s=t.explicitOrderBy;if(a.length>s.length)throw new MT(OT.INVALID_ARGUMENT,"Too many arguments provided to ".concat(i,"(). The number of arguments must be less than or equal to the number of orderBy() clauses"));for(var u=[],c=0;c<a.length;c++){var l=a[c];if(s[c].field.isKeyField()){if("string"!=typeof l)throw new MT(OT.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in ".concat(i,"(), but got a ").concat(void 0===l?"undefined":e(On)(l)));if(!sC(t)&&-1!==l.indexOf("/"))throw new MT(OT.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by documentId(), the value passed to ".concat(i,"() must be a plain document ID, but '").concat(l,"' contains a slash."));var h=t.path.child(ZT.fromString(l));if(!nE.isDocumentKey(h))throw new MT(OT.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by documentId(), the value passed to ".concat(i,"() must result in a valid document path, but '").concat(h,"' is not because it contains an odd number of segments."));var f=new nE(h);u.push(tS(n,f))}else{var d=YL(r,i,l);u.push(d)}}return new dS(u,o)}(t._query,t.firestore._databaseId,a,n,r,i)}function TF(e,t,n){if("string"==typeof(n=lt(n))){if(""===n)throw new MT(OT.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!sC(t)&&-1!==n.indexOf("/"))throw new MT(OT.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));var r=t.path.child(ZT.fromString(n));if(!nE.isDocumentKey(r))throw new MT(OT.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return tS(e,new nE(r))}if(n instanceof FM)return tS(e,n._key);throw new MT(OT.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(NM(n),"."))}function EF(e,t){if(!Array.isArray(e)||0===e.length)throw new MT(OT.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."));if(e.length>10)throw new MT(OT.INVALID_ARGUMENT,"Invalid Query. '".concat(t.toString(),"' filters support a maximum of 10 elements in the value array."))}function SF(e,t){if(t.isInequality()){var n=oC(e),r=t.field;if(null!==n&&!n.isEqual(r))throw new MT(OT.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '".concat(n.toString(),"' and '").concat(r.toString(),"'"));var i=aC(e);null!==i&&CF(e,r,i)}var a=function(e,t){var n=!0,r=!1,i=void 0,a=!0,o=!1,s=void 0;try{for(var u,c=e[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var l=u.value;try{for(var h,f=l.getFlattenedFilters()[Symbol.iterator]();!(n=(h=f.next()).done);n=!0){var d=h.value;if(t.indexOf(d.op)>=0)return d.op}}catch(e){r=!0,i=e}finally{try{n||null==f.return||f.return()}finally{if(r)throw i}}}}catch(e){o=!0,s=e}finally{try{a||null==c.return||c.return()}finally{if(o)throw s}}return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==a)throw a===t.op?new MT(OT.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter.")):new MT(OT.INVALID_ARGUMENT,"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(a.toString(),"' filters."))}function CF(e,t,n){if(!n.isEqual(t))throw new MT(OT.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '".concat(t.toString(),"' and so you must also use '").concat(t.toString(),"' as your first argument to orderBy(), but your first orderBy() is on field '").concat(n.toString(),"' instead."))}var AF=function(){"use strict";function t(){e(l)(this,t)}return e(h)(t,[{key:"convertValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(QE(e)){case 0:return null;case 1:return e.booleanValue;case 2:return jE(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(BE(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw RT()}}},{key:"convertObject",value:function(e,t){var n=this,r={};return DE(e.fields,(function(e,i){r[e]=n.convertValue(i,t)})),r}},{key:"convertGeoPoint",value:function(e){return new DL(jE(e.latitude),jE(e.longitude))}},{key:"convertArray",value:function(e,t){var n=this;return(e.values||[]).map((function(e){return n.convertValue(e,t)}))}},{key:"convertServerTimestamp",value:function(e,t){switch(t){case"previous":var n=zE(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(WE(e));default:return null}}},{key:"convertTimestamp",value:function(e){var t=VE(e);return new JT(t.seconds,t.nanos)}},{key:"convertDocumentKey",value:function(e,t){var n=ZT.fromString(e);DT(eN(n));var r=new NE(n.get(1),n.get(3)),i=new nE(n.popFirst(5));return r.isEqual(t)||CT("Document ".concat(i," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),i}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NF(e,t,n){return e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t}var RF=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t){var i;return e(l)(this,r),(i=n.call(this)).firestore=t,e(gw)(i)}return e(h)(r,[{key:"convertBytes",value:function(e){return new AL(e)}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new FM(this.firestore,null,t)}}]),r}(AF),DF=function(){"use strict";function t(n,r){e(l)(this,t),this.hasPendingWrites=n,this.fromCache=r}return e(h)(t,[{key:"isEqual",value:function(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}]),t}(),PF=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i,a,o,s,u){var c;return e(l)(this,r),(c=n.call(this,t,i,a,o,u))._firestore=t,c._firestoreImpl=t,c.metadata=s,e(gw)(c)}return e(h)(r,[{key:"exists",value:function(){return e(Nd)(e(Pd)(r.prototype),"exists",this).call(this)}},{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){var t=new OF(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){var n=this._document.data.field(sF("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}]),r}(aF),OF=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(){return e(l)(this,r),n.apply(this,arguments)}return e(h)(r,[{key:"data",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e(Nd)(e(Pd)(r.prototype),"data",this).call(this,t)}}]),r}(PF),MF=function(){"use strict";function t(n,r,i,a){e(l)(this,t),this._firestore=n,this._userDataWriter=r,this._snapshot=a,this.metadata=new DF(a.hasPendingWrites,a.fromCache),this.query=i}return e(h)(t,[{key:"docs",get:function(){var e=[];return this.forEach((function(t){return e.push(t)})),e}},{key:"size",get:function(){return this._snapshot.docs.size}},{key:"empty",get:function(){return 0===this.size}},{key:"forEach",value:function(e,t){var n=this;this._snapshot.docs.forEach((function(r){e.call(t,new OF(n._firestore,n._userDataWriter,r.key,r,new DF(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))}))}},{key:"docChanges",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new MT(OT.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){var n=0;return e._snapshot.docChanges.map((function(t){var r=new OF(e._firestore,e._userDataWriter,t.doc.key,t.doc,new DF(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);return t.doc,{type:"added",doc:r,oldIndex:-1,newIndex:n++}}))}var r=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((function(e){return t||3!==e.type})).map((function(t){var n=new OF(e._firestore,e._userDataWriter,t.doc.key,t.doc,new DF(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),i=-1,a=-1;return 0!==t.type&&(i=r.indexOf(t.doc.key),r=r.delete(t.doc.key)),1!==t.type&&(a=(r=r.add(t.doc)).indexOf(t.doc.key)),{type:LF(t.type),doc:n,oldIndex:i,newIndex:a}}))}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LF(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return RT()}}function FF(e,t){return e instanceof PF&&t instanceof PF?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof MF&&t instanceof MF&&e._firestore===t._firestore&&zM(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UF(e){e=RM(e,FM);var t=RM(e.firestore,mL);return fL(gL(t),e._key).then((function(n){return XF(t,e,n)}))}var qF=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t){var i;return e(l)(this,r),(i=n.call(this)).firestore=t,e(gw)(i)}return e(h)(r,[{key:"convertBytes",value:function(e){return new AL(e)}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new FM(this.firestore,null,t)}}]),r}(AF);function VF(t){t=RM(t,FM);var n,r,i,a=RM(t.firestore,mL),o=gL(a),s=new qF(a);return(n=o,r=t._key,i=new LT,n.asyncQueue.enqueueAndForget(e(u)(e(_).mark((function t(){return e(_).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=function(){var t=e(u)(e(_).mark((function t(n,r,i){var a,o;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,function(e,t){var n=PT(e);return n.persistence.runTransaction("read document","readonly",(function(e){return n.localDocuments.getDocument(e,t)}))}(n,r);case 3:(a=e.sent).isFoundDocument()?i.resolve(a):a.isNoDocument()?i.resolve(null):i.reject(new MT(OT.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),o=nO(e.t0,"Failed to get document '".concat(r," from cache")),i.reject(o);case 11:case"end":return e.stop()}}),t,null,[[0,7]])})));return function(e,n,r){return t.apply(this,arguments)}}(),t.next=3,oL(n);case 3:return t.t1=t.sent,t.t2=r,t.t3=i,t.abrupt("return",(0,t.t0)(t.t1,t.t2,t.t3));case 7:case"end":return t.stop()}}),t)})))),i.promise).then((function(e){return new PF(a,s,t._key,e,new DF(null!==e&&e.hasLocalMutations,!0),t.converter)}))}function jF(e){e=RM(e,FM);var t=RM(e.firestore,mL);return fL(gL(t),e._key,{source:"server"}).then((function(n){return XF(t,e,n)}))}function BF(e){e=RM(e,UM);var t=RM(e.firestore,mL),n=gL(t),r=new qF(t);return uF(e._query),dL(n,e._query).then((function(n){return new MF(t,r,e,n)}))}function KF(t){t=RM(t,UM);var n,r,i,a=RM(t.firestore,mL),o=gL(a),s=new qF(a);return(n=o,r=t._query,i=new LT,n.asyncQueue.enqueueAndForget(e(u)(e(_).mark((function t(){return e(_).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=function(){var t=e(u)(e(_).mark((function t(n,r,i){var a,o,s,u,c;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,MD(n,r,!0);case 3:a=e.sent,o=new bO(r,a.Hi),s=o.Wu(a.documents),u=o.applyChanges(s,!1),i.resolve(u.snapshot),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),c=nO(e.t0,"Failed to execute query '".concat(r," against cache")),i.reject(c);case 14:case"end":return e.stop()}}),t,null,[[0,10]])})));return function(e,n,r){return t.apply(this,arguments)}}(),t.next=3,oL(n);case 3:return t.t1=t.sent,t.t2=r,t.t3=i,t.abrupt("return",(0,t.t0)(t.t1,t.t2,t.t3));case 7:case"end":return t.stop()}}),t)})))),i.promise).then((function(e){return new MF(a,s,t,e)}))}function zF(e){e=RM(e,UM);var t=RM(e.firestore,mL),n=gL(t),r=new qF(t);return dL(n,e._query,{source:"server"}).then((function(n){return new MF(t,r,e,n)}))}function WF(e,t,n){e=RM(e,FM);var r=RM(e.firestore,mL),i=NF(e.converter,t,n);return JF(r,[VL(qL(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,LC.none())])}function GF(e,t,n){for(var r=arguments.length,i=new Array(r>3?r-3:0),a=3;a<r;a++)i[a-3]=arguments[a];e=RM(e,FM);var o=RM(e.firestore,mL),s=qL(o);return JF(o,[("string"==typeof(t=lt(t))||t instanceof NL?QL(s,"updateDoc",e._key,t,n,i):HL(s,"updateDoc",e._key,t)).toMutation(e._key,LC.exists(!0))])}function HF(e,t){var n=RM(e.firestore,mL),r=BM(e),i=NF(e.converter,t);return JF(n,[VL(qL(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,LC.exists(!1))]).then((function(){return r}))}function QF(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var a,o,s;t=lt(t);var c={includeMetadataChanges:!1},l=0;"object"!=typeof r[l]||vL(r[l])||(c=r[l],l++);var h,f,d,p={includeMetadataChanges:c.includeMetadataChanges};if(vL(r[l])){var v=r[l];r[l]=null===(a=v.next)||void 0===a?void 0:a.bind(v),r[l+1]=null===(o=v.error)||void 0===o?void 0:o.bind(v),r[l+2]=null===(s=v.complete)||void 0===s?void 0:s.bind(v)}if(t instanceof FM)f=RM(t.firestore,mL),d=rC(t._key.path),h={next:function(e){r[l]&&r[l](XF(f,t,e))},error:r[l+1],complete:r[l+2]};else{var y=RM(t,UM);f=RM(y.firestore,mL),d=y._query;var m=new qF(f);h={next:function(e){r[l]&&r[l](new MF(f,m,y,e))},error:r[l+1],complete:r[l+2]},uF(t._query)}return function(t,n,r,i){var a=new GM(i),o=new vO(n,a,r);return t.asyncQueue.enqueueAndForget(e(u)(e(_).mark((function n(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=uO,e.next=3,lL(t);case 3:return e.t1=e.sent,e.t2=o,e.abrupt("return",(0,e.t0)(e.t1,e.t2));case 6:case"end":return e.stop()}}),n)})))),function(){a.bc(),t.asyncQueue.enqueueAndForget(e(u)(e(_).mark((function n(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=lO,e.next=3,lL(t);case 3:return e.t1=e.sent,e.t2=o,e.abrupt("return",(0,e.t0)(e.t1,e.t2));case 6:case"end":return e.stop()}}),n)}))))}}(gL(f),d,p,h)}function YF(t,n){return r=gL(t=RM(t,mL)),i=vL(n)?n:{next:n},a=new GM(i),r.asyncQueue.enqueueAndForget(e(u)(e(_).mark((function t(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=function(e,t){PT(e).Ru.add(t),t.next()},e.next=3,lL(r);case 3:return e.t1=e.sent,e.t2=a,e.abrupt("return",(0,e.t0)(e.t1,e.t2));case 6:case"end":return e.stop()}}),t)})))),function(){a.bc(),r.asyncQueue.enqueueAndForget(e(u)(e(_).mark((function t(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=function(e,t){PT(e).Ru.delete(t)},e.next=3,lL(r);case 3:return e.t1=e.sent,e.t2=a,e.abrupt("return",(0,e.t0)(e.t1,e.t2));case 6:case"end":return e.stop()}}),t)}))))};var r,i,a}function JF(t,n){return r=gL(t),i=n,a=new LT,r.asyncQueue.enqueueAndForget(e(u)(e(_).mark((function t(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=DO,e.next=3,uL(r);case 3:return e.t1=e.sent,e.t2=i,e.t3=a,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3));case 7:case"end":return e.stop()}}),t)})))),a.promise;var r,i,a}function XF(e,t,n){var r=n.docs.get(t._key),i=new qF(e);return new PF(e,i,t._key,r,new DF(n.hasPendingWrites,n.fromCache),t.converter)}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var $F={maxAttempts:5},ZF=function(){"use strict";function t(n,r){e(l)(this,t),this._firestore=n,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=qL(n)}return e(h)(t,[{key:"set",value:function(e,t,n){this._verifyNotCommitted();var r=eU(e,this._firestore),i=NF(r.converter,t,n),a=VL(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(a.toMutation(r._key,LC.none())),this}},{key:"update",value:function(e,t,n){for(var r=arguments.length,i=new Array(r>3?r-3:0),a=3;a<r;a++)i[a-3]=arguments[a];this._verifyNotCommitted();var o,s=eU(e,this._firestore);return o="string"==typeof(t=lt(t))||t instanceof NL?QL(this._dataReader,"WriteBatch.update",s._key,t,n,i):HL(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,LC.exists(!0))),this}},{key:"delete",value:function(e){this._verifyNotCommitted();var t=eU(e,this._firestore);return this._mutations=this._mutations.concat(new XC(t._key,LC.none())),this}},{key:"commit",value:function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}},{key:"_verifyNotCommitted",value:function(){if(this._committed)throw new MT(OT.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eU(e,t){if((e=lt(e)).firestore!==t)throw new MT(OT.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var tU=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i){var a;return e(l)(this,r),(a=n.call(this,t,i))._firestore=t,e(gw)(a)}return e(h)(r,[{key:"get",value:function(t){var n=this,i=eU(t,this._firestore),a=new qF(this._firestore);return e(Nd)(e(Pd)(r.prototype),"get",this).call(this,t).then((function(e){return new PF(n._firestore,a,i._key,e._document,new DF(!1,!1),i.converter)}))}}]),r}(function(){"use strict";function t(n,r){e(l)(this,t),this._firestore=n,this._transaction=r,this._dataReader=qL(n)}return e(h)(t,[{key:"get",value:function(e){var t=this,n=eU(e,this._firestore),r=new RF(this._firestore);return this._transaction.lookup([n._key]).then((function(e){if(!e||1!==e.length)return RT();var i=e[0];if(i.isFoundDocument())return new aF(t._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new aF(t._firestore,r,n._key,null,n.converter);throw RT()}))}},{key:"set",value:function(e,t,n){var r=eU(e,this._firestore),i=NF(r.converter,t,n),a=VL(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,a),this}},{key:"update",value:function(e,t,n){for(var r=arguments.length,i=new Array(r>3?r-3:0),a=3;a<r;a++)i[a-3]=arguments[a];var o,s=eU(e,this._firestore);return o="string"==typeof(t=lt(t))||t instanceof NL?QL(this._dataReader,"Transaction.update",s._key,t,n,i):HL(this._dataReader,"Transaction.update",s._key,t),this._transaction.update(s._key,o),this}},{key:"delete",value:function(e){var t=eU(e,this._firestore);return this._transaction.delete(t._key),this}}]),t}());function nU(t,n,r){t=RM(t,mL);var i,a,o,s,c=Object.assign(Object.assign({},$F),r);return function(e){if(e.maxAttempts<1)throw new MT(OT.INVALID_ARGUMENT,"Max attempts must be at least 1")}(c),i=gL(t),a=function(e){return n(new tU(t,e))},o=c,s=new LT,i.asyncQueue.enqueueAndForget(e(u)(e(_).mark((function t(){var n;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,cL(i);case 2:n=e.sent,new YM(i.asyncQueue,n,o,a,s).run();case 4:case"end":return e.stop()}}),t)})))),s.promise}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rU(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new zL("arrayUnion",t)}function iU(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new WL("arrayRemove",t)}!function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];IT=hn,rn(new ht("firestore",(function(e,n){var r=n.instanceIdentifier,i=n.options,a=e.getProvider("app").getImmediate(),o=new mL(new VT(e.getProvider("auth-internal")),new zT(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new MT(OT.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new NE(e.options.projectId,t)}(a,r),a);return i=Object.assign({useFetchStreams:t},i),o._setSettings(i),o}),"PUBLIC").setMultipleInstances(!0)),mn(bT,"3.8.0",e),mn(bT,"3.8.0","esm2017")}();
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function aU(e,t){if(void 0===t)return{merge:!1};if(void 0!==t.mergeFields&&void 0!==t.merge)throw new MT("invalid-argument","Invalid options passed to function ".concat(e,"(): You cannot ")+'specify both "merge" and "mergeFields".');return t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oU(){if("undefined"==typeof Uint8Array)throw new MT("unimplemented","Uint8Arrays are not available in this environment.")}function sU(){if("undefined"==typeof atob)throw new MT("unimplemented","Blobs are unavailable in Firestore in this environment.")}var uU=function(){"use strict";function t(n){e(l)(this,t),this._delegate=n}return e(h)(t,[{key:"toBase64",value:function(){return sU(),this._delegate.toBase64()}},{key:"toUint8Array",value:function(){return oU(),this._delegate.toUint8Array()}},{key:"isEqual",value:function(e){return this._delegate.isEqual(e._delegate)}},{key:"toString",value:function(){return"Blob(base64: "+this.toBase64()+")"}}],[{key:"fromBase64String",value:function(e){return sU(),new t(AL.fromBase64String(e))}},{key:"fromUint8Array",value:function(e){return oU(),new t(AL.fromUint8Array(e))}}]),t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cU(e){return function(e,t){if("object"!=typeof e||null===e)return!1;var n=e,r=!0,i=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;if(u in n&&"function"==typeof n[u])return!0}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return!1}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e,["next","error","complete"])}var lU=function(){"use strict";function t(){e(l)(this,t)}return e(h)(t,[{key:"enableIndexedDbPersistence",value:function(e,t){return _L(e._delegate,{forceOwnership:t})}},{key:"enableMultiTabIndexedDbPersistence",value:function(e){return wL(e._delegate)}},{key:"clearIndexedDbPersistence",value:function(e){return xL(e._delegate)}}]),t}(),hU=function(){"use strict";function t(n,r,i){var a=this;e(l)(this,t),this._delegate=r,this._persistenceProvider=i,this.INTERNAL={delete:function(){return a.terminate()}},n instanceof NE||(this._appCompat=n)}return e(h)(t,[{key:"_databaseId",get:function(){return this._delegate._databaseId}},{key:"settings",value:function(e){var t=this._delegate._getSettings();e.merge||t.host===e.host||AT("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}},{key:"useEmulator",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};LM(this._delegate,e,t,n)}},{key:"enableNetwork",value:function(){return IL(this._delegate)}},{key:"disableNetwork",value:function(){return TL(this._delegate)}},{key:"enablePersistence",value:function(e){var t=!1,n=!1;return e&&SM("synchronizeTabs",t=!!e.synchronizeTabs,"experimentalForceOwningTab",n=!!e.experimentalForceOwningTab),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,n)}},{key:"clearPersistence",value:function(){return this._persistenceProvider.clearIndexedDbPersistence(this)}},{key:"terminate",value:function(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}},{key:"waitForPendingWrites",value:function(){return t=this._delegate,n=gL(t=RM(t,mL)),r=new LT,n.asyncQueue.enqueueAndForget(e(u)(e(_).mark((function t(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=KO,e.next=3,uL(n);case 3:return e.t1=e.sent,e.t2=r,e.abrupt("return",(0,e.t0)(e.t1,e.t2));case 6:case"end":return e.stop()}}),t)})))),r.promise;var t,n,r}},{key:"onSnapshotsInSync",value:function(e){return YF(this._delegate,e)}},{key:"app",get:function(){if(!this._appCompat)throw new MT("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}},{key:"collection",value:function(e){try{return new TU(this,VM(this._delegate,e))}catch(e){throw mU(e,"collection()","Firestore.collection()")}}},{key:"doc",value:function(e){try{return new yU(this,BM(this._delegate,e))}catch(e){throw mU(e,"doc()","Firestore.doc()")}}},{key:"collectionGroup",value:function(e){try{return new bU(this,jM(this._delegate,e))}catch(e){throw mU(e,"collectionGroup()","Firestore.collectionGroup()")}}},{key:"runTransaction",value:function(e){var t=this;return nU(this._delegate,(function(n){return e(new dU(t,n))}))}},{key:"batch",value:function(){var e=this;return gL(this._delegate),new pU(new ZF(this._delegate,(function(t){return JF(e._delegate,t)})))}},{key:"loadBundle",value:function(e){return EL(this._delegate,e)}},{key:"namedQuery",value:function(e){var t=this;return SL(this._delegate,e).then((function(e){return e?new bU(t,e):null}))}}]),t}(),fU=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t){var i;return e(l)(this,r),(i=n.call(this)).firestore=t,i}return e(h)(r,[{key:"convertBytes",value:function(e){return new uU(new AL(e))}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return yU.forKey(t,this.firestore,null)}}]),r}(AF);var dU=function(){"use strict";function t(n,r){e(l)(this,t),this._firestore=n,this._delegate=r,this._userDataWriter=new fU(n)}return e(h)(t,[{key:"get",value:function(e){var t=this,n=EU(e);return this._delegate.get(n).then((function(e){return new _U(t._firestore,new PF(t._firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,n.converter))}))}},{key:"set",value:function(e,t,n){var r=EU(e);return n?(aU("Transaction.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}},{key:"update",value:function(t,n,r){for(var i=arguments.length,a=new Array(i>3?i-3:0),o=3;o<i;o++)a[o-3]=arguments[o];var s,u=EU(t);return 2===arguments.length?this._delegate.update(u,n):(s=this._delegate).update.apply(s,[u,n,r].concat(e(p)(a))),this}},{key:"delete",value:function(e){var t=EU(e);return this._delegate.delete(t),this}}]),t}(),pU=function(){"use strict";function t(n){e(l)(this,t),this._delegate=n}return e(h)(t,[{key:"set",value:function(e,t,n){var r=EU(e);return n?(aU("WriteBatch.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}},{key:"update",value:function(t,n,r){for(var i=arguments.length,a=new Array(i>3?i-3:0),o=3;o<i;o++)a[o-3]=arguments[o];var s,u=EU(t);return 2===arguments.length?this._delegate.update(u,n):(s=this._delegate).update.apply(s,[u,n,r].concat(e(p)(a))),this}},{key:"delete",value:function(e){var t=EU(e);return this._delegate.delete(t),this}},{key:"commit",value:function(){return this._delegate.commit()}}]),t}(),vU=function(){"use strict";function t(n,r,i){e(l)(this,t),this._firestore=n,this._userDataWriter=r,this._delegate=i}return e(h)(t,[{key:"fromFirestore",value:function(e,t){var n=new OF(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new wU(this._firestore,n),null!=t?t:{})}},{key:"toFirestore",value:function(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}}],[{key:"getInstance",value:function(e,n){var r=t.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));var a=i.get(n);return a||(a=new t(e,new fU(e),n),i.set(n,a)),a}}]),t}();vU.INSTANCES=new WeakMap;var yU=function(){"use strict";function t(n,r){e(l)(this,t),this.firestore=n,this._delegate=r,this._userDataWriter=new fU(n)}return e(h)(t,[{key:"id",get:function(){return this._delegate.id}},{key:"parent",get:function(){return new TU(this.firestore,this._delegate.parent)}},{key:"path",get:function(){return this._delegate.path}},{key:"collection",value:function(e){try{return new TU(this.firestore,VM(this._delegate,e))}catch(e){throw mU(e,"collection()","DocumentReference.collection()")}}},{key:"isEqual",value:function(e){return(e=lt(e))instanceof FM&&KM(this._delegate,e)}},{key:"set",value:function(e,t){t=aU("DocumentReference.set",t);try{return t?WF(this._delegate,e,t):WF(this._delegate,e)}catch(e){throw mU(e,"setDoc()","DocumentReference.set()")}}},{key:"update",value:function(t,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];try{return 1===arguments.length?GF(this._delegate,t):GF.apply(void 0,[this._delegate,t,n].concat(e(p)(i)))}catch(e){throw mU(e,"updateDoc()","DocumentReference.update()")}}},{key:"delete",value:function(){return JF(RM((e=this._delegate).firestore,mL),[new XC(e._key,LC.none())]);var e}},{key:"onSnapshot",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=this,i=gU(t),a=kU(t,(function(e){return new _U(r.firestore,new PF(r.firestore._delegate,r._userDataWriter,e._key,e._document,e.metadata,r._delegate.converter))}));return QF(this._delegate,i,a)}},{key:"get",value:function(e){var t=this;return("cache"===(null==e?void 0:e.source)?VF(this._delegate):"server"===(null==e?void 0:e.source)?jF(this._delegate):UF(this._delegate)).then((function(e){return new _U(t.firestore,new PF(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate.converter))}))}},{key:"withConverter",value:function(e){return new t(this.firestore,e?this._delegate.withConverter(vU.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}],[{key:"forPath",value:function(e,n,r){if(e.length%2!=0)throw new MT("invalid-argument","Invalid document reference. Document references must have an even number of segments, but "+"".concat(e.canonicalString()," has ").concat(e.length));return new t(n,new FM(n._delegate,r,new nE(e)))}},{key:"forKey",value:function(e,n,r){return new t(n,new FM(n._delegate,r,e))}}]),t}();function mU(e,t,n){return e.message=e.message.replace(t,n),e}function gU(e){var t=!0,n=!1,r=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;if("object"==typeof o&&!cU(o))return o}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return{}}function kU(e,t){var n,r,i;return{next:function(e){i.next&&i.next(t(e))},error:null===(n=(i=cU(e[0])?e[0]:cU(e[1])?e[1]:"function"==typeof e[0]?{next:e[0],error:e[1],complete:e[2]}:{next:e[1],error:e[2],complete:e[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var _U=function(){"use strict";function t(n,r){e(l)(this,t),this._firestore=n,this._delegate=r}return e(h)(t,[{key:"ref",get:function(){return new yU(this._firestore,this._delegate.ref)}},{key:"id",get:function(){return this._delegate.id}},{key:"metadata",get:function(){return this._delegate.metadata}},{key:"exists",get:function(){return this._delegate.exists()}},{key:"data",value:function(e){return this._delegate.data(e)}},{key:"get",value:function(e,t){return this._delegate.get(e,t)}},{key:"isEqual",value:function(e){return FF(this._delegate,e._delegate)}}]),t}(),wU=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(){return e(l)(this,r),n.apply(this,arguments)}return e(h)(r,[{key:"data",value:function(e){var t=this._delegate.data(e);return void 0!==t||RT(),t}}]),r}(_U),bU=function(){"use strict";function t(n,r){e(l)(this,t),this.firestore=n,this._delegate=r,this._userDataWriter=new fU(n)}return e(h)(t,[{key:"where",value:function(e,n,r){try{return new t(this.firestore,hF(this._delegate,dF(e,n,r)))}catch(e){throw mU(e,/(orderBy|where)\(\)/,"Query.$1()")}}},{key:"orderBy",value:function(e,n){try{return new t(this.firestore,hF(this._delegate,yF(e,n)))}catch(e){throw mU(e,/(orderBy|where)\(\)/,"Query.$1()")}}},{key:"limit",value:function(e){try{return new t(this.firestore,hF(this._delegate,(DM("limit",n=e),mF._create("limit",n,"F"))))}catch(e){throw mU(e,"limit()","Query.limit()")}var n}},{key:"limitToLast",value:function(e){try{return new t(this.firestore,hF(this._delegate,(DM("limitToLast",n=e),mF._create("limitToLast",n,"L"))))}catch(e){throw mU(e,"limitToLast()","Query.limitToLast()")}var n}},{key:"startAt",value:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];try{return new t(this.firestore,hF(this._delegate,kF.apply(void 0,e(p)(r))))}catch(e){throw mU(e,"startAt()","Query.startAt()")}}},{key:"startAfter",value:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];try{return new t(this.firestore,hF(this._delegate,_F.apply(void 0,e(p)(r))))}catch(e){throw mU(e,"startAfter()","Query.startAfter()")}}},{key:"endBefore",value:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];try{return new t(this.firestore,hF(this._delegate,bF.apply(void 0,e(p)(r))))}catch(e){throw mU(e,"endBefore()","Query.endBefore()")}}},{key:"endAt",value:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];try{return new t(this.firestore,hF(this._delegate,xF.apply(void 0,e(p)(r))))}catch(e){throw mU(e,"endAt()","Query.endAt()")}}},{key:"isEqual",value:function(e){return zM(this._delegate,e._delegate)}},{key:"get",value:function(e){var t=this;return("cache"===(null==e?void 0:e.source)?KF(this._delegate):"server"===(null==e?void 0:e.source)?zF(this._delegate):BF(this._delegate)).then((function(e){return new IU(t.firestore,new MF(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))}))}},{key:"onSnapshot",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=this,i=gU(t),a=kU(t,(function(e){return new IU(r.firestore,new MF(r.firestore._delegate,r._userDataWriter,r._delegate,e._snapshot))}));return QF(this._delegate,i,a)}},{key:"withConverter",value:function(e){return new t(this.firestore,e?this._delegate.withConverter(vU.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}]),t}(),xU=function(){"use strict";function t(n,r){e(l)(this,t),this._firestore=n,this._delegate=r}return e(h)(t,[{key:"type",get:function(){return this._delegate.type}},{key:"doc",get:function(){return new wU(this._firestore,this._delegate.doc)}},{key:"oldIndex",get:function(){return this._delegate.oldIndex}},{key:"newIndex",get:function(){return this._delegate.newIndex}}]),t}(),IU=function(){"use strict";function t(n,r){e(l)(this,t),this._firestore=n,this._delegate=r}return e(h)(t,[{key:"query",get:function(){return new bU(this._firestore,this._delegate.query)}},{key:"metadata",get:function(){return this._delegate.metadata}},{key:"size",get:function(){return this._delegate.size}},{key:"empty",get:function(){return this._delegate.empty}},{key:"docs",get:function(){var e=this;return this._delegate.docs.map((function(t){return new wU(e._firestore,t)}))}},{key:"docChanges",value:function(e){var t=this;return this._delegate.docChanges(e).map((function(e){return new xU(t._firestore,e)}))}},{key:"forEach",value:function(e,t){var n=this;this._delegate.forEach((function(r){e.call(t,new wU(n._firestore,r))}))}},{key:"isEqual",value:function(e){return FF(this._delegate,e._delegate)}}]),t}(),TU=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i){var a;return e(l)(this,r),(a=n.call(this,t,i)).firestore=t,a._delegate=i,a}return e(h)(r,[{key:"id",get:function(){return this._delegate.id}},{key:"path",get:function(){return this._delegate.path}},{key:"parent",get:function(){var e=this._delegate.parent;return e?new yU(this.firestore,e):null}},{key:"doc",value:function(e){try{return new yU(this.firestore,void 0===e?BM(this._delegate):BM(this._delegate,e))}catch(e){throw mU(e,"doc()","CollectionReference.doc()")}}},{key:"add",value:function(e){var t=this;return HF(this._delegate,e).then((function(e){return new yU(t.firestore,e)}))}},{key:"isEqual",value:function(e){return KM(this._delegate,e._delegate)}},{key:"withConverter",value:function(e){return new r(this.firestore,e?this._delegate.withConverter(vU.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}]),r}(bU);function EU(e){return RM(e,FM)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var SU=function(){"use strict";function t(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];e(l)(this,t),this._delegate=e(mw)(NL,e(p)(r))}return e(h)(t,[{key:"isEqual",value:function(e){return(e=lt(e))instanceof NL&&this._delegate._internalPath.isEqual(e._internalPath)}}],[{key:"documentId",value:function(){return new t(tE.keyField().canonicalString())}}]),t}(),CU=function(){"use strict";function t(n){e(l)(this,t),this._delegate=n}return e(h)(t,[{key:"isEqual",value:function(e){return this._delegate.isEqual(e._delegate)}}],[{key:"serverTimestamp",value:function(){var e=new KL("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new t(e)}},{key:"delete",value:function(){var e=new jL("deleteField");return e._methodName="FieldValue.delete",new t(e)}},{key:"arrayUnion",value:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var a=rU.apply(void 0,e(p)(r));return a._methodName="FieldValue.arrayUnion",new t(a)}},{key:"arrayRemove",value:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var a=iU.apply(void 0,e(p)(r));return a._methodName="FieldValue.arrayRemove",new t(a)}},{key:"increment",value:function(e){var n=new GL("increment",e);return n._methodName="FieldValue.increment",new t(n)}}]),t}(),AU={Firestore:hU,GeoPoint:DL,Timestamp:JT,Blob:uU,Transaction:dU,WriteBatch:pU,DocumentReference:yU,DocumentSnapshot:_U,Query:bU,QueryDocumentSnapshot:wU,QuerySnapshot:IU,CollectionReference:TU,FieldPath:SU,FieldValue:CU,setLogLevel:function(e){var t;t=e,TT.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */!
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(e){var t;t=function(e,t){return new hU(e,t,new lU)},e.INTERNAL.registerComponent(new ht("firestore-compat",(function(e){var n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("firestore").getImmediate();return t(n,r)}),"PUBLIC").setServiceProps(Object.assign({},AU))),e.registerVersion("@firebase/firestore-compat","0.3.0")}(Fc);function NU(e,t){var n={};for(var r in e)e.hasOwnProperty(r)&&(n[r]=t(e[r]));return n}function RU(e){if(null==e)return null;if(e instanceof Number&&(e=e.valueOf()),"number"==typeof e&&isFinite(e))return e;if(!0===e||!1===e)return e;if("[object String]"===Object.prototype.toString.call(e))return e;if(e instanceof Date)return e.toISOString();if(Array.isArray(e))return e.map((function(e){return RU(e)}));if("function"==typeof e||"object"==typeof e)return NU(e,(function(e){return RU(e)}));throw new Error("Data cannot be encoded in JSON: "+e)}function DU(e){if(null==e)return e;if(e["@type"])switch(e["@type"]){case"type.googleapis.com/google.protobuf.Int64Value":case"type.googleapis.com/google.protobuf.UInt64Value":var t=Number(e.value);if(isNaN(t))throw new Error("Data cannot be decoded from JSON: "+e);return t;default:throw new Error("Data cannot be decoded from JSON: "+e)}return Array.isArray(e)?e.map((function(e){return DU(e)})):"function"==typeof e||"object"==typeof e?NU(e,(function(e){return DU(e)})):e}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var PU="functions",OU={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},MU=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i,a){var o;return e(l)(this,r),(o=n.call(this,"".concat(PU,"/").concat(t),i||"")).details=a,o}return r}(Oe);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LU(e,t){var n=function(e){if(e>=200&&e<300)return"ok";switch(e){case 0:case 500:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(e),r=n,i=void 0;try{var a=t&&t.error;if(a){var o=a.status;if("string"==typeof o){if(!OU[o])return new MU("internal","internal");n=OU[o],r=o}var s=a.message;"string"==typeof s&&(r=s),void 0!==(i=a.details)&&(i=DU(i))}}catch(e){}return"ok"===n?null:new MU(n,r,i)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var FU=function(){"use strict";function t(n,r,i){var a=this;e(l)(this,t),this.auth=null,this.messaging=null,this.appCheck=null,this.auth=n.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||n.get().then((function(e){return a.auth=e}),(function(){})),this.messaging||r.get().then((function(e){return a.messaging=e}),(function(){})),this.appCheck||i.get().then((function(e){return a.appCheck=e}),(function(){}))}return e(h)(t,[{key:"getAuthToken",value:function(){var t=this;return e(u)(e(_).mark((function n(){var r;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.auth){e.next=2;break}return e.abrupt("return",void 0);case 2:return e.prev=2,e.next=5,t.auth.getToken();case 5:return r=e.sent,e.abrupt("return",null==r?void 0:r.accessToken);case 9:return e.prev=9,e.t0=e.catch(2),e.abrupt("return",void 0);case 12:case"end":return e.stop()}}),n,null,[[2,9]])})))()}},{key:"getMessagingToken",value:function(){var t=this;return e(u)(e(_).mark((function n(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.messaging&&"Notification"in self&&"granted"===Notification.permission){e.next=2;break}return e.abrupt("return",void 0);case 2:return e.prev=2,e.next=5,t.messaging.getToken();case 5:return e.abrupt("return",e.sent);case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return",void 0);case 11:case"end":return e.stop()}}),n,null,[[2,8]])})))()}},{key:"getAppCheckToken",value:function(){var t=this;return e(u)(e(_).mark((function n(){var r;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.appCheck){e.next=7;break}return e.next=3,t.appCheck.getToken();case 3:if(!(r=e.sent).error){e.next=6;break}return e.abrupt("return",null);case 6:return e.abrupt("return",r.token);case 7:return e.abrupt("return",null);case 8:case"end":return e.stop()}}),n)})))()}},{key:"getContext",value:function(){var t=this;return e(u)(e(_).mark((function n(){var r,i,a;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getAuthToken();case 2:return r=e.sent,e.next=5,t.getMessagingToken();case 5:return i=e.sent,e.next=8,t.getAppCheckToken();case 8:return a=e.sent,e.abrupt("return",{authToken:r,messagingToken:i,appCheckToken:a});case 10:case"end":return e.stop()}}),n)})))()}}]),t}(),UU="us-central1";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qU(e){var t=null;return{promise:new Promise((function(n,r){t=setTimeout((function(){r(new MU("deadline-exceeded","deadline-exceeded"))}),e)})),cancel:function(){t&&clearTimeout(t)}}}var VU=function(){"use strict";function t(n,r,i,a){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:UU,s=arguments.length>5?arguments[5]:void 0,u=this;e(l)(this,t),this.app=n,this.fetchImpl=s,this.emulatorOrigin=null,this.contextProvider=new FU(r,i,a),this.cancelAllRequests=new Promise((function(e){u.deleteService=function(){return Promise.resolve(e())}}));try{var c=new URL(o);this.customDomain=c.origin,this.region=UU}catch(e){this.customDomain=null,this.region=o}}return e(h)(t,[{key:"_delete",value:function(){return this.deleteService()}},{key:"_url",value:function(e){var t=this.app.options.projectId;if(null!==this.emulatorOrigin){var n=this.emulatorOrigin;return"".concat(n,"/").concat(t,"/").concat(this.region,"/").concat(e)}return null!==this.customDomain?"".concat(this.customDomain,"/").concat(e):"https://".concat(this.region,"-").concat(t,".cloudfunctions.net/").concat(e)}}]),t}();function jU(e,t,n){return function(r){return function(e,t,n,r){var i=e._url(t);return zU(e,i,n,r)}(e,t,r,n||{})}}function BU(e,t,n,r){return KU.apply(this,arguments)}function KU(){return(KU=e(u)(e(_).mark((function t(n,r,i,a){var o,s;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i["Content-Type"]="application/json",e.prev=2,e.next=5,a(n,{method:"POST",body:JSON.stringify(r),headers:i});case 5:o=e.sent,e.next=11;break;case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return",{status:0,json:null});case 11:return s=null,e.prev=12,e.next=15,o.json();case 15:s=e.sent,e.next=20;break;case 18:e.prev=18,e.t1=e.catch(12);case 20:return e.abrupt("return",{status:o.status,json:s});case 21:case"end":return e.stop()}}),t,null,[[2,8],[12,18]])})))).apply(this,arguments)}function zU(e,t,n,r){return WU.apply(this,arguments)}function WU(){return(WU=e(u)(e(_).mark((function t(n,r,i,a){var o,s,u,c,l,h,f,d,p;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=RU(i),o={data:i},s={},e.next=5,n.contextProvider.getContext();case 5:return(u=e.sent).authToken&&(s.Authorization="Bearer "+u.authToken),u.messagingToken&&(s["Firebase-Instance-ID-Token"]=u.messagingToken),null!==u.appCheckToken&&(s["X-Firebase-AppCheck"]=u.appCheckToken),c=a.timeout||7e4,l=qU(c),e.next=13,Promise.race([BU(r,o,s,n.fetchImpl),l.promise,n.cancelAllRequests]);case 13:if(h=e.sent,l.cancel(),h){e.next=17;break}throw new MU("cancelled","Firebase Functions instance was deleted.");case 17:if(!(f=LU(h.status,h.json))){e.next=20;break}throw f;case 20:if(h.json){e.next=22;break}throw new MU("internal","Response is not valid JSON object.");case 22:if(void 0===(d=h.json.data)&&(d=h.json.result),void 0!==d){e.next=26;break}throw new MU("internal","Response is missing data field.");case 26:return p=DU(d),e.abrupt("return",{data:p});case 28:case"end":return e.stop()}}),t)})))).apply(this,arguments)}var GU="@firebase/functions",HU="0.9.0";function QU(e,t,n){!function(e,t,n){e.emulatorOrigin="http://".concat(t,":").concat(n)}(lt(e),t,n)}function YU(e,t,n){return jU(lt(e),t,n)}function JU(e,t,n){return function(e,t,n){return function(r){return zU(e,t,r,n||{})}}(lt(e),t,n)}!function(e,t){rn(new ht(PU,(function(t,n){var r=n.instanceIdentifier,i=t.getProvider("app").getImmediate(),a=t.getProvider("auth-internal"),o=t.getProvider("messaging-internal"),s=t.getProvider("app-check-internal");return new VU(i,a,o,s,r,e)}),"PUBLIC").setMultipleInstances(!0)),mn(GU,HU,t),mn(GU,HU,"esm2017")}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(fetch.bind(self));var XU=function(){"use strict";function t(n,r){e(l)(this,t),this.app=n,this._delegate=r,this._region=this._delegate.region,this._customDomain=this._delegate.customDomain}return e(h)(t,[{key:"httpsCallable",value:function(e,t){return YU(this._delegate,e,t)}},{key:"httpsCallableFromURL",value:function(e,t){return JU(this._delegate,e,t)}},{key:"useFunctionsEmulator",value:function(e){var t=e.match("[a-zA-Z]+://([a-zA-Z0-9.-]+)(?::([0-9]+))?");if(null==t)throw new Oe("functions","No origin provided to useFunctionsEmulator()");if(null==t[2])throw new Oe("functions","Port missing in origin provided to useFunctionsEmulator()");return QU(this._delegate,t[1],Number(t[2]))}},{key:"useEmulator",value:function(e,t){return QU(this._delegate,e,t)}}]),t}(),$U=function(e,t){var n=t.instanceIdentifier,r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("functions").getImmediate({identifier:null!=n?n:"us-central1"});return new XU(r,i)};
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
!function(){var e={Functions:XU};Fc.INTERNAL.registerComponent(new ht("functions-compat",$U,"PUBLIC").setServiceProps(e).setMultipleInstances(!0))}(),Fc.registerVersion("@firebase/functions-compat","0.3.0");d=o("hKHmD");
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ZU,eq,tq,nq,rq="/firebase-messaging-sw.js",iq="/firebase-cloud-messaging-push-scope",aq="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",oq="google.c.a.c_id";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function sq(t){var n,r=new Uint8Array(t);return btoa((n=String).fromCharCode.apply(n,e(p)(r))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function uq(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(t),r=new Uint8Array(n.length),i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(eq=ZU||(ZU={}))[eq.DATA_MESSAGE=1]="DATA_MESSAGE",eq[eq.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION",(nq=tq||(tq={})).PUSH_RECEIVED="push-received",nq.NOTIFICATION_CLICKED="notification-clicked";var cq="fcm_token_details_db",lq="fcm_token_object_Store";function hq(e){return fq.apply(this,arguments)}function fq(){return fq=e(u)(e(_).mark((function t(n){var r,i;return e(_).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!("databases"in indexedDB)){t.next=7;break}return t.next=3,indexedDB.databases();case 3:if(r=t.sent,r.map((function(e){return e.name})).includes(cq)){t.next=7;break}return t.abrupt("return",null);case 7:return i=null,t.next=10,qt(cq,5,{upgrade:function(){var t=e(u)(e(_).mark((function t(r,a,o,s){var u,c,l,h,f,d;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a<2)){e.next=3;break}return e.abrupt("return");case 3:if(r.objectStoreNames.contains(lq)){e.next=5;break}return e.abrupt("return");case 5:return c=s.objectStore(lq),e.next=8,c.index("fcmSenderId").get(n);case 8:return l=e.sent,e.next=11,c.clear();case 11:if(l){e.next=13;break}return e.abrupt("return");case 13:if(2!==a){e.next=20;break}if((h=l).auth&&h.p256dh&&h.endpoint){e.next=17;break}return e.abrupt("return");case 17:i={token:h.fcmToken,createTime:null!==(u=h.createTime)&&void 0!==u?u:Date.now(),subscriptionOptions:{auth:h.auth,p256dh:h.p256dh,endpoint:h.endpoint,swScope:h.swScope,vapidKey:"string"==typeof h.vapidKey?h.vapidKey:sq(h.vapidKey)}},e.next=21;break;case 20:3===a?i={token:(f=l).fcmToken,createTime:f.createTime,subscriptionOptions:{auth:sq(f.auth),p256dh:sq(f.p256dh),endpoint:f.endpoint,swScope:f.swScope,vapidKey:sq(f.vapidKey)}}:4===a&&(i={token:(d=l).fcmToken,createTime:d.createTime,subscriptionOptions:{auth:sq(d.auth),p256dh:sq(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:sq(d.vapidKey)}});case 21:case"end":return e.stop()}}),t)})));return function(e,n,r,i){return t.apply(this,arguments)}}()});case 10:return t.sent.close(),t.next=14,Vt(cq);case 14:return t.next=16,Vt("fcm_vapid_details_db");case 16:return t.next=18,Vt("undefined");case 18:return t.abrupt("return",dq(i)?i:null);case 19:case"end":return t.stop()}}),t)}))),fq.apply(this,arguments)}function dq(e){if(!e||!e.subscriptionOptions)return!1;var t=e.subscriptionOptions;return"number"==typeof e.createTime&&e.createTime>0&&"string"==typeof e.token&&e.token.length>0&&"string"==typeof t.auth&&t.auth.length>0&&"string"==typeof t.p256dh&&t.p256dh.length>0&&"string"==typeof t.endpoint&&t.endpoint.length>0&&"string"==typeof t.swScope&&t.swScope.length>0&&"string"==typeof t.vapidKey&&t.vapidKey.length>0}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var pq,vq="firebase-messaging-store",yq=null;function mq(){return yq||(yq=qt("firebase-messaging-database",1,{upgrade:function(e,t){if(0===t)e.createObjectStore(vq)}})),yq}function gq(e){return kq.apply(this,arguments)}function kq(){return(kq=e(u)(e(_).mark((function t(n){var r,i,a,o;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Iq(n),e.next=3,mq();case 3:return i=e.sent,e.next=6,i.transaction(vq).objectStore(vq).get(r);case 6:if(!(a=e.sent)){e.next=11;break}return e.abrupt("return",a);case 11:return e.next=13,hq(n.appConfig.senderId);case 13:if(!(o=e.sent)){e.next=18;break}return e.next=17,_q(n,o);case 17:return e.abrupt("return",o);case 18:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function _q(e,t){return wq.apply(this,arguments)}function wq(){return(wq=e(u)(e(_).mark((function t(n,r){var i,a,o;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Iq(n),e.next=3,mq();case 3:return a=e.sent,o=a.transaction(vq,"readwrite"),e.next=7,o.objectStore(vq).put(r,i);case 7:return e.next=9,o.done;case 9:return e.abrupt("return",r);case 10:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function bq(e){return xq.apply(this,arguments)}function xq(){return(xq=e(u)(e(_).mark((function t(n){var r,i,a;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Iq(n),e.next=3,mq();case 3:return i=e.sent,a=i.transaction(vq,"readwrite"),e.next=7,a.objectStore(vq).delete(r);case 7:return e.next=9,a.done;case 9:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Iq(e){return e.appConfig.appId}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Tq=(pq={},e(d)(pq,"missing-app-config-values",'Missing App configuration value: "{$valueName}"'),e(d)(pq,"only-available-in-window","This method is available in a Window context."),e(d)(pq,"only-available-in-sw","This method is available in a service worker context."),e(d)(pq,"permission-default","The notification permission was not granted and dismissed instead."),e(d)(pq,"permission-blocked","The notification permission was not granted and blocked instead."),e(d)(pq,"unsupported-browser","This browser doesn't support the API's required to use the Firebase SDK."),e(d)(pq,"indexed-db-unsupported","This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)"),e(d)(pq,"failed-service-worker-registration","We are unable to register the default service worker. {$browserErrorMessage}"),e(d)(pq,"token-subscribe-failed","A problem occurred while subscribing the user to FCM: {$errorInfo}"),e(d)(pq,"token-subscribe-no-token","FCM returned no token when subscribing the user to push."),e(d)(pq,"token-unsubscribe-failed","A problem occurred while unsubscribing the user from FCM: {$errorInfo}"),e(d)(pq,"token-update-failed","A problem occurred while updating the user from FCM: {$errorInfo}"),e(d)(pq,"token-update-no-token","FCM returned no token when updating the user to push."),e(d)(pq,"use-sw-after-get-token","The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used."),e(d)(pq,"invalid-sw-registration","The input to useServiceWorker() must be a ServiceWorkerRegistration."),e(d)(pq,"invalid-bg-handler","The input to setBackgroundMessageHandler() must be a function."),e(d)(pq,"invalid-vapid-key","The public VAPID key must be a string."),e(d)(pq,"use-vapid-key-after-get-token","The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."),pq),Eq=new Me("messaging","Messaging",Tq);function Sq(e,t){return Cq.apply(this,arguments)}function Cq(){return(Cq=
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(_).mark((function t(n,r){var i,a,o,s,u,c;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Oq(n);case 2:return i=e.sent,a=Lq(r),o={method:"POST",headers:i,body:JSON.stringify(a)},e.prev=6,e.next=9,fetch(Pq(n.appConfig),o);case 9:return u=e.sent,e.next=12,u.json();case 12:s=e.sent,e.next=18;break;case 15:throw e.prev=15,e.t0=e.catch(6),Eq.create("token-subscribe-failed",{errorInfo:null===e.t0||void 0===e.t0?void 0:e.t0.toString()});case 18:if(!s.error){e.next=21;break}throw c=s.error.message,Eq.create("token-subscribe-failed",{errorInfo:c});case 21:if(s.token){e.next=23;break}throw Eq.create("token-subscribe-no-token");case 23:return e.abrupt("return",s.token);case 24:case"end":return e.stop()}}),t,null,[[6,15]])})))).apply(this,arguments)}function Aq(e,t){return Nq.apply(this,arguments)}function Nq(){return(Nq=e(u)(e(_).mark((function t(n,r){var i,a,o,s,u,c;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Oq(n);case 2:return i=e.sent,a=Lq(r.subscriptionOptions),o={method:"PATCH",headers:i,body:JSON.stringify(a)},e.prev=6,e.next=9,fetch("".concat(Pq(n.appConfig),"/").concat(r.token),o);case 9:return u=e.sent,e.next=12,u.json();case 12:s=e.sent,e.next=18;break;case 15:throw e.prev=15,e.t0=e.catch(6),Eq.create("token-update-failed",{errorInfo:null===e.t0||void 0===e.t0?void 0:e.t0.toString()});case 18:if(!s.error){e.next=21;break}throw c=s.error.message,Eq.create("token-update-failed",{errorInfo:c});case 21:if(s.token){e.next=23;break}throw Eq.create("token-update-no-token");case 23:return e.abrupt("return",s.token);case 24:case"end":return e.stop()}}),t,null,[[6,15]])})))).apply(this,arguments)}function Rq(e,t){return Dq.apply(this,arguments)}function Dq(){return(Dq=e(u)(e(_).mark((function t(n,r){var i,a,o,s,u;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Oq(n);case 2:return i=e.sent,a={method:"DELETE",headers:i},e.prev=4,e.next=7,fetch("".concat(Pq(n.appConfig),"/").concat(r),a);case 7:return o=e.sent,e.next=10,o.json();case 10:if(!(s=e.sent).error){e.next=14;break}throw u=s.error.message,Eq.create("token-unsubscribe-failed",{errorInfo:u});case 14:e.next=19;break;case 16:throw e.prev=16,e.t0=e.catch(4),Eq.create("token-unsubscribe-failed",{errorInfo:null===e.t0||void 0===e.t0?void 0:e.t0.toString()});case 19:case"end":return e.stop()}}),t,null,[[4,16]])})))).apply(this,arguments)}function Pq(e){var t=e.projectId;return"".concat("https://fcmregistrations.googleapis.com/v1","/projects/").concat(t,"/registrations")}function Oq(e){return Mq.apply(this,arguments)}function Mq(){return(Mq=e(u)(e(_).mark((function t(n){var r,i,a;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.appConfig,i=n.installations,e.next=3,i.getToken();case 3:return a=e.sent,e.abrupt("return",new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":r.apiKey,"x-goog-firebase-installations-auth":"FIS ".concat(a)}));case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Lq(e){var t=e.p256dh,n=e.auth,r=e.endpoint,i=e.vapidKey,a={web:{endpoint:r,auth:n,p256dh:t}};return i!==aq&&(a.web.applicationPubKey=i),a}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Fq=6048e5;function Uq(e){return qq.apply(this,arguments)}function qq(){return(qq=e(u)(e(_).mark((function t(n){var r,i,a;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Gq(n.swRegistration,n.vapidKey);case 2:return r=e.sent,i={vapidKey:n.vapidKey,swScope:n.swRegistration.scope,endpoint:r.endpoint,auth:sq(r.getKey("auth")),p256dh:sq(r.getKey("p256dh"))},e.next=6,gq(n.firebaseDependencies);case 6:if(a=e.sent){e.next=11;break}return e.abrupt("return",zq(n.firebaseDependencies,i));case 11:if(Qq(a.subscriptionOptions,i)){e.next=23;break}return e.prev=12,e.next=15,Rq(n.firebaseDependencies,a.token);case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(12),console.warn(e.t0);case 20:return e.abrupt("return",zq(n.firebaseDependencies,i));case 23:if(!(Date.now()>=a.createTime+Fq)){e.next=27;break}return e.abrupt("return",Bq(n,{token:a.token,createTime:Date.now(),subscriptionOptions:i}));case 27:return e.abrupt("return",a.token);case 28:case"end":return e.stop()}}),t,null,[[12,17]])})))).apply(this,arguments)}function Vq(e){return jq.apply(this,arguments)}function jq(){return(jq=e(u)(e(_).mark((function t(n){var r,i;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,gq(n.firebaseDependencies);case 2:if(!(r=e.sent)){e.next=8;break}return e.next=6,Rq(n.firebaseDependencies,r.token);case 6:return e.next=8,bq(n.firebaseDependencies);case 8:return e.next=10,n.swRegistration.pushManager.getSubscription();case 10:if(!(i=e.sent)){e.next=13;break}return e.abrupt("return",i.unsubscribe());case 13:return e.abrupt("return",!0);case 14:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Bq(e,t){return Kq.apply(this,arguments)}function Kq(){return(Kq=e(u)(e(_).mark((function t(n,r){var i,a;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Aq(n.firebaseDependencies,r);case 3:return i=e.sent,a=Object.assign(Object.assign({},r),{token:i,createTime:Date.now()}),e.next=7,_q(n.firebaseDependencies,a);case 7:return e.abrupt("return",i);case 10:return e.prev=10,e.t0=e.catch(0),e.next=14,Vq(n);case 14:throw e.t0;case 15:case"end":return e.stop()}}),t,null,[[0,10]])})))).apply(this,arguments)}function zq(e,t){return Wq.apply(this,arguments)}function Wq(){return(Wq=e(u)(e(_).mark((function t(n,r){var i,a;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Sq(n,r);case 2:return i=e.sent,a={token:i,createTime:Date.now(),subscriptionOptions:r},e.next=6,_q(n,a);case 6:return e.abrupt("return",a.token);case 7:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Gq(e,t){return Hq.apply(this,arguments)}function Hq(){return(Hq=e(u)(e(_).mark((function t(n,r){var i;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.pushManager.getSubscription();case 2:if(!(i=e.sent)){e.next=5;break}return e.abrupt("return",i);case 5:return e.abrupt("return",n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:uq(r)}));case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Qq(e,t){var n=t.vapidKey===e.vapidKey,r=t.endpoint===e.endpoint,i=t.auth===e.auth,a=t.p256dh===e.p256dh;return n&&r&&i&&a}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yq(e){var t={from:e.from,collapseKey:e.collapse_key,messageId:e.fcmMessageId};return function(e,t){if(!t.notification)return;e.notification={};var n=t.notification.title;n&&(e.notification.title=n);var r=t.notification.body;r&&(e.notification.body=r);var i=t.notification.image;i&&(e.notification.image=i);var a=t.notification.icon;a&&(e.notification.icon=a)}(t,e),function(e,t){if(!t.data)return;e.data=t.data}(t,e),function(e,t){var n,r,i,a,o;if(!t.fcmOptions&&!(null===(n=t.notification)||void 0===n?void 0:n.click_action))return;e.fcmOptions={};var s=null!==(i=null===(r=t.fcmOptions)||void 0===r?void 0:r.link)&&void 0!==i?i:null===(a=t.notification)||void 0===a?void 0:a.click_action;s&&(e.fcmOptions.link=s);var u=null===(o=t.fcmOptions)||void 0===o?void 0:o.analytics_label;u&&(e.fcmOptions.analyticsLabel=u)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t,e),t}function Jq(e){return"object"==typeof e&&!!e&&oq in e}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xq(e,t){for(var n=[],r=0;r<e.length;r++)n.push(e.charAt(r)),r<t.length&&n.push(t.charAt(r));return n.join("")}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $q(e){return Eq.create("missing-app-config-values",{valueName:e})}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Xq("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),Xq("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");var Zq=function(){"use strict";function t(n,r,i){e(l)(this,t),this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;var a=function(e){if(!e||!e.options)throw $q("App Configuration Object");if(!e.name)throw $q("App Name");var t=e.options,n=!0,r=!1,i=void 0;try{for(var a,o=["projectId","apiKey","appId","messagingSenderId"][Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;if(!t[s])throw $q(s)}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return{appName:e.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}(n);this.firebaseDependencies={app:n,appConfig:a,installations:r,analyticsProvider:i}}return e(h)(t,[{key:"_delete",value:function(){return Promise.resolve()}}]),t}();function eV(e){return tV.apply(this,arguments)}function tV(){return(tV=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(_).mark((function t(n){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.serviceWorker.register(rq,{scope:iq});case 3:n.swRegistration=e.sent,n.swRegistration.update().catch((function(){})),e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),Eq.create("failed-service-worker-registration",{browserErrorMessage:null===e.t0||void 0===e.t0?void 0:e.t0.message});case 10:case"end":return e.stop()}}),t,null,[[0,7]])})))).apply(this,arguments)}function nV(e,t){return rV.apply(this,arguments)}function rV(){return(rV=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(_).mark((function t(n,r){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r||n.swRegistration){e.next=3;break}return e.next=3,eV(n);case 3:if(r||!n.swRegistration){e.next=5;break}return e.abrupt("return");case 5:if(r instanceof ServiceWorkerRegistration){e.next=7;break}throw Eq.create("invalid-sw-registration");case 7:n.swRegistration=r;case 8:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function iV(e,t){return aV.apply(this,arguments)}function aV(){return(aV=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(_).mark((function t(n,r){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r?n.vapidKey=r:n.vapidKey||(n.vapidKey=aq);case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function oV(e,t){return sV.apply(this,arguments)}function sV(){return(sV=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(_).mark((function t(n,r){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator){e.next=2;break}throw Eq.create("only-available-in-window");case 2:if("default"!==Notification.permission){e.next=5;break}return e.next=5,Notification.requestPermission();case 5:if("granted"===Notification.permission){e.next=7;break}throw Eq.create("permission-blocked");case 7:return e.next=9,iV(n,null==r?void 0:r.vapidKey);case 9:return e.next=11,nV(n,null==r?void 0:r.serviceWorkerRegistration);case 11:return e.abrupt("return",Uq(n));case 12:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function uV(e,t,n){return cV.apply(this,arguments)}function cV(){return(cV=
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(_).mark((function t(n,r,i){var a;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=lV(r),e.next=3,n.firebaseDependencies.analyticsProvider.get();case 3:e.sent.logEvent(a,{message_id:i["google.c.a.c_id"],message_name:i["google.c.a.c_l"],message_time:i["google.c.a.ts"],message_device_time:Math.floor(Date.now()/1e3)});case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function lV(e){switch(e){case tq.NOTIFICATION_CLICKED:return"notification_open";case tq.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function hV(){return(hV=
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(_).mark((function t(n,r){var i,a;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((i=r.data).isFirebaseMessaging){e.next=3;break}return e.abrupt("return");case 3:if(n.onMessageHandler&&i.messageType===tq.PUSH_RECEIVED&&("function"==typeof n.onMessageHandler?n.onMessageHandler(Yq(i)):n.onMessageHandler.next(Yq(i))),!Jq(a=i.data)||"1"!==a["google.c.a.e"]){e.next=8;break}return e.next=8,uV(n,i.messageType,a);case 8:case"end":return e.stop()}}),t)})))).apply(this,arguments)}var fV="@firebase/messaging",dV="0.12.0",pV=function(e){var t=new Zq(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),e.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",(function(e){return function(e,t){return hV.apply(this,arguments)}(t,e)})),t},vV=function(e){var t=e.getProvider("messaging").getImmediate();return{getToken:function(e){return oV(t,e)}}};function yV(){return(yV=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(_).mark((function t(n){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator){e.next=2;break}throw Eq.create("only-available-in-window");case 2:if(n.swRegistration){e.next=5;break}return e.next=5,eV(n);case 5:return e.abrupt("return",Vq(n));case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mV(e,t){return gV.apply(this,arguments)}function gV(){return(gV=e(u)(e(_).mark((function t(n,r){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=lt(n),e.abrupt("return",oV(n,r));case 2:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function kV(e){return function(e){return yV.apply(this,arguments)}(e=lt(e))}function _V(e,t){return function(e,t){if(!navigator)throw Eq.create("only-available-in-window");return e.onMessageHandler=t,function(){e.onMessageHandler=null}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e=lt(e),t)}rn(new ht("messaging",pV,"PUBLIC")),rn(new ht("messaging-internal",vV,"PRIVATE")),mn(fV,dV),mn(fV,dV,"esm2017");d=o("hKHmD");
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var wV,bV,xV="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",IV="FCM_MSG";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function TV(t){var n,r=new Uint8Array(t);return btoa((n=String).fromCharCode.apply(n,e(p)(r))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function EV(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(t),r=new Uint8Array(n.length),i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */!function(e){e[e.DATA_MESSAGE=1]="DATA_MESSAGE",e[e.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"}(wV||(wV={})),function(e){e.PUSH_RECEIVED="push-received",e.NOTIFICATION_CLICKED="notification-clicked"}(bV||(bV={}));var SV="fcm_token_details_db",CV="fcm_token_object_Store";function AV(e){return NV.apply(this,arguments)}function NV(){return NV=e(u)(e(_).mark((function t(n){var r,i;return e(_).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!("databases"in indexedDB)){t.next=7;break}return t.next=3,indexedDB.databases();case 3:if(r=t.sent,r.map((function(e){return e.name})).includes(SV)){t.next=7;break}return t.abrupt("return",null);case 7:return i=null,t.next=10,qt(SV,5,{upgrade:function(){var t=e(u)(e(_).mark((function t(r,a,o,s){var u,c,l,h,f,d;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a<2)){e.next=3;break}return e.abrupt("return");case 3:if(r.objectStoreNames.contains(CV)){e.next=5;break}return e.abrupt("return");case 5:return c=s.objectStore(CV),e.next=8,c.index("fcmSenderId").get(n);case 8:return l=e.sent,e.next=11,c.clear();case 11:if(l){e.next=13;break}return e.abrupt("return");case 13:if(2!==a){e.next=20;break}if((h=l).auth&&h.p256dh&&h.endpoint){e.next=17;break}return e.abrupt("return");case 17:i={token:h.fcmToken,createTime:null!==(u=h.createTime)&&void 0!==u?u:Date.now(),subscriptionOptions:{auth:h.auth,p256dh:h.p256dh,endpoint:h.endpoint,swScope:h.swScope,vapidKey:"string"==typeof h.vapidKey?h.vapidKey:TV(h.vapidKey)}},e.next=21;break;case 20:3===a?i={token:(f=l).fcmToken,createTime:f.createTime,subscriptionOptions:{auth:TV(f.auth),p256dh:TV(f.p256dh),endpoint:f.endpoint,swScope:f.swScope,vapidKey:TV(f.vapidKey)}}:4===a&&(i={token:(d=l).fcmToken,createTime:d.createTime,subscriptionOptions:{auth:TV(d.auth),p256dh:TV(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:TV(d.vapidKey)}});case 21:case"end":return e.stop()}}),t)})));return function(e,n,r,i){return t.apply(this,arguments)}}()});case 10:return t.sent.close(),t.next=14,Vt(SV);case 14:return t.next=16,Vt("fcm_vapid_details_db");case 16:return t.next=18,Vt("undefined");case 18:return t.abrupt("return",RV(i)?i:null);case 19:case"end":return t.stop()}}),t)}))),NV.apply(this,arguments)}function RV(e){if(!e||!e.subscriptionOptions)return!1;var t=e.subscriptionOptions;return"number"==typeof e.createTime&&e.createTime>0&&"string"==typeof e.token&&e.token.length>0&&"string"==typeof t.auth&&t.auth.length>0&&"string"==typeof t.p256dh&&t.p256dh.length>0&&"string"==typeof t.endpoint&&t.endpoint.length>0&&"string"==typeof t.swScope&&t.swScope.length>0&&"string"==typeof t.vapidKey&&t.vapidKey.length>0}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var DV,PV="firebase-messaging-store",OV=null;function MV(){return OV||(OV=qt("firebase-messaging-database",1,{upgrade:function(e,t){if(0===t)e.createObjectStore(PV)}})),OV}function LV(e){return FV.apply(this,arguments)}function FV(){return(FV=e(u)(e(_).mark((function t(n){var r,i,a,o;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=BV(n),e.next=3,MV();case 3:return i=e.sent,e.next=6,i.transaction(PV).objectStore(PV).get(r);case 6:if(!(a=e.sent)){e.next=11;break}return e.abrupt("return",a);case 11:return e.next=13,AV(n.appConfig.senderId);case 13:if(!(o=e.sent)){e.next=18;break}return e.next=17,UV(n,o);case 17:return e.abrupt("return",o);case 18:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function UV(e,t){return qV.apply(this,arguments)}function qV(){return(qV=e(u)(e(_).mark((function t(n,r){var i,a,o;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=BV(n),e.next=3,MV();case 3:return a=e.sent,o=a.transaction(PV,"readwrite"),e.next=7,o.objectStore(PV).put(r,i);case 7:return e.next=9,o.done;case 9:return e.abrupt("return",r);case 10:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function VV(e){return jV.apply(this,arguments)}function jV(){return(jV=e(u)(e(_).mark((function t(n){var r,i,a;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=BV(n),e.next=3,MV();case 3:return i=e.sent,a=i.transaction(PV,"readwrite"),e.next=7,a.objectStore(PV).delete(r);case 7:return e.next=9,a.done;case 9:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function BV(e){return e.appConfig.appId}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var KV=(DV={},e(d)(DV,"missing-app-config-values",'Missing App configuration value: "{$valueName}"'),e(d)(DV,"only-available-in-window","This method is available in a Window context."),e(d)(DV,"only-available-in-sw","This method is available in a service worker context."),e(d)(DV,"permission-default","The notification permission was not granted and dismissed instead."),e(d)(DV,"permission-blocked","The notification permission was not granted and blocked instead."),e(d)(DV,"unsupported-browser","This browser doesn't support the API's required to use the Firebase SDK."),e(d)(DV,"indexed-db-unsupported","This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)"),e(d)(DV,"failed-service-worker-registration","We are unable to register the default service worker. {$browserErrorMessage}"),e(d)(DV,"token-subscribe-failed","A problem occurred while subscribing the user to FCM: {$errorInfo}"),e(d)(DV,"token-subscribe-no-token","FCM returned no token when subscribing the user to push."),e(d)(DV,"token-unsubscribe-failed","A problem occurred while unsubscribing the user from FCM: {$errorInfo}"),e(d)(DV,"token-update-failed","A problem occurred while updating the user from FCM: {$errorInfo}"),e(d)(DV,"token-update-no-token","FCM returned no token when updating the user to push."),e(d)(DV,"use-sw-after-get-token","The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used."),e(d)(DV,"invalid-sw-registration","The input to useServiceWorker() must be a ServiceWorkerRegistration."),e(d)(DV,"invalid-bg-handler","The input to setBackgroundMessageHandler() must be a function."),e(d)(DV,"invalid-vapid-key","The public VAPID key must be a string."),e(d)(DV,"use-vapid-key-after-get-token","The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."),DV),zV=new Me("messaging","Messaging",KV);function WV(e,t){return GV.apply(this,arguments)}function GV(){return(GV=
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(_).mark((function t(n,r){var i,a,o,s,u,c;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$V(n);case 2:return i=e.sent,a=ej(r),o={method:"POST",headers:i,body:JSON.stringify(a)},e.prev=6,e.next=9,fetch(XV(n.appConfig),o);case 9:return u=e.sent,e.next=12,u.json();case 12:s=e.sent,e.next=18;break;case 15:throw e.prev=15,e.t0=e.catch(6),zV.create("token-subscribe-failed",{errorInfo:null===e.t0||void 0===e.t0?void 0:e.t0.toString()});case 18:if(!s.error){e.next=21;break}throw c=s.error.message,zV.create("token-subscribe-failed",{errorInfo:c});case 21:if(s.token){e.next=23;break}throw zV.create("token-subscribe-no-token");case 23:return e.abrupt("return",s.token);case 24:case"end":return e.stop()}}),t,null,[[6,15]])})))).apply(this,arguments)}function HV(e,t){return QV.apply(this,arguments)}function QV(){return(QV=e(u)(e(_).mark((function t(n,r){var i,a,o,s,u,c;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$V(n);case 2:return i=e.sent,a=ej(r.subscriptionOptions),o={method:"PATCH",headers:i,body:JSON.stringify(a)},e.prev=6,e.next=9,fetch("".concat(XV(n.appConfig),"/").concat(r.token),o);case 9:return u=e.sent,e.next=12,u.json();case 12:s=e.sent,e.next=18;break;case 15:throw e.prev=15,e.t0=e.catch(6),zV.create("token-update-failed",{errorInfo:null===e.t0||void 0===e.t0?void 0:e.t0.toString()});case 18:if(!s.error){e.next=21;break}throw c=s.error.message,zV.create("token-update-failed",{errorInfo:c});case 21:if(s.token){e.next=23;break}throw zV.create("token-update-no-token");case 23:return e.abrupt("return",s.token);case 24:case"end":return e.stop()}}),t,null,[[6,15]])})))).apply(this,arguments)}function YV(e,t){return JV.apply(this,arguments)}function JV(){return(JV=e(u)(e(_).mark((function t(n,r){var i,a,o,s,u;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$V(n);case 2:return i=e.sent,a={method:"DELETE",headers:i},e.prev=4,e.next=7,fetch("".concat(XV(n.appConfig),"/").concat(r),a);case 7:return o=e.sent,e.next=10,o.json();case 10:if(!(s=e.sent).error){e.next=14;break}throw u=s.error.message,zV.create("token-unsubscribe-failed",{errorInfo:u});case 14:e.next=19;break;case 16:throw e.prev=16,e.t0=e.catch(4),zV.create("token-unsubscribe-failed",{errorInfo:null===e.t0||void 0===e.t0?void 0:e.t0.toString()});case 19:case"end":return e.stop()}}),t,null,[[4,16]])})))).apply(this,arguments)}function XV(e){var t=e.projectId;return"".concat("https://fcmregistrations.googleapis.com/v1","/projects/").concat(t,"/registrations")}function $V(e){return ZV.apply(this,arguments)}function ZV(){return(ZV=e(u)(e(_).mark((function t(n){var r,i,a;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.appConfig,i=n.installations,e.next=3,i.getToken();case 3:return a=e.sent,e.abrupt("return",new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":r.apiKey,"x-goog-firebase-installations-auth":"FIS ".concat(a)}));case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function ej(e){var t=e.p256dh,n=e.auth,r=e.endpoint,i=e.vapidKey,a={web:{endpoint:r,auth:n,p256dh:t}};return i!==xV&&(a.web.applicationPubKey=i),a}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var tj=6048e5;function nj(e){return rj.apply(this,arguments)}function rj(){return(rj=e(u)(e(_).mark((function t(n){var r,i,a;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,lj(n.swRegistration,n.vapidKey);case 2:return r=e.sent,i={vapidKey:n.vapidKey,swScope:n.swRegistration.scope,endpoint:r.endpoint,auth:TV(r.getKey("auth")),p256dh:TV(r.getKey("p256dh"))},e.next=6,LV(n.firebaseDependencies);case 6:if(a=e.sent){e.next=11;break}return e.abrupt("return",uj(n.firebaseDependencies,i));case 11:if(fj(a.subscriptionOptions,i)){e.next=23;break}return e.prev=12,e.next=15,YV(n.firebaseDependencies,a.token);case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(12),console.warn(e.t0);case 20:return e.abrupt("return",uj(n.firebaseDependencies,i));case 23:if(!(Date.now()>=a.createTime+tj)){e.next=27;break}return e.abrupt("return",oj(n,{token:a.token,createTime:Date.now(),subscriptionOptions:i}));case 27:return e.abrupt("return",a.token);case 28:case"end":return e.stop()}}),t,null,[[12,17]])})))).apply(this,arguments)}function ij(e){return aj.apply(this,arguments)}function aj(){return(aj=e(u)(e(_).mark((function t(n){var r,i;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,LV(n.firebaseDependencies);case 2:if(!(r=e.sent)){e.next=8;break}return e.next=6,YV(n.firebaseDependencies,r.token);case 6:return e.next=8,VV(n.firebaseDependencies);case 8:return e.next=10,n.swRegistration.pushManager.getSubscription();case 10:if(!(i=e.sent)){e.next=13;break}return e.abrupt("return",i.unsubscribe());case 13:return e.abrupt("return",!0);case 14:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function oj(e,t){return sj.apply(this,arguments)}function sj(){return(sj=e(u)(e(_).mark((function t(n,r){var i,a;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,HV(n.firebaseDependencies,r);case 3:return i=e.sent,a=Object.assign(Object.assign({},r),{token:i,createTime:Date.now()}),e.next=7,UV(n.firebaseDependencies,a);case 7:return e.abrupt("return",i);case 10:return e.prev=10,e.t0=e.catch(0),e.next=14,ij(n);case 14:throw e.t0;case 15:case"end":return e.stop()}}),t,null,[[0,10]])})))).apply(this,arguments)}function uj(e,t){return cj.apply(this,arguments)}function cj(){return(cj=e(u)(e(_).mark((function t(n,r){var i,a;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,WV(n,r);case 2:return i=e.sent,a={token:i,createTime:Date.now(),subscriptionOptions:r},e.next=6,UV(n,a);case 6:return e.abrupt("return",a.token);case 7:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function lj(e,t){return hj.apply(this,arguments)}function hj(){return(hj=e(u)(e(_).mark((function t(n,r){var i;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.pushManager.getSubscription();case 2:if(!(i=e.sent)){e.next=5;break}return e.abrupt("return",i);case 5:return e.abrupt("return",n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:EV(r)}));case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function fj(e,t){var n=t.vapidKey===e.vapidKey,r=t.endpoint===e.endpoint,i=t.auth===e.auth,a=t.p256dh===e.p256dh;return n&&r&&i&&a}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dj(e){var t={from:e.from,collapseKey:e.collapse_key,messageId:e.fcmMessageId};return function(e,t){if(!t.notification)return;e.notification={};var n=t.notification.title;n&&(e.notification.title=n);var r=t.notification.body;r&&(e.notification.body=r);var i=t.notification.image;i&&(e.notification.image=i);var a=t.notification.icon;a&&(e.notification.icon=a)}(t,e),function(e,t){if(!t.data)return;e.data=t.data}(t,e),function(e,t){var n,r,i,a,o;if(!t.fcmOptions&&!(null===(n=t.notification)||void 0===n?void 0:n.click_action))return;e.fcmOptions={};var s=null!==(i=null===(r=t.fcmOptions)||void 0===r?void 0:r.link)&&void 0!==i?i:null===(a=t.notification)||void 0===a?void 0:a.click_action;s&&(e.fcmOptions.link=s);var u=null===(o=t.fcmOptions)||void 0===o?void 0:o.analytics_label;u&&(e.fcmOptions.analyticsLabel=u)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t,e),t}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pj(e){return new Promise((function(t){setTimeout(t,e)}))}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vj(e,t){return yj.apply(this,arguments)}function yj(){return(yj=e(u)(e(_).mark((function t(n,r){var i;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=mj,e.t1=r,e.next=4,n.firebaseDependencies.installations.getId();case 4:e.t2=e.sent,i=(0,e.t0)(e.t1,e.t2),gj(n,i);case 7:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function mj(e,t){var n,r,i={};return e.from&&(i.project_number=e.from),e.fcmMessageId&&(i.message_id=e.fcmMessageId),i.instance_id=t,e.notification?i.message_type=wV.DISPLAY_NOTIFICATION.toString():i.message_type=wV.DATA_MESSAGE.toString(),i.sdk_platform=3..toString(),i.package_name=self.origin.replace(/(^\w+:|^)\/\//,""),e.collapse_key&&(i.collapse_key=e.collapse_key),i.event=1..toString(),(null===(n=e.fcmOptions)||void 0===n?void 0:n.analytics_label)&&(i.analytics_label=null===(r=e.fcmOptions)||void 0===r?void 0:r.analytics_label),i}function gj(e,t){var n={};n.event_time_ms=Math.floor(Date.now()).toString(),n.source_extension_json_proto3=JSON.stringify(t),e.logEvents.push(n)}function kj(e,t){for(var n=[],r=0;r<e.length;r++)n.push(e.charAt(r)),r<t.length&&n.push(t.charAt(r));return n.join("")}function _j(){return(_j=
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(_).mark((function t(n,r){var i,a,o;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.newSubscription){e.next=6;break}return e.next=5,ij(r);case 5:return e.abrupt("return");case 6:return e.next=8,LV(r.firebaseDependencies);case 8:return o=e.sent,e.next=11,ij(r);case 11:return r.vapidKey=null!==(a=null===(i=null==o?void 0:o.subscriptionOptions)||void 0===i?void 0:i.vapidKey)&&void 0!==a?a:xV,e.next=14,nj(r);case 14:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function wj(){return(wj=e(u)(e(_).mark((function t(n,r){var i,a,o;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=Ij(n)){e.next=3;break}return e.abrupt("return");case 3:if(!r.deliveryMetricsExportedToBigQueryEnabled){e.next=6;break}return e.next=6,vj(r,i);case 6:return e.next=8,Aj();case 8:if(!Sj(a=e.sent)){e.next=11;break}return e.abrupt("return",Cj(a,i));case 11:if(!i.notification){e.next=14;break}return e.next=14,Nj(xj(i));case 14:if(r){e.next=16;break}return e.abrupt("return");case 16:if(!r.onBackgroundMessageHandler){e.next=24;break}if(o=dj(i),"function"!=typeof r.onBackgroundMessageHandler){e.next=23;break}return e.next=21,r.onBackgroundMessageHandler(o);case 21:e.next=24;break;case 23:r.onBackgroundMessageHandler.next(o);case 24:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function bj(){return(bj=e(u)(e(_).mark((function t(n){var r,i,a,o,s,u,c;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null===(i=null===(r=n.notification)||void 0===r?void 0:r.data)||void 0===i?void 0:i.FCM_MSG){e.next=6;break}return e.abrupt("return");case 6:if(!n.action){e.next=8;break}return e.abrupt("return");case 8:if(n.stopImmediatePropagation(),n.notification.close(),o=Rj(a)){e.next=13;break}return e.abrupt("return");case 13:if(s=new URL(o,self.location.href),u=new URL(self.location.origin),s.host===u.host){e.next=17;break}return e.abrupt("return");case 17:return e.next=19,Tj(s);case 19:if(c=e.sent){e.next=28;break}return e.next=23,self.clients.openWindow(o);case 23:return c=e.sent,e.next=26,pj(3e3);case 26:e.next=31;break;case 28:return e.next=30,c.focus();case 30:c=e.sent;case 31:if(c){e.next=33;break}return e.abrupt("return");case 33:return a.messageType=bV.NOTIFICATION_CLICKED,a.isFirebaseMessaging=!0,e.abrupt("return",c.postMessage(a));case 36:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function xj(t){var n=Object.assign({},t.notification);return n.data=e(d)({},IV,t),n}function Ij(e){var t=e.data;if(!t)return null;try{return t.json()}catch(e){return null}}function Tj(e){return Ej.apply(this,arguments)}function Ej(){return(Ej=e(u)(e(_).mark((function t(n){var r,i,a,o,s,u,c,l;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Aj();case 2:r=e.sent,i=!0,a=!1,o=void 0,e.prev=4,s=r[Symbol.iterator]();case 6:if(i=(u=s.next()).done){e.next=14;break}if(c=u.value,l=new URL(c.url,self.location.href),n.host!==l.host){e.next=11;break}return e.abrupt("return",c);case 11:i=!0,e.next=6;break;case 14:e.next=20;break;case 16:e.prev=16,e.t0=e.catch(4),a=!0,o=e.t0;case 20:e.prev=20,e.prev=21,i||null==s.return||s.return();case 23:if(e.prev=23,!a){e.next=26;break}throw o;case 26:return e.finish(23);case 27:return e.finish(20);case 28:return e.abrupt("return",null);case 29:case"end":return e.stop()}}),t,null,[[4,16,20,28],[21,,23,27]])})))).apply(this,arguments)}function Sj(e){return e.some((function(e){return"visible"===e.visibilityState&&!e.url.startsWith("chrome-extension://")}))}function Cj(e,t){t.isFirebaseMessaging=!0,t.messageType=bV.PUSH_RECEIVED;var n=!0,r=!1,i=void 0;try{for(var a,o=e[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){a.value.postMessage(t)}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}}function Aj(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function Nj(e){var t,n=e.actions,r=Notification.maxActions;return n&&r&&n.length>r&&console.warn("This browser only supports ".concat(r," actions. The remaining actions will not be displayed.")),self.registration.showNotification(null!==(t=e.title)&&void 0!==t?t:"",e)}function Rj(e){var t,n,r,i,a=null!==(n=null===(t=e.fcmOptions)||void 0===t?void 0:t.link)&&void 0!==n?n:null===(r=e.notification)||void 0===r?void 0:r.click_action;return a||("object"==typeof(i=e.data)&&i&&"google.c.a.c_id"in i?self.location.origin:null)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dj(e){return zV.create("missing-app-config-values",{valueName:e})}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */kj("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),kj("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");var Pj=function(){"use strict";function t(n,r,i){e(l)(this,t),this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;var a=function(e){if(!e||!e.options)throw Dj("App Configuration Object");if(!e.name)throw Dj("App Name");var t=e.options,n=!0,r=!1,i=void 0;try{for(var a,o=["projectId","apiKey","appId","messagingSenderId"][Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;if(!t[s])throw Dj(s)}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return{appName:e.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}(n);this.firebaseDependencies={app:n,appConfig:a,installations:r,analyticsProvider:i}}return e(h)(t,[{key:"_delete",value:function(){return Promise.resolve()}}]),t}(),Oj=function(e){var t=new Pj(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),e.getProvider("analytics-internal"));return self.addEventListener("push",(function(e){e.waitUntil(function(e,t){return wj.apply(this,arguments)}(e,t))})),self.addEventListener("pushsubscriptionchange",(function(e){e.waitUntil(function(e,t){return _j.apply(this,arguments)}(e,t))})),self.addEventListener("notificationclick",(function(e){e.waitUntil(function(e){return bj.apply(this,arguments)}(e))})),t};
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mj(e,t){
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
return function(e,t){if(void 0!==self.document)throw zV.create("only-available-in-sw");return e.onBackgroundMessageHandler=t,function(){e.onBackgroundMessageHandler=null}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e=lt(e),t)}rn(new ht("messaging-sw",Oj,"PUBLIC"));var Lj=function(){"use strict";function t(n,r){e(l)(this,t),this.app=n,this._delegate=r,this.app=n,this._delegate=r}return e(h)(t,[{key:"getToken",value:function(t){var n=this;return e(u)(e(_).mark((function r(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",mV(n._delegate,t));case 1:case"end":return e.stop()}}),r)})))()}},{key:"deleteToken",value:function(){var t=this;return e(u)(e(_).mark((function n(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",kV(t._delegate));case 1:case"end":return e.stop()}}),n)})))()}},{key:"onMessage",value:function(e){return _V(this._delegate,e)}},{key:"onBackgroundMessage",value:function(e){return Mj(this._delegate,e)}}]),t}(),Fj=function(e){return self&&"ServiceWorkerGlobalScope"in self?new Lj(e.getProvider("app-compat").getImmediate(),e.getProvider("messaging-sw").getImmediate()):new Lj(e.getProvider("app-compat").getImmediate(),e.getProvider("messaging").getImmediate())},Uj={isSupported:
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(){return self&&"ServiceWorkerGlobalScope"in self?xe()&&"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey"):"undefined"!=typeof window&&xe()&&Te()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}};
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Fc.INTERNAL.registerComponent(new ht("messaging-compat",Fj,"PUBLIC").setServiceProps(Uj)),Fc.registerVersion("@firebase/messaging-compat","0.2.0");C=o("ds8z5");
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var qj="firebasestorage.googleapis.com",Vj=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(t,i){var a,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e(l)(this,r),(a=n.call(this,jj(t),"Firebase Storage: ".concat(i," (").concat(jj(t),")"))).status_=o,a.customData={serverResponse:null},a._baseMessage=a.message,Object.setPrototypeOf(e(C)(a),r.prototype),a}return e(h)(r,[{key:"status",get:function(){return this.status_},set:function(e){this.status_=e}},{key:"_codeEquals",value:function(e){return jj(e)===this.code}},{key:"serverResponse",get:function(){return this.customData.serverResponse},set:function(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message="".concat(this._baseMessage,"\n").concat(this.customData.serverResponse):this.message=this._baseMessage}}]),r}(Oe);function jj(e){return"storage/"+e}function Bj(){return new Vj("unknown","An unknown error occurred, please check the error payload for server response.")}function Kj(){return new Vj("retry-limit-exceeded","Max retry time for operation exceeded, please try again.")}function zj(){return new Vj("canceled","User canceled the upload/download.")}function Wj(){return new Vj("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function Gj(e){return new Vj("invalid-argument",e)}function Hj(){return new Vj("app-deleted","The Firebase app was deleted.")}function Qj(e){return new Vj("invalid-root-operation","The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Yj(e,t){return new Vj("invalid-format","String does not match format '"+e+"': "+t)}function Jj(e){throw new Vj("internal-error","Internal error: "+e)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Xj,$j,Zj=function(){"use strict";function t(n,r){e(l)(this,t),this.bucket=n,this.path_=r}return e(h)(t,[{key:"path",get:function(){return this.path_}},{key:"isRoot",get:function(){return 0===this.path.length}},{key:"fullServerUrl",value:function(){var e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}},{key:"bucketOnlyServerUrl",value:function(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}}],[{key:"makeFromBucketSpec",value:function(e,n){var r;try{r=t.makeFromUrl(e,n)}catch(n){return new t(e,"")}if(""===r.path)return r;throw new Vj("invalid-default-bucket","Invalid default bucket '"+e+"'.")}},{key:"makeFromUrl",value:function(e,n){var r=null,i="([A-Za-z0-9.\\-_]+)";var a=new RegExp("^gs://"+i+"(/(.*))?$","i");function o(e){e.path_=decodeURIComponent(e.path)}for(var s=n.replace(/[.]/g,"\\."),u=[{regex:a,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp("^https?://".concat(s,"/").concat("v[A-Za-z0-9_]+","/b/").concat(i,"/o").concat("(/([^?#]*).*)?$"),"i"),indices:{bucket:1,path:3},postModify:o},{regex:new RegExp("^https?://".concat(n===qj?"(?:storage.googleapis.com|storage.cloud.google.com)":n,"/").concat(i,"/").concat("([^?#]*)"),"i"),indices:{bucket:1,path:2},postModify:o}],c=0;c<u.length;c++){var l=u[c],h=l.regex.exec(e);if(h){var f=h[l.indices.bucket],d=h[l.indices.path];d||(d=""),r=new t(f,d),l.postModify(r);break}}if(null==r)throw function(e){return new Vj("invalid-url","Invalid URL '"+e+"'.")}(e);return r}}]),t}(),eB=function(){"use strict";function t(n){e(l)(this,t),this.promise_=Promise.reject(n)}return e(h)(t,[{key:"getPromise",value:function(){return this.promise_}},{key:"cancel",value:function(){}}]),t}();function tB(e){return"string"==typeof e||e instanceof String}function nB(e){return rB()&&e instanceof Blob}function rB(){return"undefined"!=typeof Blob&&!ge()}function iB(e,t,n,r){if(r<t)throw Gj("Invalid value for '".concat(e,"'. Expected ").concat(t," or greater."));if(r>n)throw Gj("Invalid value for '".concat(e,"'. Expected ").concat(n," or less."))}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aB(e,t,n){var r=t;return null==n&&(r="https://".concat(t)),"".concat(n,"://").concat(r,"/v0").concat(e)}function oB(e){var t=encodeURIComponent,n="?";for(var r in e)if(e.hasOwnProperty(r)){n=n+(t(r)+"="+t(e[r]))+"&"}return n=n.slice(0,-1)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function sB(e,t){var n=e>=500&&e<600,r=-1!==[408,429].indexOf(e),i=-1!==t.indexOf(e);return n||r||i}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */($j=Xj||(Xj={}))[$j.NO_ERROR=0]="NO_ERROR",$j[$j.NETWORK_ERROR=1]="NETWORK_ERROR",$j[$j.ABORT=2]="ABORT";var uB=function(){"use strict";function t(n,r,i,a,o,s,u,c,h,f,d){var p=!(arguments.length>11&&void 0!==arguments[11])||arguments[11],v=this;e(l)(this,t),this.url_=n,this.method_=r,this.headers_=i,this.body_=a,this.successCodes_=o,this.additionalRetryCodes_=s,this.callback_=u,this.errorCallback_=c,this.timeout_=h,this.progressCallback_=f,this.connectionFactory_=d,this.retry=p,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((function(e,t){v.resolve_=e,v.reject_=t,v.start_()}))}return e(h)(t,[{key:"start_",value:function(){var t=this,n=function(e,n){var r=t.resolve_,i=t.reject_,a=n.connection;if(n.wasSuccessCode)try{var o=t.callback_(a,a.getResponse());void 0!==o?r(o):r()}catch(e){i(e)}else if(null!==a){var s=Bj();s.serverResponse=a.getErrorText(),t.errorCallback_?i(t.errorCallback_(a,s)):i(s)}else if(n.canceled){i(t.appDelete_?Hj():zj())}else{i(Kj())}};this.canceled_?n(0,new cB(!1,null,!0)):this.backoffId_=
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(t,n,r){var i=1,a=null,o=null,s=!1,u=0;function c(){return 2===u}var l=!1;function h(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];l||(l=!0,n.apply(null,t))}function f(e){a=setTimeout((function(){a=null,t(v,c())}),e)}function d(){o&&clearTimeout(o)}function v(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];if(l)d();else{var o,v,y;if(t)return d(),void(o=h).call.apply(o,[null,t].concat(e(p)(r)));if(c()||s)return d(),void(v=h).call.apply(v,[null,t].concat(e(p)(r)));i<64&&(i*=2),1===u?(u=2,y=0):y=1e3*(i+Math.random()),f(y)}}var y=!1;function m(e){y||(y=!0,d(),l||(null!==a?(e||(u=2),clearTimeout(a),f(0)):e||(u=1)))}return f(0),o=setTimeout((function(){s=!0,m(!0)}),r),m}((function(e,n){var r=t;if(n)e(!1,new cB(!1,null,!0));else{var i=t.connectionFactory_();t.pendingConnection_=i;var a=function(e){var t=e.loaded,n=e.lengthComputable?e.total:-1;null!==r.progressCallback_&&r.progressCallback_(t,n)};null!==t.progressCallback_&&i.addUploadProgressListener(a),i.send(t.url_,t.method_,t.body_,t.headers_).then((function(){null!==r.progressCallback_&&i.removeUploadProgressListener(a),r.pendingConnection_=null;var t=i.getErrorCode()===Xj.NO_ERROR,n=i.getStatus();if(t&&!sB(n,r.additionalRetryCodes_)||!r.retry){var o=-1!==r.successCodes_.indexOf(n);e(!0,new cB(o,i))}else{var s=i.getErrorCode()===Xj.ABORT;e(!1,new cB(!1,null,s))}}))}}),n,this.timeout_)}},{key:"getPromise",value:function(){return this.promise_}},{key:"cancel",value:function(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&function(e){e(!1)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}]),t}(),cB=function t(n,r,i){"use strict";e(l)(this,t),this.wasSuccessCode=n,this.connection=r,this.canceled=!!i};function lB(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}function hB(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(null!=t?t:"AppManager")}function fB(e,t){t&&(e["X-Firebase-GMPID"]=t)}function dB(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}function pB(e,t,n,r,i,a){var o=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],s=oB(e.urlParams),u=e.url+s,c=Object.assign({},e.headers);return fB(c,t),lB(c,n),hB(c,a),dB(c,r),new uB(u,e.method,c,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,i,o)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vB(){return"undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function yB(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=vB();if(void 0!==r){for(var i=new r,a=0;a<t.length;a++)i.append(t[a]);return i.getBlob()}if(rB())return new Blob(t);throw new Vj("unsupported-environment","This browser doesn't seem to support creating Blobs")}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mB(e){if("undefined"==typeof atob)throw new Vj("unsupported-environment","".concat("base-64"," is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information."));return atob(e)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var gB={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},kB=function t(n,r){"use strict";e(l)(this,t),this.data=n,this.contentType=r||null};function _B(e,t){switch(e){case gB.RAW:return new kB(wB(t));case gB.BASE64:case gB.BASE64URL:return new kB(bB(e,t));case gB.DATA_URL:return new kB((n=new xB(t)).base64?bB(gB.BASE64,n.rest):function(e){var t;try{t=decodeURIComponent(e)}catch(e){throw Yj(gB.DATA_URL,"Malformed data URL.")}return wB(t)}(n.rest),function(e){return new xB(e).contentType}(t))}var n;throw Bj()}function wB(e){for(var t=[],n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r<=127)t.push(r);else if(r<=2047)t.push(192|r>>6,128|63&r);else{if(55296==(64512&r))if(n<e.length-1&&56320==(64512&e.charCodeAt(n+1)))r=65536|(1023&r)<<10|1023&e.charCodeAt(++n),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r);else t.push(239,191,189);else 56320==(64512&r)?t.push(239,191,189):t.push(224|r>>12,128|r>>6&63,128|63&r)}}return new Uint8Array(t)}function bB(e,t){switch(e){case gB.BASE64:var n=-1!==t.indexOf("-"),r=-1!==t.indexOf("_");if(n||r)throw Yj(e,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?");break;case gB.BASE64URL:var i=-1!==t.indexOf("+"),a=-1!==t.indexOf("/");if(i||a)throw Yj(e,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/")}var o;try{o=mB(t)}catch(t){if(t.message.includes("polyfill"))throw t;throw Yj(e,"Invalid character found")}for(var s=new Uint8Array(o.length),u=0;u<o.length;u++)s[u]=o.charCodeAt(u);return s}var xB=function t(n){"use strict";e(l)(this,t),this.base64=!1,this.contentType=null;var r=n.match(/^data:([^,]+)?,/);if(null===r)throw Yj(gB.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");var i,a,o=r[1]||null;null!=o&&(this.base64=(a=";base64",!!((i=o).length>=a.length)&&i.substring(i.length-a.length)===a),this.contentType=this.base64?o.substring(0,o.length-7):o),this.rest=n.substring(n.indexOf(",")+1)};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var IB=function(){"use strict";function t(n,r){e(l)(this,t);var i=0,a="";nB(n)?(this.data_=n,i=n.size,a=n.type):n instanceof ArrayBuffer?(r?this.data_=new Uint8Array(n):(this.data_=new Uint8Array(n.byteLength),this.data_.set(new Uint8Array(n))),i=this.data_.length):n instanceof Uint8Array&&(r?this.data_=n:(this.data_=new Uint8Array(n.length),this.data_.set(n)),i=n.length),this.size_=i,this.type_=a}return e(h)(t,[{key:"size",value:function(){return this.size_}},{key:"type",value:function(){return this.type_}},{key:"slice",value:function(e,n){if(nB(this.data_)){var r=this.data_,i=(o=e,s=n,(a=r).webkitSlice?a.webkitSlice(o,s):a.mozSlice?a.mozSlice(o,s):a.slice?a.slice(o,s):null);return null===i?null:new t(i)}var a,o,s;return new t(new Uint8Array(this.data_.buffer,e,n-e),!0)}},{key:"uploadData",value:function(){return this.data_}}],[{key:"getBlob",value:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];if(rB()){var i=n.map((function(e){return e instanceof t?e.data_:e}));return new t(yB.apply(null,i))}var a=n.map((function(e){return tB(e)?_B(gB.RAW,e).data:e.data_})),o=0;a.forEach((function(e){o+=e.byteLength}));var s=new Uint8Array(o),u=0;return a.forEach((function(e){for(var t=0;t<e.length;t++)s[u++]=e[t]})),new t(s,!0)}}]),t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TB(e){var t,n;try{t=JSON.parse(e)}catch(e){return null}return"object"!=typeof(n=t)||Array.isArray(n)?null:t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EB(e){var t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SB(e,t){return t}var CB=function t(n,r,i,a){"use strict";e(l)(this,t),this.server=n,this.local=r||n,this.writable=!!i,this.xform=a||SB},AB=null;function NB(){if(AB)return AB;var e=[];e.push(new CB("bucket")),e.push(new CB("generation")),e.push(new CB("metageneration")),e.push(new CB("name","fullPath",!0));var t=new CB("name");t.xform=function(e,t){return function(e){return!tB(e)||e.length<2?e:EB(e)}(t)},e.push(t);var n=new CB("size");return n.xform=function(e,t){return void 0!==t?Number(t):t},e.push(n),e.push(new CB("timeCreated")),e.push(new CB("updated")),e.push(new CB("md5Hash",null,!0)),e.push(new CB("cacheControl",null,!0)),e.push(new CB("contentDisposition",null,!0)),e.push(new CB("contentEncoding",null,!0)),e.push(new CB("contentLanguage",null,!0)),e.push(new CB("contentType",null,!0)),e.push(new CB("metadata","customMetadata",!0)),AB=e}function RB(e,t,n){for(var r={type:"file"},i=n.length,a=0;a<i;a++){var o=n[a];r[o.local]=o.xform(r,t[o.server])}return function(e,t){Object.defineProperty(e,"ref",{get:function(){var n=e.bucket,r=e.fullPath,i=new Zj(n,r);return t._makeStorageReference(i)}})}(r,e),r}function DB(e,t,n){var r=TB(t);return null===r?null:RB(e,r,n)}function PB(e,t){for(var n={},r=t.length,i=0;i<r;i++){var a=t[i];a.writable&&(n[a.server]=e[a.local])}return JSON.stringify(n)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OB(e,t,n){var r=TB(n);return null===r?null:function(e,t,n){var r={prefixes:[],items:[],nextPageToken:n.nextPageToken},i=!0,a=!1,o=void 0;if(n.prefixes)try{for(var s,u=n.prefixes[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value.replace(/\/$/,""),l=e._makeStorageReference(new Zj(t,c));r.prefixes.push(l)}}catch(e){a=!0,o=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw o}}var h=!0,f=!1,d=void 0;if(n.items)try{for(var p,v=n.items[Symbol.iterator]();!(h=(p=v.next()).done);h=!0){var y=p.value,m=e._makeStorageReference(new Zj(t,y.name));r.items.push(m)}}catch(e){f=!0,d=e}finally{try{h||null==v.return||v.return()}finally{if(f)throw d}}return r}(e,t,r)}var MB=function t(n,r,i,a){"use strict";e(l)(this,t),this.url=n,this.method=r,this.handler=i,this.timeout=a,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LB(e){if(!e)throw Bj()}function FB(e,t){return function(n,r){var i=DB(e,r,t);return LB(null!==i),i}}function UB(e,t){return function(n,r){var i=DB(e,r,t);return LB(null!==i),function(e,t,n,r){var i=TB(t);if(null===i)return null;if(!tB(i.downloadTokens))return null;var a=i.downloadTokens;if(0===a.length)return null;var o=encodeURIComponent;return a.split(",").map((function(t){var i=e.bucket,a=e.fullPath;return aB("/b/"+o(i)+"/o/"+o(a),n,r)+oB({alt:"media",token:t})}))[0]}(i,r,e.host,e._protocol)}}function qB(e){return function(t,n){var r,i,a;return 401===t.getStatus()?r=t.getErrorText().includes("Firebase App Check token is invalid")?new Vj("unauthorized-app","This app does not have permission to access Firebase Storage on this project."):new Vj("unauthenticated","User is not authenticated, please authenticate using Firebase Authentication and try again."):402===t.getStatus()?(a=e.bucket,r=new Vj("quota-exceeded","Quota for bucket '"+a+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===t.getStatus()?(i=e.path,r=new Vj("unauthorized","User does not have permission to access '"+i+"'.")):r=n,r.status=t.getStatus(),r.serverResponse=n.serverResponse,r}}function VB(e){var t=qB(e);return function(n,r){var i,a=t(n,r);return 404===n.getStatus()&&(i=e.path,a=new Vj("object-not-found","Object '"+i+"' does not exist.")),a.serverResponse=r.serverResponse,a}}function jB(e,t,n){var r=aB(t.fullServerUrl(),e.host,e._protocol),i=e.maxOperationRetryTime,a=new MB(r,"GET",FB(e,n),i);return a.errorHandler=VB(t),a}function BB(e,t,n,r,i){var a={};t.isRoot?a.prefix="":a.prefix=t.path+"/",n&&n.length>0&&(a.delimiter=n),r&&(a.pageToken=r),i&&(a.maxResults=i);var o=aB(t.bucketOnlyServerUrl(),e.host,e._protocol),s=e.maxOperationRetryTime,u=new MB(o,"GET",function(e,t){return function(n,r){var i=OB(e,t,r);return LB(null!==i),i}}(e,t.bucket),s);return u.urlParams=a,u.errorHandler=qB(t),u}function KB(e,t,n){var r=Object.assign({},n);return r.fullPath=e.path,r.size=t.size(),r.contentType||(r.contentType=function(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}(null,t)),r}function zB(e,t,n,r,i){var a=t.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};var s=function(){for(var e="",t=0;t<2;t++)e+=Math.random().toString().slice(2);return e}();o["Content-Type"]="multipart/related; boundary="+s;var u=KB(t,r,i),c="--"+s+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+PB(u,n)+"\r\n--"+s+"\r\nContent-Type: "+u.contentType+"\r\n\r\n",l="\r\n--"+s+"--",h=IB.getBlob(c,r,l);if(null===h)throw Wj();var f={name:u.fullPath},d=aB(a,e.host,e._protocol),p=e.maxUploadRetryTime,v=new MB(d,"POST",FB(e,n),p);return v.urlParams=f,v.headers=o,v.body=h.uploadData(),v.errorHandler=qB(t),v}var WB=function t(n,r,i,a){"use strict";e(l)(this,t),this.current=n,this.total=r,this.finalized=!!i,this.metadata=a||null};function GB(e,t){var n=null;try{n=e.getResponseHeader("X-Goog-Upload-Status")}catch(e){LB(!1)}return LB(!!n&&-1!==(t||["active"]).indexOf(n)),n}var HB=262144;function QB(e,t,n,r,i,a,o,s){var u=new WB(0,0);if(o?(u.current=o.current,u.total=o.total):(u.current=0,u.total=r.size()),r.size()!==u.total)throw new Vj("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.");var c=u.total-u.current,l=c;i>0&&(l=Math.min(l,i));var h=u.current,f=h+l,d={"X-Goog-Upload-Command":0===l?"finalize":c===l?"upload, finalize":"upload","X-Goog-Upload-Offset":"".concat(u.current)},p=r.slice(h,f);if(null===p)throw Wj();var v=t.maxUploadRetryTime,y=new MB(n,"POST",(function(e,n){var i,o=GB(e,["active","final"]),s=u.current+l,c=r.size();return i="final"===o?FB(t,a)(e,n):null,new WB(s,c,"final"===o,i)}),v);return y.headers=d,y.body=p.uploadData(),y.progressCallback=s||null,y.errorHandler=qB(e),y}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var YB={STATE_CHANGED:"state_changed"},JB={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function XB(e){switch(e){case"running":case"pausing":case"canceling":return JB.RUNNING;case"paused":return JB.PAUSED;case"success":return JB.SUCCESS;case"canceled":return JB.CANCELED;default:return JB.ERROR}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $B=function t(n,r,i){"use strict";if(e(l)(this,t),"function"==typeof n||null!=r||null!=i)this.next=n,this.error=null!=r?r:void 0,this.complete=null!=i?i:void 0;else{var a=n;this.next=a.next,this.error=a.error,this.complete=a.complete}};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZB(t){return function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];Promise.resolve().then((function(){return t.apply(void 0,e(p)(r))}))}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var eK=function(){"use strict";function t(){var n=this;e(l)(this,t),this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Xj.NO_ERROR,this.sendPromise_=new Promise((function(e){var t=n;n.xhr_.addEventListener("abort",(function(){t.errorCode_=Xj.ABORT,e()})),n.xhr_.addEventListener("error",(function(){t.errorCode_=Xj.NETWORK_ERROR,e()})),n.xhr_.addEventListener("load",(function(){e()}))}))}return e(h)(t,[{key:"send",value:function(e,t,n,r){if(this.sent_)throw Jj("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==r)for(var i in r)r.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,r[i].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_}},{key:"getErrorCode",value:function(){if(!this.sent_)throw Jj("cannot .getErrorCode() before sending");return this.errorCode_}},{key:"getStatus",value:function(){if(!this.sent_)throw Jj("cannot .getStatus() before sending");try{return this.xhr_.status}catch(e){return-1}}},{key:"getResponse",value:function(){if(!this.sent_)throw Jj("cannot .getResponse() before sending");return this.xhr_.response}},{key:"getErrorText",value:function(){if(!this.sent_)throw Jj("cannot .getErrorText() before sending");return this.xhr_.statusText}},{key:"abort",value:function(){this.xhr_.abort()}},{key:"getResponseHeader",value:function(e){return this.xhr_.getResponseHeader(e)}},{key:"addUploadProgressListener",value:function(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}},{key:"removeUploadProgressListener",value:function(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}]),t}(),tK=function(t){"use strict";e(A)(r,t);var n=e(q)(r);function r(){return e(l)(this,r),n.apply(this,arguments)}return e(h)(r,[{key:"initXhr",value:function(){this.xhr_.responseType="text"}}]),r}(eK);function nK(){return new tK}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var rK=function(){"use strict";function t(n,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=this;e(l)(this,t),this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=n,this._blob=r,this._metadata=i,this._mappings=NB(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=function(e){if(a._request=void 0,a._chunkMultiplier=1,e._codeEquals("canceled"))a._needToFetchStatus=!0,a.completeTransitions_();else{var t=a.isExponentialBackoffExpired();if(sB(e.status,[])){if(!t)return a.sleepTime=Math.max(2*a.sleepTime,1e3),a._needToFetchStatus=!0,void a.completeTransitions_();e=Kj()}a._error=e,a._transition("error")}},this._metadataErrorHandler=function(e){a._request=void 0,e._codeEquals("canceled")?a.completeTransitions_():(a._error=e,a._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((function(e,t){a._resolve=e,a._reject=t,a._start()})),this._promise.then(null,(function(){}))}return e(h)(t,[{key:"isExponentialBackoffExpired",value:function(){return this.sleepTime>this.maxSleepTime}},{key:"_makeProgressCallback",value:function(){var e=this,t=this._transferred;return function(n){return e._updateProgress(t+n)}}},{key:"_shouldDoResumable",value:function(e){return e.size()>262144}},{key:"_start",value:function(){if("running"===this._state&&void 0===this._request)if(this._resumable)if(void 0===this._uploadUrl)this._createResumable();else{var e=this;this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout((function(){e.pendingTimeout=void 0,e._continueUpload()}),this.sleepTime)}else this._oneShotUpload()}},{key:"_resolveToken",value:function(t){var n=this;Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then((function(r){var i=e(b)(r,2),a=i[0],o=i[1];switch(n._state){case"running":t(a,o);break;case"canceling":n._transition("canceled");break;case"pausing":n._transition("paused")}}))}},{key:"_createResumable",value:function(){var e=this;this._resolveToken((function(t,n){var r=e,i=function(e,t,n,r,i){var a=t.bucketOnlyServerUrl(),o=KB(t,r,i),s={name:o.fullPath},u=aB(a,e.host,e._protocol),c={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":"".concat(r.size()),"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},l=PB(o,n),h=e.maxUploadRetryTime,f=new MB(u,"POST",(function(e){var t;GB(e);try{t=e.getResponseHeader("X-Goog-Upload-URL")}catch(e){LB(!1)}return LB(tB(t)),t}),h);return f.urlParams=s,f.headers=c,f.body=l,f.errorHandler=qB(t),f}(e._ref.storage,e._ref._location,e._mappings,e._blob,e._metadata),a=e._ref.storage._makeRequest(i,nK,t,n);e._request=a,a.getPromise().then((function(e){r._request=void 0,r._uploadUrl=e,r._needToFetchStatus=!1,r.completeTransitions_()}),e._errorHandler)}))}},{key:"_fetchStatus",value:function(){var e=this,t=this._uploadUrl;this._resolveToken((function(n,r){var i=e,a=function(e,t,n,r){var i=e.maxUploadRetryTime,a=new MB(n,"POST",(function(e){var t=GB(e,["active","final"]),n=null;try{n=e.getResponseHeader("X-Goog-Upload-Size-Received")}catch(e){LB(!1)}n||LB(!1);var i=Number(n);return LB(!isNaN(i)),new WB(i,r.size(),"final"===t)}),i);return a.headers={"X-Goog-Upload-Command":"query"},a.errorHandler=qB(t),a}(e._ref.storage,e._ref._location,t,e._blob),o=e._ref.storage._makeRequest(a,nK,n,r);e._request=o,o.getPromise().then((function(e){i._request=void 0,i._updateProgress(e.current),i._needToFetchStatus=!1,e.finalized&&(i._needToFetchMetadata=!0),i.completeTransitions_()}),e._errorHandler)}))}},{key:"_continueUpload",value:function(){var e=this,t=HB*this._chunkMultiplier,n=new WB(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((function(i,a){var o,s=e;try{o=QB(e._ref._location,e._ref.storage,r,e._blob,t,e._mappings,n,e._makeProgressCallback())}catch(t){return e._error=t,void e._transition("error")}var u=e._ref.storage._makeRequest(o,nK,i,a,!1);e._request=u,u.getPromise().then((function(e){s._increaseMultiplier(),s._request=void 0,s._updateProgress(e.current),e.finalized?(s._metadata=e.metadata,s._transition("success")):s.completeTransitions_()}),e._errorHandler)}))}},{key:"_increaseMultiplier",value:function(){2*(HB*this._chunkMultiplier)<33554432&&(this._chunkMultiplier*=2)}},{key:"_fetchMetadata",value:function(){var e=this;this._resolveToken((function(t,n){var r=e,i=jB(e._ref.storage,e._ref._location,e._mappings),a=e._ref.storage._makeRequest(i,nK,t,n);e._request=a,a.getPromise().then((function(e){r._request=void 0,r._metadata=e,r._transition("success")}),e._metadataErrorHandler)}))}},{key:"_oneShotUpload",value:function(){var e=this;this._resolveToken((function(t,n){var r=e,i=zB(e._ref.storage,e._ref._location,e._mappings,e._blob,e._metadata),a=e._ref.storage._makeRequest(i,nK,t,n);e._request=a,a.getPromise().then((function(e){r._request=void 0,r._metadata=e,r._updateProgress(r._blob.size()),r._transition("success")}),e._errorHandler)}))}},{key:"_updateProgress",value:function(e){var t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}},{key:"_transition",value:function(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,void 0!==this._request?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":var t="paused"===this._state;this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=e,this._notifyObservers();break;case"canceled":this._error=zj(),this._state=e,this._notifyObservers()}}},{key:"completeTransitions_",value:function(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}},{key:"snapshot",get:function(){var e=XB(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}},{key:"on",value:function(e,t,n,r){var i=this,a=new $B(t||void 0,n||void 0,r||void 0);return this._addObserver(a),function(){i._removeObserver(a)}}},{key:"then",value:function(e,t){return this._promise.then(e,t)}},{key:"catch",value:function(e){return this.then(null,e)}},{key:"_addObserver",value:function(e){this._observers.push(e),this._notifyObserver(e)}},{key:"_removeObserver",value:function(e){var t=this._observers.indexOf(e);-1!==t&&this._observers.splice(t,1)}},{key:"_notifyObservers",value:function(){var e=this;this._finishPromise(),this._observers.slice().forEach((function(t){e._notifyObserver(t)}))}},{key:"_finishPromise",value:function(){if(void 0!==this._resolve){var e=!0;switch(XB(this._state)){case JB.SUCCESS:ZB(this._resolve.bind(null,this.snapshot))();break;case JB.CANCELED:case JB.ERROR:ZB(this._reject.bind(null,this._error))();break;default:e=!1}e&&(this._resolve=void 0,this._reject=void 0)}}},{key:"_notifyObserver",value:function(e){switch(XB(this._state)){case JB.RUNNING:case JB.PAUSED:e.next&&ZB(e.next.bind(e,this.snapshot))();break;case JB.SUCCESS:e.complete&&ZB(e.complete.bind(e))();break;default:e.error&&ZB(e.error.bind(e,this._error))()}}},{key:"resume",value:function(){var e="paused"===this._state||"pausing"===this._state;return e&&this._transition("running"),e}},{key:"pause",value:function(){var e="running"===this._state;return e&&this._transition("pausing"),e}},{key:"cancel",value:function(){var e="running"===this._state||"pausing"===this._state;return e&&this._transition("canceling"),e}}]),t}(),iK=function(){"use strict";function t(n,r){e(l)(this,t),this._service=n,this._location=r instanceof Zj?r:Zj.makeFromUrl(r,n.host)}return e(h)(t,[{key:"toString",value:function(){return"gs://"+this._location.bucket+"/"+this._location.path}},{key:"_newRef",value:function(e,n){return new t(e,n)}},{key:"root",get:function(){var e=new Zj(this._location.bucket,"");return this._newRef(this._service,e)}},{key:"bucket",get:function(){return this._location.bucket}},{key:"fullPath",get:function(){return this._location.path}},{key:"name",get:function(){return EB(this._location.path)}},{key:"storage",get:function(){return this._service}},{key:"parent",get:function(){var e=function(e){if(0===e.length)return null;var t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===e)return null;var n=new Zj(this._location.bucket,e);return new t(this._service,n)}},{key:"_throwIfRoot",value:function(e){if(""===this._location.path)throw Qj(e)}}]),t}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aK(e,t,n){return oK.apply(this,arguments)}function oK(){return(oK=e(u)(e(_).mark((function t(n,r,i){var a,o,s,u;return e(_).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s={pageToken:i},t.next=4,sK(n,s);case 4:if(u=t.sent,(a=r.prefixes).push.apply(a,e(p)(u.prefixes)),(o=r.items).push.apply(o,e(p)(u.items)),null==u.nextPageToken){t.next=10;break}return t.next=10,aK(n,r,u.nextPageToken);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function sK(e,t){null!=t&&"number"==typeof t.maxResults&&iB("options.maxResults",1,1e3,t.maxResults);var n=t||{},r=BB(e.storage,e._location,"/",n.pageToken,n.maxResults);return e.storage.makeRequestWithTokens(r,nK)}function uK(e,t){e._throwIfRoot("updateMetadata");var n=function(e,t,n,r){var i=aB(t.fullServerUrl(),e.host,e._protocol),a=PB(n,r),o=e.maxOperationRetryTime,s=new MB(i,"PATCH",FB(e,r),o);return s.headers={"Content-Type":"application/json; charset=utf-8"},s.body=a,s.errorHandler=VB(t),s}(e.storage,e._location,t,NB());return e.storage.makeRequestWithTokens(n,nK)}function cK(e){e._throwIfRoot("getDownloadURL");var t=function(e,t,n){var r=aB(t.fullServerUrl(),e.host,e._protocol),i=e.maxOperationRetryTime,a=new MB(r,"GET",UB(e,n),i);return a.errorHandler=VB(t),a}(e.storage,e._location,NB());return e.storage.makeRequestWithTokens(t,nK).then((function(e){if(null===e)throw new Vj("no-download-url","The given file does not have any download URLs.");return e}))}function lK(e){e._throwIfRoot("deleteObject");var t=function(e,t){var n=aB(t.fullServerUrl(),e.host,e._protocol),r=e.maxOperationRetryTime,i=new MB(n,"DELETE",(function(e,t){}),r);return i.successCodes=[200,204],i.errorHandler=VB(t),i}(e.storage,e._location);return e.storage.makeRequestWithTokens(t,nK)}function hK(e,t){var n=function(e,t){var n=t.split("/").filter((function(e){return e.length>0})).join("/");return 0===e.length?n:e+"/"+n}(e._location.path,t),r=new Zj(e._location.bucket,n);return new iK(e.storage,r)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fK(e,t){if(e instanceof yK){var n=e;if(null==n._bucket)throw new Vj("no-default-bucket","No default bucket found. Did you set the 'storageBucket' property when initializing the app?");var r=new iK(n,n._bucket);return null!=t?fK(r,t):r}return void 0!==t?hK(e,t):e}function dK(e,t){if(t&&/^[A-Za-z]+:\/\//.test(t)){if(e instanceof yK)return new iK(e,t);throw Gj("To use ref(service, url), the first argument must be a Storage instance.")}return fK(e,t)}function pK(e,t){var n=null==t?void 0:t.storageBucket;return null==n?null:Zj.makeFromBucketSpec(n,e)}function vK(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e.host="".concat(t,":").concat(n),e._protocol="http";var i=r.mockUserToken;i&&(e._overrideAuthToken="string"==typeof i?i:Pe(i,e.app.options.projectId))}var yK=function(){"use strict";function t(n,r,i,a,o){e(l)(this,t),this.app=n,this._authProvider=r,this._appCheckProvider=i,this._url=a,this._firebaseVersion=o,this._bucket=null,this._host=qj,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=a?Zj.makeFromBucketSpec(a,this._host):pK(this._host,this.app.options)}return e(h)(t,[{key:"host",get:function(){return this._host},set:function(e){this._host=e,null!=this._url?this._bucket=Zj.makeFromBucketSpec(this._url,e):this._bucket=pK(e,this.app.options)}},{key:"maxUploadRetryTime",get:function(){return this._maxUploadRetryTime},set:function(e){iB("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}},{key:"maxOperationRetryTime",get:function(){return this._maxOperationRetryTime},set:function(e){iB("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}},{key:"_getAuthToken",value:function(){var t=this;return e(u)(e(_).mark((function n(){var r,i;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t._overrideAuthToken){e.next=2;break}return e.abrupt("return",t._overrideAuthToken);case 2:if(!(r=t._authProvider.getImmediate({optional:!0}))){e.next=9;break}return e.next=6,r.getToken();case 6:if(null===(i=e.sent)){e.next=9;break}return e.abrupt("return",i.accessToken);case 9:return e.abrupt("return",null);case 10:case"end":return e.stop()}}),n)})))()}},{key:"_getAppCheckToken",value:function(){var t=this;return e(u)(e(_).mark((function n(){var r,i;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=t._appCheckProvider.getImmediate({optional:!0}))){e.next=6;break}return e.next=4,r.getToken();case 4:return i=e.sent,e.abrupt("return",i.token);case 6:return e.abrupt("return",null);case 7:case"end":return e.stop()}}),n)})))()}},{key:"_delete",value:function(){return this._deleted||(this._deleted=!0,this._requests.forEach((function(e){return e.cancel()})),this._requests.clear()),Promise.resolve()}},{key:"_makeStorageReference",value:function(e){return new iK(this,e)}},{key:"_makeRequest",value:function(e,t,n,r){var i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(this._deleted)return new eB(Hj());var a=this,o=pB(e,this._appId,n,r,t,this._firebaseVersion,i);return this._requests.add(o),o.getPromise().then((function(){return a._requests.delete(o)}),(function(){return a._requests.delete(o)})),o}},{key:"makeRequestWithTokens",value:function(t,n){var r=this;return e(u)(e(_).mark((function i(){var a,o,s;return e(_).wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.t0=e(b),i.next=3,Promise.all([r._getAuthToken(),r._getAppCheckToken()]);case 3:return i.t1=i.sent,a=(0,i.t0)(i.t1,2),o=a[0],s=a[1],i.abrupt("return",r._makeRequest(t,n,o,s).getPromise());case 8:case"end":return i.stop()}}),i)})))()}}]),t}(),mK="@firebase/storage",gK="0.10.0",kK="storage";function _K(e,t,n){return function(e,t,n){return e._throwIfRoot("uploadBytesResumable"),new rK(e,new IB(t),n)}(e=lt(e),t,n)}function wK(e){return function(e){e._throwIfRoot("getMetadata");var t=jB(e.storage,e._location,NB());return e.storage.makeRequestWithTokens(t,nK)}(e=lt(e))}function bK(e,t){return uK(e=lt(e),t)}function xK(e,t){return sK(e=lt(e),t)}function IK(e){return e=lt(e),aK(e,t={prefixes:[],items:[]}).then((function(){return t}));var t}function TK(e,t){return dK(e=lt(e),t)}function EK(e,t){return hK(e,t)}function SK(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};vK(e,t,n,r)}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CK(e,t){var n=t.instanceIdentifier,r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),a=e.getProvider("app-check-internal");return new yK(r,i,a,n,hn)}rn(new ht(kK,CK,"PUBLIC").setMultipleInstances(!0)),mn(mK,gK,""),mn(mK,gK,"esm2017");
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var AK=function(){"use strict";function t(n,r,i){e(l)(this,t),this._delegate=n,this.task=r,this.ref=i}return e(h)(t,[{key:"bytesTransferred",get:function(){return this._delegate.bytesTransferred}},{key:"metadata",get:function(){return this._delegate.metadata}},{key:"state",get:function(){return this._delegate.state}},{key:"totalBytes",get:function(){return this._delegate.totalBytes}}]),t}(),NK=function(){"use strict";function t(n,r){e(l)(this,t),this._delegate=n,this._ref=r,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}return e(h)(t,[{key:"snapshot",get:function(){return new AK(this._delegate.snapshot,this,this._ref)}},{key:"then",value:function(e,t){var n=this;return this._delegate.then((function(t){if(e)return e(new AK(t,n,n._ref))}),t)}},{key:"on",value:function(e,t,n,r){var i=void 0;if(t){var a=this;i="function"==typeof t?function(e){return t(new AK(e,a,a._ref))}:{next:t.next?function(e){return t.next(new AK(e,a,a._ref))}:void 0,complete:t.complete||void 0,error:t.error||void 0}}return this._delegate.on(e,i,n||void 0,r||void 0)}}]),t}(),RK=function(){"use strict";function t(n,r){e(l)(this,t),this._delegate=n,this._service=r}return e(h)(t,[{key:"prefixes",get:function(){var e=this;return this._delegate.prefixes.map((function(t){return new DK(t,e._service)}))}},{key:"items",get:function(){var e=this;return this._delegate.items.map((function(t){return new DK(t,e._service)}))}},{key:"nextPageToken",get:function(){return this._delegate.nextPageToken||null}}]),t}(),DK=function(){"use strict";function t(n,r){e(l)(this,t),this._delegate=n,this.storage=r}return e(h)(t,[{key:"name",get:function(){return this._delegate.name}},{key:"bucket",get:function(){return this._delegate.bucket}},{key:"fullPath",get:function(){return this._delegate.fullPath}},{key:"toString",value:function(){return this._delegate.toString()}},{key:"child",value:function(e){return new t(EK(this._delegate,e),this.storage)}},{key:"root",get:function(){return new t(this._delegate.root,this.storage)}},{key:"parent",get:function(){var e=this._delegate.parent;return null==e?null:new t(e,this.storage)}},{key:"put",value:function(e,t){return this._throwIfRoot("put"),new NK(_K(this._delegate,e,t),this)}},{key:"putString",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:gB.RAW,n=arguments.length>2?arguments[2]:void 0;this._throwIfRoot("putString");var r=_B(t,e),i=Object.assign({},n);return null==i.contentType&&null!=r.contentType&&(i.contentType=r.contentType),new NK(new rK(this._delegate,new IB(r.data,!0),i),this)}},{key:"listAll",value:function(){var e=this;return IK(this._delegate).then((function(t){return new RK(t,e.storage)}))}},{key:"list",value:function(e){var t=this;return xK(this._delegate,e||void 0).then((function(e){return new RK(e,t.storage)}))}},{key:"getMetadata",value:function(){return wK(this._delegate)}},{key:"updateMetadata",value:function(e){return bK(this._delegate,e)}},{key:"getDownloadURL",value:function(){return cK(lt(this._delegate))}},{key:"delete",value:function(){return this._throwIfRoot("delete"),lK(lt(this._delegate))}},{key:"_throwIfRoot",value:function(e){if(""===this._delegate._location.path)throw Qj(e)}}]),t}(),PK=function(){"use strict";function t(n,r){e(l)(this,t),this.app=n,this._delegate=r}return e(h)(t,[{key:"maxOperationRetryTime",get:function(){return this._delegate.maxOperationRetryTime}},{key:"maxUploadRetryTime",get:function(){return this._delegate.maxUploadRetryTime}},{key:"ref",value:function(e){if(OK(e))throw Gj("ref() expected a child path but got a URL, use refFromURL instead.");return new DK(TK(this._delegate,e),this)}},{key:"refFromURL",value:function(e){if(!OK(e))throw Gj("refFromURL() expected a full URL but got a child path, use ref() instead.");try{Zj.makeFromUrl(e,this._delegate.host)}catch(e){throw Gj("refFromUrl() expected a valid full URL but got an invalid one.")}return new DK(TK(this._delegate,e),this)}},{key:"setMaxUploadRetryTime",value:function(e){this._delegate.maxUploadRetryTime=e}},{key:"setMaxOperationRetryTime",value:function(e){this._delegate.maxOperationRetryTime=e}},{key:"useEmulator",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};SK(this._delegate,e,t,n)}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OK(e){return/^[A-Za-z]+:\/\//.test(e)}function MK(e,t){var n=t.instanceIdentifier,r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("storage").getImmediate({identifier:n});return new PK(r,i)}!function(e){var t={TaskState:JB,TaskEvent:YB,StringFormat:gB,Storage:PK,Reference:DK};e.INTERNAL.registerComponent(new ht("storage-compat",MK,"PUBLIC").setServiceProps(t).setMultipleInstances(!0)),e.registerVersion("@firebase/storage-compat","0.2.0")}(Fc);d=o("hKHmD");var LK,FK,UK,qK="@firebase/performance",VK="0.6.0",jK=VK,BK="FB-PERF-TRACE-START",KK="FB-PERF-TRACE-STOP",zK="FB-PERF-TRACE-MEASURE",WK="_wt_",GK="_fcp",HK="_fid",QK="@firebase/performance/config",YK="@firebase/performance/configexpire",JK="Performance",XK=(LK={},e(d)(LK,"trace started","Trace {$traceName} was started before."),e(d)(LK,"trace stopped","Trace {$traceName} is not running."),e(d)(LK,"nonpositive trace startTime","Trace {$traceName} startTime should be positive."),e(d)(LK,"nonpositive trace duration","Trace {$traceName} duration should be positive."),e(d)(LK,"no window","Window is not available."),e(d)(LK,"no app id","App id is not available."),e(d)(LK,"no project id","Project id is not available."),e(d)(LK,"no api key","Api key is not available."),e(d)(LK,"invalid cc log","Attempted to queue invalid cc event"),e(d)(LK,"FB not default","Performance can only start when Firebase app instance is the default one."),e(d)(LK,"RC response not ok","RC response is not ok"),e(d)(LK,"invalid attribute name","Attribute name {$attributeName} is invalid."),e(d)(LK,"invalid attribute value","Attribute value {$attributeValue} is invalid."),e(d)(LK,"invalid custom metric name","Custom metric name {$customMetricName} is invalid"),e(d)(LK,"invalid String merger input","Input for String merger is invalid, contact support team to resolve."),e(d)(LK,"already initialized","initializePerformance() has already been called with different options. To avoid this error, call initializePerformance() with the same options as when it was originally called, or call getPerformance() to return the already initialized instance."),LK),$K=new Me("performance",JK,XK),ZK=new xt(JK);ZK.logLevel=pt.INFO;var ez,tz,nz=function(){"use strict";function t(n){if(e(l)(this,t),this.window=n,!n)throw $K.create("no window");this.performance=n.performance,this.PerformanceObserver=n.PerformanceObserver,this.windowLocation=n.location,this.navigator=n.navigator,this.document=n.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=n.localStorage),n.perfMetrics&&n.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=n.perfMetrics.onFirstInputDelay)}return e(h)(t,[{key:"getUrl",value:function(){return this.windowLocation.href.split("?")[0]}},{key:"mark",value:function(e){this.performance&&this.performance.mark&&this.performance.mark(e)}},{key:"measure",value:function(e,t,n){this.performance&&this.performance.measure&&this.performance.measure(e,t,n)}},{key:"getEntriesByType",value:function(e){return this.performance&&this.performance.getEntriesByType?this.performance.getEntriesByType(e):[]}},{key:"getEntriesByName",value:function(e){return this.performance&&this.performance.getEntriesByName?this.performance.getEntriesByName(e):[]}},{key:"getTimeOrigin",value:function(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)}},{key:"requiredApisAvailable",value:function(){return fetch&&Promise&&Te()?!!xe()||(ZK.info("IndexedDB is not supported by current browswer"),!1):(ZK.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1)}},{key:"setupObserver",value:function(e,t){this.PerformanceObserver&&new this.PerformanceObserver((function(e){var n=!0,r=!1,i=void 0;try{for(var a,o=e.getEntries()[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;t(s)}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}})).observe({entryTypes:[e]})}}],[{key:"getInstance",value:function(){return void 0===FK&&(FK=new t(UK)),FK}}]),t}();function rz(){return ez}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function iz(e,t){var n=e.length-t.length;if(n<0||n>1)throw $K.create("invalid String merger input");for(var r=[],i=0;i<e.length;i++)r.push(e.charAt(i)),t.length>i&&r.push(t.charAt(i));return r.join("")}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var az,oz,sz=function(){"use strict";function t(){e(l)(this,t),this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=iz("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=iz("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}return e(h)(t,[{key:"getFlTransportFullUrl",value:function(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)}}],[{key:"getInstance",value:function(){return void 0===tz&&(tz=new t),tz}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(oz=az||(az={}))[oz.UNKNOWN=0]="UNKNOWN",oz[oz.VISIBLE=1]="VISIBLE",oz[oz.HIDDEN=2]="HIDDEN";var uz=["firebase_","google_","ga_"],cz=new RegExp("^[a-zA-Z]\\w*$");function lz(){var e=nz.getInstance().navigator;return(null==e?void 0:e.serviceWorker)?e.serviceWorker.controller?2:3:1}function hz(){switch(nz.getInstance().document.visibilityState){case"visible":return az.VISIBLE;case"hidden":return az.HIDDEN;default:return az.UNKNOWN}}function fz(){var e=nz.getInstance().navigator.connection;switch(e&&e.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function dz(e){var t,n=null===(t=e.options)||void 0===t?void 0:t.appId;if(!n)throw $K.create("no app id");return n}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var pz="0.0.1",vz={loggingEnabled:!0},yz="FIREBASE_INSTALLATIONS_AUTH";function mz(e,t){var n=function(){var e=nz.getInstance().localStorage;if(!e)return;var t=e.getItem(YK);if(!(t&&(n=t,Number(n)>Date.now())))return;var n;var r=e.getItem(QK);if(!r)return;try{return JSON.parse(r)}catch(e){return}}();return n?(kz(n),Promise.resolve()):function(e,t){return(n=e.installations,r=n.getToken(),r.then((function(e){})),r).then((function(n){var r=function(e){var t,n=null===(t=e.options)||void 0===t?void 0:t.projectId;if(!n)throw $K.create("no project id");return n}(e.app),i=function(e){var t,n=null===(t=e.options)||void 0===t?void 0:t.apiKey;if(!n)throw $K.create("no api key");return n}(e.app),a="https://firebaseremoteconfig.googleapis.com/v1/projects/".concat(r,"/namespaces/fireperf:fetch?key=").concat(i),o=new Request(a,{method:"POST",headers:{Authorization:"".concat(yz," ").concat(n)},body:JSON.stringify({app_instance_id:t,app_instance_id_token:n,app_id:dz(e.app),app_version:jK,sdk_version:pz})});return fetch(o).then((function(e){if(e.ok)return e.json();throw $K.create("RC response not ok")}))})).catch((function(){ZK.info(gz)}));var n,r}(e,t).then(kz).then((function(e){return function(e){var t=nz.getInstance().localStorage;if(!e||!t)return;t.setItem(QK,JSON.stringify(e)),t.setItem(YK,String(Date.now()+36e5*sz.getInstance().configTimeToLive))}(e)}),(function(){}))}var gz="Could not fetch config, will use default configs";function kz(e){if(!e)return e;var t=sz.getInstance(),n=e.entries||{};return void 0!==n.fpr_enabled?t.loggingEnabled="true"===String(n.fpr_enabled):t.loggingEnabled=vz.loggingEnabled,n.fpr_log_source?t.logSource=Number(n.fpr_log_source):vz.logSource&&(t.logSource=vz.logSource),n.fpr_log_endpoint_url?t.logEndPointUrl=n.fpr_log_endpoint_url:vz.logEndPointUrl&&(t.logEndPointUrl=vz.logEndPointUrl),n.fpr_log_transport_key?t.transportKey=n.fpr_log_transport_key:vz.transportKey&&(t.transportKey=vz.transportKey),void 0!==n.fpr_vc_network_request_sampling_rate?t.networkRequestsSamplingRate=Number(n.fpr_vc_network_request_sampling_rate):void 0!==vz.networkRequestsSamplingRate&&(t.networkRequestsSamplingRate=vz.networkRequestsSamplingRate),void 0!==n.fpr_vc_trace_sampling_rate?t.tracesSamplingRate=Number(n.fpr_vc_trace_sampling_rate):void 0!==vz.tracesSamplingRate&&(t.tracesSamplingRate=vz.tracesSamplingRate),t.logTraceAfterSampling=_z(t.tracesSamplingRate),t.logNetworkAfterSampling=_z(t.networkRequestsSamplingRate),e}function _z(e){return Math.random()<=e}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var wz,bz=1;function xz(e){return bz=2,wz=wz||function(e){return function(){var e=nz.getInstance().document;return new Promise((function(t){if(e&&"complete"!==e.readyState){var n=function(){"complete"===e.readyState&&(e.removeEventListener("readystatechange",n),t())};e.addEventListener("readystatechange",n)}else t()}))}().then((function(){return t=e.installations,(n=t.getId()).then((function(e){ez=e})),n;var t,n})).then((function(t){return mz(e,t)})).then((function(){return Iz()}),(function(){return Iz()}))}(e),wz}function Iz(){bz=3}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Tz,Ez=1e4,Sz=3,Cz=[],Az=!1;function Nz(t){setTimeout((function(){var t,n;if(0!==Sz)return Cz.length?(t=Cz.splice(0,1e3),n=t.map((function(e){return{source_extension_json_proto3:e.message,event_time_ms:String(e.eventTime)}})),void function(t,n){return function(e){var t=sz.getInstance().getFlTransportFullUrl();return fetch(t,{method:"POST",body:JSON.stringify(e)})}(t).then((function(e){return e.ok||ZK.info("Call to Firebase backend failed."),e.json()})).then((function(t){var r=Number(t.nextRequestWaitMillis),i=Ez;isNaN(r)||(i=Math.max(r,i));var a=t.logResponseDetails;Array.isArray(a)&&a.length>0&&"RETRY_REQUEST_LATER"===a[0].responseAction&&(Cz=e(p)(n).concat(e(p)(Cz)),ZK.info("Retry transport request later.")),Sz=3,Nz(i)}))}({request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:sz.getInstance().logSource,log_event:n},t).catch((function(){Cz=e(p)(t).concat(e(p)(Cz)),Sz--,ZK.info("Tries left: ".concat(Sz,".")),Nz(Ez)}))):Nz(Ez)}),t)}function Rz(t){if(!t.eventTime||!t.message)throw $K.create("invalid cc log");Cz=e(p)(Cz).concat([t])}function Dz(t,n){var r;
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Tz||(r=Mz,Tz=function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];Rz({message:r.apply(void 0,e(p)(n)),eventTime:Date.now()})}),Tz(t,n)}function Pz(e){var t=sz.getInstance();!t.instrumentationEnabled&&e.isAuto||(t.dataCollectionEnabled||e.isAuto)&&nz.getInstance().requiredApisAvailable()&&(e.isAuto&&hz()!==az.VISIBLE||(3===bz?Oz(e):xz(e.performanceController).then((function(){return Oz(e)}),(function(){return Oz(e)}))))}function Oz(e){if(rz()){var t=sz.getInstance();t.loggingEnabled&&t.logTraceAfterSampling&&setTimeout((function(){return Dz(e,1)}),0)}}function Mz(e,t){return 0===t?(r={url:(n=e).url,http_method:n.httpMethod||0,http_response_code:200,response_payload_bytes:n.responsePayloadBytes,client_start_time_us:n.startTimeUs,time_to_response_initiated_us:n.timeToResponseInitiatedUs,time_to_response_completed_us:n.timeToResponseCompletedUs},i={application_info:Lz(n.performanceController.app),network_request_metric:r},JSON.stringify(i)):function(e){var t={name:e.name,is_auto:e.isAuto,client_start_time_us:e.startTimeUs,duration_us:e.durationUs};0!==Object.keys(e.counters).length&&(t.counters=e.counters);var n=e.getAttributes();0!==Object.keys(n).length&&(t.custom_attributes=n);var r={application_info:Lz(e.performanceController.app),trace_metric:t};return JSON.stringify(r)}(e);var n,r,i}function Lz(e){return{google_app_id:dz(e),app_instance_id:rz(),web_app_info:{sdk_version:jK,page_url:nz.getInstance().getUrl(),service_worker_status:lz(),visibility_state:hz(),effective_connection_type:fz()},application_process_state:0}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Fz=["_fp",GK,HK];
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Uz=function(){"use strict";function t(n,r){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3?arguments[3]:void 0;e(l)(this,t),this.performanceController=n,this.name=r,this.isAuto=i,this.state=1,this.customAttributes={},this.counters={},this.api=nz.getInstance(),this.randomId=Math.floor(1e6*Math.random()),this.isAuto||(this.traceStartMark="".concat(BK,"-").concat(this.randomId,"-").concat(this.name),this.traceStopMark="".concat(KK,"-").concat(this.randomId,"-").concat(this.name),this.traceMeasure=a||"".concat(zK,"-").concat(this.randomId,"-").concat(this.name),a&&this.calculateTraceMetrics())}return e(h)(t,[{key:"start",value:function(){if(1!==this.state)throw $K.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2}},{key:"stop",value:function(){if(2!==this.state)throw $K.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),Pz(this)}},{key:"record",value:function(e,t,n){if(e<=0)throw $K.create("nonpositive trace startTime",{traceName:this.name});if(t<=0)throw $K.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(1e3*t),this.startTimeUs=Math.floor(1e3*e),n&&n.attributes&&(this.customAttributes=Object.assign({},n.attributes)),n&&n.metrics){var r=!0,i=!1,a=void 0;try{for(var o,s=Object.keys(n.metrics)[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;isNaN(Number(n.metrics[u]))||(this.counters[u]=Math.floor(Number(n.metrics[u])))}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}}Pz(this)}},{key:"incrementMetric",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;void 0===this.counters[e]?this.putMetric(e,t):this.putMetric(e,this.counters[e]+t)}},{key:"putMetric",value:function(e,t){if(i=e,a=this.name,0===i.length||i.length>100||!(a&&a.startsWith(WK)&&Fz.indexOf(i)>-1)&&i.startsWith("_"))throw $K.create("invalid custom metric name",{customMetricName:e});var n,r,i,a;this.counters[e]=(n=null!=t?t:0,(r=Math.floor(n))<n&&ZK.info("Metric value should be an Integer, setting the value as : ".concat(r,".")),r)}},{key:"getMetric",value:function(e){return this.counters[e]||0}},{key:"putAttribute",value:function(e,t){var n,r=!(0===(n=e).length||n.length>40||uz.some((function(e){return n.startsWith(e)}))||!n.match(cz)),i=function(e){return 0!==e.length&&e.length<=100}(t);if(r&&i)this.customAttributes[e]=t;else{if(!r)throw $K.create("invalid attribute name",{attributeName:e});if(!i)throw $K.create("invalid attribute value",{attributeValue:t})}}},{key:"getAttribute",value:function(e){return this.customAttributes[e]}},{key:"removeAttribute",value:function(e){void 0!==this.customAttributes[e]&&delete this.customAttributes[e]}},{key:"getAttributes",value:function(){return Object.assign({},this.customAttributes)}},{key:"setStartTime",value:function(e){this.startTimeUs=e}},{key:"setDuration",value:function(e){this.durationUs=e}},{key:"calculateTraceMetrics",value:function(){var e=this.api.getEntriesByName(this.traceMeasure),t=e&&e[0];t&&(this.durationUs=Math.floor(1e3*t.duration),this.startTimeUs=Math.floor(1e3*(t.startTime+this.api.getTimeOrigin())))}}],[{key:"createOobTrace",value:function(e,n,r,i){var a=nz.getInstance().getUrl();if(a){var o=new t(e,WK+a,!0),s=Math.floor(1e3*nz.getInstance().getTimeOrigin());o.setStartTime(s),n&&n[0]&&(o.setDuration(Math.floor(1e3*n[0].duration)),o.putMetric("domInteractive",Math.floor(1e3*n[0].domInteractive)),o.putMetric("domContentLoadedEventEnd",Math.floor(1e3*n[0].domContentLoadedEventEnd)),o.putMetric("loadEventEnd",Math.floor(1e3*n[0].loadEventEnd)));if(r){var u=r.find((function(e){return"first-paint"===e.name}));u&&u.startTime&&o.putMetric("_fp",Math.floor(1e3*u.startTime));var c=r.find((function(e){return"first-contentful-paint"===e.name}));c&&c.startTime&&o.putMetric(GK,Math.floor(1e3*c.startTime)),i&&o.putMetric(HK,Math.floor(1e3*i))}Pz(o)}}},{key:"createUserTimingTrace",value:function(e,n){Pz(new t(e,n,!1,n))}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qz(e,t){var n=t;if(n&&void 0!==n.responseStart){var r=nz.getInstance().getTimeOrigin(),i=Math.floor(1e3*(n.startTime+r)),a=n.responseStart?Math.floor(1e3*(n.responseStart-n.startTime)):void 0,o=Math.floor(1e3*(n.responseEnd-n.startTime));!function(e){var t=sz.getInstance();if(t.instrumentationEnabled){var n=e.url,r=t.logEndPointUrl.split("?")[0],i=t.flTransportEndpointUrl.split("?")[0];n!==r&&n!==i&&t.loggingEnabled&&t.logNetworkAfterSampling&&setTimeout((function(){return Dz(e,0)}),0)}}({performanceController:e,url:n.name&&n.name.split("?")[0],responsePayloadBytes:n.transferSize,startTimeUs:i,timeToResponseInitiatedUs:a,timeToResponseCompletedUs:o})}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vz(e){rz()&&(setTimeout((function(){return function(e){var t=nz.getInstance(),n=t.getEntriesByType("navigation"),r=t.getEntriesByType("paint");if(t.onFirstInputDelay){var i=setTimeout((function(){Uz.createOobTrace(e,n,r),i=void 0}),5e3);t.onFirstInputDelay((function(t){i&&(clearTimeout(i),Uz.createOobTrace(e,n,r,t))}))}else Uz.createOobTrace(e,n,r)}(e)}),0),setTimeout((function(){return function(e){var t=nz.getInstance(),n=t.getEntriesByType("resource"),r=!0,i=!1,a=void 0;try{for(var o,s=n[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;qz(e,u)}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}t.setupObserver("resource",(function(t){return qz(e,t)}))}(e)}),0),setTimeout((function(){return function(e){var t=nz.getInstance(),n=t.getEntriesByType("measure"),r=!0,i=!1,a=void 0;try{for(var o,s=n[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;jz(e,u)}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}t.setupObserver("measure",(function(t){return jz(e,t)}))}(e)}),0))}function jz(e,t){var n=t.name;n.substring(0,zK.length)!==zK&&Uz.createUserTimingTrace(e,n)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Bz=function(){"use strict";function t(n,r){e(l)(this,t),this.app=n,this.installations=r,this.initialized=!1}return e(h)(t,[{key:"_init",value:function(e){var t=this;this.initialized||(void 0!==(null==e?void 0:e.dataCollectionEnabled)&&(this.dataCollectionEnabled=e.dataCollectionEnabled),void 0!==(null==e?void 0:e.instrumentationEnabled)&&(this.instrumentationEnabled=e.instrumentationEnabled),nz.getInstance().requiredApisAvailable()?Ie().then((function(e){if(e){var n=t;Az||(Nz(5500),Az=!0),xz(t).then((function(){return Vz(n)}),(function(){return Vz(n)})),t.initialized=!0}})).catch((function(e){ZK.info("Environment doesn't support IndexedDB: ".concat(e))})):ZK.info('Firebase Performance cannot start if the browser does not support "Fetch" and "Promise", or cookies are disabled.'))}},{key:"instrumentationEnabled",get:function(){return sz.getInstance().instrumentationEnabled},set:function(e){sz.getInstance().instrumentationEnabled=e}},{key:"dataCollectionEnabled",get:function(){return sz.getInstance().dataCollectionEnabled},set:function(e){sz.getInstance().dataCollectionEnabled=e}}]),t}();rn(new ht("performance",(function(e,t){var n=t.options,r=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();if("[DEFAULT]"!==r.name)throw $K.create("FB not default");if("undefined"==typeof window)throw $K.create("no window");!function(e){UK=e}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(window);var a=new Bz(r,i);return a._init(n),a}),"PUBLIC")),mn(qK,VK),mn(qK,VK,"esm2017");
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Kz,zz=function(){"use strict";function t(n,r){e(l)(this,t),this.app=n,this._delegate=r}return e(h)(t,[{key:"instrumentationEnabled",get:function(){return this._delegate.instrumentationEnabled},set:function(e){this._delegate.instrumentationEnabled=e}},{key:"dataCollectionEnabled",get:function(){return this._delegate.dataCollectionEnabled},set:function(e){this._delegate.dataCollectionEnabled=e}},{key:"trace",value:function(e){return t=this._delegate,n=e,t=lt(t),new Uz(t,n);var t,n}}]),t}();function Wz(e){var t=e.getProvider("app-compat").getImmediate(),n=e.getProvider("performance").getImmediate();return new zz(t,n)}(Kz=Fc).INTERNAL.registerComponent(new ht("performance-compat",Wz,"PUBLIC")),Kz.registerVersion("@firebase/performance-compat","0.2.0");d=o("hKHmD");var Gz,Hz="@firebase/remote-config",Qz="0.4.0",Yz=function(){"use strict";function t(){e(l)(this,t),this.listeners=[]}return e(h)(t,[{key:"addEventListener",value:function(e){this.listeners.push(e)}},{key:"abort",value:function(){this.listeners.forEach((function(e){return e()}))}}]),t}(),Jz="remote-config",Xz=(Gz={},e(d)(Gz,"registration-window","Undefined window object. This SDK only supports usage in a browser environment."),e(d)(Gz,"registration-project-id","Undefined project identifier. Check Firebase app initialization."),e(d)(Gz,"registration-api-key","Undefined API key. Check Firebase app initialization."),e(d)(Gz,"registration-app-id","Undefined app identifier. Check Firebase app initialization."),e(d)(Gz,"storage-open","Error thrown when opening storage. Original error: {$originalErrorMessage}."),e(d)(Gz,"storage-get","Error thrown when reading from storage. Original error: {$originalErrorMessage}."),e(d)(Gz,"storage-set","Error thrown when writing to storage. Original error: {$originalErrorMessage}."),e(d)(Gz,"storage-delete","Error thrown when deleting from storage. Original error: {$originalErrorMessage}."),e(d)(Gz,"fetch-client-network","Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}."),e(d)(Gz,"fetch-timeout",'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.'),e(d)(Gz,"fetch-throttle",'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.'),e(d)(Gz,"fetch-client-parse","Fetch client could not parse response. Original error: {$originalErrorMessage}."),e(d)(Gz,"fetch-status","Fetch server returned an HTTP error status. HTTP status: {$httpStatus}."),e(d)(Gz,"indexed-db-unavailable","Indexed DB is not supported by current browser"),Gz),$z=new Me("remoteconfig","Remote Config",Xz);function Zz(e,t){return e instanceof Oe&&-1!==e.code.indexOf(t)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var eW=["1","true","t","yes","y","on"],tW=function(){"use strict";function t(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";e(l)(this,t),this._source=n,this._value=r}return e(h)(t,[{key:"asString",value:function(){return this._value}},{key:"asBoolean",value:function(){return"static"!==this._source&&eW.indexOf(this._value.toLowerCase())>=0}},{key:"asNumber",value:function(){if("static"===this._source)return 0;var e=Number(this._value);return isNaN(e)&&(e=0),e}},{key:"getSource",value:function(){return this._source}}]),t}();function nW(e){return rW.apply(this,arguments)}function rW(){return(rW=e(u)(e(_).mark((function t(n){var r,i,a,o;return e(_).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=lt(n),t.t0=e(b),t.next=4,Promise.all([r._storage.getLastSuccessfulFetchResponse(),r._storage.getActiveConfigEtag()]);case 4:if(t.t1=t.sent,i=(0,t.t0)(t.t1,2),a=i[0],o=i[1],a&&a.config&&a.eTag&&a.eTag!==o){t.next=10;break}return t.abrupt("return",!1);case 10:return t.next=12,Promise.all([r._storageCache.setActiveConfig(a.config),r._storage.setActiveConfigEtag(a.eTag)]);case 12:return t.abrupt("return",!0);case 13:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function iW(e){var t=lt(e);return t._initializePromise||(t._initializePromise=t._storageCache.loadFromStorage().then((function(){t._isInitializationComplete=!0}))),t._initializePromise}function aW(e){return oW.apply(this,arguments)}function oW(){return(oW=e(u)(e(_).mark((function t(n){var r,i,a;return e(_).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=lt(n),i=new Yz,setTimeout(e(u)(e(_).mark((function t(){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i.abort();case 1:case"end":return e.stop()}}),t)}))),r.settings.fetchTimeoutMillis),t.prev=3,t.next=6,r._client.fetch({cacheMaxAgeMillis:r.settings.minimumFetchIntervalMillis,signal:i});case 6:return t.next=8,r._storageCache.setLastFetchStatus("success");case 8:t.next=16;break;case 10:return t.prev=10,t.t0=t.catch(3),a=Zz(t.t0,"fetch-throttle")?"throttle":"failure",t.next=15,r._storageCache.setLastFetchStatus(a);case 15:throw t.t0;case 16:case"end":return t.stop()}}),t,null,[[3,10]])})))).apply(this,arguments)}function sW(e){var t=lt(e);return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(Object.assign(Object.assign({},e),t))}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t._storageCache.getActiveConfig(),t.defaultConfig).reduce((function(t,n){return t[n]=hW(e,n),t}),{})}function uW(e,t){return hW(lt(e),t).asBoolean()}function cW(e,t){return hW(lt(e),t).asNumber()}function lW(e,t){return hW(lt(e),t).asString()}function hW(e,t){var n=lt(e);n._isInitializationComplete||n._logger.debug('A value was requested for key "'.concat(t,'" before SDK initialization completed.')+" Await on ensureInitialized if the intent was to get a previously activated value.");var r=n._storageCache.getActiveConfig();return r&&void 0!==r[t]?new tW("remote",r[t]):n.defaultConfig&&void 0!==n.defaultConfig[t]?new tW("default",String(n.defaultConfig[t])):(n._logger.debug('Returning static value for key "'.concat(t,'".')+" Define a default or remote value if this is unintentional."),new tW("static"))}function fW(e,t){var n=lt(e);switch(t){case"debug":n._logger.logLevel=pt.DEBUG;break;case"silent":n._logger.logLevel=pt.SILENT;break;default:n._logger.logLevel=pt.ERROR}}var dW=function(){"use strict";function t(n,r,i,a){e(l)(this,t),this.client=n,this.storage=r,this.storageCache=i,this.logger=a}return e(h)(t,[{key:"isCachedDataFresh",value:function(e,t){if(!t)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;var n=Date.now()-t,r=n<=e;return this.logger.debug("Config fetch cache check."+" Cache age millis: ".concat(n,".")+" Cache max age millis (minimumFetchIntervalMillis setting): ".concat(e,".")+" Is cache hit: ".concat(r,".")),r}},{key:"fetch",value:function(t){var n=this;return e(u)(e(_).mark((function r(){var i,a,o,s,u;return e(_).wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=e(b),r.next=3,Promise.all([n.storage.getLastSuccessfulFetchTimestampMillis(),n.storage.getLastSuccessfulFetchResponse()]);case 3:if(r.t1=r.sent,i=(0,r.t0)(r.t1,2),a=i[0],!(o=i[1])||!n.isCachedDataFresh(t.cacheMaxAgeMillis,a)){r.next=9;break}return r.abrupt("return",o);case 9:return t.eTag=o&&o.eTag,r.next=12,n.client.fetch(t);case 12:return s=r.sent,u=[n.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())],200===s.status&&u.push(n.storage.setLastSuccessfulFetchResponse(s)),r.next=17,Promise.all(u);case 17:return r.abrupt("return",s);case 18:case"end":return r.stop()}}),r)})))()}}]),t}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pW(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator;return e.languages&&e.languages[0]||e.language}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var vW=function(){"use strict";function t(n,r,i,a,o,s){e(l)(this,t),this.firebaseInstallations=n,this.sdkVersion=r,this.namespace=i,this.projectId=a,this.apiKey=o,this.appId=s}return e(h)(t,[{key:"fetch",value:function(t){var n=this;return e(u)(e(_).mark((function r(){var i,a,o,s,u,c,l,h,f,d,p,v,y,m,g,k,w;return e(_).wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=e(b),r.next=3,Promise.all([n.firebaseInstallations.getId(),n.firebaseInstallations.getToken()]);case 3:return r.t1=r.sent,i=(0,r.t0)(r.t1,2),a=i[0],o=i[1],s=window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com",u="".concat(s,"/v1/projects/").concat(n.projectId,"/namespaces/").concat(n.namespace,":fetch?key=").concat(n.apiKey),c={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":t.eTag||"*"},l={sdk_version:n.sdkVersion,app_instance_id:a,app_instance_id_token:o,app_id:n.appId,language_code:pW()},h={method:"POST",headers:c,body:JSON.stringify(l)},f=fetch(u,h),d=new Promise((function(e,n){t.signal.addEventListener((function(){var e=new Error("The operation was aborted.");e.name="AbortError",n(e)}))})),r.prev=15,r.next=18,Promise.race([f,d]);case 18:return r.next=20,f;case 20:p=r.sent,r.next=28;break;case 23:throw r.prev=23,r.t2=r.catch(15),v="fetch-client-network","AbortError"===(null===r.t2||void 0===r.t2?void 0:r.t2.name)&&(v="fetch-timeout"),$z.create(v,{originalErrorMessage:null===r.t2||void 0===r.t2?void 0:r.t2.message});case 28:if(y=p.status,m=p.headers.get("ETag")||void 0,200!==p.status){r.next=45;break}return r.prev=34,r.next=37,p.json();case 37:w=r.sent,r.next=43;break;case 40:throw r.prev=40,r.t3=r.catch(34),$z.create("fetch-client-parse",{originalErrorMessage:null===r.t3||void 0===r.t3?void 0:r.t3.message});case 43:g=w.entries,k=w.state;case 45:if("INSTANCE_STATE_UNSPECIFIED"===k?y=500:"NO_CHANGE"===k?y=304:"NO_TEMPLATE"!==k&&"EMPTY_CONFIG"!==k||(g={}),304===y||200===y){r.next=48;break}throw $z.create("fetch-status",{httpStatus:y});case 48:return r.abrupt("return",{status:y,eTag:m,config:g});case 49:case"end":return r.stop()}}),r,null,[[15,23],[34,40]])})))()}}]),t}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yW(e,t){return new Promise((function(n,r){var i=Math.max(t-Date.now(),0),a=setTimeout(n,i);e.addEventListener((function(){clearTimeout(a),r($z.create("fetch-throttle",{throttleEndTimeMillis:t}))}))}))}function mW(e){if(!(e instanceof Oe&&e.customData))return!1;var t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}var gW=function(){"use strict";function t(n,r){e(l)(this,t),this.client=n,this.storage=r}return e(h)(t,[{key:"fetch",value:function(t){var n=this;return e(u)(e(_).mark((function r(){var i;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.storage.getThrottleMetadata();case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0={backoffCount:0,throttleEndTimeMillis:Date.now()};case 5:return i=e.t0,e.abrupt("return",n.attemptFetch(t,i));case 7:case"end":return e.stop()}}),r)})))()}},{key:"attemptFetch",value:function(t,n){var r=n.throttleEndTimeMillis,i=n.backoffCount,a=this;return e(u)(e(_).mark((function n(){var o,s;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,yW(t.signal,r);case 2:return e.prev=2,e.next=5,a.client.fetch(t);case 5:return o=e.sent,e.next=8,a.storage.deleteThrottleMetadata();case 8:return e.abrupt("return",o);case 11:if(e.prev=11,e.t0=e.catch(2),mW(e.t0)){e.next=15;break}throw e.t0;case 15:return s={throttleEndTimeMillis:Date.now()+ct(i),backoffCount:i+1},e.next=18,a.storage.setThrottleMetadata(s);case 18:return e.abrupt("return",a.attemptFetch(t,s));case 19:case"end":return e.stop()}}),n,null,[[2,11]])})))()}}]),t}(),kW=function(){"use strict";function t(n,r,i,a,o){e(l)(this,t),this.app=n,this._client=r,this._storageCache=i,this._storage=a,this._logger=o,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}return e(h)(t,[{key:"fetchTimeMillis",get:function(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}},{key:"lastFetchStatus",get:function(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}]),t}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function _W(e,t){var n=e.target.error||void 0;return $z.create(t,{originalErrorMessage:n&&(null==n?void 0:n.message)})}var wW="app_namespace_store";function bW(){return new Promise((function(e,t){try{var n=indexedDB.open("firebase_remote_config",1);n.onerror=function(e){t(_W(e,"storage-open"))},n.onsuccess=function(t){e(t.target.result)},n.onupgradeneeded=function(e){var t=e.target.result;if(0===e.oldVersion)t.createObjectStore(wW,{keyPath:"compositeKey"})}}catch(e){t($z.create("storage-open",{originalErrorMessage:null==e?void 0:e.message}))}}))}var xW=function(){"use strict";function t(n,r,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:bW();e(l)(this,t),this.appId=n,this.appName=r,this.namespace=i,this.openDbPromise=a}return e(h)(t,[{key:"getLastFetchStatus",value:function(){return this.get("last_fetch_status")}},{key:"setLastFetchStatus",value:function(e){return this.set("last_fetch_status",e)}},{key:"getLastSuccessfulFetchTimestampMillis",value:function(){return this.get("last_successful_fetch_timestamp_millis")}},{key:"setLastSuccessfulFetchTimestampMillis",value:function(e){return this.set("last_successful_fetch_timestamp_millis",e)}},{key:"getLastSuccessfulFetchResponse",value:function(){return this.get("last_successful_fetch_response")}},{key:"setLastSuccessfulFetchResponse",value:function(e){return this.set("last_successful_fetch_response",e)}},{key:"getActiveConfig",value:function(){return this.get("active_config")}},{key:"setActiveConfig",value:function(e){return this.set("active_config",e)}},{key:"getActiveConfigEtag",value:function(){return this.get("active_config_etag")}},{key:"setActiveConfigEtag",value:function(e){return this.set("active_config_etag",e)}},{key:"getThrottleMetadata",value:function(){return this.get("throttle_metadata")}},{key:"setThrottleMetadata",value:function(e){return this.set("throttle_metadata",e)}},{key:"deleteThrottleMetadata",value:function(){return this.delete("throttle_metadata")}},{key:"get",value:function(t){var n=this;return e(u)(e(_).mark((function r(){var i;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.openDbPromise;case 2:return i=e.sent,e.abrupt("return",new Promise((function(e,r){var a=i.transaction([wW],"readonly").objectStore(wW),o=n.createCompositeKey(t);try{var s=a.get(o);s.onerror=function(e){r(_W(e,"storage-get"))},s.onsuccess=function(t){var n=t.target.result;e(n?n.value:void 0)}}catch(e){r($z.create("storage-get",{originalErrorMessage:null==e?void 0:e.message}))}})));case 4:case"end":return e.stop()}}),r)})))()}},{key:"set",value:function(t,n){var r=this;return e(u)(e(_).mark((function i(){var a;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.openDbPromise;case 2:return a=e.sent,e.abrupt("return",new Promise((function(e,i){var o=a.transaction([wW],"readwrite").objectStore(wW),s=r.createCompositeKey(t);try{var u=o.put({compositeKey:s,value:n});u.onerror=function(e){i(_W(e,"storage-set"))},u.onsuccess=function(){e()}}catch(e){i($z.create("storage-set",{originalErrorMessage:null==e?void 0:e.message}))}})));case 4:case"end":return e.stop()}}),i)})))()}},{key:"delete",value:function(t){var n=this;return e(u)(e(_).mark((function r(){var i;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.openDbPromise;case 2:return i=e.sent,e.abrupt("return",new Promise((function(e,r){var a=i.transaction([wW],"readwrite").objectStore(wW),o=n.createCompositeKey(t);try{var s=a.delete(o);s.onerror=function(e){r(_W(e,"storage-delete"))},s.onsuccess=function(){e()}}catch(e){r($z.create("storage-delete",{originalErrorMessage:null==e?void 0:e.message}))}})));case 4:case"end":return e.stop()}}),r)})))()}},{key:"createCompositeKey",value:function(e){return[this.appId,this.appName,this.namespace,e].join()}}]),t}(),IW=function(){"use strict";function t(n){e(l)(this,t),this.storage=n}return e(h)(t,[{key:"getLastFetchStatus",value:function(){return this.lastFetchStatus}},{key:"getLastSuccessfulFetchTimestampMillis",value:function(){return this.lastSuccessfulFetchTimestampMillis}},{key:"getActiveConfig",value:function(){return this.activeConfig}},{key:"loadFromStorage",value:function(){var t=this;return e(u)(e(_).mark((function n(){var r,i,a,o,s,u;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.storage.getLastFetchStatus(),i=t.storage.getLastSuccessfulFetchTimestampMillis(),a=t.storage.getActiveConfig(),e.next=5,r;case 5:return(o=e.sent)&&(t.lastFetchStatus=o),e.next=9,i;case 9:return(s=e.sent)&&(t.lastSuccessfulFetchTimestampMillis=s),e.next=13,a;case 13:(u=e.sent)&&(t.activeConfig=u);case 15:case"end":return e.stop()}}),n)})))()}},{key:"setLastFetchStatus",value:function(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)}},{key:"setLastSuccessfulFetchTimestampMillis",value:function(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)}},{key:"setActiveConfig",value:function(e){return this.activeConfig=e,this.storage.setActiveConfig(e)}}]),t}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TW(e){return EW.apply(this,arguments)}function EW(){return(EW=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(_).mark((function t(n){return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=lt(n),e.next=3,aW(n);case 3:return e.abrupt("return",nW(n));case 4:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function SW(){return CW.apply(this,arguments)}function CW(){return(CW=e(u)(e(_).mark((function t(){var n;return e(_).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(xe()){e.next=2;break}return e.abrupt("return",!1);case 2:return e.prev=2,e.next=5,Ie();case 5:return n=e.sent,e.abrupt("return",n);case 9:return e.prev=9,e.t0=e.catch(2),e.abrupt("return",!1);case 12:case"end":return e.stop()}}),t,null,[[2,9]])})))).apply(this,arguments)}rn(new ht(Jz,(function(e,t){var n=t.instanceIdentifier,r=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();if("undefined"==typeof window)throw $z.create("registration-window");if(!xe())throw $z.create("indexed-db-unavailable");var a=r.options,o=a.projectId,s=a.apiKey,u=a.appId;if(!o)throw $z.create("registration-project-id");if(!s)throw $z.create("registration-api-key");if(!u)throw $z.create("registration-app-id");n=n||"firebase";var c=new xW(u,r.name,n),l=new IW(c),h=new xt(Hz);h.logLevel=pt.ERROR;var f=new vW(i,hn,n,o,s,u),d=new gW(f,c),p=new dW(d,c,l,h),v=new kW(r,p,l,c,h);return iW(v),v}),"PUBLIC").setMultipleInstances(!0)),mn(Hz,Qz),mn(Hz,Qz,"esm2017");
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var AW=function(){"use strict";function t(n,r){e(l)(this,t),this.app=n,this._delegate=r}return e(h)(t,[{key:"defaultConfig",get:function(){return this._delegate.defaultConfig},set:function(e){this._delegate.defaultConfig=e}},{key:"fetchTimeMillis",get:function(){return this._delegate.fetchTimeMillis}},{key:"lastFetchStatus",get:function(){return this._delegate.lastFetchStatus}},{key:"settings",get:function(){return this._delegate.settings},set:function(e){this._delegate.settings=e}},{key:"activate",value:function(){return nW(this._delegate)}},{key:"ensureInitialized",value:function(){return iW(this._delegate)}},{key:"fetch",value:function(){return aW(this._delegate)}},{key:"fetchAndActivate",value:function(){return TW(this._delegate)}},{key:"getAll",value:function(){return sW(this._delegate)}},{key:"getBoolean",value:function(e){return uW(this._delegate,e)}},{key:"getNumber",value:function(e){return cW(this._delegate,e)}},{key:"getString",value:function(e){return lW(this._delegate,e)}},{key:"getValue",value:function(e){return hW(this._delegate,e)}},{key:"setLogLevel",value:function(e){fW(this._delegate,e)}}]),t}();function NW(e,t){var n=t.instanceIdentifier,r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("remote-config").getImmediate({identifier:n});return new AW(r,i)}!
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(e){e.INTERNAL.registerComponent(new ht("remoteConfig-compat",NW,"PUBLIC").setMultipleInstances(!0).setServiceProps({isSupported:SW})),e.registerVersion("@firebase/remote-config-compat","0.2.0")}(Fc);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
Fc.registerVersion("firebase","9.15.0","app-compat");
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
console.warn("\nIt looks like you're using the development build of the Firebase JS SDK.\nWhen deploying Firebase apps to production, it is advisable to only import\nthe individual SDK components you intend to use.\n\nFor the module builds, these are available in the following manner\n(replace <PACKAGE> with the name of a component - i.e. auth, database, etc):\n\nCommonJS Modules:\nconst firebase = require('firebase/app');\nrequire('firebase/<PACKAGE>');\n\nES Modules:\nimport firebase from 'firebase/app';\nimport 'firebase/<PACKAGE>';\n\nTypescript:\nimport firebase from 'firebase/app';\nimport 'firebase/<PACKAGE>';\n"),Fc.registerVersion("firebase","9.15.0","compat");fn({apiKey:"AIzaSyDzrIjxMANcnuFMVxmD7t6ueqbK3ijInpU",authDomain:"orddreamer-test-firebase.firebaseapp.com",projectId:"orddreamer-test-firebase",storageBucket:"orddreamer-test-firebase.appspot.com",messagingSenderId:"256769224354",appId:"1:256769224354:web:13d1372c5f53d117c3b1fb"});var RW=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:dn(),n=arguments.length>1?arguments[1]:void 0,r=an(t,"database").getImmediate({identifier:n}),i=Ae("database");return i&&bc.apply(void 0,[r].concat(e(p)(i))),r}();var DW={form:document.querySelector("#main-form"),list:document.querySelector(".main-list")};DW.form.addEventListener("submit",(function(e){e.preventDefault();var t=e.currentTarget.elements,n=t["input-id"],r=t["input-name"];!function(e,t){Cu(Tu(RW,"users/"+OW.uid+"/library"),{id:e,watched:!1}).then((function(){console.log("Write => Done!")}))}(n.value,r.value)}));var PW=new yy,OW=null,MW=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:dn(),t=an(e,"auth");if(t.isInitialized())return t.getImmediate();var n=pp(e,{popupRedirectResolver:Kk,persistence:[ig,Om,Lm]}),r=Re("authTokenSyncURL");if(r){var i=$k(r);Tm(n,i,(function(){return i(n.currentUser)})),Im(n,(function(e){return i(e)}))}var a=Ce("auth");return a&&Sv(n,"http://".concat(a)),n}();Vg(MW,PW).then((function(e){OW=e.user,Uu(Tu(RW,"users/"+OW.uid+"/library"),(function(e){var t=e.val();console.log(t);var n="";t&&(n=Object.values(t).map((function(e){return'\n      <li class="main-list-item">\n        <p><b>'.concat(e.id,"</b></p>\n        <p>Wathced: ").concat(e.watched,"</p>\n      </li>\n    ")})).join("")),DW.list.innerHTML=n,console.log("Read => Done!")}))})).catch((function(e){console.error("Сталася помилка, спробуйте, будь ласка, ще раз.")}))}();
//# sourceMappingURL=index.17d2ec60.js.map
